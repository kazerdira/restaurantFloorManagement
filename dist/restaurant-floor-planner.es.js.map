{"version":3,"file":"restaurant-floor-planner.es.js","sources":["../src/floorPlanner/constants.ts","../src/floorPlanner/utils.ts","../src/floorPlanner/components/Chair.tsx","../src/floorPlanner/components/Table.tsx","../src/floorPlanner/components/FloorObject.tsx","../src/floorPlanner/components/Wall.tsx","../src/floorPlanner/components/FixedElement.tsx","../src/floorPlanner/components/Sidebar.tsx","../src/floorPlanner/components/Toolbar.tsx","../src/floorPlanner/components/Preview3DModal.tsx","../src/RestaurantFloorPlanner.tsx"],"sourcesContent":["import { Circle, Square, Wine, ChefHat, Bath, DoorOpen, RectangleVertical, Columns, Rows } from 'lucide-react';\r\nimport type { ChairPosition, TableShapeIconMap, TableSize, TableShape, ObjectType, ObjectIconMap, WallType, FixedElementType } from './types';\r\n\r\nexport const hexagonStyle = `\r\n  .hexagon-shape {\r\n    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);\r\n  }\r\n`;\r\n\r\nexport const GRID_SIZE = 20;\r\n\r\nexport const TABLE_SIZES: Record<TableSize, { width: number; height: number }> = {\r\n  small: { width: 50, height: 50 },\r\n  medium: { width: 90, height: 90 },\r\n  large: { width: 130, height: 130 }\r\n};\r\n\r\nexport const TABLE_SHAPES: TableShapeIconMap = {\r\n  square: Square,\r\n  circle: Circle,\r\n  rectangle: Square,\r\n  hexagon: Square\r\n};\r\n\r\nexport const SIZE_LABELS: Record<TableSize, string> = {\r\n  small: 'Small',\r\n  medium: 'Medium',\r\n  large: 'Big'\r\n};\r\n\r\nexport const CHAIR_POSITIONS: ChairPosition[] = ['top', 'bottom', 'left', 'right'];\r\n\r\nexport const TABLE_SHAPE_LABELS: Record<TableShape, string> = {\r\n  square: 'Square',\r\n  circle: 'Circle',\r\n  rectangle: 'Rectangle',\r\n  hexagon: 'Hexagon'\r\n};\r\n\r\nexport const OBJECT_ICONS: ObjectIconMap = {\r\n  bar: Wine,\r\n  kitchen: ChefHat,\r\n  toilet: Bath\r\n};\r\n\r\nexport const OBJECT_LABELS: Record<ObjectType, string> = {\r\n  bar: 'Bar',\r\n  kitchen: 'Kitchen',\r\n  toilet: 'Toilet'\r\n};\r\n\r\nexport const OBJECT_COLORS: Record<ObjectType, { bg: string; border: string; text: string }> = {\r\n  bar: {\r\n    bg: 'bg-gradient-to-br from-purple-500 to-purple-700',\r\n    border: 'border-purple-600',\r\n    text: 'text-purple-100'\r\n  },\r\n  kitchen: {\r\n    bg: 'bg-gradient-to-br from-orange-500 to-orange-700',\r\n    border: 'border-orange-600',\r\n    text: 'text-orange-100'\r\n  },\r\n  toilet: {\r\n    bg: 'bg-gradient-to-br from-cyan-500 to-cyan-700',\r\n    border: 'border-cyan-600',\r\n    text: 'text-cyan-100'\r\n  }\r\n};\r\n\r\nexport const WALL_LABELS: Record<WallType, string> = {\r\n  wall: 'Wall',\r\n  door: 'Door',\r\n  window: 'Window'\r\n};\r\n\r\nexport const WALL_ICONS = {\r\n  wall: RectangleVertical,\r\n  door: DoorOpen,\r\n  window: RectangleVertical\r\n};\r\n\r\nexport const WALL_COLORS: Record<WallType, { stroke: string; fill: string; hover: string }> = {\r\n  wall: {\r\n    stroke: 'stroke-gray-800',\r\n    fill: 'fill-gray-700',\r\n    hover: 'hover:stroke-gray-900'\r\n  },\r\n  door: {\r\n    stroke: 'stroke-amber-600',\r\n    fill: 'fill-amber-500',\r\n    hover: 'hover:stroke-amber-700'\r\n  },\r\n  window: {\r\n    stroke: 'stroke-blue-600',\r\n    fill: 'fill-blue-400',\r\n    hover: 'hover:stroke-blue-700'\r\n  }\r\n};\r\n\r\nexport const FIXED_ELEMENT_LABELS: Record<FixedElementType, string> = {\r\n  pillar: 'Pillar',\r\n  column: 'Column',\r\n  stairs: 'Stairs'\r\n};\r\n\r\nexport const FIXED_ELEMENT_ICONS = {\r\n  pillar: Columns,\r\n  column: Columns,\r\n  stairs: Rows\r\n};\r\n\r\nexport const FIXED_ELEMENT_COLORS: Record<FixedElementType, { bg: string; border: string; text: string }> = {\r\n  pillar: {\r\n    bg: 'bg-gradient-to-br from-gray-600 to-gray-800',\r\n    border: 'border-gray-700',\r\n    text: 'text-gray-100'\r\n  },\r\n  column: {\r\n    bg: 'bg-gradient-to-br from-slate-600 to-slate-800',\r\n    border: 'border-slate-700',\r\n    text: 'text-slate-100'\r\n  },\r\n  stairs: {\r\n    bg: 'bg-gradient-to-br from-stone-600 to-stone-800',\r\n    border: 'border-stone-700',\r\n    text: 'text-stone-100'\r\n  }\r\n};\r\n","import type { ChairPosition, Table, TableShape, TableSize } from './types';\r\nimport { TABLE_SIZES } from './constants';\r\n\r\nexport const generateId = (): string => Math.random().toString(36).slice(2, 11);\r\n\r\nexport const calculateChairSize = (table: Table): number => {\r\n  const actualWidth = table.shape === 'rectangle' ? table.width * 1.5 : table.width;\r\n  const limitingDimension = Math.min(actualWidth, table.height);\r\n  const scaled = Math.round(limitingDimension * 0.35);\r\n  return Math.max(18, Math.min(48, scaled));\r\n};\r\n\r\nexport const getActualTableWidth = (table: Table): number =>\r\n  table.shape === 'rectangle' ? table.width * 1.5 : table.width;\r\n\r\nexport const resolveTableDimensions = (\r\n  shape: TableShape,\r\n  size: TableSize\r\n): { width: number; height: number } => {\r\n  const { width, height } = TABLE_SIZES[size];\r\n  return {\r\n    width: shape === 'rectangle' ? width * 1.5 : width,\r\n    height\r\n  };\r\n};\r\n\r\nexport const getNextChairPosition = (\r\n  occupied: Set<ChairPosition>\r\n): ChairPosition | null => {\r\n  const candidates: ChairPosition[] = ['top', 'bottom', 'left', 'right'];\r\n  return candidates.find((position) => !occupied.has(position)) ?? null;\r\n};\r\n\r\n/**\r\n * Snap wall endpoint to horizontal or vertical axis\r\n * Makes drawing walls much easier and more professional\r\n */\r\nexport const snapToAxis = (\r\n  start: { x: number; y: number },\r\n  end: { x: number; y: number }\r\n): { x: number; y: number } => {\r\n  const dx = Math.abs(end.x - start.x);\r\n  const dy = Math.abs(end.y - start.y);\r\n\r\n  // If closer to horizontal, snap to horizontal\r\n  if (dx > dy) {\r\n    return { x: end.x, y: start.y };\r\n  } else {\r\n    // Snap to vertical\r\n    return { x: start.x, y: end.y };\r\n  }\r\n};\r\n","import React from 'react';\r\nimport { Armchair } from 'lucide-react';\r\n\r\nimport type { Chair, Table } from '../types';\r\nimport { calculateChairSize, getActualTableWidth } from '../utils';\r\n\r\nexport interface ChairComponentProps {\r\n  chair: Chair;\r\n  table: Table;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDrag: (event: React.MouseEvent, id: string) => void;\r\n  onDragEnd: () => void;\r\n  totalChairsOnSide: number; // Total chairs on this side\r\n}\r\n\r\nexport const ChairComponent: React.FC<ChairComponentProps> = ({\r\n  chair,\r\n  table,\r\n  isSelected,\r\n  onSelect,\r\n  onDrag,\r\n  onDragEnd,\r\n  totalChairsOnSide\r\n}) => {\r\n  // Use custom size if provided, otherwise calculate default and increase by 30%\r\n  const baseChairSize = calculateChairSize(table);\r\n  const chairSize = chair.size ?? Math.round(baseChairSize * 1.3);\r\n  const spacing = Math.max(10, Math.round(chairSize * 0.25));\r\n  const iconSize = Math.min(chairSize - 4, Math.max(20, Math.round(chairSize * 0.65)));\r\n  const tableWidth = getActualTableWidth(table);\r\n  const tableRotation = (table.rotation || 0) * (Math.PI / 180); // Convert to radians\r\n\r\n  const position = (() => {\r\n    // Determine side length based on chair position\r\n    const sideLength = chair.position === 'top' || chair.position === 'bottom' \r\n      ? tableWidth \r\n      : table.height;\r\n    \r\n    // Calculate spacing between chairs more accurately\r\n    const availableSpace = sideLength - (chairSize * totalChairsOnSide);\r\n    const gapBetweenChairs = totalChairsOnSide > 1 \r\n      ? availableSpace / (totalChairsOnSide + 1) \r\n      : availableSpace / 2;\r\n    \r\n    // Calculate the chair's offset along its side\r\n    const offsetAlongSide = gapBetweenChairs + (chair.index * (chairSize + gapBetweenChairs)) + chairSize / 2;\r\n    \r\n    // Calculate position relative to table center (before rotation)\r\n    let relativeX = 0;\r\n    let relativeY = 0;\r\n    \r\n    switch (chair.position) {\r\n      case 'top':\r\n        relativeX = offsetAlongSide - tableWidth / 2;\r\n        relativeY = -(table.height / 2 + spacing + chairSize / 2);\r\n        break;\r\n      case 'bottom':\r\n        relativeX = offsetAlongSide - tableWidth / 2;\r\n        relativeY = table.height / 2 + spacing + chairSize / 2;\r\n        break;\r\n      case 'left':\r\n        relativeX = -(tableWidth / 2 + spacing + chairSize / 2);\r\n        relativeY = offsetAlongSide - table.height / 2;\r\n        break;\r\n      case 'right':\r\n        relativeX = tableWidth / 2 + spacing + chairSize / 2;\r\n        relativeY = offsetAlongSide - table.height / 2;\r\n        break;\r\n    }\r\n    \r\n    // Apply rotation transformation around table center\r\n    const rotatedX = relativeX * Math.cos(tableRotation) - relativeY * Math.sin(tableRotation);\r\n    const rotatedY = relativeX * Math.sin(tableRotation) + relativeY * Math.cos(tableRotation);\r\n    \r\n    // Convert to absolute position\r\n    const tableCenterX = table.x + tableWidth / 2;\r\n    const tableCenterY = table.y + table.height / 2;\r\n    \r\n    return {\r\n      x: tableCenterX + rotatedX - chairSize / 2,\r\n      y: tableCenterY + rotatedY - chairSize / 2\r\n    };\r\n  })();\r\n\r\n  // Calculate chair rotation based on position and table rotation\r\n  const getChairRotation = () => {\r\n    let baseRotation = 0;\r\n    switch (chair.position) {\r\n      case 'top':\r\n        baseRotation = 0;\r\n        break;\r\n      case 'right':\r\n        baseRotation = 90;\r\n        break;\r\n      case 'bottom':\r\n        baseRotation = 180;\r\n        break;\r\n      case 'left':\r\n        baseRotation = 270;\r\n        break;\r\n    }\r\n    return baseRotation + (table.rotation || 0);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move transition-all duration-150 ${\r\n        isSelected ? 'ring-4 ring-amber-400 ring-offset-2' : ''\r\n      }`}\r\n      style={{\r\n        left: position.x,\r\n        top: position.y,\r\n        width: chairSize,\r\n        height: chairSize,\r\n        transform: `rotate(${getChairRotation()}deg)`,\r\n        zIndex: isSelected ? 100 : 50,\r\n        filter: 'drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2))'\r\n      }}\r\n      onMouseDown={(event) => {\r\n        event.stopPropagation();\r\n        onSelect();\r\n        onDrag(event, chair.id);\r\n      }}\r\n      onMouseUp={onDragEnd}\r\n    >\r\n      <div className=\"rfp-w-full rfp-h-full bg-gradient-to-br from-amber-500 to-amber-700 rfp-rounded-lg rfp-border-4 border-amber-800 rfp-flex rfp-items-center rfp-justify-center rfp-shadow-xl hover:shadow-2xl hover:scale-105 rfp-transition-all\">\r\n        <Armchair size={iconSize} strokeWidth={3.5} className=\"text-amber-50\" />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\n\r\nimport type { Chair, Table } from '../types';\r\nimport { getActualTableWidth } from '../utils';\r\n\r\nexport interface TableComponentProps {\r\n  table: Table;\r\n  chairs: Chair[];\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDrag: (event: React.MouseEvent, id: string) => void;\r\n  onDragEnd: () => void;\r\n}\r\n\r\nexport const TableComponent: React.FC<TableComponentProps> = ({\r\n  table,\r\n  chairs,\r\n  isSelected,\r\n  onSelect,\r\n  onDrag,\r\n  onDragEnd\r\n}) => {\r\n  const containerStyle: React.CSSProperties = {\r\n    left: table.x,\r\n    top: table.y,\r\n    width: getActualTableWidth(table),\r\n    height: table.height,\r\n    zIndex: isSelected ? 100 : 50,\r\n    transform: `rotate(${table.rotation || 0}deg)`\r\n  };\r\n\r\n  const baseClasses =\r\n    'w-full h-full flex items-center justify-center relative';\r\n\r\n  const tableClasses =\r\n    table.shape === 'circle'\r\n      ? `${baseClasses} rounded-full`\r\n      : table.shape === 'hexagon'\r\n      ? `${baseClasses} hexagon-shape`\r\n      : baseClasses;\r\n\r\n  const tableChairs = chairs.filter((chair) => chair.tableId === table.id);\r\n  const seatsCount = tableChairs.length;\r\n  const nameMatch = table.name.match(/\\d+/);\r\n  const tableLabel = nameMatch ? nameMatch[0] : table.name;\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move transition-all duration-150 ${\r\n        isSelected ? 'ring-2 ring-emerald-500 ring-offset-2' : ''\r\n      }`}\r\n      style={containerStyle}\r\n      onMouseDown={(event) => {\r\n        event.stopPropagation();\r\n        onSelect();\r\n        onDrag(event, table.id);\r\n      }}\r\n      onClick={(event) => {\r\n        event.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseUp={onDragEnd}\r\n    >\r\n      <div className={tableClasses}>\r\n        {/* 3D Table Effect */}\r\n        <div \r\n          className=\"rfp-absolute rfp-inset-0 rounded-[inherit]\"\r\n          style={{\r\n            background: 'linear-gradient(145deg, #059669 0%, #047857 50%, #065f46 100%)',\r\n            boxShadow: `\r\n              0 8px 16px rgba(0, 0, 0, 0.3),\r\n              0 4px 8px rgba(0, 0, 0, 0.2),\r\n              inset 0 2px 4px rgba(255, 255, 255, 0.2),\r\n              inset 0 -2px 4px rgba(0, 0, 0, 0.2)\r\n            `\r\n          }}\r\n        />\r\n        \r\n        {/* Wood grain effect overlay */}\r\n        <div \r\n          className=\"rfp-absolute rfp-inset-0 rounded-[inherit] rfp-opacity-20\"\r\n          style={{\r\n            background: `\r\n              repeating-linear-gradient(\r\n                90deg,\r\n                transparent,\r\n                transparent 2px,\r\n                rgba(0, 0, 0, 0.1) 2px,\r\n                rgba(0, 0, 0, 0.1) 4px\r\n              )\r\n            `\r\n          }}\r\n        />\r\n        \r\n        {/* Bevel edge highlight */}\r\n        <div \r\n          className=\"rfp-absolute rfp-inset-0 rounded-[inherit]\"\r\n          style={{\r\n            border: '3px solid transparent',\r\n            borderImage: 'linear-gradient(145deg, rgba(255,255,255,0.4), rgba(0,0,0,0.2)) 1',\r\n            pointerEvents: 'none'\r\n          }}\r\n        />\r\n        \r\n        {/* Content */}\r\n        <div className=\"rfp-relative z-10 rfp-flex rfp-flex-col rfp-items-center rfp-justify-center rfp-gap-1 rfp-text-white rfp-drop-shadow-lg\">\r\n          <span className=\"rfp-text-xs rfp-font-bold rfp-uppercase rfp-tracking-wide\">N: {tableLabel}</span>\r\n          <span className=\"rfp-text-xs rfp-font-bold rfp-uppercase rfp-tracking-wide\">S: {seatsCount}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport type { FloorObject as FloorObjectType } from '../types';\r\nimport { OBJECT_ICONS, OBJECT_COLORS } from '../constants';\r\n\r\ninterface FloorObjectProps {\r\n  object: FloorObjectType;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDragStart: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport const FloorObjectComponent: React.FC<FloorObjectProps> = ({\r\n  object,\r\n  isSelected,\r\n  onSelect,\r\n  onDragStart\r\n}) => {\r\n  const Icon = OBJECT_ICONS[object.type];\r\n  const colors = OBJECT_COLORS[object.type];\r\n  const [isDragging, setIsDragging] = useState(false);\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    setIsDragging(true);\r\n    onDragStart(e);\r\n    \r\n    const handleMouseUp = () => {\r\n      setIsDragging(false);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n    \r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move select-none ${!isDragging ? 'transition-all duration-75' : ''} ${colors.bg} ${colors.border} border-2 rounded-lg shadow-lg flex items-center justify-center ${\r\n        isSelected ? 'ring-4 ring-blue-400 ring-opacity-50 scale-105' : 'hover:scale-102'\r\n      }`}\r\n      style={{\r\n        left: `${object.x}px`,\r\n        top: `${object.y}px`,\r\n        width: `${object.width}px`,\r\n        height: `${object.height}px`,\r\n        transform: `rotate(${object.rotation}deg)`,\r\n        transformOrigin: 'center',\r\n        willChange: isDragging ? 'transform' : 'auto'\r\n      }}\r\n      onClick={(e) => {\r\n        e.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseDown={handleMouseDown}\r\n    >\r\n      <div className=\"rfp-flex rfp-flex-col rfp-items-center rfp-justify-center rfp-gap-2 rfp-pointer-events-none\">\r\n        <Icon className={`w-8 h-8 ${colors.text}`} strokeWidth={2} />\r\n        <span className={`text-sm font-bold ${colors.text} uppercase tracking-wide`}>\r\n          {object.name}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Resize handles when selected */}\r\n      {isSelected && (\r\n        <>\r\n          {/* Corner resize handles */}\r\n          <div className=\"rfp-absolute -top-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-nw-resize\" />\r\n          <div className=\"rfp-absolute -top-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-ne-resize\" />\r\n          <div className=\"rfp-absolute -bottom-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-sw-resize\" />\r\n          <div className=\"rfp-absolute -bottom-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-se-resize\" />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport type { Wall as WallType } from '../types';\r\nimport { WALL_LABELS } from '../constants';\r\n\r\ninterface WallProps {\r\n  wall: WallType;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDragHandle?: (e: React.MouseEvent, handleType: 'start' | 'end') => void;\r\n  onDragStart?: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport const WallComponent: React.FC<WallProps> = ({\r\n  wall,\r\n  isSelected,\r\n  onSelect,\r\n  onDragHandle,\r\n  onDragStart\r\n}) => {\r\n  const length = Math.sqrt(\r\n    Math.pow(wall.endX - wall.startX, 2) + Math.pow(wall.endY - wall.startY, 2)\r\n  );\r\n  const angle = Math.atan2(wall.endY - wall.startY, wall.endX - wall.startX) * (180 / Math.PI);\r\n\r\n  // Determine cursor based on wall orientation\r\n  const getCursorStyle = () => {\r\n    if (!isSelected) return 'pointer';\r\n    \r\n    // Calculate if wall is more horizontal or vertical\r\n    const dx = Math.abs(wall.endX - wall.startX);\r\n    const dy = Math.abs(wall.endY - wall.startY);\r\n    \r\n    return dx > dy ? 'ew-resize' : 'ns-resize';\r\n  };\r\n\r\n  const getWallColor = () => {\r\n    switch (wall.type) {\r\n      case 'wall':\r\n        return 'bg-gray-800';\r\n      case 'door':\r\n        return 'bg-amber-600';\r\n      case 'window':\r\n        return 'bg-blue-500';\r\n    }\r\n  };\r\n\r\n  const getWallPattern = () => {\r\n    if (wall.type === 'window') {\r\n      return 'bg-gradient-to-r from-blue-400 via-blue-300 to-blue-400';\r\n    }\r\n    if (wall.type === 'door') {\r\n      // Door gets custom rendering, return empty\r\n      return '';\r\n    }\r\n    return getWallColor();\r\n  };\r\n\r\n  // Render door as two angled panels\r\n  const renderDoor = () => {\r\n    const gapSize = length * 0.1; // 10% gap in the middle\r\n    const panelWidth = (length - gapSize) / 2;\r\n    \r\n    return (\r\n      <div className=\"rfp-w-full rfp-h-full rfp-relative\">\r\n        {/* Left door panel */}\r\n        <div\r\n          className=\"rfp-absolute rfp-left-0 bg-gradient-to-r from-amber-600 to-amber-700 rfp-shadow-md rfp-rounded-sm\"\r\n          style={{\r\n            width: `${panelWidth}px`,\r\n            height: `${wall.thickness}px`,\r\n            borderTop: '1px solid #fbbf24',\r\n            borderBottom: '1px solid #78350f',\r\n            borderRight: '2px solid #92400e'\r\n          }}\r\n        >\r\n          {/* Door handle/knob */}\r\n          <div \r\n            className=\"rfp-absolute right-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rfp-rounded-full rfp-shadow-sm\"\r\n          />\r\n        </div>\r\n        \r\n        {/* Gap in the middle */}\r\n        <div\r\n          className=\"rfp-absolute rfp-bg-transparent\"\r\n          style={{\r\n            left: `${panelWidth}px`,\r\n            width: `${gapSize}px`,\r\n            height: `${wall.thickness}px`\r\n          }}\r\n        />\r\n        \r\n        {/* Right door panel */}\r\n        <div\r\n          className=\"rfp-absolute rfp-right-0 bg-gradient-to-r from-amber-700 to-amber-600 rfp-shadow-md rfp-rounded-sm\"\r\n          style={{\r\n            width: `${panelWidth}px`,\r\n            height: `${wall.thickness}px`,\r\n            borderTop: '1px solid #fbbf24',\r\n            borderBottom: '1px solid #78350f',\r\n            borderLeft: '2px solid #92400e'\r\n          }}\r\n        >\r\n          {/* Door handle/knob */}\r\n          <div \r\n            className=\"rfp-absolute left-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rfp-rounded-full rfp-shadow-sm\"\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div\r\n      onClick={(e) => {\r\n        e.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseDown={(e) => {\r\n        // Only allow dragging the wall body when selected and not clicking handles\r\n        if (isSelected && onDragStart) {\r\n          e.stopPropagation();\r\n          onDragStart(e);\r\n        }\r\n      }}\r\n      className={`absolute transition-all ${\r\n        isSelected ? 'ring-4 ring-blue-400 ring-opacity-50 hover:ring-6 hover:ring-blue-300' : ''\r\n      }`}\r\n      style={{\r\n        left: `${wall.startX}px`,\r\n        top: `${wall.startY}px`,\r\n        width: `${length}px`,\r\n        height: `${wall.thickness}px`,\r\n        transform: `rotate(${angle}deg)`,\r\n        transformOrigin: 'top left',\r\n        zIndex: 10,\r\n        cursor: isSelected ? 'move' : 'pointer',\r\n        pointerEvents: 'auto'\r\n      }}\r\n    >\r\n      {wall.type === 'door' ? (\r\n        renderDoor()\r\n      ) : (\r\n        <div className={`w-full h-full ${getWallPattern()} shadow-lg hover:opacity-90 transition-opacity rounded-sm`}>\r\n          {isSelected && (\r\n            <div className=\"rfp-absolute -top-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30\">\r\n              {WALL_LABELS[wall.type]} - {Math.round(length)}px\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n      \r\n      {/* Label for door */}\r\n      {wall.type === 'door' && isSelected && (\r\n        <div className=\"rfp-absolute -top-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30\">\r\n          {WALL_LABELS[wall.type]} - {Math.round(length)}px\r\n        </div>\r\n      )}\r\n      \r\n      {/* End point handles */}\r\n      {isSelected && (\r\n        <>\r\n          <div \r\n            className=\"rfp-absolute -left-2 top-1/2 transform -translate-y-1/2 rfp-w-5 rfp-h-5 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white hover:bg-blue-600 hover:scale-125 rfp-transition-all rfp-shadow-xl z-30\"\r\n            style={{ cursor: getCursorStyle() }}\r\n            onMouseDown={(e) => {\r\n              e.stopPropagation();\r\n              onDragHandle?.(e, 'start');\r\n            }}\r\n            title=\"Drag to resize\"\r\n          />\r\n          <div \r\n            className=\"rfp-absolute -right-2 top-1/2 transform -translate-y-1/2 rfp-w-5 rfp-h-5 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white hover:bg-blue-600 hover:scale-125 rfp-transition-all rfp-shadow-xl z-30\"\r\n            style={{ cursor: getCursorStyle() }}\r\n            onMouseDown={(e) => {\r\n              e.stopPropagation();\r\n              onDragHandle?.(e, 'end');\r\n            }}\r\n            title=\"Drag to resize\"\r\n          />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport type { FixedElement as FixedElementType } from '../types';\r\n\r\ninterface FixedElementProps {\r\n  element: FixedElementType;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDragStart: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport const FixedElementComponent: React.FC<FixedElementProps> = ({\r\n  element,\r\n  isSelected,\r\n  onSelect,\r\n  onDragStart\r\n}) => {\r\n  const [isDragging, setIsDragging] = useState(false);\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    setIsDragging(true);\r\n    onDragStart(e);\r\n    \r\n    const handleMouseUp = () => {\r\n      setIsDragging(false);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n    \r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  };\r\n\r\n  const renderContent = () => {\r\n    if (element.type === 'pillar') {\r\n      return (\r\n        <div className=\"rfp-w-full rfp-h-full rfp-relative\">\r\n          {/* Circular pillar with 3D effect */}\r\n          <div className=\"rfp-absolute inset-2 bg-gradient-to-br from-gray-400 via-gray-600 to-gray-800 rfp-rounded-full shadow-2xl\">\r\n            <div className=\"rfp-absolute rfp-inset-0 rfp-rounded-full bg-gradient-to-tr from-transparent via-white/10 to-white/20\" />\r\n            {/* Shadow effect */}\r\n            <div className=\"rfp-absolute rfp-inset-0 rfp-rounded-full shadow-inner\" style={{ boxShadow: 'inset -4px -4px 12px rgba(0,0,0,0.5), inset 4px 4px 12px rgba(255,255,255,0.2)' }} />\r\n          </div>\r\n          {/* Center highlight */}\r\n          <div className=\"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center\">\r\n            <div className=\"w-1/3 h-1/3 bg-white/10 rfp-rounded-full blur-sm\" />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    if (element.type === 'column') {\r\n      return (\r\n        <div className=\"rfp-w-full rfp-h-full rfp-relative\">\r\n          {/* Square column with depth */}\r\n          <div className=\"rfp-absolute inset-2 bg-gradient-to-br from-slate-400 via-slate-600 to-slate-800 rfp-rounded-lg shadow-2xl\">\r\n            {/* Top face (3D effect) */}\r\n            <div className=\"rfp-absolute rfp-inset-0 rfp-rounded-lg bg-gradient-to-br from-white/20 via-transparent to-black/30\" />\r\n            {/* Edge highlights */}\r\n            <div className=\"rfp-absolute rfp-top-0 rfp-left-0 rfp-right-0 rfp-h-1 bg-gradient-to-r from-transparent via-white/30 to-transparent rounded-t-lg\" />\r\n            <div className=\"rfp-absolute rfp-top-0 rfp-bottom-0 rfp-left-0 rfp-w-1 bg-gradient-to-b from-transparent via-white/30 to-transparent rounded-l-lg\" />\r\n            {/* Inner shadow */}\r\n            <div className=\"rfp-absolute rfp-inset-0 rfp-rounded-lg\" style={{ boxShadow: 'inset 0 0 20px rgba(0,0,0,0.5)' }} />\r\n          </div>\r\n          {/* Decorative lines */}\r\n          <div className=\"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center rfp-pointer-events-none\">\r\n            <div className=\"w-0.5 h-2/3 bg-white/20\" />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    if (element.type === 'stairs') {\r\n      return (\r\n        <div className=\"rfp-w-full rfp-h-full rfp-relative bg-gradient-to-br from-amber-200 via-amber-300 to-amber-400 rfp-rounded-lg rfp-shadow-xl rfp-overflow-hidden\">\r\n          {/* Steps */}\r\n          {[0, 1, 2, 3, 4, 5].map((step) => (\r\n            <div\r\n              key={step}\r\n              className=\"rfp-absolute rfp-left-0 rfp-right-0 bg-gradient-to-r from-amber-400 to-amber-500 rfp-border-t border-amber-600\"\r\n              style={{\r\n                top: `${step * 16.66}%`,\r\n                height: '16.66%',\r\n                boxShadow: '0 2px 4px rgba(0,0,0,0.3)'\r\n              }}\r\n            >\r\n              {/* Step highlight */}\r\n              <div className=\"rfp-absolute rfp-inset-0 bg-gradient-to-b from-white/20 to-transparent h-1/2\" />\r\n              {/* Step edge shadow */}\r\n              <div className=\"rfp-absolute rfp-bottom-0 rfp-left-0 rfp-right-0 h-px bg-black/30\" />\r\n            </div>\r\n          ))}\r\n          {/* Arrow indicator */}\r\n          <div className=\"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center rfp-pointer-events-none\">\r\n            <div className=\"bg-white/80 rfp-rounded-full rfp-p-2 rfp-shadow-lg\">\r\n              <svg className=\"rfp-w-6 rfp-h-6 text-amber-800\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 15l7-7 7 7\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move select-none ${!isDragging ? 'transition-all duration-75' : ''} rounded-lg ${\r\n        isSelected ? 'ring-4 ring-blue-400 ring-opacity-50 scale-105' : 'hover:scale-102'\r\n      }`}\r\n      style={{\r\n        left: `${element.x}px`,\r\n        top: `${element.y}px`,\r\n        width: `${element.width}px`,\r\n        height: `${element.height}px`,\r\n        transform: `rotate(${element.rotation}deg)`,\r\n        transformOrigin: 'center',\r\n        willChange: isDragging ? 'transform' : 'auto',\r\n        zIndex: 20\r\n      }}\r\n      onClick={(e) => {\r\n        e.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseDown={handleMouseDown}\r\n    >\r\n      {renderContent()}\r\n      \r\n      {/* Label */}\r\n      {isSelected && (\r\n        <div className=\"rfp-absolute -bottom-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30\">\r\n          {element.name}\r\n        </div>\r\n      )}\r\n      \r\n      {/* Selection indicators */}\r\n      {isSelected && (\r\n        <>\r\n          <div className=\"rfp-absolute -top-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white\" />\r\n          <div className=\"rfp-absolute -top-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white\" />\r\n          <div className=\"rfp-absolute -bottom-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white\" />\r\n          <div className=\"rfp-absolute -bottom-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white\" />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Layers, Minus, Plus, RotateCw, Save, Trash2, Upload, LayoutGrid, Package, Home } from 'lucide-react';\r\n\r\nimport { SIZE_LABELS, TABLE_SHAPES, OBJECT_ICONS, OBJECT_LABELS, OBJECT_COLORS, WALL_ICONS, WALL_LABELS, FIXED_ELEMENT_ICONS, FIXED_ELEMENT_LABELS, FIXED_ELEMENT_COLORS } from '../constants';\r\nimport type {\r\n  Chair,\r\n  Floor,\r\n  Table,\r\n  ObjectType,\r\n  WallType,\r\n  FixedElementType\r\n} from '../types';\r\n\r\ninterface SidebarProps {\r\n  floors: Floor[];\r\n  currentFloor?: Floor;\r\n  onAddFloor: () => void;\r\n  onRemoveFloor: () => void;\r\n  onSwitchFloor: (floorId: string) => void;\r\n  onRenameFloor: (floorId: string, newName: string) => void;\r\n  onAddTable: (shape: Table['shape']) => void;\r\n  onAddObject: (type: ObjectType) => void;\r\n  onStartWallDrawing: (type: WallType) => void;\r\n  onAddFixedElement: (type: FixedElementType) => void;\r\n  onRotateTable: () => void;\r\n  onDuplicateTable: () => void;\r\n  onRemoveTable: () => void;\r\n  onSave: () => void;\r\n  onLoad: () => void;\r\n  selectedTable: Table | null;\r\n  selectedTableChairs: Chair[];\r\n}\r\n\r\nconst sizeLabels = SIZE_LABELS;\r\n\r\nexport const Sidebar: React.FC<SidebarProps> = ({\r\n  floors,\r\n  currentFloor,\r\n  onAddFloor,\r\n  onRemoveFloor,\r\n  onSwitchFloor,\r\n  onRenameFloor,\r\n  onAddTable,\r\n  onAddObject,\r\n  onStartWallDrawing,\r\n  onAddFixedElement,\r\n  onRotateTable,\r\n  onDuplicateTable,\r\n  onRemoveTable,\r\n  onSave,\r\n  onLoad,\r\n  selectedTable,\r\n  selectedTableChairs\r\n}) => {\r\n  const [editingFloorId, setEditingFloorId] = React.useState<string | null>(null);\r\n  const [editingFloorName, setEditingFloorName] = React.useState<string>('');\r\n  const [activeTab, setActiveTab] = React.useState<'tables' | 'objects' | 'roomLayout'>('tables');\r\n  const inputRef = React.useRef<HTMLInputElement>(null);\r\n\r\n  // Focus input when editing starts\r\n  React.useEffect(() => {\r\n    if (editingFloorId && inputRef.current) {\r\n      inputRef.current.focus();\r\n      inputRef.current.select();\r\n    }\r\n  }, [editingFloorId]);\r\n\r\n  const handleDoubleClick = (floor: Floor) => {\r\n    setEditingFloorId(floor.id);\r\n    setEditingFloorName(floor.name);\r\n  };\r\n\r\n  const handleSaveFloorName = () => {\r\n    if (editingFloorId && editingFloorName.trim()) {\r\n      onRenameFloor(editingFloorId, editingFloorName.trim());\r\n    }\r\n    setEditingFloorId(null);\r\n    setEditingFloorName('');\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      handleSaveFloorName();\r\n    } else if (e.key === 'Escape') {\r\n      setEditingFloorId(null);\r\n      setEditingFloorName('');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"rfp-w-80 rfp-bg-white rfp-shadow-lg rfp-border-r rfp-border-gray-200 rfp-flex rfp-flex-col\">\r\n      <div className=\"rfp-p-4 bg-gradient-to-r from-blue-600 to-purple-600 rfp-text-white\">\r\n        <h1 className=\"rfp-text-xl rfp-font-bold\">Restaurant Designer</h1>\r\n        <p className=\"rfp-text-blue-100 rfp-text-sm\">Professional Floor Planner</p>\r\n      </div>\r\n\r\n      <div className=\"rfp-p-4 rfp-border-b rfp-border-gray-200\">\r\n        <div className=\"rfp-flex rfp-items-center rfp-justify-between rfp-mb-4\">\r\n          <h2 className=\"rfp-text-lg rfp-font-semibold rfp-text-gray-800 rfp-flex rfp-items-center rfp-gap-2\">\r\n            <Layers className=\"rfp-w-5 rfp-h-5\" />\r\n            Floor Plans ({floors.length})\r\n          </h2>\r\n          <div className=\"rfp-flex rfp-gap-1\">\r\n            <button\r\n              onClick={onAddFloor}\r\n              className=\"rfp-p-2 rfp-text-gray-600 hover:text-green-600 hover:bg-green-50 rfp-rounded-lg transition-colors\"\r\n              title=\"Add New Floor\"\r\n            >\r\n              <Plus className=\"rfp-w-4 rfp-h-4\" />\r\n            </button>\r\n            <button\r\n              onClick={onRemoveFloor}\r\n              disabled={floors.length <= 1}\r\n              className=\"rfp-p-2 rfp-text-gray-600 hover:text-red-600 hover:bg-red-50 rfp-rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              title=\"Remove Current Floor\"\r\n            >\r\n              <Minus className=\"rfp-w-4 rfp-h-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"rfp-space-y-2 rfp-max-h-32 overflow-y-auto\">\r\n          {floors.map((floor) => (\r\n            <div\r\n              key={floor.id}\r\n              className={`w-full p-3 rounded-lg transition-all flex items-center justify-between ${\r\n                floor.isActive\r\n                  ? 'bg-blue-100 text-blue-800 border border-blue-200 shadow-sm'\r\n                  : 'text-gray-600 hover:bg-gray-100 border border-transparent'\r\n              }`}\r\n              onClick={() => {\r\n                if (editingFloorId !== floor.id) {\r\n                  onSwitchFloor(floor.id);\r\n                }\r\n              }}\r\n              onDoubleClick={() => handleDoubleClick(floor)}\r\n            >\r\n              <div className=\"rfp-flex-1\">\r\n                {editingFloorId === floor.id ? (\r\n                  <input\r\n                    ref={inputRef}\r\n                    type=\"text\"\r\n                    value={editingFloorName}\r\n                    onChange={(e) => setEditingFloorName(e.target.value)}\r\n                    onBlur={handleSaveFloorName}\r\n                    onKeyDown={handleKeyDown}\r\n                    className=\"rfp-w-full rfp-px-2 rfp-py-1 rfp-text-sm rfp-font-medium rfp-bg-white rfp-border rfp-border-blue-400 rfp-rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    onClick={(e) => e.stopPropagation()}\r\n                  />\r\n                ) : (\r\n                  <div className=\"rfp-font-medium rfp-cursor-pointer\">{floor.name}</div>\r\n                )}\r\n                <div className=\"rfp-text-xs rfp-text-gray-500 mt-0.5\">\r\n                  {floor.tables.length} tables, {floor.chairs.length} chairs\r\n                </div>\r\n              </div>\r\n              {floor.isActive && <div className=\"rfp-w-2 rfp-h-2 rfp-bg-blue-500 rfp-rounded-full\" />}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs for Tables, Objects, and Room Layout */}\r\n      <div className=\"rfp-border-b rfp-border-gray-200\">\r\n        <div className=\"rfp-flex\">\r\n          <button\r\n            onClick={() => setActiveTab('tables')}\r\n            className={`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${\r\n              activeTab === 'tables'\r\n                ? 'bg-white text-emerald-600 border-b-2 border-emerald-600'\r\n                : 'bg-gray-50 text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            <LayoutGrid className=\"rfp-w-4 rfp-h-4\" />\r\n            Tables\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('objects')}\r\n            className={`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${\r\n              activeTab === 'objects'\r\n                ? 'bg-white text-purple-600 border-b-2 border-purple-600'\r\n                : 'bg-gray-50 text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            <Package className=\"rfp-w-4 rfp-h-4\" />\r\n            Objects\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('roomLayout')}\r\n            className={`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${\r\n              activeTab === 'roomLayout'\r\n                ? 'bg-white text-gray-700 border-b-2 border-gray-700'\r\n                : 'bg-gray-50 text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            <Home className=\"rfp-w-4 rfp-h-4\" />\r\n            Room\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tables Tab Content */}\r\n      {activeTab === 'tables' && (\r\n        <div className=\"rfp-p-4 rfp-border-b rfp-border-gray-200\">\r\n          <h3 className=\"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3\">Add Tables</h3>\r\n          <div className=\"rfp-grid grid-cols-2 rfp-gap-3\">\r\n            {Object.entries(TABLE_SHAPES).map(([shape, Icon]) => (\r\n              <button\r\n                key={shape}\r\n                onClick={() => onAddTable(shape as Table['shape'])}\r\n                className=\"rfp-p-3 rfp-border-2 rfp-border-gray-200 rfp-rounded-lg hover:border-emerald-400 hover:bg-emerald-50 rfp-transition-all rfp-flex rfp-flex-col rfp-items-center rfp-gap-2 hover:shadow-md\"\r\n              >\r\n                <Icon className=\"rfp-w-6 rfp-h-6 text-emerald-600\" />\r\n                <span className=\"rfp-text-xs rfp-text-gray-700 rfp-capitalize rfp-font-medium\">{shape}</span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Objects Tab Content */}\r\n      {activeTab === 'objects' && (\r\n        <div className=\"rfp-p-4 rfp-border-b rfp-border-gray-200\">\r\n          <h3 className=\"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3\">Add Objects</h3>\r\n          <div className=\"rfp-space-y-3\">\r\n            {(Object.keys(OBJECT_LABELS) as ObjectType[]).map((objectType) => {\r\n              const Icon = OBJECT_ICONS[objectType];\r\n              const colors = OBJECT_COLORS[objectType];\r\n              const label = OBJECT_LABELS[objectType];\r\n              \r\n              return (\r\n                <button\r\n                  key={objectType}\r\n                  onClick={() => onAddObject(objectType)}\r\n                  className={`w-full p-4 ${colors.bg} border-2 ${colors.border} rounded-xl hover:scale-105 transition-all flex items-center gap-3 shadow-lg hover:shadow-xl`}\r\n                >\r\n                  <div className=\"bg-white/20 rfp-p-2 rfp-rounded-lg\">\r\n                    <Icon className={`w-6 h-6 ${colors.text}`} strokeWidth={2.5} />\r\n                  </div>\r\n                  <div className=\"rfp-flex-1 rfp-text-left\">\r\n                    <span className={`text-base font-bold ${colors.text}`}>{label}</span>\r\n                    <div className=\"rfp-text-xs text-white/80 mt-0.5\">Click to add to floor</div>\r\n                  </div>\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Room Layout Tab Content */}\r\n      {activeTab === 'roomLayout' && (\r\n        <div className=\"rfp-p-4 rfp-border-b rfp-border-gray-200\">\r\n          {/* Walls Section */}\r\n          <div className=\"rfp-mb-6\">\r\n            <h3 className=\"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3\">Draw Walls</h3>\r\n            <div className=\"rfp-space-y-2\">\r\n              {(['wall', 'door', 'window'] as WallType[]).map((wallType) => {\r\n                const Icon = WALL_ICONS[wallType];\r\n                const label = WALL_LABELS[wallType];\r\n                \r\n                const colorClasses = {\r\n                  wall: 'bg-gradient-to-br from-gray-600 to-gray-800 border-gray-700 text-white hover:from-gray-700 hover:to-gray-900',\r\n                  door: 'bg-gradient-to-br from-amber-500 to-amber-700 border-amber-600 text-white hover:from-amber-600 hover:to-amber-800',\r\n                  window: 'bg-gradient-to-br from-blue-500 to-blue-700 border-blue-600 text-white hover:from-blue-600 hover:to-blue-800'\r\n                };\r\n                \r\n                return (\r\n                  <button\r\n                    key={wallType}\r\n                    onClick={() => onStartWallDrawing(wallType)}\r\n                    className={`w-full p-3 border-2 rounded-lg transition-all flex items-center gap-3 shadow-md hover:shadow-lg ${colorClasses[wallType]}`}\r\n                  >\r\n                    <Icon className=\"rfp-w-5 rfp-h-5\" strokeWidth={2.5} />\r\n                    <span className=\"rfp-text-sm rfp-font-semibold\">{label}</span>\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Fixed Elements Section */}\r\n          <div>\r\n            <h3 className=\"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3\">Add Elements</h3>\r\n            <div className=\"rfp-space-y-2\">\r\n              {(['pillar', 'column', 'stairs'] as FixedElementType[]).map((elementType) => {\r\n                const Icon = FIXED_ELEMENT_ICONS[elementType];\r\n                const colors = FIXED_ELEMENT_COLORS[elementType];\r\n                const label = FIXED_ELEMENT_LABELS[elementType];\r\n                \r\n                return (\r\n                  <button\r\n                    key={elementType}\r\n                    onClick={() => onAddFixedElement(elementType)}\r\n                    className={`w-full p-3 ${colors.bg} border-2 ${colors.border} rounded-lg hover:scale-105 transition-all flex items-center gap-3 shadow-md hover:shadow-lg`}\r\n                  >\r\n                    <div className=\"bg-white/10 p-1.5 rfp-rounded\">\r\n                      <Icon className={`w-5 h-5 ${colors.text}`} strokeWidth={2.5} />\r\n                    </div>\r\n                    <span className={`text-sm font-semibold ${colors.text}`}>{label}</span>\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {selectedTable && (\r\n        <div className=\"rfp-p-4 rfp-border-b rfp-border-gray-200\">\r\n          <div className=\"rfp-flex rfp-items-center rfp-justify-between rfp-mb-3\">\r\n            <h3 className=\"text-md rfp-font-semibold rfp-text-gray-800\">Table Properties</h3>\r\n            <div className=\"rfp-flex rfp-gap-1\">\r\n              <button\r\n                onClick={onRotateTable}\r\n                className=\"rfp-p-1 rfp-text-blue-600 hover:bg-blue-100 rfp-rounded transition-colors\"\r\n                title=\"Rotate Table\"\r\n              >\r\n                <RotateCw className=\"rfp-w-4 rfp-h-4\" />\r\n              </button>\r\n              <button\r\n                onClick={onDuplicateTable}\r\n                className=\"rfp-p-1 rfp-text-green-600 hover:bg-green-100 rfp-rounded transition-colors\"\r\n                title=\"Duplicate Table\"\r\n              >\r\n                <Plus className=\"rfp-w-4 rfp-h-4\" />\r\n              </button>\r\n              <button\r\n                onClick={onRemoveTable}\r\n                className=\"rfp-p-1 rfp-text-red-600 hover:bg-red-100 rfp-rounded transition-colors\"\r\n                title=\"Delete Table\"\r\n              >\r\n                <Trash2 className=\"rfp-w-4 rfp-h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"rfp-space-y-3 rfp-text-sm rfp-text-gray-600\">\r\n            <div className=\"rfp-grid grid-cols-2 rfp-gap-3\">\r\n              <div>\r\n                <div className=\"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400\">Name</div>\r\n                <div className=\"rfp-font-semibold rfp-text-gray-800\">{selectedTable.name}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400\">Shape</div>\r\n                <div className=\"rfp-font-semibold rfp-text-gray-800 rfp-capitalize\">{selectedTable.shape}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400\">Size</div>\r\n                <div className=\"rfp-font-semibold rfp-text-gray-800\">{sizeLabels[selectedTable.size]}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400\">Seats</div>\r\n                <div className=\"rfp-font-semibold rfp-text-gray-800\">{selectedTableChairs.length}</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"rfp-bg-blue-50 rfp-border rfp-border-blue-200 rfp-rounded-md rfp-p-3\">\r\n              <p className=\"rfp-text-xs rfp-text-blue-700\">\r\n                ðŸ’¡ <span className=\"rfp-font-semibold\">Tip:</span> Use the <span className=\"rfp-font-semibold\">Manage Chairs</span> button in the toolbar above to add or remove chairs from each side of the table.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"rfp-p-4 mt-auto rfp-space-y-3\">\r\n        <div className=\"rfp-bg-gray-50 rfp-p-3 rfp-rounded-lg\">\r\n          <h4 className=\"rfp-text-sm rfp-font-semibold rfp-text-gray-700 rfp-mb-2\">Current Floor Stats</h4>\r\n          <div className=\"rfp-grid grid-cols-2 rfp-gap-4 rfp-text-sm\">\r\n            <div>\r\n              <div className=\"rfp-text-gray-600\">Tables</div>\r\n              <div className=\"rfp-font-bold rfp-text-lg text-emerald-600\">\r\n                {currentFloor?.tables.length ?? 0}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"rfp-text-gray-600\">Total Seats</div>\r\n              <div className=\"rfp-font-bold rfp-text-lg text-amber-600\">\r\n                {currentFloor?.chairs.length ?? 0}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"rfp-flex rfp-gap-2\">\r\n          <button\r\n            onClick={onSave}\r\n            className=\"rfp-flex-1 rfp-bg-green-600 rfp-text-white rfp-py-3 rfp-px-4 rfp-rounded-lg hover:bg-green-700 transition-colors rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-medium\"\r\n          >\r\n            <Save className=\"rfp-w-4 rfp-h-4\" />\r\n            Save\r\n          </button>\r\n          <button\r\n            onClick={onLoad}\r\n            className=\"rfp-flex-1 rfp-bg-blue-600 rfp-text-white rfp-py-3 rfp-px-4 rfp-rounded-lg hover:bg-blue-700 transition-colors rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-medium\"\r\n          >\r\n            <Upload className=\"rfp-w-4 rfp-h-4\" />\r\n            Load\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Armchair, Box, ChevronRight, Eye, EyeOff, Minus, Plus, RotateCcw, Square, Trash2 } from 'lucide-react';\r\n\r\nimport type { Chair, ChairPosition, Table, TableSize, FloorObject, Wall, FixedElement } from '../types';\r\nimport { SIZE_LABELS, OBJECT_ICONS, OBJECT_LABELS, WALL_LABELS, FIXED_ELEMENT_LABELS } from '../constants';\r\n\r\ninterface ToolbarProps {\r\n  showGrid: boolean;\r\n  selectedTable: Table | null;\r\n  selectedObject: FloorObject | null;\r\n  selectedWall: Wall | null;\r\n  selectedFixedElement: FixedElement | null;\r\n  selectedTableChairs: Chair[];\r\n  tableCount: number;\r\n  chairCount: number;\r\n  objectCount: number;\r\n  wallCount: number;\r\n  fixedElementCount: number;\r\n  selectedElementType: string | null;\r\n  onToggleGrid: () => void;\r\n  onAddChair: (position: ChairPosition) => void;\r\n  onRemoveChair: (position: ChairPosition) => void;\r\n  onChangeTableSize: (size: TableSize) => void;\r\n  onTableNameChange: (name: string) => void;\r\n  onCustomTableSize: (width: number, height: number) => void;\r\n  onObjectNameChange: (name: string) => void;\r\n  onObjectResize: (width: number, height: number) => void;\r\n  onRemoveObject: () => void;\r\n  onRemoveWall: () => void;\r\n  onRemoveFixedElement: () => void;\r\n  onChangeWallThickness?: (thickness: number) => void;\r\n  onConvertWallType?: (type: 'wall' | 'door' | 'window') => void;\r\n  onFixedElementNameChange?: (name: string) => void;\r\n  onFixedElementResize?: (width: number, height: number) => void;\r\n  onChairSizeChange?: (position: ChairPosition, size: number) => void;\r\n  onResetChairSizes?: () => void;\r\n  on3DPreview?: () => void;\r\n  onObjectRotate?: (rotation: number) => void;\r\n}\r\n\r\nconst sizeLabels = SIZE_LABELS;\r\nconst chairPositions: ChairPosition[] = ['top', 'right', 'bottom', 'left'];\r\nconst sizeOptions: TableSize[] = ['small', 'medium', 'large'];\r\n\r\nexport const Toolbar: React.FC<ToolbarProps> = ({\r\n  showGrid,\r\n  selectedTable,\r\n  selectedObject,\r\n  selectedWall,\r\n  selectedFixedElement,\r\n  selectedTableChairs,\r\n  onToggleGrid,\r\n  onAddChair,\r\n  onRemoveChair,\r\n  onChangeTableSize,\r\n  onTableNameChange,\r\n  onCustomTableSize,\r\n  onObjectNameChange,\r\n  onObjectResize,\r\n  onRemoveObject,\r\n  onRemoveWall,\r\n  onRemoveFixedElement,\r\n  onChangeWallThickness,\r\n  onConvertWallType,\r\n  onFixedElementNameChange,\r\n  onFixedElementResize,\r\n  onChairSizeChange,\r\n  onResetChairSizes,\r\n  on3DPreview,\r\n  onObjectRotate,\r\n  tableCount,\r\n  chairCount,\r\n  objectCount,\r\n  wallCount,\r\n  fixedElementCount,\r\n  selectedElementType\r\n}) => {\r\n  const chairMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const sizeMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const objectSizeMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const fixedElementSizeMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const [isChairMenuOpen, setIsChairMenuOpen] = useState(false);\r\n  const [isSizeMenuOpen, setIsSizeMenuOpen] = useState(false);\r\n  const [isObjectSizeMenuOpen, setIsObjectSizeMenuOpen] = useState(false);\r\n  const [isFixedElementSizeMenuOpen, setIsFixedElementSizeMenuOpen] = useState(false);\r\n  const [showProSlider, setShowProSlider] = useState(false);\r\n  const [customWidth, setCustomWidth] = useState(90);\r\n  const [customHeight, setCustomHeight] = useState(90);\r\n  const [objectWidth, setObjectWidth] = useState(120);\r\n  const [objectHeight, setObjectHeight] = useState(80);\r\n  const [fixedElementWidth, setFixedElementWidth] = useState(60);\r\n  const [fixedElementHeight, setFixedElementHeight] = useState(60);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (chairMenuRef.current && !chairMenuRef.current.contains(event.target as Node)) {\r\n        setIsChairMenuOpen(false);\r\n      }\r\n      if (sizeMenuRef.current && !sizeMenuRef.current.contains(event.target as Node)) {\r\n        setIsSizeMenuOpen(false);\r\n      }\r\n      if (objectSizeMenuRef.current && !objectSizeMenuRef.current.contains(event.target as Node)) {\r\n        setIsObjectSizeMenuOpen(false);\r\n      }\r\n      if (fixedElementSizeMenuRef.current && !fixedElementSizeMenuRef.current.contains(event.target as Node)) {\r\n        setIsFixedElementSizeMenuOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!selectedTable) {\r\n      setIsChairMenuOpen(false);\r\n      setIsSizeMenuOpen(false);\r\n      setShowProSlider(false);\r\n    } else {\r\n      // Update custom sliders when table changes\r\n      setCustomWidth(selectedTable.width);\r\n      setCustomHeight(selectedTable.height);\r\n    }\r\n    \r\n    if (!selectedObject) {\r\n      setIsObjectSizeMenuOpen(false);\r\n    } else {\r\n      // Update object sliders when object changes\r\n      setObjectWidth(selectedObject.width);\r\n      setObjectHeight(selectedObject.height);\r\n    }\r\n    \r\n    if (!selectedFixedElement) {\r\n      setIsFixedElementSizeMenuOpen(false);\r\n    } else {\r\n      // Update fixed element sliders when element changes\r\n      setFixedElementWidth(selectedFixedElement.width);\r\n      setFixedElementHeight(selectedFixedElement.height);\r\n    }\r\n  }, [selectedTable, selectedObject, selectedFixedElement]);\r\n\r\n  return (\r\n    <div className=\"rfp-bg-white rfp-border-b rfp-border-gray-200 rfp-shadow-sm min-h-[72px]\">\r\n      <div className=\"rfp-px-4 rfp-py-3 rfp-flex rfp-items-center rfp-justify-between min-h-[72px]\">\r\n        {/* Left Section - Controls */}\r\n        <div className=\"rfp-flex rfp-items-center rfp-gap-3 rfp-flex-wrap\">\r\n          {/* Grid Toggle */}\r\n          <button\r\n            onClick={onToggleGrid}\r\n            className={`px-3 py-2 rounded-lg transition-all flex items-center gap-2 text-sm font-medium ${\r\n              showGrid \r\n                ? 'bg-blue-500 text-white shadow-md hover:bg-blue-600' \r\n                : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n            }`}\r\n            title={showGrid ? 'Hide Grid' : 'Show Grid'}\r\n          >\r\n            {showGrid ? <Eye className=\"rfp-w-4 rfp-h-4\" /> : <EyeOff className=\"rfp-w-4 rfp-h-4\" />}\r\n            <span>Grid</span>\r\n          </button>\r\n\r\n          {selectedTable && (\r\n            <>\r\n              <div className=\"w-px rfp-h-8 rfp-bg-gray-300\" />\r\n\r\n              {/* Chair Management Dropdown */}\r\n              <div ref={chairMenuRef} className=\"rfp-relative\">\r\n                <button\r\n                  onClick={() => {\r\n                    setIsChairMenuOpen(!isChairMenuOpen);\r\n                    setIsSizeMenuOpen(false);\r\n                  }}\r\n                  className=\"rfp-px-3 rfp-py-2 rfp-rounded-lg bg-gradient-to-r from-amber-500 to-amber-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold\"\r\n                >\r\n                  <Armchair className=\"rfp-w-4 rfp-h-4\" />\r\n                  <span>Manage Chairs</span>\r\n                  <span className=\"rfp-ml-1 px-1.5 py-0.5 bg-white/20 rfp-rounded rfp-text-xs\">\r\n                    {selectedTableChairs.length}\r\n                  </span>\r\n                </button>\r\n                \r\n                {isChairMenuOpen && (\r\n                  <div className=\"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-72 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden\">\r\n                    <div className=\"bg-gradient-to-r from-amber-500 to-amber-600 rfp-px-4 rfp-py-3 rfp-text-white\">\r\n                      <div className=\"rfp-flex rfp-items-center rfp-justify-between\">\r\n                        <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                          <Armchair className=\"rfp-w-4 rfp-h-4\" />\r\n                          <span className=\"rfp-font-semibold rfp-text-sm\">Chair Positions</span>\r\n                        </div>\r\n                        <span className=\"rfp-text-xs bg-white/20 rfp-px-2 rfp-py-1 rfp-rounded\">\r\n                          Total: {selectedTableChairs.length}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"rfp-p-3 rfp-space-y-2\">\r\n                      {chairPositions.map((position) => {\r\n                        const chairsOnSide = selectedTableChairs.filter(c => c.position === position).length;\r\n                        const chairSample = selectedTableChairs.find(c => c.position === position);\r\n                        const currentSize = chairSample?.size || 40; // Default fallback\r\n                        \r\n                        return (\r\n                          <div\r\n                            key={position}\r\n                            className=\"rfp-bg-gray-50 rfp-rounded-lg rfp-px-3 rfp-py-2 rfp-border rfp-border-gray-200 hover:border-amber-300 rfp-transition-all rfp-space-y-2\"\r\n                          >\r\n                            <div className=\"rfp-flex rfp-items-center rfp-justify-between\">\r\n                              <div className=\"rfp-flex rfp-items-center rfp-gap-3\">\r\n                                <div className=\"rfp-w-8 rfp-h-8 bg-gradient-to-br from-gray-600 to-gray-700 rfp-rounded-md rfp-flex rfp-items-center rfp-justify-center rfp-text-white rfp-text-xs rfp-font-bold rfp-uppercase\">\r\n                                  {position[0]}\r\n                                </div>\r\n                                <div>\r\n                                  <div className=\"rfp-text-sm rfp-font-medium rfp-text-gray-800 rfp-capitalize\">{position}</div>\r\n                                  <div className=\"rfp-text-xs rfp-text-gray-500\">{chairsOnSide} chair{chairsOnSide !== 1 ? 's' : ''}</div>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"rfp-flex rfp-items-center rfp-gap-1\">\r\n                                <button\r\n                                  onClick={() => onRemoveChair(position)}\r\n                                  disabled={chairsOnSide === 0}\r\n                                  className=\"rfp-w-7 rfp-h-7 rfp-rounded-md rfp-bg-red-50 rfp-text-red-600 hover:bg-red-100 disabled:opacity-30 disabled:cursor-not-allowed rfp-transition-all rfp-flex rfp-items-center rfp-justify-center\"\r\n                                  title=\"Remove chair\"\r\n                                >\r\n                                  <Minus className=\"rfp-w-4 rfp-h-4\" />\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => onAddChair(position)}\r\n                                  className=\"rfp-w-7 rfp-h-7 rfp-rounded-md rfp-bg-green-50 rfp-text-green-600 hover:bg-green-100 rfp-transition-all rfp-flex rfp-items-center rfp-justify-center\"\r\n                                  title=\"Add chair\"\r\n                                >\r\n                                  <Plus className=\"rfp-w-4 rfp-h-4\" />\r\n                                </button>\r\n                              </div>\r\n                            </div>\r\n                            \r\n                            {/* Size Slider */}\r\n                            {chairsOnSide > 0 && (\r\n                              <div className=\"rfp-pt-2 rfp-border-t rfp-border-gray-200\">\r\n                                <div className=\"rfp-flex rfp-items-center rfp-justify-between rfp-mb-1\">\r\n                                  <span className=\"rfp-text-xs rfp-font-medium rfp-text-gray-600\">Chair Size</span>\r\n                                  <span className=\"rfp-text-xs rfp-font-bold text-amber-600\">{currentSize}px</span>\r\n                                </div>\r\n                                <input\r\n                                  type=\"range\"\r\n                                  min=\"20\"\r\n                                  max=\"60\"\r\n                                  value={currentSize}\r\n                                  onChange={(e) => onChairSizeChange?.(position, parseInt(e.target.value))}\r\n                                  className=\"rfp-w-full rfp-h-2 bg-gradient-to-r from-amber-200 to-amber-400 rfp-rounded-full appearance-none rfp-cursor-pointer slider-thumb\"\r\n                                  style={{\r\n                                    background: `linear-gradient(to right, rgb(251, 191, 36) 0%, rgb(251, 191, 36) ${((currentSize - 20) / 40) * 100}%, rgb(253, 230, 138) ${((currentSize - 20) / 40) * 100}%, rgb(253, 230, 138) 100%)`\r\n                                  }}\r\n                                />\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        );\r\n                      })}\r\n                      \r\n                      {/* Reset Button */}\r\n                      <button\r\n                        onClick={() => onResetChairSizes?.()}\r\n                        className=\"rfp-w-full rfp-mt-3 rfp-px-3 rfp-py-2 bg-gradient-to-r from-gray-500 to-gray-600 rfp-text-white rfp-rounded-lg hover:from-gray-600 hover:to-gray-700 rfp-transition-all rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-text-sm rfp-font-medium\"\r\n                      >\r\n                        <RotateCcw className=\"rfp-w-4 rfp-h-4\" />\r\n                        <span>Reset All Sizes</span>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Table Size Dropdown */}\r\n              <div ref={sizeMenuRef} className=\"rfp-relative\">\r\n                <button\r\n                  onClick={() => {\r\n                    setIsSizeMenuOpen(!isSizeMenuOpen);\r\n                    setIsChairMenuOpen(false);\r\n                  }}\r\n                  className=\"rfp-px-3 rfp-py-2 rfp-rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold\"\r\n                >\r\n                  <Square className=\"rfp-w-4 rfp-h-4\" />\r\n                  <span>Size: {sizeLabels[selectedTable.size]}</span>\r\n                </button>\r\n                \r\n                {isSizeMenuOpen && (\r\n                  <div className=\"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-64 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden\">\r\n                    <div className=\"bg-gradient-to-r from-emerald-500 to-emerald-600 rfp-px-4 rfp-py-2 rfp-text-white\">\r\n                      <span className=\"rfp-font-semibold rfp-text-sm\">Table Size</span>\r\n                    </div>\r\n                    \r\n                    {/* Size Buttons */}\r\n                    <div className=\"rfp-p-3 rfp-space-y-2\">\r\n                      <div className=\"rfp-flex rfp-gap-2\">\r\n                        {sizeOptions.map((sizeOption) => {\r\n                          const isActive = selectedTable.size === sizeOption;\r\n                          return (\r\n                            <button\r\n                              key={sizeOption}\r\n                              onClick={() => {\r\n                                onChangeTableSize(sizeOption);\r\n                                setShowProSlider(false);\r\n                              }}\r\n                              className={`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-all ${\r\n                                isActive && !showProSlider\r\n                                  ? 'bg-emerald-500 text-white shadow-sm'\r\n                                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                              }`}\r\n                            >\r\n                              {sizeLabels[sizeOption]}\r\n                            </button>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                      \r\n                      {/* Pro Mode Toggle */}\r\n                      <button\r\n                        onClick={() => setShowProSlider(!showProSlider)}\r\n                        className={`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-all ${\r\n                          showProSlider\r\n                            ? 'bg-purple-500 text-white shadow-sm'\r\n                            : 'bg-gradient-to-r from-purple-100 to-purple-50 text-purple-700 hover:from-purple-200 hover:to-purple-100'\r\n                        }`}\r\n                      >\r\n                        <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                          <span className=\"rfp-text-sm rfp-font-semibold\">Pro Mode</span>\r\n                          <span className=\"rfp-text-xs bg-white/20 px-1.5 py-0.5 rfp-rounded\">Custom</span>\r\n                        </div>\r\n                        <ChevronRight className={`w-4 h-4 transition-transform ${showProSlider ? 'rotate-90' : ''}`} />\r\n                      </button>\r\n                      \r\n                      {/* Pro Sliders - Smooth Reveal */}\r\n                      <div className={`overflow-hidden transition-all duration-300 ease-in-out ${\r\n                        showProSlider ? 'max-h-48 opacity-100' : 'max-h-0 opacity-0'\r\n                      }`}>\r\n                        <div className=\"rfp-pt-2 rfp-space-y-3 rfp-border-t rfp-border-gray-200\">\r\n                          {/* Width Slider */}\r\n                          <div className=\"rfp-space-y-1\">\r\n                            <div className=\"rfp-flex rfp-items-center rfp-justify-between\">\r\n                              <label className=\"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide\">\r\n                                Width\r\n                              </label>\r\n                              <span className=\"rfp-text-xs font-mono rfp-bg-purple-100 rfp-text-purple-700 rfp-px-2 py-0.5 rfp-rounded\">\r\n                                {customWidth}px\r\n                              </span>\r\n                            </div>\r\n                            <input\r\n                              type=\"range\"\r\n                              min=\"40\"\r\n                              max=\"200\"\r\n                              step=\"5\"\r\n                              value={customWidth}\r\n                              onChange={(e) => {\r\n                                const newWidth = parseInt(e.target.value);\r\n                                setCustomWidth(newWidth);\r\n                                onCustomTableSize(newWidth, customHeight);\r\n                              }}\r\n                              className=\"rfp-w-full rfp-h-2 rfp-bg-purple-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb\"\r\n                              style={{\r\n                                background: `linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${((customWidth - 40) / 160) * 100}%, rgb(233, 213, 255) ${((customWidth - 40) / 160) * 100}%, rgb(233, 213, 255) 100%)`\r\n                              }}\r\n                            />\r\n                          </div>\r\n                          \r\n                          {/* Height Slider */}\r\n                          <div className=\"rfp-space-y-1\">\r\n                            <div className=\"rfp-flex rfp-items-center rfp-justify-between\">\r\n                              <label className=\"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide\">\r\n                                Height\r\n                              </label>\r\n                              <span className=\"rfp-text-xs font-mono rfp-bg-purple-100 rfp-text-purple-700 rfp-px-2 py-0.5 rfp-rounded\">\r\n                                {customHeight}px\r\n                              </span>\r\n                            </div>\r\n                            <input\r\n                              type=\"range\"\r\n                              min=\"40\"\r\n                              max=\"200\"\r\n                              step=\"5\"\r\n                              value={customHeight}\r\n                              onChange={(e) => {\r\n                                const newHeight = parseInt(e.target.value);\r\n                                setCustomHeight(newHeight);\r\n                                onCustomTableSize(customWidth, newHeight);\r\n                              }}\r\n                              className=\"rfp-w-full rfp-h-2 rfp-bg-purple-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb\"\r\n                              style={{\r\n                                background: `linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${((customHeight - 40) / 160) * 100}%, rgb(233, 213, 255) ${((customHeight - 40) / 160) * 100}%, rgb(233, 213, 255) 100%)`\r\n                              }}\r\n                            />\r\n                          </div>\r\n                          \r\n                          {/* Info Text */}\r\n                          <p className=\"rfp-text-xs rfp-text-gray-500 italic rfp-pt-1\">\r\n                            Drag sliders for precise sizing\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Table Name Input */}\r\n              <div className=\"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2\">\r\n                <span className=\"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500\">Name:</span>\r\n                <input\r\n                  type=\"text\"\r\n                  value={selectedTable.name}\r\n                  onChange={(event) => onTableNameChange(event.target.value)}\r\n                  className=\"rfp-bg-transparent rfp-text-sm rfp-text-gray-800 rfp-font-medium focus:outline-none rfp-w-32\"\r\n                  placeholder=\"Table name\"\r\n                />\r\n              </div>\r\n            </>\r\n          )}\r\n          \r\n          {/* Object Controls */}\r\n          {selectedObject && (\r\n            <>\r\n              <div className=\"w-px rfp-h-8 rfp-bg-gray-300\" />\r\n\r\n              {/* Object Size Control */}\r\n              <div ref={objectSizeMenuRef} className=\"rfp-relative\">\r\n                <button\r\n                  onClick={() => setIsObjectSizeMenuOpen(!isObjectSizeMenuOpen)}\r\n                  className={`px-3 py-2 rounded-lg ${\r\n                    selectedObject.type === 'bar' ? 'bg-gradient-to-r from-purple-500 to-purple-600' :\r\n                    selectedObject.type === 'kitchen' ? 'bg-gradient-to-r from-orange-500 to-orange-600' :\r\n                    'bg-gradient-to-r from-cyan-500 to-cyan-600'\r\n                  } text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`}\r\n                >\r\n                  {(() => {\r\n                    const Icon = OBJECT_ICONS[selectedObject.type];\r\n                    return <Icon className=\"rfp-w-4 rfp-h-4\" />;\r\n                  })()}\r\n                  <span>Resize {OBJECT_LABELS[selectedObject.type]}</span>\r\n                </button>\r\n                \r\n                {isObjectSizeMenuOpen && (\r\n                  <div className=\"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-64 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden\">\r\n                    <div className={`${\r\n                      selectedObject.type === 'bar' ? 'bg-gradient-to-r from-purple-500 to-purple-600' :\r\n                      selectedObject.type === 'kitchen' ? 'bg-gradient-to-r from-orange-500 to-orange-600' :\r\n                      'bg-gradient-to-r from-cyan-500 to-cyan-600'\r\n                    } px-4 py-2 text-white`}>\r\n                      <span className=\"rfp-font-semibold rfp-text-sm\">Custom Size</span>\r\n                    </div>\r\n                    \r\n                    <div className=\"rfp-p-3 rfp-space-y-3\">\r\n                      {/* Width Slider */}\r\n                      <div className=\"rfp-space-y-1\">\r\n                        <div className=\"rfp-flex rfp-items-center rfp-justify-between\">\r\n                          <label className=\"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide\">\r\n                            Width\r\n                          </label>\r\n                          <span className={`text-xs font-mono px-2 py-0.5 rounded ${\r\n                            selectedObject.type === 'bar' ? 'bg-purple-100 text-purple-700' :\r\n                            selectedObject.type === 'kitchen' ? 'bg-orange-100 text-orange-700' :\r\n                            'bg-cyan-100 text-cyan-700'\r\n                          }`}>\r\n                            {objectWidth}px\r\n                          </span>\r\n                        </div>\r\n                        <input\r\n                          type=\"range\"\r\n                          min=\"60\"\r\n                          max=\"1000\"\r\n                          step=\"10\"\r\n                          value={objectWidth}\r\n                          onChange={(e) => {\r\n                            const newWidth = parseInt(e.target.value);\r\n                            setObjectWidth(newWidth);\r\n                            onObjectResize(newWidth, objectHeight);\r\n                          }}\r\n                          className=\"rfp-w-full rfp-h-2 rfp-bg-gray-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb\"\r\n                          style={{\r\n                            background: `linear-gradient(to right, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } 0%, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } ${((objectWidth - 60) / 940) * 100}%, rgb(229, 231, 235) ${((objectWidth - 60) / 940) * 100}%, rgb(229, 231, 235) 100%)`\r\n                          }}\r\n                        />\r\n                      </div>\r\n                      \r\n                      {/* Height Slider */}\r\n                      <div className=\"rfp-space-y-1\">\r\n                        <div className=\"rfp-flex rfp-items-center rfp-justify-between\">\r\n                          <label className=\"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide\">\r\n                            Height\r\n                          </label>\r\n                          <span className={`text-xs font-mono px-2 py-0.5 rounded ${\r\n                            selectedObject.type === 'bar' ? 'bg-purple-100 text-purple-700' :\r\n                            selectedObject.type === 'kitchen' ? 'bg-orange-100 text-orange-700' :\r\n                            'bg-cyan-100 text-cyan-700'\r\n                          }`}>\r\n                            {objectHeight}px\r\n                          </span>\r\n                        </div>\r\n                        <input\r\n                          type=\"range\"\r\n                          min=\"60\"\r\n                          max=\"1000\"\r\n                          step=\"10\"\r\n                          value={objectHeight}\r\n                          onChange={(e) => {\r\n                            const newHeight = parseInt(e.target.value);\r\n                            setObjectHeight(newHeight);\r\n                            onObjectResize(objectWidth, newHeight);\r\n                          }}\r\n                          className=\"rfp-w-full rfp-h-2 rfp-bg-gray-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb\"\r\n                          style={{\r\n                            background: `linear-gradient(to right, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } 0%, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } ${((objectHeight - 60) / 940) * 100}%, rgb(229, 231, 235) ${((objectHeight - 60) / 940) * 100}%, rgb(229, 231, 235) 100%)`\r\n                          }}\r\n                        />\r\n                      </div>\r\n                      \r\n                      {/* Info Text */}\r\n                      <p className=\"rfp-text-xs rfp-text-gray-500 italic rfp-pt-1\">\r\n                        Drag sliders to resize the object\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Rotate Object Button */}\r\n              <button\r\n                onClick={() => {\r\n                  const newRotation = ((selectedObject.rotation || 0) + 90) % 360;\r\n                  onObjectRotate?.(newRotation);\r\n                }}\r\n                className={`px-3 py-2 rounded-lg ${\r\n                  selectedObject.type === 'bar' ? 'bg-gradient-to-r from-purple-600 to-purple-700' :\r\n                  selectedObject.type === 'kitchen' ? 'bg-gradient-to-r from-orange-600 to-orange-700' :\r\n                  'bg-gradient-to-r from-cyan-600 to-cyan-700'\r\n                } text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`}\r\n                title=\"Rotate 90Â°\"\r\n              >\r\n                <RotateCcw className=\"rfp-w-4 rfp-h-4\" />\r\n                <span>Rotate</span>\r\n              </button>\r\n\r\n              {/* Delete Object Button */}\r\n              <button\r\n                onClick={onRemoveObject}\r\n                className=\"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold\"\r\n                title=\"Delete Object\"\r\n              >\r\n                <Trash2 className=\"rfp-w-4 rfp-h-4\" />\r\n                <span>Delete</span>\r\n              </button>\r\n\r\n              {/* Object Name Input */}\r\n              <div className=\"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2\">\r\n                <span className=\"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500\">Name:</span>\r\n                <input\r\n                  type=\"text\"\r\n                  value={selectedObject.name}\r\n                  onChange={(event) => onObjectNameChange(event.target.value)}\r\n                  className=\"rfp-bg-transparent rfp-text-sm rfp-text-gray-800 rfp-font-medium focus:outline-none rfp-w-32\"\r\n                  placeholder=\"Object name\"\r\n                />\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {/* Wall Controls */}\r\n          {selectedWall && (\r\n            <>\r\n              <div className=\"w-px rfp-h-8 rfp-bg-gray-300\" />\r\n\r\n              {/* Wall Type Converter */}\r\n              {onConvertWallType && (\r\n                <div className=\"rfp-flex rfp-items-center rfp-gap-1 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-p-1\">\r\n                  <button\r\n                    onClick={() => onConvertWallType('wall')}\r\n                    className={`px-3 py-1.5 rounded text-xs font-semibold transition-all ${\r\n                      selectedWall.type === 'wall'\r\n                        ? 'bg-gray-600 text-white shadow-md'\r\n                        : 'text-gray-600 hover:bg-gray-200'\r\n                    }`}\r\n                    title=\"Convert to Wall\"\r\n                  >\r\n                    Wall\r\n                  </button>\r\n                  <button\r\n                    onClick={() => onConvertWallType('door')}\r\n                    className={`px-3 py-1.5 rounded text-xs font-semibold transition-all ${\r\n                      selectedWall.type === 'door'\r\n                        ? 'bg-amber-600 text-white shadow-md'\r\n                        : 'text-gray-600 hover:bg-gray-200'\r\n                    }`}\r\n                    title=\"Convert to Door\"\r\n                  >\r\n                    Door\r\n                  </button>\r\n                  <button\r\n                    onClick={() => onConvertWallType('window')}\r\n                    className={`px-3 py-1.5 rounded text-xs font-semibold transition-all ${\r\n                      selectedWall.type === 'window'\r\n                        ? 'bg-blue-600 text-white shadow-md'\r\n                        : 'text-gray-600 hover:bg-gray-200'\r\n                    }`}\r\n                    title=\"Convert to Window\"\r\n                  >\r\n                    Window\r\n                  </button>\r\n                </div>\r\n              )}\r\n\r\n              {/* Wall Thickness Selector */}\r\n              {onChangeWallThickness && (\r\n                <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                  <span className=\"rfp-text-xs rfp-font-semibold rfp-text-gray-600\">Thickness:</span>\r\n                  <select\r\n                    value={selectedWall.thickness}\r\n                    onChange={(e) => onChangeWallThickness(Number(e.target.value))}\r\n                    className=\"rfp-px-2 rfp-py-1 rfp-text-sm rfp-border rfp-border-gray-300 rfp-rounded rfp-bg-white hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  >\r\n                    <option value={4}>Thin (4px)</option>\r\n                    <option value={8}>Normal (8px)</option>\r\n                    <option value={12}>Thick (12px)</option>\r\n                    <option value={16}>Very Thick (16px)</option>\r\n                  </select>\r\n                </div>\r\n              )}\r\n\r\n              {/* Wall Info */}\r\n              <div className=\"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2\">\r\n                <span className=\"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500\">\r\n                  {WALL_LABELS[selectedWall.type]}\r\n                </span>\r\n                <span className=\"rfp-text-sm rfp-text-gray-600\">\r\n                  {Math.round(Math.sqrt(\r\n                    Math.pow(selectedWall.endX - selectedWall.startX, 2) + \r\n                    Math.pow(selectedWall.endY - selectedWall.startY, 2)\r\n                  ))}px\r\n                </span>\r\n              </div>\r\n\r\n              {/* Delete Wall Button */}\r\n              <button\r\n                onClick={onRemoveWall}\r\n                className=\"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold\"\r\n                title=\"Delete Wall\"\r\n              >\r\n                <Trash2 className=\"rfp-w-4 rfp-h-4\" />\r\n                <span>Delete</span>\r\n              </button>\r\n            </>\r\n          )}\r\n\r\n          {/* Fixed Element Controls */}\r\n          {selectedFixedElement && (\r\n            <>\r\n              <div className=\"w-px rfp-h-8 rfp-bg-gray-300\" />\r\n\r\n              {/* Fixed Element Info */}\r\n              <div className=\"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2\">\r\n                <span className=\"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500\">\r\n                  {FIXED_ELEMENT_LABELS[selectedFixedElement.type]}\r\n                </span>\r\n              </div>\r\n\r\n              {/* Fixed Element Resize Controls */}\r\n              {onFixedElementResize && (\r\n                <div ref={fixedElementSizeMenuRef} className=\"rfp-relative\">\r\n                  <button\r\n                    onClick={() => setIsFixedElementSizeMenuOpen(!isFixedElementSizeMenuOpen)}\r\n                    className=\"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-gray-600 hover:bg-gray-700 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold\"\r\n                  >\r\n                    <Square className=\"rfp-w-4 rfp-h-4\" />\r\n                    <span>Resize</span>\r\n                  </button>\r\n                  \r\n                  {isFixedElementSizeMenuOpen && (\r\n                    <div className=\"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-bg-white rfp-rounded-xl shadow-2xl rfp-border rfp-border-gray-200 rfp-p-4 z-50 min-w-[320px]\">\r\n                      <div className=\"rfp-space-y-4\">\r\n                        {/* Width Slider */}\r\n                        <div>\r\n                          <div className=\"rfp-flex rfp-justify-between rfp-items-center rfp-mb-2\">\r\n                            <label className=\"rfp-text-sm rfp-font-semibold rfp-text-gray-700\">Width</label>\r\n                            <span className=\"rfp-text-sm rfp-font-bold rfp-text-blue-600\">{fixedElementWidth}px</span>\r\n                          </div>\r\n                          <input\r\n                            type=\"range\"\r\n                            min=\"30\"\r\n                            max=\"200\"\r\n                            value={fixedElementWidth}\r\n                            onChange={(e) => {\r\n                              const newWidth = parseInt(e.target.value);\r\n                              setFixedElementWidth(newWidth);\r\n                              onFixedElementResize(newWidth, fixedElementHeight);\r\n                            }}\r\n                            className=\"rfp-w-full rfp-h-2 bg-gradient-to-r from-blue-200 to-blue-500 rfp-rounded-lg appearance-none rfp-cursor-pointer slider\"\r\n                          />\r\n                          <div className=\"rfp-flex rfp-justify-between rfp-text-xs rfp-text-gray-500 rfp-mt-1\">\r\n                            <span>30px</span>\r\n                            <span>200px</span>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Height Slider */}\r\n                        <div>\r\n                          <div className=\"rfp-flex rfp-justify-between rfp-items-center rfp-mb-2\">\r\n                            <label className=\"rfp-text-sm rfp-font-semibold rfp-text-gray-700\">Height</label>\r\n                            <span className=\"rfp-text-sm rfp-font-bold rfp-text-blue-600\">{fixedElementHeight}px</span>\r\n                          </div>\r\n                          <input\r\n                            type=\"range\"\r\n                            min=\"30\"\r\n                            max=\"200\"\r\n                            value={fixedElementHeight}\r\n                            onChange={(e) => {\r\n                              const newHeight = parseInt(e.target.value);\r\n                              setFixedElementHeight(newHeight);\r\n                              onFixedElementResize(fixedElementWidth, newHeight);\r\n                            }}\r\n                            className=\"rfp-w-full rfp-h-2 bg-gradient-to-r from-green-200 to-green-500 rfp-rounded-lg appearance-none rfp-cursor-pointer slider\"\r\n                          />\r\n                          <div className=\"rfp-flex rfp-justify-between rfp-text-xs rfp-text-gray-500 rfp-mt-1\">\r\n                            <span>30px</span>\r\n                            <span>200px</span>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Current Size Display */}\r\n                        <div className=\"rfp-pt-3 rfp-border-t rfp-border-gray-200\">\r\n                          <div className=\"rfp-text-center\">\r\n                            <span className=\"rfp-text-xs rfp-text-gray-600\">Current Size: </span>\r\n                            <span className=\"rfp-text-sm rfp-font-bold rfp-text-gray-800\">{fixedElementWidth} Ã— {fixedElementHeight}px</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Delete Fixed Element Button */}\r\n              <button\r\n                onClick={onRemoveFixedElement}\r\n                className=\"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold\"\r\n                title=\"Delete Element\"\r\n              >\r\n                <Trash2 className=\"rfp-w-4 rfp-h-4\" />\r\n                <span>Delete</span>\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Right Section - Stats */}\r\n        <div className=\"rfp-flex rfp-items-center rfp-gap-3 rfp-flex-wrap\">\r\n          {/* 3D Button */}\r\n          <button\r\n            onClick={on3DPreview}\r\n            className=\"rfp-px-4 rfp-py-2 bg-gradient-to-r from-purple-600 to-blue-600 rfp-text-white rfp-rounded-lg hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-font-semibold rfp-text-sm\"\r\n          >\r\n            <Box className=\"rfp-w-4 rfp-h-4\" />\r\n            3D\r\n          </button>\r\n          \r\n          <div className=\"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 bg-emerald-50 rfp-rounded rfp-text-xs\">\r\n            <div className=\"rfp-w-2 rfp-h-2 bg-emerald-600 rfp-rounded-full\" />\r\n            <span className=\"rfp-font-medium text-emerald-800\">Tables: {tableCount}</span>\r\n          </div>\r\n          <div className=\"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 bg-amber-50 rfp-rounded rfp-text-xs\">\r\n            <div className=\"rfp-w-2 rfp-h-2 bg-amber-600 rfp-rounded-full\" />\r\n            <span className=\"rfp-font-medium text-amber-800\">Chairs: {chairCount}</span>\r\n          </div>\r\n          <div className=\"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 rfp-bg-purple-50 rfp-rounded rfp-text-xs\">\r\n            <div className=\"rfp-w-2 rfp-h-2 rfp-bg-purple-600 rfp-rounded-full\" />\r\n            <span className=\"rfp-font-medium rfp-text-purple-800\">Objects: {objectCount}</span>\r\n          </div>\r\n          {selectedElementType && (\r\n            <div className=\"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 rfp-bg-blue-50 rfp-rounded rfp-text-xs\">\r\n              <div className=\"w-1.5 h-1.5 rfp-bg-blue-600 rfp-rounded-full rfp-animate-pulse\" />\r\n              <span className=\"rfp-font-medium rfp-text-blue-800 rfp-capitalize\">Selected: {selectedElementType}</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport * as THREE from 'three';\r\nimport { X, RotateCcw, ZoomIn, ZoomOut, Maximize2, Move3d, Grid, Layers } from 'lucide-react';\r\nimport type { Floor } from '../types';\r\n\r\ninterface Preview3DModalProps {\r\n  floor: Floor;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\n// Predefined camera positions for smooth transitions\r\nconst CAMERA_VIEWS = {\r\n  default: { \r\n    position: { x: 1050, y: 800, z: 1050 }, // Slightly more zoomed out\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Default',\r\n    icon: 'ðŸ '\r\n  },\r\n  top: { \r\n    position: { x: 0, y: 1200, z: 1 }, // Higher for better top view\r\n    target: { x: 0, y: 0, z: 0 },\r\n    name: 'Top View',\r\n    icon: 'â¬‡'\r\n  },\r\n  front: { \r\n    position: { x: 0, y: 300, z: 1000 }, // Further back\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Front',\r\n    icon: 'â¬†'\r\n  },\r\n  side: { \r\n    position: { x: 1000, y: 300, z: 0 }, // Further to the side\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Side',\r\n    icon: 'âž¡'\r\n  },\r\n  corner: { \r\n    position: { x: -900, y: 700, z: -900 }, // More zoomed out corner\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Corner',\r\n    icon: 'â†–'\r\n  }\r\n};\r\n\r\nexport const Preview3DModal: React.FC<Preview3DModalProps> = ({ floor, isOpen, onClose }) => {\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const sceneRef = useRef<THREE.Scene | null>(null);\r\n  const cameraRef = useRef<THREE.PerspectiveCamera | null>(null);\r\n  const rendererRef = useRef<THREE.WebGLRenderer | null>(null);\r\n  const animationFrameRef = useRef<number | null>(null);\r\n  const [autoRotate, setAutoRotate] = useState(false);\r\n  const [currentView, setCurrentView] = useState<keyof typeof CAMERA_VIEWS>('default');\r\n  const [isTransitioning, setIsTransitioning] = useState(false);\r\n  const rotationSpeedRef = useRef(0.003);\r\n  const transitionRef = useRef<{ \r\n    startPos: THREE.Vector3; \r\n    endPos: THREE.Vector3;\r\n    startTarget: THREE.Vector3;\r\n    endTarget: THREE.Vector3;\r\n    progress: number;\r\n  } | null>(null);\r\n\r\n  // Smooth camera transition function\r\n  const smoothCameraTransition = (viewKey: keyof typeof CAMERA_VIEWS) => {\r\n    if (!cameraRef.current || isTransitioning) return;\r\n    \r\n    const view = CAMERA_VIEWS[viewKey];\r\n    const camera = cameraRef.current;\r\n    \r\n    transitionRef.current = {\r\n      startPos: camera.position.clone(),\r\n      endPos: new THREE.Vector3(view.position.x, view.position.y, view.position.z),\r\n      startTarget: new THREE.Vector3(0, 100, 0),\r\n      endTarget: new THREE.Vector3(view.target.x, view.target.y, view.target.z),\r\n      progress: 0\r\n    };\r\n    \r\n    setIsTransitioning(true);\r\n    setCurrentView(viewKey);\r\n    setAutoRotate(false);\r\n  };\r\n\r\n  // Manual rotation controls\r\n  const rotateCamera = (direction: 'left' | 'right' | 'up' | 'down') => {\r\n    if (!cameraRef.current || isTransitioning) return;\r\n    \r\n    const camera = cameraRef.current;\r\n    const radius = Math.sqrt(camera.position.x ** 2 + camera.position.z ** 2);\r\n    const currentAngle = Math.atan2(camera.position.z, camera.position.x);\r\n    \r\n    switch(direction) {\r\n      case 'left':\r\n        const leftAngle = currentAngle + 0.2;\r\n        camera.position.x = radius * Math.cos(leftAngle);\r\n        camera.position.z = radius * Math.sin(leftAngle);\r\n        break;\r\n      case 'right':\r\n        const rightAngle = currentAngle - 0.2;\r\n        camera.position.x = radius * Math.cos(rightAngle);\r\n        camera.position.z = radius * Math.sin(rightAngle);\r\n        break;\r\n      case 'up':\r\n        camera.position.y = Math.min(camera.position.y + 50, 900);\r\n        break;\r\n      case 'down':\r\n        camera.position.y = Math.max(camera.position.y - 50, 100);\r\n        break;\r\n    }\r\n    \r\n    camera.lookAt(0, 100, 0);\r\n  };\r\n\r\n  const zoomCamera = (factor: number) => {\r\n    if (!cameraRef.current || isTransitioning) return;\r\n    cameraRef.current.position.multiplyScalar(factor);\r\n    cameraRef.current.lookAt(0, 100, 0);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!isOpen || !containerRef.current) return;\r\n\r\n    // Scene setup with light modern theme\r\n    const scene = new THREE.Scene();\r\n    scene.background = new THREE.Color(0xdee6ef); // Soft blue-grey for pleasant atmosphere\r\n    sceneRef.current = scene;\r\n\r\n    // Camera\r\n    const camera = new THREE.PerspectiveCamera(\r\n      45,\r\n      containerRef.current.clientWidth / containerRef.current.clientHeight,\r\n      0.1,\r\n      10000\r\n    );\r\n    camera.position.set(1050, 800, 1050); // Slightly more zoomed out default view\r\n    camera.lookAt(0, 100, 0); // Looking at mid-level\r\n    cameraRef.current = camera;\r\n\r\n    // Renderer with advanced settings\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\r\n    renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    renderer.toneMapping = THREE.ACESFilmicToneMapping;\r\n    renderer.toneMappingExposure = 1.2;\r\n    containerRef.current.appendChild(renderer.domElement);\r\n    rendererRef.current = renderer;\r\n    \r\n    // Add environment map for better reflections\r\n    const pmremGenerator = new THREE.PMREMGenerator(renderer);\r\n    const envScene = new THREE.Scene();\r\n    envScene.background = new THREE.Color(0xffffff);\r\n    const envTexture = pmremGenerator.fromScene(envScene).texture;\r\n    scene.environment = envTexture;\r\n    pmremGenerator.dispose();\r\n\r\n    // Professional lighting setup\r\n    scene.add(new THREE.AmbientLight(0xffffff, 0.6));\r\n    \r\n    const mainLight = new THREE.DirectionalLight(0xffffff, 0.8);\r\n    mainLight.position.set(400, 600, 300);\r\n    mainLight.castShadow = true;\r\n    mainLight.shadow.mapSize.width = 4096;\r\n    mainLight.shadow.mapSize.height = 4096;\r\n    mainLight.shadow.camera.left = mainLight.shadow.camera.bottom = -700;\r\n    mainLight.shadow.camera.right = mainLight.shadow.camera.top = 700;\r\n    mainLight.shadow.bias = -0.0001;\r\n    scene.add(mainLight);\r\n    \r\n    const fillLight = new THREE.DirectionalLight(0xffffff, 0.3);\r\n    fillLight.position.set(-400, 400, -300);\r\n    scene.add(fillLight);\r\n    \r\n    const rimLight = new THREE.DirectionalLight(0xffffff, 0.2);\r\n    rimLight.position.set(0, 300, -500);\r\n    scene.add(rimLight);\r\n\r\n    // Modern floor\r\n    const floorMesh = new THREE.Mesh(\r\n      new THREE.PlaneGeometry(1200, 1200),\r\n      new THREE.MeshStandardMaterial({ color: 0xd0d0d5, roughness: 0.8, metalness: 0.2 }) // Medium grey\r\n    );\r\n    floorMesh.rotation.x = -Math.PI / 2;\r\n    floorMesh.receiveShadow = true;\r\n    scene.add(floorMesh);\r\n\r\n    const grid = new THREE.GridHelper(3000, 150, 0xa0a0a8, 0xb8b8c0); // Much larger grid (3000x3000)\r\n    grid.position.y = 1;\r\n    scene.add(grid);\r\n\r\n    // WALLS - Premium styling\r\n    floor.walls.forEach(wall => {\r\n      const length = Math.sqrt(Math.pow(wall.endX - wall.startX, 2) + Math.pow(wall.endY - wall.startY, 2));\r\n      const angle = Math.atan2(wall.endY - wall.startY, wall.endX - wall.startX);\r\n      const wallHeight = wall.type === 'window' ? 80 : 120; // Windows are 80, walls and doors are 120\r\n      const baseX = wall.startX + (wall.endX - wall.startX) / 2 - 400;\r\n      const baseZ = -(wall.startY + (wall.endY - wall.startY) / 2 - 400);\r\n      \r\n      if (wall.type === 'door') {\r\n        // === RESTAURANT DOUBLE GLASS DOOR ===\r\n        const doorGroup = new THREE.Group();\r\n        const doorWidth = length; // Full wall width\r\n        const doorHeight = wallHeight; // Full wall height\r\n        const doorThickness = wall.thickness * 0.8;\r\n\r\n        // === FRAME (dark wood or metal) ===\r\n        const frameMat = new THREE.MeshStandardMaterial({\r\n          color: 0x3a2e25, // dark stained wood\r\n          roughness: 0.9,\r\n          metalness: 0.0,\r\n        });\r\n\r\n        const frameThickness = 8;\r\n\r\n        // Frame sides, top, and bottom - adjusted to fit within wall height\r\n        const topFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(doorWidth, frameThickness, wall.thickness + 4),\r\n          frameMat\r\n        );\r\n        topFrame.position.y = doorHeight / 2 - frameThickness / 2;\r\n        doorGroup.add(topFrame);\r\n\r\n        const bottomFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(doorWidth, frameThickness, wall.thickness + 4),\r\n          frameMat\r\n        );\r\n        bottomFrame.position.y = -doorHeight / 2 + frameThickness / 2;\r\n        doorGroup.add(bottomFrame);\r\n\r\n        const leftFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(frameThickness, doorHeight, wall.thickness + 4),\r\n          frameMat\r\n        );\r\n        leftFrame.position.x = -doorWidth / 2 + frameThickness / 2;\r\n        doorGroup.add(leftFrame);\r\n\r\n        const rightFrame = leftFrame.clone();\r\n        rightFrame.position.x = doorWidth / 2 - frameThickness / 2;\r\n        doorGroup.add(rightFrame);\r\n\r\n        // === LEFT + RIGHT DOOR PANELS ===\r\n        const doorMat = new THREE.MeshStandardMaterial({\r\n          color: 0x4e342e, // warm brown\r\n          roughness: 0.85,\r\n          metalness: 0.0,\r\n        });\r\n\r\n        const glassMat = new THREE.MeshStandardMaterial({\r\n          color: 0x9eb3b5, // subtle bluish-gray tint\r\n          transparent: true,\r\n          opacity: 0.5,     // semi-transparent\r\n          roughness: 0.95,  // frosted effect\r\n          metalness: 0.0,   // no mirror reflection\r\n        });\r\n\r\n        const singleDoorWidth = (doorWidth - frameThickness * 2 - 4) / 2;\r\n        const doorPanelHeight = doorHeight - frameThickness * 2 - 4; // Fit within top and bottom frame\r\n\r\n        const makeDoor = (xOffset: number) => {\r\n          const group = new THREE.Group();\r\n\r\n          // Wood border\r\n          const doorBorder = new THREE.Mesh(\r\n            new THREE.BoxGeometry(singleDoorWidth, doorPanelHeight, doorThickness),\r\n            doorMat\r\n          );\r\n          group.add(doorBorder);\r\n\r\n          // Glass inset (center window)\r\n          const glass = new THREE.Mesh(\r\n            new THREE.PlaneGeometry(singleDoorWidth * 0.8, doorPanelHeight * 0.85),\r\n            glassMat\r\n          );\r\n          glass.position.set(0, 0, doorThickness / 2 + 0.1);\r\n          group.add(glass);\r\n\r\n          // Handle (simple vertical metal bar)\r\n          const handleMat = new THREE.MeshStandardMaterial({\r\n            color: 0x888888,\r\n            metalness: 0.4,\r\n            roughness: 0.7,\r\n          });\r\n\r\n          const handle = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(0.6, 0.6, 12, 12),\r\n            handleMat\r\n          );\r\n          handle.rotation.z = Math.PI / 2;\r\n          handle.position.set(xOffset > 0 ? -singleDoorWidth * 0.35 : singleDoorWidth * 0.35, 0, doorThickness / 2 + 1.5);\r\n          group.add(handle);\r\n\r\n          group.position.x = xOffset;\r\n          return group;\r\n        };\r\n\r\n        // Left & Right doors\r\n        const leftDoor = makeDoor(-singleDoorWidth / 2);\r\n        const rightDoor = makeDoor(singleDoorWidth / 2);\r\n        doorGroup.add(leftDoor);\r\n        doorGroup.add(rightDoor);\r\n\r\n        // === WELCOME SIGN ===\r\n        const signHeight = 14;\r\n        const signGeometry = new THREE.PlaneGeometry(doorWidth * 0.9, signHeight);\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = 512;\r\n        canvas.height = 128;\r\n        const ctx = canvas.getContext('2d');\r\n\r\n        if (ctx) {\r\n          // Draw wooden background\r\n          ctx.fillStyle = '#3a2e25';\r\n          ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n          // Draw text\r\n          ctx.font = 'bold 60px Arial';\r\n          ctx.fillStyle = '#f5d590'; // warm golden lettering\r\n          ctx.textAlign = 'center';\r\n          ctx.textBaseline = 'middle';\r\n          ctx.fillText('WELCOME', canvas.width / 2, canvas.height / 2);\r\n        }\r\n\r\n        const signTexture = new THREE.CanvasTexture(canvas);\r\n        const signMaterial = new THREE.MeshStandardMaterial({\r\n          map: signTexture,\r\n          roughness: 0.8,\r\n          metalness: 0.1,\r\n        });\r\n\r\n        const sign = new THREE.Mesh(signGeometry, signMaterial);\r\n        sign.position.set(0, doorHeight / 2 - frameThickness - signHeight / 2 - 4, wall.thickness / 2 + 2);\r\n        doorGroup.add(sign);\r\n\r\n        // === FINAL POSITIONING ===\r\n        doorGroup.position.set(baseX, doorHeight / 2, baseZ);\r\n        doorGroup.rotation.y = -angle;\r\n        doorGroup.castShadow = true;\r\n        doorGroup.receiveShadow = true;\r\n        scene.add(doorGroup);\r\n        \r\n      } else if (wall.type === 'window') {\r\n        // === REALISTIC ARCHITECTURAL WINDOW (With top wall section) ===\r\n        \r\n        // Use standard size if length is too small\r\n        const windowLength = length > 20 ? length : 120;\r\n        const windowHeight = wallHeight;\r\n\r\n        // HEIGHT RATIOS\r\n        const h1 = windowHeight * 0.45;  // bottom wall/sill (increased)\r\n        const h2 = windowHeight * 0.65;  // main window area\r\n        const h3 = windowHeight * 0.10;  // top transom\r\n        const h4 = windowHeight * 0.30;  // top wall section\r\n\r\n        // === MATERIALS ===\r\n        const wallMat = new THREE.MeshStandardMaterial({\r\n          color: 0xc8c8d0, // Grey-blue for window sills and wall sections\r\n          roughness: 0.85,\r\n          metalness: 0.05\r\n        });\r\n\r\n        // Dark aluminum/black frame for contrast\r\n        const frameMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x2a2a2a,\r\n          metalness: 0.95,\r\n          roughness: 0.2,\r\n          clearcoat: 0.8,\r\n          clearcoatRoughness: 0.1,\r\n        });\r\n\r\n        // Realistic glass - visible but transparent with subtle blue tint\r\n        const glassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xe6f2ff,\r\n          transparent: true,\r\n          opacity: 0.4,\r\n          transmission: 0.85,\r\n          thickness: 1.5,\r\n          roughness: 0.05,\r\n          metalness: 0.05,\r\n          ior: 1.52,\r\n          envMapIntensity: 1.0,\r\n          clearcoat: 0.8,\r\n          clearcoatRoughness: 0.1,\r\n          reflectivity: 0.5,\r\n        });\r\n\r\n        // === BOTTOM WALL/SILL ===\r\n        const sill = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, h1, wall.thickness),\r\n          wallMat\r\n        );\r\n        sill.position.set(baseX, h1 / 2, baseZ);\r\n        sill.rotation.y = -angle;\r\n        sill.receiveShadow = true;\r\n        sill.castShadow = true;\r\n        scene.add(sill);\r\n\r\n        // === MAIN WINDOW AREA ===\r\n        const winY = h1 + h2 / 2;\r\n        const frameThickness = 4;\r\n        const numPanes = Math.max(2, Math.floor(windowLength / 80)); // At least 2 panes\r\n        const paneWidth = (windowLength - frameThickness * (numPanes + 1)) / numPanes;\r\n\r\n        // Individual glass panes WITH PROPER POSITIONING\r\n        for (let i = 0; i < numPanes; i++) {\r\n          const paneX = -windowLength / 2 + frameThickness + paneWidth / 2 + i * (paneWidth + frameThickness);\r\n          const localX = baseX + paneX * Math.cos(-angle);\r\n          const localZ = baseZ + paneX * Math.sin(-angle);\r\n\r\n          // Glass pane (positioned INSIDE the frame)\r\n          const glass = new THREE.Mesh(\r\n            new THREE.BoxGeometry(paneWidth - 2, h2 - frameThickness * 2, 1),\r\n            glassMat\r\n          );\r\n          glass.position.set(localX, winY, localZ);\r\n          glass.rotation.y = -angle;\r\n          glass.castShadow = false;\r\n          glass.receiveShadow = false;\r\n          scene.add(glass);\r\n\r\n          // Vertical divider (except after last pane)\r\n          if (i < numPanes - 1) {\r\n            const divX = -windowLength / 2 + frameThickness + (i + 1) * paneWidth + (i + 0.5) * frameThickness;\r\n            const divLocalX = baseX + divX * Math.cos(-angle);\r\n            const divLocalZ = baseZ + divX * Math.sin(-angle);\r\n            \r\n            const divider = new THREE.Mesh(\r\n              new THREE.BoxGeometry(frameThickness, h2, wall.thickness + 3),\r\n              frameMat\r\n            );\r\n            divider.position.set(divLocalX, winY, divLocalZ);\r\n            divider.rotation.y = -angle;\r\n            divider.castShadow = true;\r\n            scene.add(divider);\r\n          }\r\n        }\r\n\r\n        // === TOP TRANSOM WINDOW ===\r\n        const topY = h1 + h2 + h3 / 2;\r\n\r\n        const transomGlass = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength - frameThickness * 2, h3 - frameThickness, 1),\r\n          glassMat\r\n        );\r\n        transomGlass.position.set(baseX, topY, baseZ);\r\n        transomGlass.rotation.y = -angle;\r\n        transomGlass.castShadow = false;\r\n        scene.add(transomGlass);\r\n        \r\n        // Transom frame (between main window and transom)\r\n        const transomFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, frameThickness, wall.thickness + 2),\r\n          frameMat\r\n        );\r\n        transomFrame.position.set(baseX, h1 + h2 + frameThickness / 2, baseZ);\r\n        transomFrame.rotation.y = -angle;\r\n        transomFrame.castShadow = true;\r\n        scene.add(transomFrame);\r\n\r\n        // Frame between transom and top wall\r\n        const transomTopFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, frameThickness, wall.thickness + 2),\r\n          frameMat\r\n        );\r\n        transomTopFrame.position.set(baseX, h1 + h2 + h3 + frameThickness / 2, baseZ);\r\n        transomTopFrame.rotation.y = -angle;\r\n        transomTopFrame.castShadow = true;\r\n        scene.add(transomTopFrame);\r\n\r\n        // === TOP WALL SECTION (same material as regular wall) ===\r\n        const topWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, h4, wall.thickness),\r\n          wallMat\r\n        );\r\n        topWall.position.set(baseX, h1 + h2 + h3 + h4 / 2, baseZ);\r\n        topWall.rotation.y = -angle;\r\n        topWall.castShadow = true;\r\n        topWall.receiveShadow = true;\r\n        scene.add(topWall);\r\n        \r\n      } else {\r\n        // Regular walls - warmer grey-blue for better definition\r\n        const wallMesh = new THREE.Mesh(\r\n          new THREE.BoxGeometry(length, wallHeight, wall.thickness),\r\n          new THREE.MeshStandardMaterial({ color: 0xb8b8c0, roughness: 0.9, metalness: 0.05 })\r\n        );\r\n        wallMesh.position.set(baseX, wallHeight / 2, baseZ);\r\n        wallMesh.rotation.y = -angle;\r\n        wallMesh.castShadow = true;\r\n        wallMesh.receiveShadow = true;\r\n        scene.add(wallMesh);\r\n      }\r\n    });\r\n\r\n    // FIXED ELEMENTS - Premium styling\r\n    floor.fixedElements.forEach(element => {\r\n      const baseX = element.x - 400 + element.width / 2;\r\n      const baseZ = -(element.y - 400 + element.height / 2);\r\n      \r\n      if (element.type === 'pillar') {\r\n        const radius = Math.min(element.width, element.height) / 2;\r\n        \r\n        // Main pillar shaft\r\n        const pillar = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(radius, radius * 1.1, 140, 32),\r\n          new THREE.MeshStandardMaterial({ color: 0x4a4a5a, roughness: 0.6, metalness: 0.4 })\r\n        );\r\n        pillar.position.set(baseX, 70, baseZ);\r\n        pillar.castShadow = true;\r\n        scene.add(pillar);\r\n        \r\n        // Classical capital (top decoration)\r\n        const capital = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(radius * 1.3, radius * 1.1, 10, 32),\r\n          new THREE.MeshStandardMaterial({ color: 0x5a5a6a, roughness: 0.5, metalness: 0.5 })\r\n        );\r\n        capital.position.set(baseX, 135, baseZ);\r\n        capital.castShadow = true;\r\n        scene.add(capital);\r\n        \r\n        // Base\r\n        const base = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(radius * 1.2, radius * 1.3, 10, 32),\r\n          new THREE.MeshStandardMaterial({ color: 0x5a5a6a, roughness: 0.5, metalness: 0.5 })\r\n        );\r\n        base.position.set(baseX, 5, baseZ);\r\n        base.castShadow = true;\r\n        scene.add(base);\r\n        \r\n      } else if (element.type === 'column') {\r\n        const column = new THREE.Mesh(\r\n          new THREE.BoxGeometry(element.width, 140, element.height),\r\n          new THREE.MeshStandardMaterial({ color: 0x3a3a4a, roughness: 0.7, metalness: 0.3 })\r\n        );\r\n        column.position.set(baseX, 70, baseZ);\r\n        column.castShadow = true;\r\n        scene.add(column);\r\n        \r\n        // Edge highlights\r\n        const edges = new THREE.LineSegments(\r\n          new THREE.EdgesGeometry(column.geometry),\r\n          new THREE.LineBasicMaterial({ color: 0x6a6a7a })\r\n        );\r\n        edges.position.copy(column.position);\r\n        scene.add(edges);\r\n        \r\n      } else { // stairs - individual steps\r\n        const stepCount = 8;\r\n        const stepHeight = 50 / stepCount;\r\n        const stepDepth = element.height / stepCount;\r\n        \r\n        for (let i = 0; i < stepCount; i++) {\r\n          const step = new THREE.Mesh(\r\n            new THREE.BoxGeometry(element.width, stepHeight, stepDepth * (stepCount - i)),\r\n            new THREE.MeshStandardMaterial({ color: 0x654321, roughness: 0.8 })\r\n          );\r\n          step.position.set(baseX, stepHeight / 2 + i * stepHeight, baseZ + i * stepDepth / 2);\r\n          step.castShadow = true;\r\n          scene.add(step);\r\n          \r\n          const edges = new THREE.LineSegments(\r\n            new THREE.EdgesGeometry(step.geometry),\r\n            new THREE.LineBasicMaterial({ color: 0x3a2410 })\r\n          );\r\n          edges.position.copy(step.position);\r\n          scene.add(edges);\r\n        }\r\n      }\r\n    });\r\n\r\n    // OBJECTS (Bar, Kitchen, Toilet) - Ultra-realistic materials\r\n    floor.objects.forEach(obj => {\r\n      const baseX = obj.x - 400 + obj.width / 2;\r\n      const baseZ = -(obj.y - 400 + obj.height / 2);\r\n      const rotation = -(obj.rotation * Math.PI / 180);\r\n      \r\n      // === MODERN HOTEL BAR (Glass Top with Wine & Liquor Tones) ===\r\n      if (obj.type === 'bar') {\r\n        const baseX = obj.x - 400 + obj.width / 2;\r\n        const baseZ = -(obj.y - 400 + obj.height / 2);\r\n        const rotation = -(obj.rotation * Math.PI / 180);\r\n        const barHeight = 50;\r\n\r\n        // === Base Cabinet (dark brushed metal) ===\r\n        const baseMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x1a1a1a,\r\n          roughness: 0.5,\r\n          metalness: 0.8,\r\n          clearcoat: 0.2,\r\n          clearcoatRoughness: 0.4,\r\n        });\r\n\r\n        const base = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, barHeight, obj.height),\r\n          baseMat\r\n        );\r\n        base.position.set(baseX, barHeight / 2, baseZ);\r\n        base.rotation.y = rotation;\r\n        base.castShadow = true;\r\n        base.receiveShadow = true;\r\n        scene.add(base);\r\n\r\n        // === Translucent Glass Countertop ===\r\n        const glassColors = [0x7f0000, 0xa45a00, 0x661a00, 0x8b0000, 0x884400]; // wine, whiskey, rum tones\r\n        const glassColor = glassColors[Math.floor(Math.random() * glassColors.length)];\r\n\r\n        const glassTopMat = new THREE.MeshPhysicalMaterial({\r\n          color: glassColor,\r\n          metalness: 0.1,\r\n          roughness: 0.05,\r\n          transmission: 0.9,           // transparency\r\n          thickness: 2.0,\r\n          ior: 1.5,\r\n          reflectivity: 0.9,\r\n          clearcoat: 1.0,\r\n          clearcoatRoughness: 0.05,\r\n        });\r\n\r\n        const glassTop = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 6, 6, obj.height + 6),\r\n          glassTopMat\r\n        );\r\n        glassTop.position.set(baseX, barHeight + 3, baseZ);\r\n        glassTop.rotation.y = rotation;\r\n        glassTop.castShadow = true;\r\n        scene.add(glassTop);\r\n\r\n        // === Under Counter LED glow ===\r\n        const ledGlowMat = new THREE.MeshStandardMaterial({\r\n          emissive: 0xff0077,  // pinkish-red glow\r\n          emissiveIntensity: 0.6,\r\n          color: 0x000000,\r\n        });\r\n        const ledStrip = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 6, 0.5, obj.height + 6),\r\n          ledGlowMat\r\n        );\r\n        ledStrip.position.set(baseX, barHeight + 1, baseZ);\r\n        ledStrip.rotation.y = rotation;\r\n        scene.add(ledStrip);\r\n\r\n        // === Edge Trim (gold or chrome depending on glass tone) ===\r\n        const trimColor = glassColor === 0x7f0000 ? 0xd4af37 : 0xb0b0b0;\r\n        const trim = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 8, 0.6, obj.height + 8),\r\n          new THREE.MeshStandardMaterial({\r\n            color: trimColor,\r\n            metalness: 1.0,\r\n            roughness: 0.2,\r\n          })\r\n        );\r\n        trim.position.set(baseX, barHeight + 6.5, baseZ);\r\n        trim.rotation.y = rotation;\r\n        scene.add(trim);\r\n\r\n        // === Bar Legs (stainless steel) ===\r\n        const legMat = new THREE.MeshStandardMaterial({\r\n          color: 0xcccccc,\r\n          metalness: 1.0,\r\n          roughness: 0.1,\r\n        });\r\n        const legGeo = new THREE.CylinderGeometry(2, 2, barHeight, 16);\r\n        const legOffsets = [\r\n          [obj.width / 2 - 6, obj.height / 2 - 6],\r\n          [-obj.width / 2 + 6, obj.height / 2 - 6],\r\n          [obj.width / 2 - 6, -obj.height / 2 + 6],\r\n          [-obj.width / 2 + 6, -obj.height / 2 + 6],\r\n        ];\r\n        legOffsets.forEach(([lx, lz]) => {\r\n          const leg = new THREE.Mesh(legGeo, legMat);\r\n          leg.position.set(\r\n            baseX + lx * Math.cos(rotation) - lz * Math.sin(rotation),\r\n            barHeight / 2,\r\n            baseZ + lx * Math.sin(rotation) + lz * Math.cos(rotation)\r\n          );\r\n          leg.castShadow = true;\r\n          scene.add(leg);\r\n        });\r\n\r\n        // === Optional: Light reflection simulation (point light above the bar) ===\r\n        const barLight = new THREE.PointLight(glassColor, 0.4, 600);\r\n        barLight.position.set(baseX, barHeight + 70, baseZ); // Adjusted for lower canopy\r\n        scene.add(barLight);\r\n\r\n        // === PREMIUM MODERN BAR CANOPY ===\r\n        const canopyHeight = 120; // Lowered from 160 to 120\r\n        const canopyOuter = new THREE.Group();\r\n\r\n        // === Outer frame (brushed dark metal) ===\r\n        const outerMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x202020,\r\n          metalness: 1.0,\r\n          roughness: 0.25,\r\n          clearcoat: 0.6,\r\n          clearcoatRoughness: 0.1,\r\n        });\r\n\r\n        const outerShell = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 40, 10, obj.height + 40),\r\n          outerMat\r\n        );\r\n        outerShell.castShadow = true;\r\n        outerShell.receiveShadow = true;\r\n        canopyOuter.add(outerShell);\r\n\r\n        // === Inner glass ceiling panel (liquor-tinted glass) ===\r\n        const innerGlassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xa45a00, // whiskey amber\r\n          metalness: 0,\r\n          roughness: 0.05,\r\n          transmission: 0.95,\r\n          thickness: 1.5,\r\n          ior: 1.45,\r\n          clearcoat: 1.0,\r\n          clearcoatRoughness: 0.05,\r\n        });\r\n        const innerGlass = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width + 32, obj.height + 32),\r\n          innerGlassMat\r\n        );\r\n        innerGlass.rotation.x = -Math.PI / 2;\r\n        innerGlass.position.y = -3;\r\n        canopyOuter.add(innerGlass);\r\n\r\n        // === Embedded LED strips around the rim ===\r\n        const ledMat = new THREE.MeshStandardMaterial({\r\n          emissive: 0xffcc88,\r\n          emissiveIntensity: 1.6,\r\n          color: 0x000000,\r\n        });\r\n        const ledGeom = new THREE.BoxGeometry(4, 2, obj.height + 36);\r\n        const ledLeft = new THREE.Mesh(ledGeom, ledMat);\r\n        const ledRight = ledLeft.clone();\r\n        ledLeft.position.set(-(obj.width + 36) / 2, -2, 0);\r\n        ledRight.position.set((obj.width + 36) / 2, -2, 0);\r\n        canopyOuter.add(ledLeft, ledRight);\r\n\r\n        // === Hanging wine bottle rack ===\r\n        const bottleRack = new THREE.Group();\r\n        const bottleColors = [0xb22222, 0xe3a857, 0x8b4513, 0x006994, 0x772f1a];\r\n        for (let i = -3; i <= 3; i++) {\r\n          const color = bottleColors[Math.floor(Math.random() * bottleColors.length)];\r\n          const bottleMat = new THREE.MeshPhysicalMaterial({\r\n            color,\r\n            roughness: 0.1,\r\n            transmission: 0.95,\r\n            thickness: 0.6,\r\n            ior: 1.5,\r\n            clearcoat: 0.3,\r\n            clearcoatRoughness: 0.2,\r\n          });\r\n\r\n          const bottle = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(3, 3, 20, 32),\r\n            bottleMat\r\n          );\r\n          bottle.position.set(i * 12, -12, 0);\r\n          bottleRack.add(bottle);\r\n\r\n          // neck\r\n          const neck = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(1.2, 1.2, 6, 16),\r\n            bottleMat\r\n          );\r\n          neck.position.set(i * 12, -3, 0);\r\n          bottleRack.add(neck);\r\n        }\r\n        bottleRack.position.y = -15;\r\n        canopyOuter.add(bottleRack);\r\n\r\n        // === Hanging glass rack ===\r\n        const glassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xffffff,\r\n          roughness: 0.1,\r\n          transmission: 0.9,\r\n          thickness: 0.4,\r\n          ior: 1.45,\r\n        });\r\n        for (let i = -2; i <= 2; i++) {\r\n          const glass = new THREE.Mesh(\r\n            new THREE.SphereGeometry(2.5, 16, 16, 0, Math.PI), // half-sphere\r\n            glassMat\r\n          );\r\n          glass.position.set(i * 10, -25, 0);\r\n          glass.scale.y = 0.6;\r\n          canopyOuter.add(glass);\r\n        }\r\n\r\n        // === Support rods (chrome metal) ===\r\n        const rodMat = new THREE.MeshStandardMaterial({\r\n          color: 0xaaaaaa,\r\n          metalness: 1.0,\r\n          roughness: 0.2,\r\n        });\r\n        const rodGeo = new THREE.CylinderGeometry(1.5, 1.5, canopyHeight - 60, 16);\r\n        [\r\n          [obj.width / 2 - 10, obj.height / 2 - 10],\r\n          [-obj.width / 2 + 10, obj.height / 2 - 10],\r\n          [obj.width / 2 - 10, -obj.height / 2 + 10],\r\n          [-obj.width / 2 + 10, -obj.height / 2 + 10],\r\n        ].forEach(([lx, lz]) => {\r\n          const rod = new THREE.Mesh(rodGeo, rodMat);\r\n          rod.position.set(lx, -(canopyHeight - 80) / 2, lz);\r\n          rod.rotation.x = Math.PI / 2;\r\n          canopyOuter.add(rod);\r\n        });\r\n\r\n        // === Final canopy transform & light ===\r\n        canopyOuter.position.set(baseX, canopyHeight, baseZ);\r\n        canopyOuter.rotation.y = rotation;\r\n        scene.add(canopyOuter);\r\n\r\n        // Add soft ambient light matching liquor tone\r\n        const warmLight = new THREE.PointLight(0xffaa55, 0.8, 600);\r\n        warmLight.position.set(baseX, canopyHeight - 20, baseZ);\r\n        scene.add(warmLight);\r\n        \r\n      } else if (obj.type === 'kitchen') {\r\n        // === PROFESSIONAL COMMERCIAL KITCHEN ===\r\n        const kitchenGroup = new THREE.Group();\r\n        \r\n        // === MATERIALS ===\r\n        const steelMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xb0b0b0,\r\n          metalness: 1.0,\r\n          roughness: 0.25,\r\n          envMapIntensity: 1.0,\r\n          clearcoat: 1.0,\r\n          clearcoatRoughness: 0.05,\r\n        });\r\n\r\n        const glassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x99ccff,\r\n          roughness: 0.05,\r\n          transmission: 0.9,\r\n          thickness: 0.5,\r\n          metalness: 0.1,\r\n          envMapIntensity: 1.2,\r\n        });\r\n\r\n        // === COUNTERTOP (stainless steel base) ===\r\n        const counter = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, 50, obj.height),\r\n          steelMat\r\n        );\r\n        counter.position.set(0, 25, 0);\r\n        counter.castShadow = true;\r\n        counter.receiveShadow = true;\r\n        kitchenGroup.add(counter);\r\n\r\n        // === GLASS COVER on countertop ===\r\n        const glassTop = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, 4, obj.height),\r\n          glassMat\r\n        );\r\n        glassTop.position.set(0, 52, 0);\r\n        kitchenGroup.add(glassTop);\r\n\r\n        // === STOVE AREA (dark cooking surface) ===\r\n        const stove = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.4, 10, obj.height * 0.6),\r\n          new THREE.MeshStandardMaterial({ color: 0x222222, roughness: 0.4 })\r\n        );\r\n        stove.position.set(-obj.width * 0.2, 55, 0);\r\n        kitchenGroup.add(stove);\r\n\r\n        // === STOVE BURNERS (4 metal burners) ===\r\n        const burnerMat = new THREE.MeshStandardMaterial({ \r\n          color: 0x333333, \r\n          metalness: 0.8, \r\n          roughness: 0.2 \r\n        });\r\n        const burnerPositions = [\r\n          [-obj.width * 0.25, obj.height * 0.15],\r\n          [-obj.width * 0.15, obj.height * 0.15],\r\n          [-obj.width * 0.25, -obj.height * 0.15],\r\n          [-obj.width * 0.15, -obj.height * 0.15],\r\n        ];\r\n        burnerPositions.forEach(([bx, bz]) => {\r\n          const burner = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(6, 6, 2, 32), \r\n            burnerMat\r\n          );\r\n          burner.rotation.x = Math.PI / 2;\r\n          burner.position.set(bx, 61, bz);\r\n          kitchenGroup.add(burner);\r\n        });\r\n\r\n        // === RANGE HOOD (exhaust fan above stove) ===\r\n        const hood = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.5, 35, obj.height * 0.65),\r\n          new THREE.MeshPhysicalMaterial({\r\n            color: 0xc0c0c0,\r\n            metalness: 1.0,\r\n            roughness: 0.2,\r\n            envMapIntensity: 1.1,\r\n          })\r\n        );\r\n        hood.position.set(-obj.width * 0.2, 95, 0);\r\n        hood.castShadow = true;\r\n        kitchenGroup.add(hood);\r\n\r\n        // === SHELVES (3 wall-mounted shelves) ===\r\n        const shelfMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xdddddd,\r\n          roughness: 0.3,\r\n          metalness: 0.5,\r\n        });\r\n        for (let i = 0; i < 3; i++) {\r\n          const shelf = new THREE.Mesh(\r\n            new THREE.BoxGeometry(obj.width * 0.7, 4, obj.height * 0.2),\r\n            shelfMat\r\n          );\r\n          shelf.position.set(obj.width * 0.15, 75 + i * 22, obj.height * 0.35);\r\n          shelf.castShadow = true;\r\n          kitchenGroup.add(shelf);\r\n        }\r\n\r\n        // === CABINET HANDLES ===\r\n        const handleMat = new THREE.MeshStandardMaterial({ \r\n          color: 0x888888, \r\n          metalness: 0.9, \r\n          roughness: 0.2 \r\n        });\r\n        for (let i = -1; i <= 1; i++) {\r\n          const handle = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(1.5, 1.5, 15, 16), \r\n            handleMat\r\n          );\r\n          handle.rotation.z = Math.PI / 2;\r\n          handle.position.set(i * obj.width * 0.2, 35, obj.height * 0.45);\r\n          kitchenGroup.add(handle);\r\n        }\r\n\r\n        // === OVERHEAD LIGHTS ===\r\n        const kitchenLight = new THREE.PointLight(0xffffff, 1.5, 400);\r\n        kitchenLight.position.set(0, 140, 0);\r\n        kitchenLight.castShadow = true;\r\n        kitchenGroup.add(kitchenLight);\r\n\r\n        // === CHEF SIGN on Left Side (BOLD & CLEAR Design) ===\r\n        const chefCanvas = document.createElement('canvas');\r\n        chefCanvas.width = 1024;\r\n        chefCanvas.height = 768;\r\n        const chefCtx = chefCanvas.getContext('2d');\r\n        if (chefCtx) {\r\n          // Bold red background\r\n          chefCtx.fillStyle = '#dc2626';\r\n          chefCtx.fillRect(0, 0, chefCanvas.width, chefCanvas.height);\r\n          \r\n          // Thick white border\r\n          chefCtx.strokeStyle = '#ffffff';\r\n          chefCtx.lineWidth = 25;\r\n          chefCtx.strokeRect(30, 30, chefCanvas.width - 60, chefCanvas.height - 60);\r\n          \r\n          // Inner black border for contrast\r\n          chefCtx.strokeStyle = '#000000';\r\n          chefCtx.lineWidth = 15;\r\n          chefCtx.strokeRect(50, 50, chefCanvas.width - 100, chefCanvas.height - 100);\r\n          \r\n          // Strong text shadow\r\n          chefCtx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n          chefCtx.shadowBlur = 20;\r\n          chefCtx.shadowOffsetX = 8;\r\n          chefCtx.shadowOffsetY = 8;\r\n          \r\n          // Large chef hat emoji on top\r\n          chefCtx.font = 'bold 180px Arial';\r\n          chefCtx.textAlign = 'center';\r\n          chefCtx.textBaseline = 'middle';\r\n          chefCtx.fillStyle = '#ffffff';\r\n          chefCtx.fillText('ðŸ‘¨â€ðŸ³', chefCanvas.width / 2, chefCanvas.height / 2 - 150);\r\n          \r\n          // CHEF text - VERY LARGE and WHITE\r\n          chefCtx.fillStyle = '#ffffff';\r\n          chefCtx.font = 'bold 220px Impact, Arial Black, sans-serif';\r\n          chefCtx.fillText('CHEF', chefCanvas.width / 2, chefCanvas.height / 2 + 120);\r\n          \r\n          // Black outline for maximum contrast\r\n          chefCtx.strokeStyle = '#000000';\r\n          chefCtx.lineWidth = 12;\r\n          chefCtx.strokeText('CHEF', chefCanvas.width / 2, chefCanvas.height / 2 + 120);\r\n          \r\n          // Yellow/Gold inner stroke for style\r\n          chefCtx.strokeStyle = '#fbbf24';\r\n          chefCtx.lineWidth = 6;\r\n          chefCtx.strokeText('CHEF', chefCanvas.width / 2, chefCanvas.height / 2 + 120);\r\n        }\r\n        const chefTexture = new THREE.CanvasTexture(chefCanvas);\r\n        \r\n        // Left side sign - MUCH LARGER\r\n        const chefSignLeft = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.height * 0.6, obj.height * 0.45),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: chefTexture,\r\n            roughness: 0.4,\r\n            metalness: 0.1,\r\n            emissive: 0xdc2626,\r\n            emissiveIntensity: 0.3\r\n          })\r\n        );\r\n        chefSignLeft.position.set(-obj.width / 2 + 3, 50, 0);\r\n        chefSignLeft.rotation.y = Math.PI / 2;\r\n        kitchenGroup.add(chefSignLeft);\r\n        \r\n        // Right side sign (same design) - MUCH LARGER\r\n        const chefSignRight = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.height * 0.6, obj.height * 0.45),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: chefTexture,\r\n            roughness: 0.4,\r\n            metalness: 0.1,\r\n            emissive: 0xdc2626,\r\n            emissiveIntensity: 0.3\r\n          })\r\n        );\r\n        chefSignRight.position.set(obj.width / 2 - 3, 50, 0);\r\n        chefSignRight.rotation.y = -Math.PI / 2;\r\n        kitchenGroup.add(chefSignRight);\r\n\r\n        // === Position the entire kitchen ===\r\n        kitchenGroup.position.set(baseX, 0, baseZ);\r\n        kitchenGroup.rotation.y = rotation;\r\n        scene.add(kitchenGroup);\r\n        \r\n      } else if (obj.type === 'toilet') {\r\n        const toiletGroup = new THREE.Group();\r\n\r\n        // === MATERIALS (no excessive reflections) ===\r\n        const marbleMat = new THREE.MeshStandardMaterial({\r\n          color: 0xd5d5da,\r\n          roughness: 0.7,\r\n          metalness: 0.05,\r\n        });\r\n\r\n        const doorMat = new THREE.MeshStandardMaterial({\r\n          color: 0x3b82f6,\r\n          roughness: 0.6,\r\n          metalness: 0.1,\r\n        });\r\n\r\n        const door2Mat = new THREE.MeshStandardMaterial({\r\n          color: 0xef4444,\r\n          roughness: 0.6,\r\n          metalness: 0.1,\r\n        });\r\n\r\n        const tileFloorMat = new THREE.MeshStandardMaterial({\r\n          color: 0xd9d9d9,\r\n          roughness: 0.7,\r\n          metalness: 0.05,\r\n        });\r\n\r\n        const roomHeight = 120;\r\n\r\n        // === FLOOR ===\r\n        const floor = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, 4, obj.height), \r\n          tileFloorMat\r\n        );\r\n        floor.position.y = 2;\r\n        floor.receiveShadow = true;\r\n        toiletGroup.add(floor);\r\n\r\n        // === BACK WALL ===\r\n        const backWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        backWall.position.set(0, roomHeight / 2, -obj.height / 2);\r\n        backWall.castShadow = true;\r\n        toiletGroup.add(backWall);\r\n\r\n        // === SIDE WALLS ===\r\n        const leftWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(6, roomHeight, obj.height), \r\n          marbleMat\r\n        );\r\n        leftWall.position.set(-obj.width / 2, roomHeight / 2, 0);\r\n        leftWall.castShadow = true;\r\n        toiletGroup.add(leftWall);\r\n\r\n        const rightWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(6, roomHeight, obj.height), \r\n          marbleMat\r\n        );\r\n        rightWall.position.set(obj.width / 2, roomHeight / 2, 0);\r\n        rightWall.castShadow = true;\r\n        toiletGroup.add(rightWall);\r\n\r\n        // === FRONT WALL STRUCTURE ===\r\n        // Center divider\r\n        const centerDivider = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.24, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        centerDivider.position.set(0, roomHeight / 2, obj.height / 2);\r\n        centerDivider.castShadow = true;\r\n        toiletGroup.add(centerDivider);\r\n\r\n        // Left side section\r\n        const leftSection = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.055, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        leftSection.position.set(-obj.width * 0.4725, roomHeight / 2, obj.height / 2);\r\n        leftSection.castShadow = true;\r\n        toiletGroup.add(leftSection);\r\n\r\n        // Right side section\r\n        const rightSection = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.055, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        rightSection.position.set(obj.width * 0.4725, roomHeight / 2, obj.height / 2);\r\n        rightSection.castShadow = true;\r\n        toiletGroup.add(rightSection);\r\n\r\n        // Wall above right door (blue) - LARGER DOOR = 95 height, 33% width\r\n        const rightTopWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, roomHeight - 95, 6), \r\n          marbleMat\r\n        );\r\n        rightTopWall.position.set(obj.width * 0.285, 95 + (roomHeight - 95) / 2, obj.height / 2);\r\n        rightTopWall.castShadow = true;\r\n        toiletGroup.add(rightTopWall);\r\n\r\n        // Wall above left door (red)\r\n        const leftTopWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, roomHeight - 95, 6), \r\n          marbleMat\r\n        );\r\n        leftTopWall.position.set(-obj.width * 0.285, 95 + (roomHeight - 95) / 2, obj.height / 2);\r\n        leftTopWall.castShadow = true;\r\n        toiletGroup.add(leftTopWall);\r\n\r\n        // === DOORS (LARGER - 33% width, 95 height) ===\r\n        // Right door (Blue)\r\n        const door = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, 95, 4), \r\n          doorMat\r\n        );\r\n        door.position.set(obj.width * 0.285, 47.5, obj.height / 2 - 2);\r\n        door.castShadow = true;\r\n        toiletGroup.add(door);\r\n\r\n        const handleMat = new THREE.MeshStandardMaterial({ \r\n          color: 0xd4af37, \r\n          metalness: 0.1, \r\n          roughness: 0.8 \r\n        });\r\n        const handle = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(1.5, 1.5, 12, 16),\r\n          handleMat\r\n        );\r\n        handle.rotation.z = Math.PI / 2;\r\n        handle.position.set(obj.width * 0.285 - (obj.width * 0.132), 47.5, obj.height / 2 + 1);\r\n        toiletGroup.add(handle);\r\n\r\n        // === MALE SIGN on Blue Door (Very Stylish Design) ===\r\n        const maleCanvas = document.createElement('canvas');\r\n        maleCanvas.width = 512;\r\n        maleCanvas.height = 768;\r\n        const maleCtx = maleCanvas.getContext('2d');\r\n        if (maleCtx) {\r\n          // Gradient background\r\n          const gradient = maleCtx.createLinearGradient(0, 0, 0, maleCanvas.height);\r\n          gradient.addColorStop(0, '#3b82f6');\r\n          gradient.addColorStop(1, '#1e40af');\r\n          maleCtx.fillStyle = gradient;\r\n          maleCtx.fillRect(0, 0, maleCanvas.width, maleCanvas.height);\r\n          \r\n          // Border frame\r\n          maleCtx.strokeStyle = '#ffffff';\r\n          maleCtx.lineWidth = 12;\r\n          maleCtx.strokeRect(20, 20, maleCanvas.width - 40, maleCanvas.height - 40);\r\n          \r\n          // Inner shadow effect\r\n          maleCtx.strokeStyle = 'rgba(255, 255, 255, 0.3)';\r\n          maleCtx.lineWidth = 6;\r\n          maleCtx.strokeRect(30, 30, maleCanvas.width - 60, maleCanvas.height - 60);\r\n          \r\n          // Text shadow\r\n          maleCtx.shadowColor = 'rgba(0, 0, 0, 0.5)';\r\n          maleCtx.shadowBlur = 15;\r\n          maleCtx.shadowOffsetX = 4;\r\n          maleCtx.shadowOffsetY = 4;\r\n          \r\n          // W.C. text\r\n          maleCtx.fillStyle = '#ffffff';\r\n          maleCtx.font = 'bold 120px Georgia, serif';\r\n          maleCtx.textAlign = 'center';\r\n          maleCtx.textBaseline = 'middle';\r\n          maleCtx.fillText('W.C.', maleCanvas.width / 2, maleCanvas.height / 2 - 100);\r\n          \r\n          // Decorative line\r\n          maleCtx.strokeStyle = '#ffffff';\r\n          maleCtx.lineWidth = 4;\r\n          maleCtx.beginPath();\r\n          maleCtx.moveTo(100, maleCanvas.height / 2);\r\n          maleCtx.lineTo(maleCanvas.width - 100, maleCanvas.height / 2);\r\n          maleCtx.stroke();\r\n          \r\n          // MALE text with golden color\r\n          const goldGradient = maleCtx.createLinearGradient(0, maleCanvas.height / 2, 0, maleCanvas.height / 2 + 150);\r\n          goldGradient.addColorStop(0, '#ffd700');\r\n          goldGradient.addColorStop(0.5, '#ffed4e');\r\n          goldGradient.addColorStop(1, '#ffd700');\r\n          maleCtx.fillStyle = goldGradient;\r\n          maleCtx.font = 'bold 140px Georgia, serif';\r\n          maleCtx.fillText('MALE', maleCanvas.width / 2, maleCanvas.height / 2 + 120);\r\n          \r\n          // Add stroke to MALE text\r\n          maleCtx.strokeStyle = '#b8860b';\r\n          maleCtx.lineWidth = 3;\r\n          maleCtx.strokeText('MALE', maleCanvas.width / 2, maleCanvas.height / 2 + 120);\r\n        }\r\n        const maleTexture = new THREE.CanvasTexture(maleCanvas);\r\n        const maleSign = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width * 0.25, obj.width * 0.375),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: maleTexture,\r\n            roughness: 0.3,\r\n            metalness: 0.15,\r\n            emissive: 0x1e40af,\r\n            emissiveIntensity: 0.1\r\n          })\r\n        );\r\n        maleSign.position.set(obj.width * 0.285, 47.5, obj.height / 2 + 2.5);\r\n        toiletGroup.add(maleSign);\r\n\r\n        // Left door (Red)\r\n        const door2 = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, 95, 4),\r\n          door2Mat\r\n        );\r\n        door2.position.set(-obj.width * 0.285, 47.5, obj.height / 2 - 2);\r\n        door2.castShadow = true;\r\n        toiletGroup.add(door2);\r\n\r\n        const handle2 = handle.clone();\r\n        handle2.position.set(-obj.width * 0.285 + (obj.width * 0.132), 47.5, obj.height / 2 + 1);\r\n        toiletGroup.add(handle2);\r\n\r\n        // === FEMALE SIGN on Red Door (Very Stylish Design) ===\r\n        const femaleCanvas = document.createElement('canvas');\r\n        femaleCanvas.width = 512;\r\n        femaleCanvas.height = 768;\r\n        const femaleCtx = femaleCanvas.getContext('2d');\r\n        if (femaleCtx) {\r\n          // Gradient background\r\n          const gradient = femaleCtx.createLinearGradient(0, 0, 0, femaleCanvas.height);\r\n          gradient.addColorStop(0, '#ef4444');\r\n          gradient.addColorStop(1, '#b91c1c');\r\n          femaleCtx.fillStyle = gradient;\r\n          femaleCtx.fillRect(0, 0, femaleCanvas.width, femaleCanvas.height);\r\n          \r\n          // Border frame\r\n          femaleCtx.strokeStyle = '#ffffff';\r\n          femaleCtx.lineWidth = 12;\r\n          femaleCtx.strokeRect(20, 20, femaleCanvas.width - 40, femaleCanvas.height - 40);\r\n          \r\n          // Inner shadow effect\r\n          femaleCtx.strokeStyle = 'rgba(255, 255, 255, 0.3)';\r\n          femaleCtx.lineWidth = 6;\r\n          femaleCtx.strokeRect(30, 30, femaleCanvas.width - 60, femaleCanvas.height - 60);\r\n          \r\n          // Text shadow\r\n          femaleCtx.shadowColor = 'rgba(0, 0, 0, 0.5)';\r\n          femaleCtx.shadowBlur = 15;\r\n          femaleCtx.shadowOffsetX = 4;\r\n          femaleCtx.shadowOffsetY = 4;\r\n          \r\n          // W.C. text\r\n          femaleCtx.fillStyle = '#ffffff';\r\n          femaleCtx.font = 'bold 120px Georgia, serif';\r\n          femaleCtx.textAlign = 'center';\r\n          femaleCtx.textBaseline = 'middle';\r\n          femaleCtx.fillText('W.C.', femaleCanvas.width / 2, femaleCanvas.height / 2 - 100);\r\n          \r\n          // Decorative line\r\n          femaleCtx.strokeStyle = '#ffffff';\r\n          femaleCtx.lineWidth = 4;\r\n          femaleCtx.beginPath();\r\n          femaleCtx.moveTo(100, femaleCanvas.height / 2);\r\n          femaleCtx.lineTo(femaleCanvas.width - 100, femaleCanvas.height / 2);\r\n          femaleCtx.stroke();\r\n          \r\n          // FEMALE text with rose gold color\r\n          const roseGoldGradient = femaleCtx.createLinearGradient(0, femaleCanvas.height / 2, 0, femaleCanvas.height / 2 + 150);\r\n          roseGoldGradient.addColorStop(0, '#ffb6c1');\r\n          roseGoldGradient.addColorStop(0.5, '#ffd1dc');\r\n          roseGoldGradient.addColorStop(1, '#ffb6c1');\r\n          femaleCtx.fillStyle = roseGoldGradient;\r\n          femaleCtx.font = 'bold 120px Georgia, serif';\r\n          femaleCtx.fillText('FEMALE', femaleCanvas.width / 2, femaleCanvas.height / 2 + 120);\r\n          \r\n          // Add stroke to FEMALE text\r\n          femaleCtx.strokeStyle = '#dc143c';\r\n          femaleCtx.lineWidth = 3;\r\n          femaleCtx.strokeText('FEMALE', femaleCanvas.width / 2, femaleCanvas.height / 2 + 120);\r\n        }\r\n        const femaleTexture = new THREE.CanvasTexture(femaleCanvas);\r\n        const femaleSign = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width * 0.25, obj.width * 0.375),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: femaleTexture,\r\n            roughness: 0.3,\r\n            metalness: 0.15,\r\n            emissive: 0xb91c1c,\r\n            emissiveIntensity: 0.1\r\n          })\r\n        );\r\n        femaleSign.position.set(-obj.width * 0.285, 47.5, obj.height / 2 + 2.5);\r\n        toiletGroup.add(femaleSign);\r\n\r\n        // === W.C. SIGN ===\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = 512;\r\n        canvas.height = 256;\r\n        const ctx = canvas.getContext('2d');\r\n        if (ctx) {\r\n          ctx.fillStyle = '#d5d5da';\r\n          ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n          ctx.fillStyle = '#2a2a2a';\r\n          ctx.font = 'bold 140px Arial';\r\n          ctx.textAlign = 'center';\r\n          ctx.textBaseline = 'middle';\r\n          ctx.fillText('W.C.', canvas.width / 2, canvas.height / 2);\r\n        }\r\n        \r\n        const wcTexture = new THREE.CanvasTexture(canvas);\r\n        const wcSign = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width * 0.4, obj.width * 0.2),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: wcTexture,\r\n            roughness: 0.5,\r\n            metalness: 0.05\r\n          })\r\n        );\r\n        wcSign.position.set(0, 100, -obj.height / 2 + 3.5);\r\n        toiletGroup.add(wcSign);\r\n\r\n        // === SINK COUNTER ===\r\n        const counterMat = new THREE.MeshStandardMaterial({\r\n          color: 0xf5f5f5,\r\n          metalness: 0.1,\r\n          roughness: 0.5,\r\n        });\r\n        const counter = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.5, 12, obj.height * 0.25), \r\n          counterMat\r\n        );\r\n        counter.position.set(0, 32, -obj.height * 0.3);\r\n        counter.castShadow = true;\r\n        toiletGroup.add(counter);\r\n\r\n        // === SINK BASIN ===\r\n        const sinkMat = new THREE.MeshStandardMaterial({\r\n          color: 0xffffff,\r\n          roughness: 0.3,\r\n          metalness: 0.05,\r\n        });\r\n        const sink = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(12, 12, 6, 32), \r\n          sinkMat\r\n        );\r\n        sink.position.set(0, 40, -obj.height * 0.3);\r\n        toiletGroup.add(sink);\r\n\r\n        // === FAUCET ===\r\n        const faucetMat = new THREE.MeshStandardMaterial({\r\n          color: 0xc0c0c0,\r\n          metalness: 0.1,\r\n          roughness: 0.8,\r\n        });\r\n        const faucet = new THREE.Mesh(\r\n          new THREE.TorusGeometry(4, 1, 8, 24, Math.PI),\r\n          faucetMat\r\n        );\r\n        faucet.rotation.z = Math.PI / 2;\r\n        faucet.position.set(0, 48, -obj.height * 0.35);\r\n        toiletGroup.add(faucet);\r\n\r\n        // === TOILET BOWL ===\r\n        const toiletMat = new THREE.MeshStandardMaterial({\r\n          color: 0xffffff,\r\n          roughness: 0.25,\r\n          metalness: 0.05,\r\n        });\r\n\r\n        const toiletBowl = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(10, 8, 12, 32),\r\n          toiletMat\r\n        );\r\n        toiletBowl.position.set(-obj.width * 0.25, 6, obj.height * 0.25);\r\n        toiletGroup.add(toiletBowl);\r\n\r\n        const toiletSeat = new THREE.Mesh(\r\n          new THREE.TorusGeometry(9, 2, 16, 32),\r\n          toiletMat\r\n        );\r\n        toiletSeat.rotation.x = Math.PI / 2;\r\n        toiletSeat.position.set(-obj.width * 0.25, 13, obj.height * 0.25);\r\n        toiletGroup.add(toiletSeat);\r\n\r\n        const toiletTank = new THREE.Mesh(\r\n          new THREE.BoxGeometry(14, 20, 8),\r\n          toiletMat\r\n        );\r\n        toiletTank.position.set(-obj.width * 0.25, 22, obj.height * 0.25 - 10);\r\n        toiletGroup.add(toiletTank);\r\n\r\n        const flushHandle = new THREE.Mesh(\r\n          new THREE.BoxGeometry(2, 6, 1),\r\n          faucetMat\r\n        );\r\n        flushHandle.position.set(-obj.width * 0.25 + 8, 25, obj.height * 0.25 - 10);\r\n        toiletGroup.add(flushHandle);\r\n\r\n        // === URINAL ===\r\n        const urinal = new THREE.Mesh(\r\n          new THREE.SphereGeometry(7, 32, 32, 0, Math.PI * 2, 0, Math.PI / 1.5),\r\n          toiletMat\r\n        );\r\n        urinal.position.set(obj.width * 0.25, 25, obj.height * 0.25);\r\n        urinal.rotation.x = Math.PI / 6;\r\n        toiletGroup.add(urinal);\r\n\r\n        const urinalValve = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(1.5, 1.5, 8, 16),\r\n          faucetMat\r\n        );\r\n        urinalValve.position.set(obj.width * 0.25, 35, obj.height * 0.25 - 5);\r\n        toiletGroup.add(urinalValve);\r\n\r\n        // === LIGHTING (SOFT, NO GLOWING) ===\r\n        const softLight = new THREE.PointLight(0xffffff, 0.5, 280);\r\n        softLight.position.set(0, roomHeight - 15, 0);\r\n        softLight.castShadow = false;\r\n        toiletGroup.add(softLight);\r\n\r\n        // === Position the entire toilet room ===\r\n        toiletGroup.position.set(baseX, 0, baseZ);\r\n        toiletGroup.rotation.y = rotation;\r\n        scene.add(toiletGroup);\r\n      }\r\n    });\r\n\r\n    // TABLES - Realistic polished wood with subtle reflections\r\n    floor.tables.forEach(table => {\r\n      const tableTopHeight = 4; // Thin tabletop\r\n      const legHeight = 33; // Tall legs (increased from 30)\r\n      const actualWidth = table.shape === 'rectangle' ? table.width * 1.5 : table.width;\r\n      const tableX = table.x - 400 + actualWidth / 2;\r\n      const tableZ = -(table.y - 400 + table.height / 2);\r\n      const tableRotRad = -(table.rotation * Math.PI / 180);\r\n\r\n      // Advanced physical material (PBR wood)\r\n      const tableMaterial = new THREE.MeshPhysicalMaterial({\r\n        color: 0x6f4e37,             // rich brown wood tone\r\n        roughness: 0.35,\r\n        metalness: 0.1,\r\n        clearcoat: 0.4,              // shiny varnish layer\r\n        clearcoatRoughness: 0.2,\r\n        sheen: 0.5,                  // subtle velvet-like reflection\r\n        sheenColor: new THREE.Color(0x9c6b3c),\r\n      });\r\n\r\n      // THIN TABLETOP (not full height cube)\r\n      const tableGeometry =\r\n        table.shape === 'circle'\r\n          ? new THREE.CylinderGeometry(actualWidth / 2, actualWidth / 2, tableTopHeight, 64)\r\n          : new THREE.BoxGeometry(actualWidth, tableTopHeight, table.height);\r\n\r\n      const tableMesh = new THREE.Mesh(tableGeometry, tableMaterial);\r\n      tableMesh.position.set(tableX, legHeight + tableTopHeight / 2, tableZ);\r\n      tableMesh.rotation.y = tableRotRad;\r\n      tableMesh.castShadow = true;\r\n      tableMesh.receiveShadow = true;\r\n      scene.add(tableMesh);\r\n\r\n      // Subtle metallic edge trim\r\n      if (table.shape === 'circle') {\r\n        const edgeTrim = new THREE.Mesh(\r\n          new THREE.TorusGeometry(actualWidth / 2 + 1, 1.2, 16, 64),\r\n          new THREE.MeshStandardMaterial({\r\n            color: 0xd4af37,       // gold-like tone\r\n            metalness: 1.0,\r\n            roughness: 0.3,\r\n          })\r\n        );\r\n        edgeTrim.position.set(tableX, legHeight + tableTopHeight / 2 + 0.5, tableZ);\r\n        edgeTrim.rotation.x = Math.PI / 2;\r\n        scene.add(edgeTrim);\r\n      } else {\r\n        const edges = new THREE.LineSegments(\r\n          new THREE.EdgesGeometry(tableGeometry),\r\n          new THREE.LineBasicMaterial({ color: 0xd4af37, linewidth: 2 })\r\n        );\r\n        edges.position.copy(tableMesh.position);\r\n        edges.rotation.y = tableRotRad;\r\n        scene.add(edges);\r\n      }\r\n\r\n      // Table legs - realistic chrome or black metal (NOW VISIBLE!)\r\n      const legMaterial = new THREE.MeshStandardMaterial({\r\n        color: 0x222222,\r\n        metalness: 0.9,\r\n        roughness: 0.2,\r\n      });\r\n\r\n      const legRadius = 3.2; // Increased from 3 for better visibility\r\n      const legOffsets =\r\n        table.shape === 'circle'\r\n          ? [\r\n              [actualWidth * 0.3, actualWidth * 0.3],\r\n              [-actualWidth * 0.3, actualWidth * 0.3],\r\n              [actualWidth * 0.3, -actualWidth * 0.3],\r\n              [-actualWidth * 0.3, -actualWidth * 0.3],\r\n            ]\r\n          : [\r\n              [actualWidth / 2 - 10, table.height / 2 - 10],\r\n              [-actualWidth / 2 + 10, table.height / 2 - 10],\r\n              [actualWidth / 2 - 10, -table.height / 2 + 10],\r\n              [-actualWidth / 2 + 10, -table.height / 2 + 10],\r\n            ];\r\n\r\n      legOffsets.forEach(([lx, lz]) => {\r\n        const leg = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(legRadius, legRadius, legHeight, 16),\r\n          legMaterial\r\n        );\r\n        leg.position.set(\r\n          tableX + lx * Math.cos(tableRotRad) - lz * Math.sin(tableRotRad),\r\n          legHeight / 2,\r\n          tableZ + lx * Math.sin(tableRotRad) + lz * Math.cos(tableRotRad)\r\n        );\r\n        leg.castShadow = true;\r\n        scene.add(leg);\r\n      });\r\n\r\n      // CHAIRS - Premium with 4 legs, cushioned seats, wood backs\r\n      const tableChairs = floor.chairs.filter(c => c.tableId === table.id);\r\n      \r\n      tableChairs.forEach(chair => {\r\n        const chairSize = chair.size || 40;\r\n        const chairHeight = 38; // Increased from 35\r\n        \r\n        // Materials\r\n        const woodMaterial = new THREE.MeshStandardMaterial({ color: 0x8b4513, roughness: 0.5, metalness: 0.1 });\r\n        const cushionMaterial = new THREE.MeshStandardMaterial({ color: 0xb8860b, roughness: 0.7, metalness: 0.05 });\r\n        \r\n        // Calculate position\r\n        const totalOnSide = tableChairs.filter(c => c.position === chair.position).length;\r\n        const sideLen = ['top', 'bottom'].includes(chair.position) ? actualWidth : table.height;\r\n        const availSpace = sideLen - chairSize * totalOnSide;\r\n        const gap = totalOnSide > 1 ? availSpace / (totalOnSide + 1) : availSpace / 2;\r\n        const offset = gap + chair.index * (chairSize + gap) + chairSize / 2;\r\n        const spacing = chairSize * 0.4;\r\n        \r\n        let relX = 0, relZ = 0;\r\n        if (chair.position === 'top') { \r\n          relX = offset - actualWidth / 2; \r\n          relZ = table.height / 2 + spacing + chairSize / 2; \r\n        } else if (chair.position === 'bottom') { \r\n          relX = offset - actualWidth / 2; \r\n          relZ = -(table.height / 2 + spacing + chairSize / 2); \r\n        } else if (chair.position === 'left') { \r\n          relX = -(actualWidth / 2 + spacing + chairSize / 2); \r\n          relZ = offset - table.height / 2; \r\n        } else { \r\n          relX = actualWidth / 2 + spacing + chairSize / 2; \r\n          relZ = offset - table.height / 2; \r\n        }\r\n        \r\n        // Apply table rotation\r\n        const rotX = relX * Math.cos(tableRotRad) - relZ * Math.sin(tableRotRad);\r\n        const rotZ = relX * Math.sin(tableRotRad) + relZ * Math.cos(tableRotRad);\r\n        \r\n        // Chair seat (cushioned)\r\n        const seat = new THREE.Mesh(\r\n          new THREE.BoxGeometry(chairSize * 0.75, 4, chairSize * 0.75),\r\n          cushionMaterial\r\n        );\r\n        const seatHeight = chairHeight * 0.4; // Seat position\r\n        seat.position.set(tableX + rotX, seatHeight, tableZ - rotZ);\r\n        \r\n        // FIXED ROTATION - chair faces table\r\n        const baseRot = { \r\n          top: 0, \r\n          bottom: Math.PI, \r\n          left: Math.PI / 2, \r\n          right: -Math.PI / 2 \r\n        }[chair.position] || 0;\r\n        seat.rotation.y = baseRot + tableRotRad;\r\n        seat.castShadow = true;\r\n        scene.add(seat);\r\n        \r\n        // Chair back (wood)\r\n        const back = new THREE.Mesh(\r\n          new THREE.BoxGeometry(chairSize * 0.75, chairHeight * 0.55, 3),\r\n          woodMaterial\r\n        );\r\n        const backOff = chairSize * 0.75 / 2 + 1.5;\r\n        back.position.set(\r\n          seat.position.x - Math.sin(seat.rotation.y) * backOff,\r\n          chairHeight * 0.65,\r\n          seat.position.z - Math.cos(seat.rotation.y) * backOff\r\n        );\r\n        back.rotation.y = seat.rotation.y;\r\n        back.castShadow = true;\r\n        scene.add(back);\r\n        \r\n        // 4 Chair legs (cylindrical, wood)\r\n        const seatThickness = 4;\r\n        const legHeight = seatHeight - seatThickness / 2; // Legs reach from floor to bottom of seat\r\n        const legGeo = new THREE.CylinderGeometry(2, 2, legHeight, 8);\r\n        const legMat = new THREE.MeshStandardMaterial({ color: 0x654321, roughness: 0.6, metalness: 0.2 });\r\n        \r\n        [[chairSize * 0.3, chairSize * 0.3], [chairSize * 0.3, -chairSize * 0.3],\r\n         [-chairSize * 0.3, chairSize * 0.3], [-chairSize * 0.3, -chairSize * 0.3]\r\n        ].forEach(([lx, lz]) => {\r\n          const leg = new THREE.Mesh(legGeo, legMat);\r\n          const cos = Math.cos(seat.rotation.y);\r\n          const sin = Math.sin(seat.rotation.y);\r\n          leg.position.set(\r\n            seat.position.x + lx * cos - lz * sin,\r\n            legHeight / 2, // Position legs so they sit on the floor\r\n            seat.position.z + lx * sin + lz * cos\r\n          );\r\n          leg.castShadow = true;\r\n          scene.add(leg);\r\n        });\r\n      });\r\n    });\r\n\r\n    // Animation\r\n    const animate = () => {\r\n      animationFrameRef.current = requestAnimationFrame(animate);\r\n      \r\n      // Handle smooth camera transitions\r\n      if (transitionRef.current && transitionRef.current.progress < 1) {\r\n        const t = transitionRef.current;\r\n        t.progress += 0.05;\r\n        \r\n        if (t.progress >= 1) {\r\n          t.progress = 1;\r\n          setIsTransitioning(false);\r\n          transitionRef.current = null;\r\n        }\r\n        \r\n        // Smooth easing function\r\n        const easeInOutCubic = (x: number): number => {\r\n          return x < 0.5 ? 4 * x * x * x : 1 - Math.pow(-2 * x + 2, 3) / 2;\r\n        };\r\n        \r\n        const easedProgress = easeInOutCubic(t.progress);\r\n        \r\n        if (cameraRef.current) {\r\n          cameraRef.current.position.lerpVectors(t.startPos, t.endPos, easedProgress);\r\n          const currentTarget = new THREE.Vector3();\r\n          currentTarget.lerpVectors(t.startTarget, t.endTarget, easedProgress);\r\n          cameraRef.current.lookAt(currentTarget);\r\n        }\r\n      }\r\n      \r\n      // Auto-rotation (only when enabled and not transitioning)\r\n      if (autoRotate && cameraRef.current && !isTransitioning) {\r\n        const r = Math.sqrt(cameraRef.current.position.x ** 2 + cameraRef.current.position.z ** 2);\r\n        const a = Math.atan2(cameraRef.current.position.z, cameraRef.current.position.x) + rotationSpeedRef.current;\r\n        cameraRef.current.position.x = r * Math.cos(a);\r\n        cameraRef.current.position.z = r * Math.sin(a);\r\n        cameraRef.current.lookAt(0, 100, 0);\r\n      }\r\n      \r\n      rendererRef.current?.render(scene, camera);\r\n    };\r\n    animate();\r\n\r\n    const handleResize = () => {\r\n      if (containerRef.current && cameraRef.current && rendererRef.current) {\r\n        cameraRef.current.aspect = containerRef.current.clientWidth / containerRef.current.clientHeight;\r\n        cameraRef.current.updateProjectionMatrix();\r\n        rendererRef.current.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\r\n      }\r\n    };\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n      if (animationFrameRef.current) cancelAnimationFrame(animationFrameRef.current);\r\n      if (rendererRef.current && containerRef.current) {\r\n        containerRef.current.removeChild(rendererRef.current.domElement);\r\n        rendererRef.current.dispose();\r\n      }\r\n    };\r\n  }, [isOpen, floor, autoRotate, isTransitioning]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"rfp-fixed rfp-inset-0 bg-black/60 backdrop-blur-sm z-[200] rfp-flex rfp-items-center rfp-justify-center rfp-p-2\">\r\n      <div className=\"bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 rounded-3xl shadow-2xl rfp-w-full rfp-h-full max-w-[98vw] max-h-[98vh] rfp-flex rfp-flex-col rfp-overflow-hidden rfp-border rfp-border-gray-800\">\r\n        {/* Header */}\r\n        <div className=\"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 rfp-p-1\">\r\n          <div className=\"rfp-bg-gray-900 rfp-px-6 rfp-py-4 rfp-flex rfp-items-center rfp-justify-between\">\r\n            <div>\r\n              <h2 className=\"rfp-text-2xl rfp-font-bold rfp-text-white rfp-flex rfp-items-center rfp-gap-3\">\r\n                <div className=\"rfp-p-2 bg-gradient-to-br from-blue-500 to-purple-600 rfp-rounded-lg\">\r\n                  <Move3d className=\"rfp-w-5 rfp-h-5\" />\r\n                </div>\r\n                3D Floor Plan Visualization\r\n              </h2>\r\n              <p className=\"rfp-text-gray-400 rfp-text-sm rfp-mt-1\">Professional Camera Controls â€¢ {floor.name}</p>\r\n            </div>\r\n            <button \r\n              onClick={onClose} \r\n              className=\"p-2.5 bg-red-500/20 hover:bg-red-500/30 rfp-text-red-400 rfp-rounded-xl rfp-transition-all hover:scale-110\"\r\n            >\r\n              <X className=\"rfp-w-5 rfp-h-5\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content Area with Sidebar */}\r\n        <div className=\"rfp-flex-1 rfp-flex rfp-gap-3 rfp-p-3 rfp-min-h-0\">\r\n          {/* Smart Sidebar - Left */}\r\n          <div className=\"rfp-w-80 bg-black/90 backdrop-blur-xl rounded-2xl shadow-2xl rfp-border rfp-border-gray-700 rfp-p-5 rfp-flex rfp-flex-col rfp-gap-5 overflow-y-auto flex-shrink-0\">\r\n            {/* Default View Button */}\r\n            <button\r\n              onClick={() => smoothCameraTransition('default')}\r\n              className=\"rfp-px-4 rfp-py-3 bg-gradient-to-r from-blue-500 to-purple-600 rfp-text-white rfp-rounded-xl rfp-font-semibold rfp-transition-all hover:scale-105 hover:shadow-lg rfp-flex rfp-items-center rfp-justify-center rfp-gap-2\"\r\n            >\r\n              ðŸ  Default View\r\n            </button>\r\n\r\n            {/* Manual Controls Section */}\r\n            <div className=\"rfp-flex rfp-flex-col rfp-gap-3\">\r\n              <div className=\"rfp-text-white rfp-text-sm rfp-font-bold rfp-uppercase rfp-tracking-wider rfp-flex rfp-items-center rfp-gap-2 rfp-pb-2 rfp-border-b rfp-border-gray-700\">\r\n                <Move3d className=\"rfp-w-5 rfp-h-5 rfp-text-purple-400\" />\r\n                Manual Control\r\n              </div>\r\n              \r\n              {/* Directional Controls */}\r\n              <div className=\"rfp-flex rfp-justify-center\">\r\n                <div className=\"rfp-flex rfp-flex-col rfp-gap-1\">\r\n                  <button\r\n                    onClick={() => rotateCamera('up')}\r\n                    className=\"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30 mx-auto\"\r\n                    disabled={isTransitioning}\r\n                    title=\"Rotate Up\"\r\n                  >\r\n                    <svg className=\"rfp-w-6 rfp-h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 15l7-7 7 7\" />\r\n                    </svg>\r\n                  </button>\r\n                  <div className=\"rfp-flex rfp-gap-1 rfp-justify-center\">\r\n                    <button\r\n                      onClick={() => rotateCamera('left')}\r\n                      className=\"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30\"\r\n                      disabled={isTransitioning}\r\n                      title=\"Rotate Left\"\r\n                    >\r\n                      <svg className=\"rfp-w-6 rfp-h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n                      </svg>\r\n                    </button>\r\n                    <div className=\"rfp-w-12 rfp-h-12 bg-gradient-to-br from-blue-600 to-purple-600 rfp-rounded-lg rfp-flex rfp-items-center rfp-justify-center\">\r\n                      <Move3d className=\"rfp-w-6 rfp-h-6 rfp-text-white\" />\r\n                    </div>\r\n                    <button\r\n                      onClick={() => rotateCamera('right')}\r\n                      className=\"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30\"\r\n                      disabled={isTransitioning}\r\n                      title=\"Rotate Right\"\r\n                    >\r\n                      <svg className=\"rfp-w-6 rfp-h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => rotateCamera('down')}\r\n                    className=\"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30 mx-auto\"\r\n                    disabled={isTransitioning}\r\n                    title=\"Rotate Down\"\r\n                  >\r\n                    <svg className=\"rfp-w-6 rfp-h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Zoom Controls Section */}\r\n            <div className=\"rfp-flex rfp-flex-col rfp-gap-3\">\r\n              <div className=\"rfp-text-white rfp-text-sm rfp-font-bold rfp-uppercase rfp-tracking-wider rfp-flex rfp-items-center rfp-gap-2 rfp-pb-2 rfp-border-b rfp-border-gray-700\">\r\n                <ZoomIn className=\"rfp-w-5 rfp-h-5 rfp-text-green-400\" />\r\n                Zoom & Rotation\r\n              </div>\r\n              \r\n              <div className=\"rfp-flex rfp-flex-col rfp-gap-2\">\r\n                <button\r\n                  onClick={() => zoomCamera(0.85)}\r\n                  className=\"rfp-px-4 rfp-py-3 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-semibold disabled:opacity-30\"\r\n                  disabled={isTransitioning}\r\n                >\r\n                  <ZoomIn className=\"rfp-w-5 rfp-h-5\" />\r\n                  Zoom In\r\n                </button>\r\n                <button\r\n                  onClick={() => zoomCamera(1.15)}\r\n                  className=\"rfp-px-4 rfp-py-3 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-semibold disabled:opacity-30\"\r\n                  disabled={isTransitioning}\r\n                >\r\n                  <ZoomOut className=\"rfp-w-5 rfp-h-5\" />\r\n                  Zoom Out\r\n                </button>\r\n                <button\r\n                  onClick={() => setAutoRotate(!autoRotate)}\r\n                  className={`px-4 py-3 rounded-xl transition-all hover:scale-105 flex items-center justify-center gap-2 font-semibold ${\r\n                    autoRotate \r\n                      ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg' \r\n                      : 'bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white'\r\n                  }`}\r\n                >\r\n                  <RotateCcw className={`w-5 h-5 ${autoRotate ? 'animate-spin' : ''}`} />\r\n                  {autoRotate ? 'Auto-Rotating' : 'Auto-Rotate'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Reset & Stats Section */}\r\n            <div className=\"rfp-flex rfp-flex-col rfp-gap-3 mt-auto\">\r\n              <button\r\n                onClick={() => smoothCameraTransition('default')}\r\n                className=\"rfp-px-4 rfp-py-3 bg-gradient-to-r from-orange-500 to-red-600 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 hover:shadow-lg rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-bold\"\r\n              >\r\n                <Maximize2 className=\"rfp-w-5 rfp-h-5\" />\r\n                Reset View\r\n              </button>\r\n\r\n              {/* Scene Stats */}\r\n              <div className=\"bg-gray-800/50 rfp-rounded-xl rfp-p-4 rfp-border rfp-border-gray-700\">\r\n                <div className=\"rfp-flex rfp-items-center rfp-gap-2 rfp-text-gray-400 rfp-mb-3\">\r\n                  <Grid className=\"rfp-w-4 rfp-h-4\" />\r\n                  <span className=\"rfp-font-medium rfp-text-sm\">Scene Statistics</span>\r\n                </div>\r\n                <div className=\"rfp-grid grid-cols-2 rfp-gap-2 rfp-text-sm\">\r\n                  <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                    <div className=\"rfp-w-2 rfp-h-2 bg-emerald-500 rfp-rounded-full rfp-animate-pulse\" />\r\n                    <span className=\"rfp-text-gray-300\">{floor.tables.length} Tables</span>\r\n                  </div>\r\n                  <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                    <div className=\"rfp-w-2 rfp-h-2 bg-amber-500 rfp-rounded-full rfp-animate-pulse\" />\r\n                    <span className=\"rfp-text-gray-300\">{floor.chairs.length} Chairs</span>\r\n                  </div>\r\n                  <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                    <div className=\"rfp-w-2 rfp-h-2 rfp-bg-purple-500 rfp-rounded-full rfp-animate-pulse\" />\r\n                    <span className=\"rfp-text-gray-300\">{floor.objects.length} Objects</span>\r\n                  </div>\r\n                  <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                    <div className=\"rfp-w-2 rfp-h-2 rfp-bg-blue-500 rfp-rounded-full rfp-animate-pulse\" />\r\n                    <span className=\"rfp-text-gray-300\">{floor.walls.length} Walls</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* 3D Viewport - Right */}\r\n          <div className=\"rfp-flex-1 rfp-relative bg-gradient-to-br from-gray-100 via-gray-50 to-gray-100 rounded-2xl rfp-overflow-hidden shadow-2xl rfp-border rfp-border-gray-300\">\r\n            <div ref={containerRef} className=\"rfp-w-full rfp-h-full\" />\r\n\r\n            {/* Transition Indicator */}\r\n            {isTransitioning && (\r\n              <div className=\"rfp-absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2\">\r\n                <div className=\"bg-black/80 backdrop-blur-xl rfp-rounded-xl rfp-px-6 rfp-py-3 shadow-2xl rfp-border rfp-border-gray-700\">\r\n                  <div className=\"rfp-flex rfp-items-center rfp-gap-3\">\r\n                    <div className=\"rfp-animate-spin rfp-rounded-full rfp-h-5 rfp-w-5 rfp-border-2 rfp-border-gray-500 border-t-white\" />\r\n                    <span className=\"rfp-text-white rfp-text-sm rfp-font-medium\">Transitioning Camera...</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Bottom Status Bar */}\r\n        <div className=\"bg-gradient-to-r from-gray-900 via-slate-900 to-gray-900 rfp-px-6 rfp-py-3 rfp-border-t rfp-border-gray-800\">\r\n          <div className=\"rfp-flex rfp-items-center rfp-justify-between\">\r\n            <div className=\"rfp-flex rfp-items-center rfp-gap-4\">\r\n              <div className=\"rfp-flex rfp-items-center rfp-gap-2\">\r\n                <Layers className=\"rfp-w-4 rfp-h-4 rfp-text-gray-400\" />\r\n                <span className=\"rfp-text-sm rfp-text-gray-400\">\r\n                  Viewing: <span className=\"rfp-text-white rfp-font-semibold\">{floor.name}</span>\r\n                </span>\r\n              </div>\r\n              <div className=\"rfp-text-sm rfp-text-gray-400\">\r\n                Camera: <span className=\"rfp-text-white rfp-font-semibold\">{CAMERA_VIEWS[currentView].name}</span>\r\n              </div>\r\n            </div>\r\n            <div className=\"rfp-flex rfp-items-center rfp-gap-2 rfp-text-xs rfp-text-gray-500\">\r\n              <span>High Performance Mode</span>\r\n              <div className=\"rfp-w-2 rfp-h-2 rfp-bg-green-500 rfp-rounded-full rfp-animate-pulse\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","import React, { useState, useRef, useCallback, useEffect } from 'react';\r\n\r\nimport { ChairComponent } from './floorPlanner/components/Chair';\r\nimport { TableComponent } from './floorPlanner/components/Table';\r\nimport { FloorObjectComponent } from './floorPlanner/components/FloorObject';\r\nimport { WallComponent } from './floorPlanner/components/Wall';\r\nimport { FixedElementComponent } from './floorPlanner/components/FixedElement';\r\nimport { Sidebar } from './floorPlanner/components/Sidebar';\r\nimport { Toolbar } from './floorPlanner/components/Toolbar';\r\nimport { Preview3DModal } from './floorPlanner/components/Preview3DModal';\r\nimport {\r\n  hexagonStyle,\r\n  GRID_SIZE,\r\n  OBJECT_LABELS\r\n} from './floorPlanner/constants';\r\nimport { generateId, resolveTableDimensions, snapToAxis } from './floorPlanner/utils';\r\nimport type {\r\n  Chair,\r\n  ChairPosition,\r\n  FixedElement,\r\n  FixedElementType,\r\n  Floor,\r\n  FloorObject,\r\n  ObjectType,\r\n  SelectedElement,\r\n  Table,\r\n  TableSize,\r\n  Wall,\r\n  WallType\r\n} from './floorPlanner/types';\r\n\r\nconst RestaurantFloorPlanner: React.FC = () => {\r\n  const [floors, setFloors] = useState<Floor[]>([\r\n    { \r\n      id: 'floor-1', \r\n      name: 'Ground Floor', \r\n      isActive: true, \r\n      tables: [], \r\n      chairs: [], \r\n      objects: [],\r\n      walls: [],\r\n      fixedElements: []\r\n    }\r\n  ]);\r\n  const [currentFloor, setCurrentFloor] = useState<string>('floor-1');\r\n  const [selectedElement, setSelectedElement] = useState<SelectedElement | null>(null);\r\n  const [isDragging, setIsDragging] = useState<boolean>(false);\r\n  const [dragOffset, setDragOffset] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\r\n  const zoom = 1; // Fixed zoom level\r\n  const [showGrid, setShowGrid] = useState<boolean>(true);\r\n  const [show3DPreview, setShow3DPreview] = useState<boolean>(false);\r\n  \r\n  // Wall drawing state\r\n  const [isDrawingWall, setIsDrawingWall] = useState<boolean>(false);\r\n  const [wallType, setWallType] = useState<WallType | null>(null);\r\n  const [wallStartPoint, setWallStartPoint] = useState<{ x: number; y: number } | null>(null);\r\n  const [tempWallEndPoint, setTempWallEndPoint] = useState<{ x: number; y: number } | null>(null);\r\n  \r\n  // Wall resizing state\r\n  const [isResizingWall, setIsResizingWall] = useState<boolean>(false);\r\n  const [resizingWallHandle, setResizingWallHandle] = useState<'start' | 'end' | null>(null);\r\n  const [wallResizePreview, setWallResizePreview] = useState<{\r\n    startX: number;\r\n    startY: number;\r\n    endX: number;\r\n    endY: number;\r\n  } | null>(null);\r\n  \r\n  const canvasRef = useRef<HTMLDivElement>(null);\r\n  const dragElementRef = useRef<{ id: string; type: string } | null>(null);\r\n  const rafRef = useRef<number | null>(null);\r\n\r\n  // Initialize chair sizes for existing chairs without explicit size\r\n  useEffect(() => {\r\n    if (selectedElement?.type === 'table') {\r\n      const floor = getCurrentFloor();\r\n      if (!floor) return;\r\n\r\n      const tableChairs = floor.chairs.filter(c => c.tableId === selectedElement.id);\r\n      const chairsWithoutSize = tableChairs.filter(c => c.size === undefined);\r\n      \r\n      if (chairsWithoutSize.length > 0) {\r\n        // Group by position to ensure chairs on same side get same size\r\n        const sizeByPosition: Record<ChairPosition, number> = {} as Record<ChairPosition, number>;\r\n        \r\n        tableChairs.forEach(chair => {\r\n          if (chair.size !== undefined && !sizeByPosition[chair.position]) {\r\n            sizeByPosition[chair.position] = chair.size;\r\n          }\r\n        });\r\n\r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                chairs: floor.chairs.map(chair => {\r\n                  if (chair.tableId === selectedElement.id && chair.size === undefined) {\r\n                    // Use existing size from same position, or default to 40px\r\n                    const defaultSize = sizeByPosition[chair.position] ?? 40;\r\n                    return { ...chair, size: defaultSize };\r\n                  }\r\n                  return chair;\r\n                })\r\n              }\r\n            : floor\r\n        ));\r\n      }\r\n    }\r\n  }, [selectedElement]); // Only run when selection changes\r\n\r\n  const getCurrentFloor = (): Floor | undefined => floors.find(floor => floor.id === currentFloor);\r\n\r\n  const addTable = (shape: Table['shape'], size: TableSize = 'medium') => {\r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n\r\n    const { width, height } = resolveTableDimensions(shape, size);\r\n    const newTable: Table = {\r\n      id: generateId(),\r\n      name: `Table ${floor.tables.length + 1}`,\r\n      shape,\r\n      size,\r\n      x: 200 + floor.tables.length * 20,\r\n      y: 200 + floor.tables.length * 20,\r\n      width,\r\n      height,\r\n      rotation: 0\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, tables: [...floor.tables, newTable] }\r\n        : floor\r\n    ));\r\n    setSelectedElement({ type: 'table', id: newTable.id });\r\n  };\r\n\r\n  const addObject = (type: ObjectType) => {\r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n\r\n    const newObject: FloorObject = {\r\n      id: generateId(),\r\n      name: `${OBJECT_LABELS[type]} ${floor.objects.length + 1}`,\r\n      type,\r\n      x: 300 + floor.objects.length * 30,\r\n      y: 300 + floor.objects.length * 30,\r\n      width: 120,\r\n      height: 80,\r\n      rotation: 0\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, objects: [...floor.objects, newObject] }\r\n        : floor\r\n    ));\r\n    setSelectedElement({ type: 'object', id: newObject.id });\r\n  };\r\n\r\n  const addChair = (position: ChairPosition) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Get existing chairs on this side\r\n    const existingChairsOnSide = floor.chairs.filter(chair => \r\n      chair.tableId === selectedElement.id && chair.position === position\r\n    );\r\n    \r\n    // Calculate the next index\r\n    const nextIndex = existingChairsOnSide.length;\r\n    \r\n    // Check if any existing chair on this side has a custom size\r\n    const existingChairWithSize = existingChairsOnSide.find(c => c.size !== undefined);\r\n    \r\n    // Determine initial size: inherit from existing chairs on this side, or use default 40px\r\n    const initialSize = existingChairWithSize?.size ?? 40;\r\n    \r\n    const newChair: Chair = {\r\n      id: generateId(),\r\n      tableId: selectedElement.id,\r\n      position,\r\n      index: nextIndex,\r\n      x: 0,\r\n      y: 0,\r\n      size: initialSize // Always set a size to prevent recalculation on table resize\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, chairs: [...floor.chairs, newChair] }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const removeChair = (position: ChairPosition) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Find chairs on this side\r\n    const chairsOnSide = floor.chairs.filter(chair => \r\n      chair.tableId === selectedElement.id && chair.position === position\r\n    );\r\n    \r\n    if (chairsOnSide.length === 0) return;\r\n    \r\n    // Remove the last chair (highest index)\r\n    const chairToRemove = chairsOnSide.reduce((prev, current) => \r\n      current.index > prev.index ? current : prev\r\n    );\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            chairs: floor.chairs.filter(chair => chair.id !== chairToRemove.id)\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const changeChairSize = (position: ChairPosition, size: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Update all chairs on this side with the new size\r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            chairs: floor.chairs.map(chair => \r\n              chair.tableId === selectedElement.id && chair.position === position\r\n                ? { ...chair, size }\r\n                : chair\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const resetChairSizes = () => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Remove custom size from all chairs of this table (revert to calculated default)\r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            chairs: floor.chairs.map(chair => {\r\n              if (chair.tableId === selectedElement.id) {\r\n                const { size, ...chairWithoutSize } = chair;\r\n                return chairWithoutSize;\r\n              }\r\n              return chair;\r\n            })\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const removeElement = () => {\r\n    if (!selectedElement) return;\r\n    \r\n    if (selectedElement.type === 'table') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              tables: floor.tables.filter(t => t.id !== selectedElement.id),\r\n              chairs: floor.chairs.filter(c => c.tableId !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    } else if (selectedElement.type === 'object') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              objects: floor.objects.filter(o => o.id !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    } else if (selectedElement.type === 'wall') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              walls: floor.walls.filter(w => w.id !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    } else if (selectedElement.type === 'fixedElement') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              fixedElements: floor.fixedElements.filter(fe => fe.id !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    }\r\n    \r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const changeWallThickness = (thickness: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'wall') return;\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            walls: floor.walls.map(wall => \r\n              wall.id === selectedElement.id \r\n                ? { ...wall, thickness }\r\n                : wall\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const convertWallType = (type: WallType) => {\r\n    if (!selectedElement || selectedElement.type !== 'wall') return;\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            walls: floor.walls.map(wall => \r\n              wall.id === selectedElement.id \r\n                ? { ...wall, type }\r\n                : wall\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const rotateTable = () => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            tables: floor.tables.map(table => \r\n              table.id === selectedElement.id \r\n                ? { ...table, rotation: (table.rotation || 0) + 45 }\r\n                : table\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const duplicateTable = () => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    const originalTable = floor.tables.find(t => t.id === selectedElement.id);\r\n    if (!originalTable) return;\r\n    \r\n    const newTable: Table = {\r\n      ...originalTable,\r\n      id: generateId(),\r\n      name: `${originalTable.name} Copy`,\r\n      x: originalTable.x + 50,\r\n      y: originalTable.y + 50\r\n    };\r\n    \r\n    const originalChairs = floor.chairs.filter(c => c.tableId === originalTable.id);\r\n    const newChairs: Chair[] = originalChairs.map(chair => ({\r\n      ...chair,\r\n      id: generateId(),\r\n      tableId: newTable.id\r\n    }));\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            tables: [...floor.tables, newTable],\r\n            chairs: [...floor.chairs, ...newChairs]\r\n          }\r\n        : floor\r\n    ));\r\n    \r\n    setSelectedElement({ type: 'table', id: newTable.id });\r\n  };\r\n\r\n  const updateSelectedTable = useCallback((updater: (table: Table) => Table) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n\r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            tables: floor.tables.map(table =>\r\n              table.id === selectedElement.id ? updater(table) : table\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  }, [selectedElement, currentFloor]);\r\n\r\n  const handleTableSizeChange = (size: Table['size']) => {\r\n    updateSelectedTable(table => {\r\n      const { width, height } = resolveTableDimensions(table.shape, size);\r\n      return { ...table, size, width, height };\r\n    });\r\n  };\r\n\r\n  const handleCustomTableSize = (width: number, height: number) => {\r\n    updateSelectedTable(table => ({\r\n      ...table,\r\n      width,\r\n      height,\r\n      // Set size to a custom indicator or keep current\r\n      size: 'medium' as TableSize // Keep a valid size for the interface\r\n    }));\r\n  };\r\n\r\n  const handleObjectNameChange = (name: string) => {\r\n    if (!selectedElement || selectedElement.type !== 'object') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            objects: floor.objects.map(obj =>\r\n              obj.id === selectedElement.id ? { ...obj, name } : obj\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleObjectResize = (width: number, height: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'object') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            objects: floor.objects.map(obj =>\r\n              obj.id === selectedElement.id ? { ...obj, width, height } : obj\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleObjectRotate = (rotation: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'object') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            objects: floor.objects.map(obj =>\r\n              obj.id === selectedElement.id ? { ...obj, rotation } : obj\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleFixedElementResize = (width: number, height: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'fixedElement') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            fixedElements: floor.fixedElements.map(element =>\r\n              element.id === selectedElement.id ? { ...element, width, height } : element\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleTableNameChange = (name: string) => {\r\n    updateSelectedTable(table => ({ ...table, name }));\r\n  };\r\n\r\n  const handleCanvasClick = (e: React.MouseEvent) => {\r\n    if (!canvasRef.current) return;\r\n    \r\n    // Don't do anything if we're resizing\r\n    if (isResizingWall) return;\r\n    \r\n    // If we're in wall drawing mode\r\n    if (isDrawingWall && wallType) {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const x = Math.round(((e.clientX - rect.left) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      const y = Math.round(((e.clientY - rect.top) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      if (!wallStartPoint) {\r\n        // First click - set start point\r\n        setWallStartPoint({ x, y });\r\n      } else {\r\n        // Second click - create the wall with snapped coordinates\r\n        const floor = getCurrentFloor();\r\n        if (!floor) return;\r\n        \r\n        // Apply snap to axis for the final wall\r\n        const snappedEnd = snapToAxis(wallStartPoint, { x, y });\r\n        \r\n        const newWall: Wall = {\r\n          id: generateId(),\r\n          type: wallType,\r\n          startX: wallStartPoint.x,\r\n          startY: wallStartPoint.y,\r\n          endX: snappedEnd.x,\r\n          endY: snappedEnd.y,\r\n          thickness: 8\r\n        };\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { ...floor, walls: [...floor.walls, newWall] }\r\n            : floor\r\n        ));\r\n        \r\n        // Reset wall drawing state\r\n        setWallStartPoint(null);\r\n        setTempWallEndPoint(null);\r\n        setIsDrawingWall(false);\r\n        setWallType(null);\r\n      }\r\n      return;\r\n    }\r\n    \r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const handleElementSelect = (type: 'table' | 'chair' | 'object' | 'wall' | 'fixedElement', id: string) => {\r\n    setSelectedElement({ type, id });\r\n  };\r\n\r\n  const handleDragStart = (e: React.MouseEvent, id: string) => {\r\n    if (!canvasRef.current) return;\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / zoom;\r\n    const y = (e.clientY - rect.top) / zoom;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Find the element (table, object, fixedElement, or wall) being dragged\r\n    const table = floor.tables.find(t => t.id === id);\r\n    const object = floor.objects.find(o => o.id === id);\r\n    const fixedElement = floor.fixedElements.find(fe => fe.id === id);\r\n    const wall = floor.walls.find(w => w.id === id);\r\n    \r\n    if (wall) {\r\n      // For walls, store offset from startX/startY\r\n      setDragOffset({\r\n        x: x - wall.startX,\r\n        y: y - wall.startY\r\n      });\r\n      dragElementRef.current = { id, type: 'wall' };\r\n    } else {\r\n      const element = table || object || fixedElement;\r\n      if (element) {\r\n        setDragOffset({\r\n          x: x - element.x,\r\n          y: y - element.y\r\n        });\r\n      }\r\n      \r\n      // Determine the type based on what was found\r\n      const type = table ? 'table' : object ? 'object' : fixedElement ? 'fixedElement' : 'table';\r\n      dragElementRef.current = { id, type };\r\n    }\r\n    \r\n    setIsDragging(true);\r\n  };\r\n\r\n  const handleDrag = useCallback((e: MouseEvent) => {\r\n    if ((!isDragging && !isResizingWall) || !dragElementRef.current || !canvasRef.current) return;\r\n    \r\n    // Cancel any pending animation frame\r\n    if (rafRef.current) {\r\n      cancelAnimationFrame(rafRef.current);\r\n    }\r\n    \r\n    // Use requestAnimationFrame for smooth updates\r\n    rafRef.current = requestAnimationFrame(() => {\r\n      if (!canvasRef.current) return;\r\n      \r\n      const canvasRect = canvasRef.current.getBoundingClientRect();\r\n      const x = (e.clientX - canvasRect.left) / zoom;\r\n      const y = (e.clientY - canvasRect.top) / zoom;\r\n      \r\n      const snappedX = Math.round(x / GRID_SIZE) * GRID_SIZE;\r\n      const snappedY = Math.round(y / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      if (isResizingWall && dragElementRef.current?.type === 'wall') {\r\n        // Handle wall resizing with snap-to-axis\r\n        const currentFloorData = floors.find(f => f.id === currentFloor);\r\n        const currentWall = currentFloorData?.walls.find(w => w.id === dragElementRef.current?.id);\r\n        \r\n        if (currentWall) {\r\n          // Determine which point is fixed and which is moving\r\n          const fixedPoint = resizingWallHandle === 'start' \r\n            ? { x: currentWall.endX, y: currentWall.endY }\r\n            : { x: currentWall.startX, y: currentWall.startY };\r\n          \r\n          // Apply snap to axis based on fixed point\r\n          const snappedPoint = snapToAxis(fixedPoint, { x: snappedX, y: snappedY });\r\n          \r\n          setFloors(prev => prev.map(floor => \r\n            floor.id === currentFloor \r\n              ? { \r\n                  ...floor, \r\n                  walls: floor.walls.map(wall => \r\n                    wall.id === dragElementRef.current?.id \r\n                      ? resizingWallHandle === 'start'\r\n                        ? { ...wall, startX: snappedPoint.x, startY: snappedPoint.y }\r\n                        : { ...wall, endX: snappedPoint.x, endY: snappedPoint.y }\r\n                      : wall\r\n                  )\r\n                }\r\n              : floor\r\n          ));\r\n        }\r\n      } else if (dragElementRef.current?.type === 'table') {\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const tableSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const tableSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                tables: floor.tables.map(table => \r\n                  table.id === dragElementRef.current?.id \r\n                    ? { ...table, x: tableSnappedX, y: tableSnappedY }\r\n                    : table\r\n                )\r\n              }\r\n            : floor\r\n        ));\r\n      } else if (dragElementRef.current?.type === 'object') {\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const objectSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const objectSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                objects: floor.objects.map(object => \r\n                  object.id === dragElementRef.current?.id \r\n                    ? { ...object, x: objectSnappedX, y: objectSnappedY }\r\n                    : object\r\n                )\r\n              }\r\n            : floor\r\n        ));\r\n      } else if (dragElementRef.current?.type === 'fixedElement') {\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const elementSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const elementSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                fixedElements: floor.fixedElements.map(element => \r\n                  element.id === dragElementRef.current?.id \r\n                    ? { ...element, x: elementSnappedX, y: elementSnappedY }\r\n                    : element\r\n                )\r\n              }\r\n            : floor\r\n        ));\r\n      } else if (dragElementRef.current?.type === 'wall' && !isResizingWall) {\r\n        // Handle wall dragging (move entire wall - both endpoints)\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const wallSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const wallSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                walls: floor.walls.map(wall => {\r\n                  if (wall.id !== dragElementRef.current?.id) return wall;\r\n                  \r\n                  // Calculate delta from original startX/startY\r\n                  const deltaX = wallSnappedX - wall.startX;\r\n                  const deltaY = wallSnappedY - wall.startY;\r\n                  \r\n                  // Move both endpoints by the same delta\r\n                  return {\r\n                    ...wall,\r\n                    startX: wall.startX + deltaX,\r\n                    startY: wall.startY + deltaY,\r\n                    endX: wall.endX + deltaX,\r\n                    endY: wall.endY + deltaY\r\n                  };\r\n                })\r\n              }\r\n            : floor\r\n        ));\r\n      }\r\n    });\r\n  }, [isDragging, isResizingWall, resizingWallHandle, dragOffset, currentFloor, zoom, floors]);\r\n\r\n  const handleDragEnd = () => {\r\n    // Cancel any pending animation frame\r\n    if (rafRef.current) {\r\n      cancelAnimationFrame(rafRef.current);\r\n      rafRef.current = null;\r\n    }\r\n    setIsDragging(false);\r\n    dragElementRef.current = null;\r\n    \r\n    // Reset wall resizing state\r\n    setIsResizingWall(false);\r\n    setResizingWallHandle(null);\r\n    setWallResizePreview(null);\r\n  };\r\n\r\n  const handleWallHandleDrag = (e: React.MouseEvent, wallId: string, handleType: 'start' | 'end') => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    setIsResizingWall(true);\r\n    setResizingWallHandle(handleType);\r\n    dragElementRef.current = { id: wallId, type: 'wall' };\r\n  };\r\n\r\n  const addFloor = () => {\r\n    const newFloor: Floor = {\r\n      id: generateId(),\r\n      name: `Floor ${floors.length + 1}`,\r\n      isActive: false,\r\n      tables: [],\r\n      chairs: [],\r\n      objects: [],\r\n      walls: [],\r\n      fixedElements: []\r\n    };\r\n    setFloors(prev => [...prev, newFloor]);\r\n    switchFloor(newFloor.id);\r\n  };\r\n\r\n  const removeFloor = () => {\r\n    if (floors.length <= 1) return;\r\n    \r\n    const newFloors = floors.filter(f => f.id !== currentFloor);\r\n    setFloors(newFloors);\r\n    setCurrentFloor(newFloors[0].id);\r\n  };\r\n\r\n  const switchFloor = (floorId: string) => {\r\n    setFloors(prev => prev.map(floor => ({\r\n      ...floor,\r\n      isActive: floor.id === floorId\r\n    })));\r\n    setCurrentFloor(floorId);\r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const renameFloor = (floorId: string, newName: string) => {\r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === floorId\r\n        ? { ...floor, name: newName }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const startWallDrawing = (type: WallType) => {\r\n    setIsDrawingWall(true);\r\n    setWallType(type);\r\n    setWallStartPoint(null);\r\n    setTempWallEndPoint(null);\r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const addFixedElement = (type: FixedElementType) => {\r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n\r\n    const newElement: FixedElement = {\r\n      id: generateId(),\r\n      name: `${type.charAt(0).toUpperCase() + type.slice(1)} ${floor.fixedElements.length + 1}`,\r\n      type,\r\n      x: 400 + floor.fixedElements.length * 30,\r\n      y: 400 + floor.fixedElements.length * 30,\r\n      width: 60,\r\n      height: 60,\r\n      rotation: 0\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, fixedElements: [...floor.fixedElements, newElement] }\r\n        : floor\r\n    ));\r\n    setSelectedElement({ type: 'fixedElement', id: newElement.id });\r\n  };\r\n\r\n  const saveFloorPlan = () => {\r\n    const floorPlanData = {\r\n      floors: floors,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n    \r\n    console.log('Saving floor plan:', floorPlanData);\r\n    alert('Floor plan saved! (Check console for data)');\r\n  };\r\n\r\n  const loadFloorPlan = () => {\r\n    // Simulate loading - in real app this would be from your backend API\r\n    const sampleData: Floor[] = [\r\n      {\r\n        id: 'floor-sample',\r\n        name: 'Sample Floor',\r\n        isActive: true,\r\n        tables: [\r\n          {\r\n            id: 'table-1',\r\n            name: 'Table 1',\r\n            shape: 'circle',\r\n            size: 'medium',\r\n            x: 200,\r\n            y: 200,\r\n            width: 120,\r\n            height: 120,\r\n            rotation: 0\r\n          }\r\n        ],\r\n        chairs: [\r\n          {\r\n            id: 'chair-1',\r\n            tableId: 'table-1',\r\n            position: 'top',\r\n            index: 0,\r\n            x: 0,\r\n            y: 0\r\n          }\r\n        ],\r\n        objects: [],\r\n        walls: [],\r\n        fixedElements: []\r\n      }\r\n    ];\r\n    \r\n    setFloors(sampleData);\r\n    setCurrentFloor('floor-sample');\r\n    setSelectedElement(null);\r\n    alert('Sample floor plan loaded!');\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleMouseMove = (e: MouseEvent) => handleDrag(e);\r\n    const handleMouseUp = () => handleDragEnd();\r\n    \r\n    if (isDragging || isResizingWall) {\r\n      document.addEventListener('mousemove', handleMouseMove);\r\n      document.addEventListener('mouseup', handleMouseUp);\r\n    }\r\n    \r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isDragging, isResizingWall, handleDrag]);\r\n\r\n  // Handle mouse move for wall drawing preview\r\n  const handleCanvasMouseMove = (e: React.MouseEvent) => {\r\n    if (isDrawingWall && wallStartPoint && canvasRef.current) {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const x = Math.round(((e.clientX - rect.left) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      const y = Math.round(((e.clientY - rect.top) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      // Apply snap to axis\r\n      const snappedPoint = snapToAxis(wallStartPoint, { x, y });\r\n      setTempWallEndPoint(snappedPoint);\r\n    } else if (isResizingWall && dragElementRef.current?.type === 'wall' && canvasRef.current) {\r\n      // Show preview while resizing wall\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const x = Math.round(((e.clientX - rect.left) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      const y = Math.round(((e.clientY - rect.top) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      const currentFloorData = getCurrentFloor();\r\n      const currentWall = currentFloorData?.walls.find(w => w.id === dragElementRef.current?.id);\r\n      \r\n      if (currentWall) {\r\n        const fixedPoint = resizingWallHandle === 'start'\r\n          ? { x: currentWall.endX, y: currentWall.endY }\r\n          : { x: currentWall.startX, y: currentWall.startY };\r\n        \r\n        const snappedPoint = snapToAxis(fixedPoint, { x, y });\r\n        \r\n        setWallResizePreview(\r\n          resizingWallHandle === 'start'\r\n            ? { startX: snappedPoint.x, startY: snappedPoint.y, endX: currentWall.endX, endY: currentWall.endY }\r\n            : { startX: currentWall.startX, startY: currentWall.startY, endX: snappedPoint.x, endY: snappedPoint.y }\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  // Handle ESC key to cancel wall drawing\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape' && isDrawingWall) {\r\n        setIsDrawingWall(false);\r\n        setWallType(null);\r\n        setWallStartPoint(null);\r\n        setTempWallEndPoint(null);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [isDrawingWall]);\r\n\r\n  const currentFloorData = getCurrentFloor();\r\n  const selectedTable = currentFloorData?.tables.find(t => selectedElement?.type === 'table' && t.id === selectedElement.id);\r\n  const selectedObject = currentFloorData?.objects.find(o => selectedElement?.type === 'object' && o.id === selectedElement.id);\r\n  const selectedWall = currentFloorData?.walls.find(w => selectedElement?.type === 'wall' && w.id === selectedElement.id);\r\n  const selectedFixedElement = currentFloorData?.fixedElements.find(fe => selectedElement?.type === 'fixedElement' && fe.id === selectedElement.id);\r\n  const selectedTableChairs = selectedTable\r\n    ? (currentFloorData?.chairs.filter(c => c.tableId === selectedTable.id) ?? [])\r\n    : [];\r\n  const toggleGrid = useCallback(() => setShowGrid((prev) => !prev), []);\r\n\r\n  return (\r\n    <div className=\"restaurant-floor-planner rfp-flex rfp-h-screen rfp-bg-gray-50\">\r\n      <style dangerouslySetInnerHTML={{ __html: hexagonStyle }} />\r\n      \r\n      <Sidebar\r\n        floors={floors}\r\n        currentFloor={currentFloorData}\r\n        onAddFloor={addFloor}\r\n        onRemoveFloor={removeFloor}\r\n        onSwitchFloor={switchFloor}\r\n        onRenameFloor={renameFloor}\r\n        onAddTable={addTable}\r\n        onAddObject={addObject}\r\n        onStartWallDrawing={startWallDrawing}\r\n        onAddFixedElement={addFixedElement}\r\n        onRotateTable={rotateTable}\r\n        onDuplicateTable={duplicateTable}\r\n        onRemoveTable={removeElement}\r\n        onSave={saveFloorPlan}\r\n        selectedTable={selectedTable ?? null}\r\n        selectedTableChairs={selectedTableChairs}\r\n      />\r\n\r\n      <div className=\"flex-1 flex flex-col\">\r\n        {/* Wall Drawing Mode Banner - Removed for cleaner UX */}\r\n        {/* Wall Resizing Mode Banner - Removed for cleaner UX */}\r\n        \r\n        <Toolbar\r\n          showGrid={showGrid}\r\n          selectedTable={selectedTable ?? null}\r\n          selectedObject={selectedObject ?? null}\r\n          selectedWall={selectedWall ?? null}\r\n          selectedFixedElement={selectedFixedElement ?? null}\r\n          selectedTableChairs={selectedTableChairs}\r\n          tableCount={currentFloorData?.tables.length ?? 0}\r\n          chairCount={currentFloorData?.chairs.length ?? 0}\r\n          objectCount={currentFloorData?.objects.length ?? 0}\r\n          wallCount={currentFloorData?.walls.length ?? 0}\r\n          fixedElementCount={currentFloorData?.fixedElements.length ?? 0}\r\n          selectedElementType={selectedElement?.type ?? null}\r\n          onToggleGrid={toggleGrid}\r\n          onAddChair={addChair}\r\n          onRemoveChair={removeChair}\r\n          onChangeTableSize={handleTableSizeChange}\r\n          onCustomTableSize={handleCustomTableSize}\r\n          onTableNameChange={handleTableNameChange}\r\n          onObjectNameChange={handleObjectNameChange}\r\n          onObjectResize={handleObjectResize}\r\n          onObjectRotate={handleObjectRotate}\r\n          onRemoveObject={removeElement}\r\n          onRemoveWall={removeElement}\r\n          onRemoveFixedElement={removeElement}\r\n          onChangeWallThickness={changeWallThickness}\r\n          onConvertWallType={convertWallType}\r\n          onFixedElementResize={handleFixedElementResize}\r\n          onChairSizeChange={changeChairSize}\r\n          onResetChairSizes={resetChairSizes}\r\n          on3DPreview={() => setShow3DPreview(true)}\r\n        />\r\n\r\n        <div className=\"flex-1 overflow-hidden bg-gray-100 relative\">\r\n          <div\r\n            ref={canvasRef}\r\n            className={`w-full h-full relative ${\r\n              isDrawingWall ? 'cursor-crosshair' : \r\n              isResizingWall ? 'cursor-grabbing' : \r\n              'cursor-default'\r\n            }`}\r\n            style={{ \r\n              transform: `scale(${zoom})`,\r\n              transformOrigin: 'top left',\r\n              background: showGrid \r\n                ? `radial-gradient(circle, #d1d5db 1px, transparent 1px)` \r\n                : 'white',\r\n              backgroundSize: `${GRID_SIZE * zoom}px ${GRID_SIZE * zoom}px`\r\n            }}\r\n            onClick={handleCanvasClick}\r\n            onMouseMove={handleCanvasMouseMove}\r\n          >\r\n            {currentFloorData?.tables.length === 0 && (\r\n              <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n                <div className=\"text-center text-gray-400\">\r\n                  <div className=\"text-6xl mb-4\">ðŸª</div>\r\n                  <div className=\"text-xl font-medium mb-2\">Welcome to Your Restaurant Designer</div>\r\n                  <div className=\"text-lg\">Click \"Add Tables\" in the sidebar to start designing your floor plan</div>\r\n                  <div className=\"mt-4 space-y-1 text-sm\">\r\n                    <div>â€¢ Drag tables to move them around</div>\r\n                    <div>â€¢ Click tables to select and edit properties</div>\r\n                    <div>â€¢ Add chairs from the top toolbar or the table properties panel</div>\r\n                    <div>â€¢ Use multiple floors for complex layouts</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {currentFloorData?.tables.map(table => (\r\n              <TableComponent\r\n                key={table.id}\r\n                table={table}\r\n                isSelected={selectedElement?.type === 'table' && selectedElement.id === table.id}\r\n                chairs={currentFloorData.chairs.filter(chair => chair.tableId === table.id)}\r\n                onSelect={() => handleElementSelect('table', table.id)}\r\n                onDrag={handleDragStart}\r\n                onDragEnd={handleDragEnd}\r\n              />\r\n            ))}\r\n\r\n            {/* Render floor objects */}\r\n            {currentFloorData?.objects.map(object => (\r\n              <FloorObjectComponent\r\n                key={object.id}\r\n                object={object}\r\n                isSelected={selectedElement?.type === 'object' && selectedElement.id === object.id}\r\n                onSelect={() => handleElementSelect('object', object.id)}\r\n                onDragStart={(e) => handleDragStart(e, object.id)}\r\n              />\r\n            ))}\r\n\r\n            {/* Render walls */}\r\n            {currentFloorData?.walls.map(wall => (\r\n              <WallComponent\r\n                key={wall.id}\r\n                wall={wall}\r\n                isSelected={selectedElement?.type === 'wall' && selectedElement.id === wall.id}\r\n                onSelect={() => handleElementSelect('wall', wall.id)}\r\n                onDragHandle={(e, handleType) => handleWallHandleDrag(e, wall.id, handleType)}\r\n                onDragStart={(e) => handleDragStart(e, wall.id)}\r\n              />\r\n            ))}\r\n\r\n            {/* Render temporary wall preview while drawing */}\r\n            {isDrawingWall && wallStartPoint && tempWallEndPoint && wallType && (\r\n              <WallComponent\r\n                wall={{\r\n                  id: 'temp-wall',\r\n                  type: wallType,\r\n                  startX: wallStartPoint.x,\r\n                  startY: wallStartPoint.y,\r\n                  endX: tempWallEndPoint.x,\r\n                  endY: tempWallEndPoint.y,\r\n                  thickness: 8\r\n                }}\r\n                isSelected={false}\r\n                onSelect={() => {}}\r\n              />\r\n            )}\r\n\r\n            {/* Render wall resize preview */}\r\n            {wallResizePreview && (\r\n              <div\r\n                className=\"absolute pointer-events-none\"\r\n                style={{\r\n                  left: `${wallResizePreview.startX}px`,\r\n                  top: `${wallResizePreview.startY}px`,\r\n                  width: `${Math.sqrt(\r\n                    Math.pow(wallResizePreview.endX - wallResizePreview.startX, 2) + \r\n                    Math.pow(wallResizePreview.endY - wallResizePreview.startY, 2)\r\n                  )}px`,\r\n                  height: '4px',\r\n                  transform: `rotate(${Math.atan2(\r\n                    wallResizePreview.endY - wallResizePreview.startY, \r\n                    wallResizePreview.endX - wallResizePreview.startX\r\n                  ) * (180 / Math.PI)}deg)`,\r\n                  transformOrigin: 'top left',\r\n                  zIndex: 15\r\n                }}\r\n              >\r\n                <div className=\"w-full h-full border-2 border-blue-400 border-dashed opacity-70 bg-blue-100 rounded-sm\" />\r\n              </div>\r\n            )}\r\n\r\n            {/* Render fixed elements */}\r\n            {currentFloorData?.fixedElements.map(element => (\r\n              <FixedElementComponent\r\n                key={element.id}\r\n                element={element}\r\n                isSelected={selectedElement?.type === 'fixedElement' && selectedElement.id === element.id}\r\n                onSelect={() => handleElementSelect('fixedElement', element.id)}\r\n                onDragStart={(e) => handleDragStart(e, element.id)}\r\n              />\r\n            ))}\r\n\r\n            {/* Render all chairs separately for better positioning */}\r\n            {currentFloorData?.chairs.map(chair => {\r\n              const chairTable = currentFloorData.tables.find(t => t.id === chair.tableId);\r\n              if (!chairTable) return null;\r\n              \r\n              // Count total chairs on this side for proper spacing\r\n              const totalChairsOnSide = currentFloorData.chairs.filter(\r\n                c => c.tableId === chair.tableId && c.position === chair.position\r\n              ).length;\r\n              \r\n              return (\r\n                <ChairComponent\r\n                  key={chair.id}\r\n                  chair={chair}\r\n                  table={chairTable}\r\n                  totalChairsOnSide={totalChairsOnSide}\r\n                  isSelected={false}\r\n                  onSelect={() => {}}\r\n                  onDrag={() => {}}\r\n                  onDragEnd={() => {}}\r\n                />\r\n              );\r\n            })}\r\n\r\n            {selectedElement && selectedElement.type === 'table' && selectedTable && (\r\n              <div\r\n                className=\"absolute border-2 border-blue-500 border-dashed rounded pointer-events-none\"\r\n                style={{\r\n                  left: selectedTable.x - 10,\r\n                  top: selectedTable.y - 10,\r\n                  width: (selectedTable.shape === 'rectangle' ? selectedTable.width * 1.5 : selectedTable.width) + 20,\r\n                  height: selectedTable.height + 20,\r\n                  transform: `rotate(${selectedTable.rotation || 0}deg)`\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"absolute bottom-0 left-0 right-0 bg-white bg-opacity-95 border-t border-gray-200 p-3\">\r\n            <div className=\"flex items-center justify-between text-sm\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"flex items-center gap-2 text-gray-600\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span>Floor: {currentFloorData?.name}</span>\r\n                </div>\r\n                {isDragging && (\r\n                  <div className=\"flex items-center gap-2 text-blue-600\">\r\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\r\n                    <span>Dragging...</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"text-gray-500\">\r\n                  Zoom: {Math.round(zoom * 100)}% | Grid: {showGrid ? 'On' : 'Off'}\r\n                </div>\r\n                {selectedElement && (\r\n                  <div className=\"text-blue-600 font-medium\">\r\n                    {selectedElement.type === 'table' && selectedTable\r\n                      ? `${selectedTable.name} (${selectedTable.shape})`\r\n                      : 'Element Selected'\r\n                    }\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 3D Preview Modal */}\r\n      {currentFloorData && (\r\n        <Preview3DModal \r\n          floor={currentFloorData}\r\n          isOpen={show3DPreview}\r\n          onClose={() => setShow3DPreview(false)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RestaurantFloorPlanner;"],"names":["hexagonStyle","GRID_SIZE","TABLE_SIZES","TABLE_SHAPES","Square","Circle","SIZE_LABELS","OBJECT_ICONS","Wine","ChefHat","Bath","OBJECT_LABELS","OBJECT_COLORS","WALL_LABELS","WALL_ICONS","RectangleVertical","DoorOpen","FIXED_ELEMENT_LABELS","FIXED_ELEMENT_ICONS","Columns","Rows","FIXED_ELEMENT_COLORS","generateId","calculateChairSize","table","actualWidth","limitingDimension","scaled","getActualTableWidth","resolveTableDimensions","shape","size","width","height","snapToAxis","start","end","dx","dy","ChairComponent","chair","isSelected","onSelect","onDrag","onDragEnd","totalChairsOnSide","baseChairSize","chairSize","spacing","iconSize","tableWidth","tableRotation","position","availableSpace","gapBetweenChairs","offsetAlongSide","relativeX","relativeY","rotatedX","rotatedY","tableCenterX","tableCenterY","getChairRotation","baseRotation","jsx","event","Armchair","TableComponent","chairs","containerStyle","baseClasses","tableClasses","seatsCount","nameMatch","tableLabel","jsxs","FloorObjectComponent","object","onDragStart","Icon","colors","isDragging","setIsDragging","useState","handleMouseDown","e","handleMouseUp","Fragment","WallComponent","wall","onDragHandle","length","angle","getCursorStyle","getWallColor","getWallPattern","renderDoor","gapSize","panelWidth","FixedElementComponent","element","renderContent","step","sizeLabels","Sidebar","floors","currentFloor","onAddFloor","onRemoveFloor","onSwitchFloor","onRenameFloor","onAddTable","onAddObject","onStartWallDrawing","onAddFixedElement","onRotateTable","onDuplicateTable","onRemoveTable","onSave","onLoad","selectedTable","selectedTableChairs","editingFloorId","setEditingFloorId","React","editingFloorName","setEditingFloorName","activeTab","setActiveTab","inputRef","handleDoubleClick","floor","handleSaveFloorName","handleKeyDown","Layers","Plus","Minus","LayoutGrid","Package","Home","objectType","label","wallType","elementType","RotateCw","Trash2","Save","Upload","chairPositions","sizeOptions","Toolbar","showGrid","selectedObject","selectedWall","selectedFixedElement","onToggleGrid","onAddChair","onRemoveChair","onChangeTableSize","onTableNameChange","onCustomTableSize","onObjectNameChange","onObjectResize","onRemoveObject","onRemoveWall","onRemoveFixedElement","onChangeWallThickness","onConvertWallType","onFixedElementNameChange","onFixedElementResize","onChairSizeChange","onResetChairSizes","on3DPreview","onObjectRotate","tableCount","chairCount","objectCount","wallCount","fixedElementCount","selectedElementType","chairMenuRef","useRef","sizeMenuRef","objectSizeMenuRef","fixedElementSizeMenuRef","isChairMenuOpen","setIsChairMenuOpen","isSizeMenuOpen","setIsSizeMenuOpen","isObjectSizeMenuOpen","setIsObjectSizeMenuOpen","isFixedElementSizeMenuOpen","setIsFixedElementSizeMenuOpen","showProSlider","setShowProSlider","customWidth","setCustomWidth","customHeight","setCustomHeight","objectWidth","setObjectWidth","objectHeight","setObjectHeight","fixedElementWidth","setFixedElementWidth","fixedElementHeight","setFixedElementHeight","useEffect","handleClickOutside","Eye","EyeOff","chairsOnSide","c","chairSample","currentSize","RotateCcw","sizeOption","isActive","ChevronRight","newWidth","newHeight","newRotation","Box","CAMERA_VIEWS","Preview3DModal","isOpen","onClose","containerRef","sceneRef","cameraRef","rendererRef","animationFrameRef","autoRotate","setAutoRotate","currentView","setCurrentView","isTransitioning","setIsTransitioning","rotationSpeedRef","transitionRef","smoothCameraTransition","viewKey","view","camera","THREE","rotateCamera","direction","radius","currentAngle","leftAngle","rightAngle","zoomCamera","factor","scene","renderer","pmremGenerator","envScene","envTexture","mainLight","fillLight","rimLight","floorMesh","grid","wallHeight","baseX","baseZ","doorGroup","doorWidth","doorHeight","doorThickness","frameMat","frameThickness","topFrame","bottomFrame","leftFrame","rightFrame","doorMat","glassMat","singleDoorWidth","doorPanelHeight","makeDoor","xOffset","group","doorBorder","glass","handleMat","handle","leftDoor","rightDoor","signHeight","signGeometry","canvas","ctx","signTexture","signMaterial","sign","windowLength","windowHeight","h1","h2","h3","h4","wallMat","sill","winY","numPanes","paneWidth","i","paneX","localX","localZ","divX","divLocalX","divLocalZ","divider","topY","transomGlass","transomFrame","transomTopFrame","topWall","wallMesh","pillar","capital","base","column","edges","stepDepth","obj","rotation","barHeight","baseMat","glassColors","glassColor","glassTopMat","glassTop","ledGlowMat","ledStrip","trimColor","trim","legMat","legGeo","lx","lz","leg","barLight","canopyHeight","canopyOuter","outerMat","outerShell","innerGlassMat","innerGlass","ledMat","ledGeom","ledLeft","ledRight","bottleRack","bottleColors","color","bottleMat","bottle","neck","rodMat","rodGeo","rod","warmLight","kitchenGroup","steelMat","counter","stove","burnerMat","bx","bz","burner","hood","shelfMat","shelf","kitchenLight","chefCanvas","chefCtx","chefTexture","chefSignLeft","chefSignRight","toiletGroup","marbleMat","door2Mat","tileFloorMat","roomHeight","backWall","leftWall","rightWall","centerDivider","leftSection","rightSection","rightTopWall","leftTopWall","door","maleCanvas","maleCtx","gradient","goldGradient","maleTexture","maleSign","door2","handle2","femaleCanvas","femaleCtx","roseGoldGradient","femaleTexture","femaleSign","wcTexture","wcSign","counterMat","sinkMat","sink","faucetMat","faucet","toiletMat","toiletBowl","toiletSeat","toiletTank","flushHandle","urinal","urinalValve","softLight","tableX","tableZ","tableRotRad","tableMaterial","tableGeometry","tableMesh","edgeTrim","legMaterial","legRadius","tableChairs","chairHeight","woodMaterial","cushionMaterial","totalOnSide","availSpace","gap","offset","relX","relZ","rotX","rotZ","seat","seatHeight","baseRot","back","backOff","legHeight","cos","sin","animate","t","easedProgress","x","currentTarget","r","a","_a","handleResize","Move3d","X","ZoomIn","ZoomOut","Maximize2","Grid","RestaurantFloorPlanner","setFloors","setCurrentFloor","selectedElement","setSelectedElement","dragOffset","setDragOffset","zoom","setShowGrid","show3DPreview","setShow3DPreview","isDrawingWall","setIsDrawingWall","setWallType","wallStartPoint","setWallStartPoint","tempWallEndPoint","setTempWallEndPoint","isResizingWall","setIsResizingWall","resizingWallHandle","setResizingWallHandle","wallResizePreview","setWallResizePreview","canvasRef","dragElementRef","rafRef","getCurrentFloor","sizeByPosition","prev","defaultSize","addTable","newTable","addObject","type","newObject","addChair","existingChairsOnSide","nextIndex","existingChairWithSize","initialSize","newChair","removeChair","chairToRemove","current","changeChairSize","resetChairSizes","chairWithoutSize","removeElement","o","w","fe","changeWallThickness","thickness","convertWallType","rotateTable","duplicateTable","originalTable","newChairs","updateSelectedTable","useCallback","updater","handleTableSizeChange","handleCustomTableSize","handleObjectNameChange","name","handleObjectResize","handleObjectRotate","handleFixedElementResize","handleTableNameChange","handleCanvasClick","rect","y","snappedEnd","newWall","handleElementSelect","id","handleDragStart","fixedElement","handleDrag","canvasRect","snappedX","snappedY","currentFloorData","f","currentWall","fixedPoint","snappedPoint","_b","adjustedX","adjustedY","tableSnappedX","tableSnappedY","_c","objectSnappedX","objectSnappedY","_d","elementSnappedX","elementSnappedY","_e","wallSnappedX","wallSnappedY","deltaX","deltaY","handleDragEnd","handleWallHandleDrag","wallId","handleType","addFloor","newFloor","switchFloor","removeFloor","newFloors","floorId","renameFloor","newName","startWallDrawing","addFixedElement","newElement","saveFloorPlan","floorPlanData","handleMouseMove","handleCanvasMouseMove","toggleGrid","chairTable"],"mappings":";;;;AAGO,MAAMA,KAAe;AAAA;AAAA;AAAA;AAAA,GAMfC,IAAY,IAEZC,KAAoE;AAAA,EAC/E,OAAO,EAAE,OAAO,IAAI,QAAQ,GAAG;AAAA,EAC/B,QAAQ,EAAE,OAAO,IAAI,QAAQ,GAAG;AAAA,EAChC,OAAO,EAAE,OAAO,KAAK,QAAQ,IAAI;AACnC,GAEaC,KAAkC;AAAA,EAC7C,QAAQC;AAAA,EACR,QAAQC;AAAA,EACR,WAAWD;AAAA,EACX,SAASA;AACX,GAEaE,KAAyC;AAAA,EACpD,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,OAAO;AACT,GAWaC,KAA8B;AAAA,EACzC,KAAKC;AAAA,EACL,SAASC;AAAA,EACT,QAAQC;AACV,GAEaC,KAA4C;AAAA,EACvD,KAAK;AAAA,EACL,SAAS;AAAA,EACT,QAAQ;AACV,GAEaC,KAAkF;AAAA,EAC7F,KAAK;AAAA,IACH,IAAI;AAAA,IACJ,QAAQ;AAAA,IACR,MAAM;AAAA,EACR;AAAA,EACA,SAAS;AAAA,IACP,IAAI;AAAA,IACJ,QAAQ;AAAA,IACR,MAAM;AAAA,EACR;AAAA,EACA,QAAQ;AAAA,IACN,IAAI;AAAA,IACJ,QAAQ;AAAA,IACR,MAAM;AAAA,EACR;AACF,GAEaC,KAAwC;AAAA,EACnD,MAAM;AAAA,EACN,MAAM;AAAA,EACN,QAAQ;AACV,GAEaC,KAAa;AAAA,EACxB,MAAMC;AAAA,EACN,MAAMC;AAAA,EACN,QAAQD;AACV,GAoBaE,KAAyD;AAAA,EACpE,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,QAAQ;AACV,GAEaC,KAAsB;AAAA,EACjC,QAAQC;AAAA,EACR,QAAQA;AAAA,EACR,QAAQC;AACV,GAEaC,KAA+F;AAAA,EAC1G,QAAQ;AAAA,IACN,IAAI;AAAA,IACJ,QAAQ;AAAA,IACR,MAAM;AAAA,EACR;AAAA,EACA,QAAQ;AAAA,IACN,IAAI;AAAA,IACJ,QAAQ;AAAA,IACR,MAAM;AAAA,EACR;AAAA,EACA,QAAQ;AAAA,IACN,IAAI;AAAA,IACJ,QAAQ;AAAA,IACR,MAAM;AAAA,EACR;AACF,GC5HaC,KAAa,MAAc,KAAK,SAAS,SAAS,EAAE,EAAE,MAAM,GAAG,EAAE,GAEjEC,KAAqB,CAACC,MAAyB;AAC1D,QAAMC,IAAcD,EAAM,UAAU,cAAcA,EAAM,QAAQ,MAAMA,EAAM,OACtEE,IAAoB,KAAK,IAAID,GAAaD,EAAM,MAAM,GACtDG,IAAS,KAAK,MAAMD,IAAoB,IAAI;AAClD,SAAO,KAAK,IAAI,IAAI,KAAK,IAAI,IAAIC,CAAM,CAAC;AAC1C,GAEaC,KAAsB,CAACJ,MAClCA,EAAM,UAAU,cAAcA,EAAM,QAAQ,MAAMA,EAAM,OAE7CK,KAAyB,CACpCC,GACAC,MACsC;AACtC,QAAM,EAAE,OAAAC,GAAO,QAAAC,EAAO,IAAI/B,GAAY6B,CAAI;AACnC,SAAA;AAAA,IACL,OAAOD,MAAU,cAAcE,IAAQ,MAAMA;AAAA,IAC7C,QAAAC;AAAA,EAAA;AAEJ,GAaaC,KAAa,CACxBC,GACAC,MAC6B;AAC7B,QAAMC,IAAK,KAAK,IAAID,EAAI,IAAID,EAAM,CAAC,GAC7BG,IAAK,KAAK,IAAIF,EAAI,IAAID,EAAM,CAAC;AAGnC,SAAIE,IAAKC,IACA,EAAE,GAAGF,EAAI,GAAG,GAAGD,EAAM,MAGrB,EAAE,GAAGA,EAAM,GAAG,GAAGC,EAAI;AAEhC,GCnCaG,KAAgD,CAAC;AAAA,EAC5D,OAAAC;AAAA,EACA,OAAAhB;AAAA,EACA,YAAAiB;AAAA,EACA,UAAAC;AAAA,EACA,QAAAC;AAAA,EACA,WAAAC;AAAA,EACA,mBAAAC;AACF,MAAM;AAEE,QAAAC,KAAgBvB,GAAmBC,CAAK,GACxCuB,IAAYP,EAAM,QAAQ,KAAK,MAAMM,KAAgB,GAAG,GACxDE,KAAU,KAAK,IAAI,IAAI,KAAK,MAAMD,IAAY,IAAI,CAAC,GACnDE,IAAW,KAAK,IAAIF,IAAY,GAAG,KAAK,IAAI,IAAI,KAAK,MAAMA,IAAY,IAAI,CAAC,CAAC,GAC7EG,IAAatB,GAAoBJ,CAAK,GACtC2B,KAAiB3B,EAAM,YAAY,MAAM,KAAK,KAAK,MAEnD4B,MAAY,MAAM;AAOhB,UAAAC,MALab,EAAM,aAAa,SAASA,EAAM,aAAa,WAC9DU,IACA1B,EAAM,UAG2BuB,IAAYF,GAC3CS,KAAmBT,IAAoB,IACzCQ,MAAkBR,IAAoB,KACtCQ,KAAiB,GAGfE,KAAkBD,KAAoBd,EAAM,SAASO,IAAYO,MAAqBP,IAAY;AAGxG,QAAIS,IAAY,GACZC,IAAY;AAEhB,YAAQjB,EAAM,UAAU;AAAA,MACtB,KAAK;AACH,QAAAgB,IAAYD,KAAkBL,IAAa,GAC3CO,IAAY,EAAEjC,EAAM,SAAS,IAAIwB,KAAUD,IAAY;AACvD;AAAA,MACF,KAAK;AACH,QAAAS,IAAYD,KAAkBL,IAAa,GAC3CO,IAAYjC,EAAM,SAAS,IAAIwB,KAAUD,IAAY;AACrD;AAAA,MACF,KAAK;AACH,QAAAS,IAAY,EAAEN,IAAa,IAAIF,KAAUD,IAAY,IACzCU,IAAAF,KAAkB/B,EAAM,SAAS;AAC7C;AAAA,MACF,KAAK;AACS,QAAAgC,IAAAN,IAAa,IAAIF,KAAUD,IAAY,GACvCU,IAAAF,KAAkB/B,EAAM,SAAS;AAC7C;AAAA,IACJ;AAGM,UAAAkC,IAAWF,IAAY,KAAK,IAAIL,CAAa,IAAIM,IAAY,KAAK,IAAIN,CAAa,GACnFQ,KAAWH,IAAY,KAAK,IAAIL,CAAa,IAAIM,IAAY,KAAK,IAAIN,CAAa,GAGnFS,KAAepC,EAAM,IAAI0B,IAAa,GACtCW,KAAerC,EAAM,IAAIA,EAAM,SAAS;AAEvC,WAAA;AAAA,MACL,GAAGoC,KAAeF,IAAWX,IAAY;AAAA,MACzC,GAAGc,KAAeF,KAAWZ,IAAY;AAAA,IAAA;AAAA,EAC3C,MAIIe,KAAmB,MAAM;AAC7B,QAAIC,IAAe;AACnB,YAAQvB,EAAM,UAAU;AAAA,MACtB,KAAK;AACY,QAAAuB,IAAA;AACf;AAAA,MACF,KAAK;AACY,QAAAA,IAAA;AACf;AAAA,MACF,KAAK;AACY,QAAAA,IAAA;AACf;AAAA,MACF,KAAK;AACY,QAAAA,IAAA;AACf;AAAA,IACJ;AACO,WAAAA,KAAgBvC,EAAM,YAAY;AAAA,EAAA;AAIzC,SAAA,gBAAAwC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW,oDACTvB,IAAa,wCAAwC,EACvD;AAAA,MACA,OAAO;AAAA,QACL,MAAMW,GAAS;AAAA,QACf,KAAKA,GAAS;AAAA,QACd,OAAOL;AAAA,QACP,QAAQA;AAAA,QACR,WAAW,UAAUe,GAAA,CAAkB;AAAA,QACvC,QAAQrB,IAAa,MAAM;AAAA,QAC3B,QAAQ;AAAA,MACV;AAAA,MACA,aAAa,CAACwB,MAAU;AACtB,QAAAA,EAAM,gBAAgB,GACbvB,KACFC,EAAAsB,GAAOzB,EAAM,EAAE;AAAA,MACxB;AAAA,MACA,WAAWI;AAAA,MAEX,UAAC,gBAAAoB,EAAA,OAAA,EAAI,WAAU,mOACb,UAAC,gBAAAA,EAAAE,IAAA,EAAS,MAAMjB,GAAU,aAAa,KAAK,WAAU,gBAAgB,CAAA,GACxE;AAAA,IAAA;AAAA,EAAA;AAGN,GCrHakB,KAAgD,CAAC;AAAA,EAC5D,OAAA3C;AAAA,EACA,QAAA4C;AAAA,EACA,YAAA3B;AAAA,EACA,UAAAC;AAAA,EACA,QAAAC;AAAA,EACA,WAAAC;AACF,MAAM;AACJ,QAAMyB,IAAsC;AAAA,IAC1C,MAAM7C,EAAM;AAAA,IACZ,KAAKA,EAAM;AAAA,IACX,OAAOI,GAAoBJ,CAAK;AAAA,IAChC,QAAQA,EAAM;AAAA,IACd,QAAQiB,IAAa,MAAM;AAAA,IAC3B,WAAW,UAAUjB,EAAM,YAAY,CAAC;AAAA,EAAA,GAGpC8C,KACJ,2DAEIC,IACJ/C,EAAM,UAAU,WACZ,GAAG8C,EAAW,kBACd9C,EAAM,UAAU,YAChB,GAAG8C,EAAW,mBACdA,IAGAE,IADcJ,EAAO,OAAO,CAAC5B,OAAUA,GAAM,YAAYhB,EAAM,EAAE,EACxC,QACzBiD,IAAYjD,EAAM,KAAK,MAAM,KAAK,GAClCkD,IAAaD,IAAYA,EAAU,CAAC,IAAIjD,EAAM;AAGlD,SAAA,gBAAAwC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW,oDACTvB,IAAa,0CAA0C,EACzD;AAAA,MACA,OAAO4B;AAAA,MACP,aAAa,CAACJ,OAAU;AACtB,QAAAA,GAAM,gBAAgB,GACbvB,KACFC,EAAAsB,IAAOzC,EAAM,EAAE;AAAA,MACxB;AAAA,MACA,SAAS,CAACyC,OAAU;AAClB,QAAAA,GAAM,gBAAgB,GACbvB;MACX;AAAA,MACA,WAAWE;AAAA,MAEX,UAAA,gBAAA+B,EAAC,OAAI,EAAA,WAAWJ,GAEd,UAAA;AAAA,QAAA,gBAAAP;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,OAAO;AAAA,cACL,YAAY;AAAA,cACZ,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAMb;AAAA,UAAA;AAAA,QACF;AAAA,QAGA,gBAAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,OAAO;AAAA,cACL,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YASd;AAAA,UAAA;AAAA,QACF;AAAA,QAGA,gBAAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,OAAO;AAAA,cACL,QAAQ;AAAA,cACR,aAAa;AAAA,cACb,eAAe;AAAA,YACjB;AAAA,UAAA;AAAA,QACF;AAAA,QAGA,gBAAAW,EAAC,OAAI,EAAA,WAAU,2HACb,UAAA;AAAA,UAAC,gBAAAA,EAAA,QAAA,EAAK,WAAU,6DAA4D,UAAA;AAAA,YAAA;AAAA,YAAID;AAAA,UAAA,GAAW;AAAA,UAC3F,gBAAAC,EAAC,QAAK,EAAA,WAAU,6DAA4D,UAAA;AAAA,YAAA;AAAA,YAAIH;AAAA,UAAA,GAAW;AAAA,QAAA,GAC7F;AAAA,MAAA,GACF;AAAA,IAAA;AAAA,EAAA;AAGN,GCrGaI,KAAmD,CAAC;AAAA,EAC/D,QAAAC;AAAA,EACA,YAAApC;AAAA,EACA,UAAAC;AAAA,EACA,aAAAoC;AACF,MAAM;AACE,QAAAC,IAAOxE,GAAasE,EAAO,IAAI,GAC/BG,IAASpE,GAAciE,EAAO,IAAI,GAClC,CAACI,GAAYC,EAAa,IAAIC,EAAS,EAAK,GAE5CC,IAAkB,CAACC,OAAwB;AAC/C,IAAAH,GAAc,EAAI,GAClBJ,EAAYO,EAAC;AAEb,UAAMC,IAAgB,MAAM;AAC1B,MAAAJ,GAAc,EAAK,GACV,SAAA,oBAAoB,WAAWI,CAAa;AAAA,IAAA;AAG9C,aAAA,iBAAiB,WAAWA,CAAa;AAAA,EAAA;AAIlD,SAAA,gBAAAX;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW,oCAAqCM,IAA4C,KAA/B,4BAAiC,IAAID,EAAO,EAAE,IAAIA,EAAO,MAAM,mEAC1HvC,IAAa,mDAAmD,iBAClE;AAAA,MACA,OAAO;AAAA,QACL,MAAM,GAAGoC,EAAO,CAAC;AAAA,QACjB,KAAK,GAAGA,EAAO,CAAC;AAAA,QAChB,OAAO,GAAGA,EAAO,KAAK;AAAA,QACtB,QAAQ,GAAGA,EAAO,MAAM;AAAA,QACxB,WAAW,UAAUA,EAAO,QAAQ;AAAA,QACpC,iBAAiB;AAAA,QACjB,YAAYI,IAAa,cAAc;AAAA,MACzC;AAAA,MACA,SAAS,CAACI,OAAM;AACd,QAAAA,GAAE,gBAAgB,GACT3C;MACX;AAAA,MACA,aAAa0C;AAAA,MAEb,UAAA;AAAA,QAAC,gBAAAT,EAAA,OAAA,EAAI,WAAU,+FACb,UAAA;AAAA,UAAA,gBAAAX,EAACe,KAAK,WAAW,WAAWC,EAAO,IAAI,IAAI,aAAa,GAAG;AAAA,UAC3D,gBAAAhB,EAAC,UAAK,WAAW,qBAAqBgB,EAAO,IAAI,4BAC9C,YAAO,KACV,CAAA;AAAA,QAAA,GACF;AAAA,QAGCvC,KAGG,gBAAAkC,EAAAY,IAAA,EAAA,UAAA;AAAA,UAAC,gBAAAvB,EAAA,OAAA,EAAI,WAAU,0HAA0H,CAAA;AAAA,UACzI,gBAAAA,EAAC,OAAI,EAAA,WAAU,2HAA2H,CAAA;AAAA,UAC1I,gBAAAA,EAAC,OAAI,EAAA,WAAU,6HAA6H,CAAA;AAAA,UAC5I,gBAAAA,EAAC,OAAI,EAAA,WAAU,8HAA8H,CAAA;AAAA,QAAA,GAC/I;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAIR,GC5DawB,KAAqC,CAAC;AAAA,EACjD,MAAAC;AAAA,EACA,YAAAhD;AAAA,EACA,UAAAC;AAAA,EACA,cAAAgD;AAAA,EACA,aAAAZ;AACF,MAAM;AACJ,QAAMa,IAAS,KAAK;AAAA,IAClB,KAAK,IAAIF,EAAK,OAAOA,EAAK,QAAQ,CAAC,IAAI,KAAK,IAAIA,EAAK,OAAOA,EAAK,QAAQ,CAAC;AAAA,EAAA,GAEtEG,IAAQ,KAAK,MAAMH,EAAK,OAAOA,EAAK,QAAQA,EAAK,OAAOA,EAAK,MAAM,KAAK,MAAM,KAAK,KAGnFI,KAAiB,MAAM;AAC3B,QAAI,CAACpD;AAAmB,aAAA;AAGxB,UAAMJ,IAAK,KAAK,IAAIoD,EAAK,OAAOA,EAAK,MAAM,GACrCnD,IAAK,KAAK,IAAImD,EAAK,OAAOA,EAAK,MAAM;AAEpC,WAAApD,IAAKC,IAAK,cAAc;AAAA,EAAA,GAG3BwD,IAAe,MAAM;AACzB,YAAQL,EAAK,MAAM;AAAA,MACjB,KAAK;AACI,eAAA;AAAA,MACT,KAAK;AACI,eAAA;AAAA,MACT,KAAK;AACI,eAAA;AAAA,IACX;AAAA,EAAA,GAGIM,KAAiB,MACjBN,EAAK,SAAS,WACT,4DAELA,EAAK,SAAS,SAET,KAEFK,EAAa,GAIhBE,IAAa,MAAM;AACvB,UAAMC,IAAUN,IAAS,KACnBO,KAAcP,IAASM,KAAW;AAGtC,WAAA,gBAAAtB,EAAC,OAAI,EAAA,WAAU,sCAEb,UAAA;AAAA,MAAA,gBAAAX;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UACV,OAAO;AAAA,YACL,OAAO,GAAGkC,CAAU;AAAA,YACpB,QAAQ,GAAGT,EAAK,SAAS;AAAA,YACzB,WAAW;AAAA,YACX,cAAc;AAAA,YACd,aAAa;AAAA,UACf;AAAA,UAGA,UAAA,gBAAAzB;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,WAAU;AAAA,YAAA;AAAA,UACZ;AAAA,QAAA;AAAA,MACF;AAAA,MAGA,gBAAAA;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UACV,OAAO;AAAA,YACL,MAAM,GAAGkC,CAAU;AAAA,YACnB,OAAO,GAAGD,CAAO;AAAA,YACjB,QAAQ,GAAGR,EAAK,SAAS;AAAA,UAC3B;AAAA,QAAA;AAAA,MACF;AAAA,MAGA,gBAAAzB;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UACV,OAAO;AAAA,YACL,OAAO,GAAGkC,CAAU;AAAA,YACpB,QAAQ,GAAGT,EAAK,SAAS;AAAA,YACzB,WAAW;AAAA,YACX,cAAc;AAAA,YACd,YAAY;AAAA,UACd;AAAA,UAGA,UAAA,gBAAAzB;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,WAAU;AAAA,YAAA;AAAA,UACZ;AAAA,QAAA;AAAA,MACF;AAAA,IACF,EAAA,CAAA;AAAA,EAAA;AAKF,SAAA,gBAAAW;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,SAAS,CAACU,MAAM;AACd,QAAAA,EAAE,gBAAgB,GACT3C;MACX;AAAA,MACA,aAAa,CAAC2C,MAAM;AAElB,QAAI5C,KAAcqC,MAChBO,EAAE,gBAAgB,GAClBP,EAAYO,CAAC;AAAA,MAEjB;AAAA,MACA,WAAW,2BACT5C,IAAa,0EAA0E,EACzF;AAAA,MACA,OAAO;AAAA,QACL,MAAM,GAAGgD,EAAK,MAAM;AAAA,QACpB,KAAK,GAAGA,EAAK,MAAM;AAAA,QACnB,OAAO,GAAGE,CAAM;AAAA,QAChB,QAAQ,GAAGF,EAAK,SAAS;AAAA,QACzB,WAAW,UAAUG,CAAK;AAAA,QAC1B,iBAAiB;AAAA,QACjB,QAAQ;AAAA,QACR,QAAQnD,IAAa,SAAS;AAAA,QAC9B,eAAe;AAAA,MACjB;AAAA,MAEC,UAAA;AAAA,QAAAgD,EAAK,SAAS,SACbO,EAAW,sBAEV,OAAI,EAAA,WAAW,iBAAiBD,GAAA,CAAgB,6DAC9C,UAAAtD,KACE,gBAAAkC,EAAA,OAAA,EAAI,WAAU,yKACZ,UAAA;AAAA,UAAA9D,GAAY4E,EAAK,IAAI;AAAA,UAAE;AAAA,UAAI,KAAK,MAAME,CAAM;AAAA,UAAE;AAAA,QAAA,EAAA,CACjD,EAEJ,CAAA;AAAA,QAIDF,EAAK,SAAS,UAAUhD,KACtB,gBAAAkC,EAAA,OAAA,EAAI,WAAU,yKACZ,UAAA;AAAA,UAAA9D,GAAY4E,EAAK,IAAI;AAAA,UAAE;AAAA,UAAI,KAAK,MAAME,CAAM;AAAA,UAAE;AAAA,QAAA,GACjD;AAAA,QAIDlD,KAEG,gBAAAkC,EAAAY,IAAA,EAAA,UAAA;AAAA,UAAA,gBAAAvB;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,WAAU;AAAA,cACV,OAAO,EAAE,QAAQ6B,KAAiB;AAAA,cAClC,aAAa,CAACR,MAAM;AAClB,gBAAAA,EAAE,gBAAgB,GAClBK,KAAA,QAAAA,EAAeL,GAAG;AAAA,cACpB;AAAA,cACA,OAAM;AAAA,YAAA;AAAA,UACR;AAAA,UACA,gBAAArB;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,WAAU;AAAA,cACV,OAAO,EAAE,QAAQ6B,KAAiB;AAAA,cAClC,aAAa,CAACR,MAAM;AAClB,gBAAAA,EAAE,gBAAgB,GAClBK,KAAA,QAAAA,EAAeL,GAAG;AAAA,cACpB;AAAA,cACA,OAAM;AAAA,YAAA;AAAA,UACR;AAAA,QAAA,GACF;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAIR,GC7Kac,KAAqD,CAAC;AAAA,EACjE,SAAAC;AAAA,EACA,YAAA3D;AAAA,EACA,UAAAC;AAAA,EACA,aAAAoC;AACF,MAAM;AACJ,QAAM,CAACG,GAAYC,CAAa,IAAIC,EAAS,EAAK,GAE5CC,IAAkB,CAACC,MAAwB;AAC/C,IAAAH,EAAc,EAAI,GAClBJ,EAAYO,CAAC;AAEb,UAAMC,KAAgB,MAAM;AAC1B,MAAAJ,EAAc,EAAK,GACV,SAAA,oBAAoB,WAAWI,EAAa;AAAA,IAAA;AAG9C,aAAA,iBAAiB,WAAWA,EAAa;AAAA,EAAA,GAG9Ce,KAAgB,MAChBD,EAAQ,SAAS,WAEjB,gBAAAzB,EAAC,OAAI,EAAA,WAAU,sCAEb,UAAA;AAAA,IAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,6GACb,UAAA;AAAA,MAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,wGAAwG,CAAA;AAAA,MAEvH,gBAAAA,EAAC,SAAI,WAAU,0DAAyD,OAAO,EAAE,WAAW,oFAAoF;AAAA,IAAA,GAClL;AAAA,IAEA,gBAAAA,EAAC,SAAI,WAAU,yEACb,4BAAC,OAAI,EAAA,WAAU,oDAAmD,EACpE,CAAA;AAAA,EACF,EAAA,CAAA,IAIAoC,EAAQ,SAAS,WAEjB,gBAAAzB,EAAC,OAAI,EAAA,WAAU,sCAEb,UAAA;AAAA,IAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,8GAEb,UAAA;AAAA,MAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,sGAAsG,CAAA;AAAA,MAErH,gBAAAA,EAAC,OAAI,EAAA,WAAU,mIAAmI,CAAA;AAAA,MAClJ,gBAAAA,EAAC,OAAI,EAAA,WAAU,oIAAoI,CAAA;AAAA,MAEnJ,gBAAAA,EAAC,SAAI,WAAU,2CAA0C,OAAO,EAAE,WAAW,oCAAoC;AAAA,IAAA,GACnH;AAAA,IAEA,gBAAAA,EAAC,SAAI,WAAU,iGACb,4BAAC,OAAI,EAAA,WAAU,2BAA0B,EAC3C,CAAA;AAAA,EACF,EAAA,CAAA,IAIAoC,EAAQ,SAAS,WAEjB,gBAAAzB,EAAC,OAAI,EAAA,WAAU,mJAEZ,UAAA;AAAA,IAAC,CAAA,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,EAAE,IAAI,CAAC2B,MACvB,gBAAA3B;AAAA,MAAC;AAAA,MAAA;AAAA,QAEC,WAAU;AAAA,QACV,OAAO;AAAA,UACL,KAAK,GAAG2B,IAAO,KAAK;AAAA,UACpB,QAAQ;AAAA,UACR,WAAW;AAAA,QACb;AAAA,QAGA,UAAA;AAAA,UAAC,gBAAAtC,EAAA,OAAA,EAAI,WAAU,+EAA+E,CAAA;AAAA,UAE9F,gBAAAA,EAAC,OAAI,EAAA,WAAU,oEAAoE,CAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAX9EsC;AAAA,IAAA,CAaR;AAAA,IAEA,gBAAAtC,EAAA,OAAA,EAAI,WAAU,iGACb,UAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,sDACb,UAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,kCAAiC,MAAK,QAAO,QAAO,gBAAe,SAAQ,aACxF,UAAA,gBAAAA,EAAC,QAAK,EAAA,eAAc,SAAQ,gBAAe,SAAQ,aAAa,GAAG,GAAE,gBAAgB,CAAA,EACvF,CAAA,EACF,CAAA,GACF;AAAA,EACF,EAAA,CAAA,IAIG;AAIP,SAAA,gBAAAW;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW,oCAAqCM,IAA4C,KAA/B,4BAAiC,eAC5FxC,IAAa,mDAAmD,iBAClE;AAAA,MACA,OAAO;AAAA,QACL,MAAM,GAAG2D,EAAQ,CAAC;AAAA,QAClB,KAAK,GAAGA,EAAQ,CAAC;AAAA,QACjB,OAAO,GAAGA,EAAQ,KAAK;AAAA,QACvB,QAAQ,GAAGA,EAAQ,MAAM;AAAA,QACzB,WAAW,UAAUA,EAAQ,QAAQ;AAAA,QACrC,iBAAiB;AAAA,QACjB,YAAYnB,IAAa,cAAc;AAAA,QACvC,QAAQ;AAAA,MACV;AAAA,MACA,SAAS,CAACI,MAAM;AACd,QAAAA,EAAE,gBAAgB,GACT3C;MACX;AAAA,MACA,aAAa0C;AAAA,MAEZ,UAAA;AAAA,QAAciB,GAAA;AAAA,QAGd5D,KACE,gBAAAuB,EAAA,OAAA,EAAI,WAAU,4KACZ,YAAQ,MACX;AAAA,QAIDvB,KAEG,gBAAAkC,EAAAY,IAAA,EAAA,UAAA;AAAA,UAAC,gBAAAvB,EAAA,OAAA,EAAI,WAAU,yGAAyG,CAAA;AAAA,UACxH,gBAAAA,EAAC,OAAI,EAAA,WAAU,0GAA0G,CAAA;AAAA,UACzH,gBAAAA,EAAC,OAAI,EAAA,WAAU,4GAA4G,CAAA;AAAA,UAC3H,gBAAAA,EAAC,OAAI,EAAA,WAAU,6GAA6G,CAAA;AAAA,QAAA,GAC9H;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAIR,GChHMuC,KAAajG,IAENkG,KAAkC,CAAC;AAAA,EAC9C,QAAAC;AAAA,EACA,cAAAC;AAAA,EACA,YAAAC;AAAA,EACA,eAAAC;AAAA,EACA,eAAAC;AAAA,EACA,eAAAC;AAAA,EACA,YAAAC;AAAA,EACA,aAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,QAAAC;AAAA,EACA,QAAAC;AAAA,EACA,eAAAC;AAAA,EACA,qBAAAC;AACF,MAAM;AACJ,QAAM,CAACC,IAAgBC,EAAiB,IAAIC,GAAM,SAAwB,IAAI,GACxE,CAACC,GAAkBC,CAAmB,IAAIF,GAAM,SAAiB,EAAE,GACnE,CAACG,GAAWC,EAAY,IAAIJ,GAAM,SAA8C,QAAQ,GACxFK,KAAWL,GAAM,OAAyB,IAAI;AAGpD,EAAAA,GAAM,UAAU,MAAM;AAChB,IAAAF,MAAkBO,GAAS,YAC7BA,GAAS,QAAQ,SACjBA,GAAS,QAAQ;EACnB,GACC,CAACP,EAAc,CAAC;AAEb,QAAAQ,KAAoB,CAACC,MAAiB;AAC1C,IAAAR,GAAkBQ,EAAM,EAAE,GAC1BL,EAAoBK,EAAM,IAAI;AAAA,EAAA,GAG1BC,KAAsB,MAAM;AAC5B,IAAAV,MAAkBG,EAAiB,UACvBf,EAAAY,IAAgBG,EAAiB,KAAM,CAAA,GAEvDF,GAAkB,IAAI,GACtBG,EAAoB,EAAE;AAAA,EAAA,GAGlBO,KAAgB,CAAChD,MAA2B;AAC5C,IAAAA,EAAE,QAAQ,UACQ+C,OACX/C,EAAE,QAAQ,aACnBsC,GAAkB,IAAI,GACtBG,EAAoB,EAAE;AAAA,EACxB;AAIA,SAAA,gBAAAnD,EAAC,OAAI,EAAA,WAAU,8FACb,UAAA;AAAA,IAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,uEACb,UAAA;AAAA,MAAC,gBAAAX,EAAA,MAAA,EAAG,WAAU,6BAA4B,UAAmB,uBAAA;AAAA,MAC5D,gBAAAA,EAAA,KAAA,EAAE,WAAU,iCAAgC,UAA0B,8BAAA;AAAA,IAAA,GACzE;AAAA,IAEA,gBAAAW,EAAC,OAAI,EAAA,WAAU,4CACb,UAAA;AAAA,MAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,0DACb,UAAA;AAAA,QAAC,gBAAAA,EAAA,MAAA,EAAG,WAAU,uFACZ,UAAA;AAAA,UAAC,gBAAAX,EAAAsE,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,UAAE;AAAA,UACxB7B,EAAO;AAAA,UAAO;AAAA,QAAA,GAC9B;AAAA,QACA,gBAAA9B,EAAC,OAAI,EAAA,WAAU,sBACb,UAAA;AAAA,UAAA,gBAAAX;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS2C;AAAA,cACT,WAAU;AAAA,cACV,OAAM;AAAA,cAEN,UAAA,gBAAA3C,EAACuE,IAAK,EAAA,WAAU,kBAAkB,CAAA;AAAA,YAAA;AAAA,UACpC;AAAA,UACA,gBAAAvE;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS4C;AAAA,cACT,UAAUH,EAAO,UAAU;AAAA,cAC3B,WAAU;AAAA,cACV,OAAM;AAAA,cAEN,UAAA,gBAAAzC,EAACwE,IAAM,EAAA,WAAU,kBAAkB,CAAA;AAAA,YAAA;AAAA,UACrC;AAAA,QAAA,GACF;AAAA,MAAA,GACF;AAAA,wBAEC,OAAI,EAAA,WAAU,8CACZ,UAAO/B,EAAA,IAAI,CAAC0B,MACX,gBAAAxD;AAAA,QAAC;AAAA,QAAA;AAAA,UAEC,WAAW,0EACTwD,EAAM,WACF,+DACA,2DACN;AAAA,UACA,SAAS,MAAM;AACT,YAAAT,OAAmBS,EAAM,MAC3BtB,EAAcsB,EAAM,EAAE;AAAA,UAE1B;AAAA,UACA,eAAe,MAAMD,GAAkBC,CAAK;AAAA,UAE5C,UAAA;AAAA,YAAC,gBAAAxD,EAAA,OAAA,EAAI,WAAU,cACZ,UAAA;AAAA,cAAA+C,OAAmBS,EAAM,KACxB,gBAAAnE;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,KAAKiE;AAAA,kBACL,MAAK;AAAA,kBACL,OAAOJ;AAAA,kBACP,UAAU,CAACxC,OAAMyC,EAAoBzC,GAAE,OAAO,KAAK;AAAA,kBACnD,QAAQ+C;AAAA,kBACR,WAAWC;AAAA,kBACX,WAAU;AAAA,kBACV,SAAS,CAAChD,OAAMA,GAAE,gBAAgB;AAAA,gBAAA;AAAA,cAAA,IAGnC,gBAAArB,EAAA,OAAA,EAAI,WAAU,sCAAsC,YAAM,MAAK;AAAA,cAElE,gBAAAW,EAAC,OAAI,EAAA,WAAU,wCACZ,UAAA;AAAA,gBAAAwD,EAAM,OAAO;AAAA,gBAAO;AAAA,gBAAUA,EAAM,OAAO;AAAA,gBAAO;AAAA,cAAA,GACrD;AAAA,YAAA,GACF;AAAA,YACCA,EAAM,YAAa,gBAAAnE,EAAA,OAAA,EAAI,WAAU,oDAAmD;AAAA,UAAA;AAAA,QAAA;AAAA,QAhChFmE,EAAM;AAAA,MAkCd,CAAA,GACH;AAAA,IAAA,GACF;AAAA,sBAGC,OAAI,EAAA,WAAU,oCACb,UAAC,gBAAAxD,EAAA,OAAA,EAAI,WAAU,YACb,UAAA;AAAA,MAAA,gBAAAA;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,SAAS,MAAMqD,GAAa,QAAQ;AAAA,UACpC,WAAW,gGACTD,MAAc,WACV,4DACA,4CACN;AAAA,UAEA,UAAA;AAAA,YAAC,gBAAA/D,EAAAyE,IAAA,EAAW,WAAU,kBAAkB,CAAA;AAAA,YAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAE5C;AAAA,MACA,gBAAA9D;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,SAAS,MAAMqD,GAAa,SAAS;AAAA,UACrC,WAAW,gGACTD,MAAc,YACV,0DACA,4CACN;AAAA,UAEA,UAAA;AAAA,YAAC,gBAAA/D,EAAA0E,IAAA,EAAQ,WAAU,kBAAkB,CAAA;AAAA,YAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAEzC;AAAA,MACA,gBAAA/D;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,SAAS,MAAMqD,GAAa,YAAY;AAAA,UACxC,WAAW,gGACTD,MAAc,eACV,sDACA,4CACN;AAAA,UAEA,UAAA;AAAA,YAAC,gBAAA/D,EAAA2E,IAAA,EAAK,WAAU,kBAAkB,CAAA;AAAA,YAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAEtC;AAAA,IAAA,EAAA,CACF,EACF,CAAA;AAAA,IAGCZ,MAAc,YACZ,gBAAApD,EAAA,OAAA,EAAI,WAAU,4CACb,UAAA;AAAA,MAAC,gBAAAX,EAAA,MAAA,EAAG,WAAU,wDAAuD,UAAU,cAAA;AAAA,MAC9E,gBAAAA,EAAA,OAAA,EAAI,WAAU,kCACZ,UAAO,OAAA,QAAQ7D,EAAY,EAAE,IAAI,CAAC,CAAC2B,GAAOiD,EAAI,MAC7C,gBAAAJ;AAAA,QAAC;AAAA,QAAA;AAAA,UAEC,SAAS,MAAMoC,EAAWjF,CAAuB;AAAA,UACjD,WAAU;AAAA,UAEV,UAAA;AAAA,YAAC,gBAAAkC,EAAAe,IAAA,EAAK,WAAU,mCAAmC,CAAA;AAAA,YAClD,gBAAAf,EAAA,QAAA,EAAK,WAAU,gEAAgE,UAAMlC,GAAA;AAAA,UAAA;AAAA,QAAA;AAAA,QALjFA;AAAA,MAOR,CAAA,GACH;AAAA,IAAA,GACF;AAAA,IAIDiG,MAAc,aACZ,gBAAApD,EAAA,OAAA,EAAI,WAAU,4CACb,UAAA;AAAA,MAAC,gBAAAX,EAAA,MAAA,EAAG,WAAU,wDAAuD,UAAW,eAAA;AAAA,MAChF,gBAAAA,EAAC,OAAI,EAAA,WAAU,iBACX,UAAA,OAAO,KAAKrD,EAAa,EAAmB,IAAI,CAACiI,MAAe;AAC1D,cAAA7D,KAAOxE,GAAaqI,CAAU,GAC9B5D,IAASpE,GAAcgI,CAAU,GACjCC,IAAQlI,GAAciI,CAAU;AAGpC,eAAA,gBAAAjE;AAAA,UAAC;AAAA,UAAA;AAAA,YAEC,SAAS,MAAMqC,GAAY4B,CAAU;AAAA,YACrC,WAAW,cAAc5D,EAAO,EAAE,aAAaA,EAAO,MAAM;AAAA,YAE5D,UAAA;AAAA,cAAA,gBAAAhB,EAAC,OAAI,EAAA,WAAU,sCACb,UAAA,gBAAAA,EAACe,IAAK,EAAA,WAAW,WAAWC,EAAO,IAAI,IAAI,aAAa,IAAK,CAAA,GAC/D;AAAA,cACA,gBAAAL,EAAC,OAAI,EAAA,WAAU,4BACb,UAAA;AAAA,gBAAA,gBAAAX,EAAC,UAAK,WAAW,uBAAuBgB,EAAO,IAAI,IAAK,UAAM6D,GAAA;AAAA,gBAC7D,gBAAA7E,EAAA,OAAA,EAAI,WAAU,oCAAmC,UAAqB,yBAAA;AAAA,cAAA,GACzE;AAAA,YAAA;AAAA,UAAA;AAAA,UAVK4E;AAAA,QAAA;AAAA,MAaV,CAAA,GACH;AAAA,IAAA,GACF;AAAA,IAIDb,MAAc,gBACZ,gBAAApD,EAAA,OAAA,EAAI,WAAU,4CAEb,UAAA;AAAA,MAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,YACb,UAAA;AAAA,QAAC,gBAAAX,EAAA,MAAA,EAAG,WAAU,wDAAuD,UAAU,cAAA;AAAA,QAC/E,gBAAAA,EAAC,OAAI,EAAA,WAAU,iBACX,UAAA,CAAC,QAAQ,QAAQ,QAAQ,EAAiB,IAAI,CAAC8E,MAAa;AACtD,gBAAA/D,KAAOjE,GAAWgI,CAAQ,GAC1BD,IAAQhI,GAAYiI,CAAQ;AAShC,iBAAA,gBAAAnE;AAAA,YAAC;AAAA,YAAA;AAAA,cAEC,SAAS,MAAMsC,EAAmB6B,CAAQ;AAAA,cAC1C,WAAW,mGAVM;AAAA,gBACnB,MAAM;AAAA,gBACN,MAAM;AAAA,gBACN,QAAQ;AAAA,cAAA,EAOqHA,CAAQ,CAAC;AAAA,cAEpI,UAAA;AAAA,gBAAA,gBAAA9E,EAACe,IAAK,EAAA,WAAU,mBAAkB,aAAa,KAAK;AAAA,gBACnD,gBAAAf,EAAA,QAAA,EAAK,WAAU,iCAAiC,UAAM6E,GAAA;AAAA,cAAA;AAAA,YAAA;AAAA,YALlDC;AAAA,UAAA;AAAA,QAQV,CAAA,GACH;AAAA,MAAA,GACF;AAAA,wBAGC,OACC,EAAA,UAAA;AAAA,QAAC,gBAAA9E,EAAA,MAAA,EAAG,WAAU,wDAAuD,UAAY,gBAAA;AAAA,QACjF,gBAAAA,EAAC,OAAI,EAAA,WAAU,iBACX,UAAA,CAAC,UAAU,UAAU,QAAQ,EAAyB,IAAI,CAAC+E,MAAgB;AACrE,gBAAAhE,KAAO7D,GAAoB6H,CAAW,GACtC/D,IAAS3D,GAAqB0H,CAAW,GACzCF,IAAQ5H,GAAqB8H,CAAW;AAG5C,iBAAA,gBAAApE;AAAA,YAAC;AAAA,YAAA;AAAA,cAEC,SAAS,MAAMuC,GAAkB6B,CAAW;AAAA,cAC5C,WAAW,cAAc/D,EAAO,EAAE,aAAaA,EAAO,MAAM;AAAA,cAE5D,UAAA;AAAA,gBAAA,gBAAAhB,EAAC,OAAI,EAAA,WAAU,iCACb,UAAA,gBAAAA,EAACe,IAAK,EAAA,WAAW,WAAWC,EAAO,IAAI,IAAI,aAAa,IAAK,CAAA,GAC/D;AAAA,kCACC,QAAK,EAAA,WAAW,yBAAyBA,EAAO,IAAI,IAAK,UAAM6D,GAAA;AAAA,cAAA;AAAA,YAAA;AAAA,YAP3DE;AAAA,UAAA;AAAA,QAUV,CAAA,GACH;AAAA,MAAA,GACF;AAAA,IAAA,GACF;AAAA,IAGDvB,KACC,gBAAA7C,EAAC,OAAI,EAAA,WAAU,4CACb,UAAA;AAAA,MAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,0DACb,UAAA;AAAA,QAAC,gBAAAX,EAAA,MAAA,EAAG,WAAU,+CAA8C,UAAgB,oBAAA;AAAA,QAC5E,gBAAAW,EAAC,OAAI,EAAA,WAAU,sBACb,UAAA;AAAA,UAAA,gBAAAX;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAASmD;AAAA,cACT,WAAU;AAAA,cACV,OAAM;AAAA,cAEN,UAAA,gBAAAnD,EAACgF,IAAS,EAAA,WAAU,kBAAkB,CAAA;AAAA,YAAA;AAAA,UACxC;AAAA,UACA,gBAAAhF;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAASoD;AAAA,cACT,WAAU;AAAA,cACV,OAAM;AAAA,cAEN,UAAA,gBAAApD,EAACuE,IAAK,EAAA,WAAU,kBAAkB,CAAA;AAAA,YAAA;AAAA,UACpC;AAAA,UACA,gBAAAvE;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAASqD;AAAA,cACT,WAAU;AAAA,cACV,OAAM;AAAA,cAEN,UAAA,gBAAArD,EAACiF,IAAO,EAAA,WAAU,kBAAkB,CAAA;AAAA,YAAA;AAAA,UACtC;AAAA,QAAA,GACF;AAAA,MAAA,GACF;AAAA,MAEA,gBAAAtE,EAAC,OAAI,EAAA,WAAU,+CACb,UAAA;AAAA,QAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,kCACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OACC,EAAA,UAAA;AAAA,YAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,iEAAgE,UAAI,QAAA;AAAA,YAClF,gBAAAA,EAAA,OAAA,EAAI,WAAU,uCAAuC,YAAc,MAAK;AAAA,UAAA,GAC3E;AAAA,4BACC,OACC,EAAA,UAAA;AAAA,YAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iEAAgE,UAAK,SAAA;AAAA,YACnF,gBAAAA,EAAA,OAAA,EAAI,WAAU,sDAAsD,YAAc,OAAM;AAAA,UAAA,GAC3F;AAAA,4BACC,OACC,EAAA,UAAA;AAAA,YAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iEAAgE,UAAI,QAAA;AAAA,8BAClF,OAAI,EAAA,WAAU,uCAAuC,UAAWuC,GAAAiB,EAAc,IAAI,GAAE;AAAA,UAAA,GACvF;AAAA,4BACC,OACC,EAAA,UAAA;AAAA,YAAC,gBAAAxD,EAAA,OAAA,EAAI,WAAU,iEAAgE,UAAK,SAAA;AAAA,YACnF,gBAAAA,EAAA,OAAA,EAAI,WAAU,uCAAuC,aAAoB,QAAO;AAAA,UAAA,GACnF;AAAA,QAAA,GACF;AAAA,0BAEC,OAAI,EAAA,WAAU,wEACb,UAAC,gBAAAW,EAAA,KAAA,EAAE,WAAU,iCAAgC,UAAA;AAAA,UAAA;AAAA,UACvC,gBAAAX,EAAA,QAAA,EAAK,WAAU,qBAAoB,UAAI,QAAA;AAAA,UAAO;AAAA,UAAU,gBAAAA,EAAA,QAAA,EAAK,WAAU,qBAAoB,UAAa,iBAAA;AAAA,UAAO;AAAA,QAAA,EAAA,CACrH,EACF,CAAA;AAAA,MAAA,GACF;AAAA,IAAA,GACF;AAAA,IAGF,gBAAAW,EAAC,OAAI,EAAA,WAAU,iCACb,UAAA;AAAA,MAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,yCACb,UAAA;AAAA,QAAC,gBAAAX,EAAA,MAAA,EAAG,WAAU,4DAA2D,UAAmB,uBAAA;AAAA,QAC5F,gBAAAW,EAAC,OAAI,EAAA,WAAU,8CACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OACC,EAAA,UAAA;AAAA,YAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,qBAAoB,UAAM,UAAA;AAAA,8BACxC,OAAI,EAAA,WAAU,8CACZ,WAAc0C,KAAA,gBAAAA,EAAA,OAAO,WAAU,GAClC;AAAA,UAAA,GACF;AAAA,4BACC,OACC,EAAA,UAAA;AAAA,YAAC,gBAAA1C,EAAA,OAAA,EAAI,WAAU,qBAAoB,UAAW,eAAA;AAAA,8BAC7C,OAAI,EAAA,WAAU,4CACZ,WAAc0C,KAAA,gBAAAA,EAAA,OAAO,WAAU,GAClC;AAAA,UAAA,GACF;AAAA,QAAA,GACF;AAAA,MAAA,GACF;AAAA,MAEA,gBAAA/B,EAAC,OAAI,EAAA,WAAU,sBACb,UAAA;AAAA,QAAA,gBAAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAAS2C;AAAA,YACT,WAAU;AAAA,YAEV,UAAA;AAAA,cAAC,gBAAAtD,EAAAkF,IAAA,EAAK,WAAU,kBAAkB,CAAA;AAAA,cAAE;AAAA,YAAA;AAAA,UAAA;AAAA,QAEtC;AAAA,QACA,gBAAAvE;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAAS4C;AAAA,YACT,WAAU;AAAA,YAEV,UAAA;AAAA,cAAC,gBAAAvD,EAAAmF,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,cAAE;AAAA,YAAA;AAAA,UAAA;AAAA,QAExC;AAAA,MAAA,GACF;AAAA,IAAA,GACF;AAAA,EACF,EAAA,CAAA;AAEJ,GC5WM5C,KAAajG,IACb8I,KAAkC,CAAC,OAAO,SAAS,UAAU,MAAM,GACnEC,KAA2B,CAAC,SAAS,UAAU,OAAO,GAE/CC,KAAkC,CAAC;AAAA,EAC9C,UAAAC;AAAA,EACA,eAAA/B;AAAA,EACA,gBAAAgC;AAAA,EACA,cAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,qBAAAjC;AAAA,EACA,cAAAkC;AAAA,EACA,YAAAC;AAAA,EACA,eAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,cAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,uBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,0BAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,aAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,YAAAC;AAAA,EACA,YAAAC;AAAA,EACA,aAAAC;AAAA,EACA,WAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,qBAAAC;AACF,MAAM;AACE,QAAAC,KAAeC,GAA8B,IAAI,GACjDC,IAAcD,GAA8B,IAAI,GAChDE,IAAoBF,GAA8B,IAAI,GACtDG,IAA0BH,GAA8B,IAAI,GAC5D,CAACI,GAAiBC,CAAkB,IAAIvG,EAAS,EAAK,GACtD,CAACwG,GAAgBC,CAAiB,IAAIzG,EAAS,EAAK,GACpD,CAAC0G,GAAsBC,CAAuB,IAAI3G,EAAS,EAAK,GAChE,CAAC4G,GAA4BC,EAA6B,IAAI7G,EAAS,EAAK,GAC5E,CAAC8G,GAAeC,EAAgB,IAAI/G,EAAS,EAAK,GAClD,CAACgH,IAAaC,CAAc,IAAIjH,EAAS,EAAE,GAC3C,CAACkH,GAAcC,CAAe,IAAInH,EAAS,EAAE,GAC7C,CAACoH,GAAaC,EAAc,IAAIrH,EAAS,GAAG,GAC5C,CAACsH,GAAcC,EAAe,IAAIvH,EAAS,EAAE,GAC7C,CAACwH,GAAmBC,CAAoB,IAAIzH,EAAS,EAAE,GACvD,CAAC0H,GAAoBC,EAAqB,IAAI3H,EAAS,EAAE;AAE/D,SAAA4H,GAAU,MAAM;AACR,UAAAC,IAAqB,CAAC/I,MAAsB;AAC5C,MAAAmH,GAAa,WAAW,CAACA,GAAa,QAAQ,SAASnH,EAAM,MAAc,KAC7EyH,EAAmB,EAAK,GAEtBJ,EAAY,WAAW,CAACA,EAAY,QAAQ,SAASrH,EAAM,MAAc,KAC3E2H,EAAkB,EAAK,GAErBL,EAAkB,WAAW,CAACA,EAAkB,QAAQ,SAAStH,EAAM,MAAc,KACvF6H,EAAwB,EAAK,GAE3BN,EAAwB,WAAW,CAACA,EAAwB,QAAQ,SAASvH,EAAM,MAAc,KACnG+H,GAA8B,EAAK;AAAA,IACrC;AAGO,oBAAA,iBAAiB,aAAagB,CAAkB,GAClD,MAAM,SAAS,oBAAoB,aAAaA,CAAkB;AAAA,EAC3E,GAAG,CAAE,CAAA,GAELD,GAAU,MAAM;AACd,IAAKvF,KAMH4E,EAAe5E,EAAc,KAAK,GAClC8E,EAAgB9E,EAAc,MAAM,MANpCkE,EAAmB,EAAK,GACxBE,EAAkB,EAAK,GACvBM,GAAiB,EAAK,IAOnB1C,KAIHgD,GAAehD,EAAe,KAAK,GACnCkD,GAAgBlD,EAAe,MAAM,KAJrCsC,EAAwB,EAAK,GAO1BpC,KAIHkD,EAAqBlD,EAAqB,KAAK,GAC/CoD,GAAsBpD,EAAqB,MAAM,KAJjDsC,GAA8B,EAAK;AAAA,EAMpC,GAAA,CAACxE,GAAegC,GAAgBE,CAAoB,CAAC,qBAGrD,OAAI,EAAA,WAAU,4EACb,UAAC,gBAAA/E,EAAA,OAAA,EAAI,WAAU,gFAEb,UAAA;AAAA,IAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,qDAEb,UAAA;AAAA,MAAA,gBAAAA;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,SAASgF;AAAA,UACT,WAAW,mFACTJ,IACI,uDACA,6CACN;AAAA,UACA,OAAOA,IAAW,cAAc;AAAA,UAE/B,UAAA;AAAA,YAAWA,IAAA,gBAAAvF,EAACiJ,MAAI,WAAU,kBAAA,CAAkB,IAAM,gBAAAjJ,EAAAkJ,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,YACtF,gBAAAlJ,EAAC,UAAK,UAAI,OAAA,CAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MACZ;AAAA,MAECwD,KAEG,gBAAA7C,EAAAY,IAAA,EAAA,UAAA;AAAA,QAAC,gBAAAvB,EAAA,OAAA,EAAI,WAAU,+BAA+B,CAAA;AAAA,QAG7C,gBAAAW,EAAA,OAAA,EAAI,KAAKyG,IAAc,WAAU,gBAChC,UAAA;AAAA,UAAA,gBAAAzG;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAM;AACb,gBAAA+G,EAAmB,CAACD,CAAe,GACnCG,EAAkB,EAAK;AAAA,cACzB;AAAA,cACA,WAAU;AAAA,cAEV,UAAA;AAAA,gBAAC,gBAAA5H,EAAAE,IAAA,EAAS,WAAU,kBAAkB,CAAA;AAAA,gBACtC,gBAAAF,EAAC,UAAK,UAAa,gBAAA,CAAA;AAAA,gBAClB,gBAAAA,EAAA,QAAA,EAAK,WAAU,8DACb,YAAoB,QACvB;AAAA,cAAA;AAAA,YAAA;AAAA,UACF;AAAA,UAECyH,KACC,gBAAA9G,EAAC,OAAI,EAAA,WAAU,qJACb,UAAA;AAAA,YAAA,gBAAAX,EAAC,SAAI,WAAU,iFACb,UAAC,gBAAAW,EAAA,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,cAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,uCACb,UAAA;AAAA,gBAAC,gBAAAX,EAAAE,IAAA,EAAS,WAAU,kBAAkB,CAAA;AAAA,gBACrC,gBAAAF,EAAA,QAAA,EAAK,WAAU,iCAAgC,UAAe,mBAAA;AAAA,cAAA,GACjE;AAAA,cACA,gBAAAW,EAAC,QAAK,EAAA,WAAU,yDAAwD,UAAA;AAAA,gBAAA;AAAA,gBAC9D8C,EAAoB;AAAA,cAAA,GAC9B;AAAA,YAAA,EAAA,CACF,EACF,CAAA;AAAA,YAEA,gBAAA9C,EAAC,OAAI,EAAA,WAAU,yBACZ,UAAA;AAAA,cAAeyE,GAAA,IAAI,CAAChG,MAAa;AAChC,sBAAM+J,IAAe1F,EAAoB,OAAO,OAAK2F,EAAE,aAAahK,CAAQ,EAAE,QACxEiK,KAAc5F,EAAoB,KAAK,CAAK2F,MAAAA,EAAE,aAAahK,CAAQ,GACnEkK,KAAcD,MAAA,gBAAAA,GAAa,SAAQ;AAGvC,uBAAA,gBAAA1I;AAAA,kBAAC;AAAA,kBAAA;AAAA,oBAEC,WAAU;AAAA,oBAEV,UAAA;AAAA,sBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,wBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,uCACb,UAAA;AAAA,0BAAA,gBAAAX,EAAC,OAAI,EAAA,WAAU,kLACZ,UAAAZ,EAAS,CAAC,GACb;AAAA,4CACC,OACC,EAAA,UAAA;AAAA,4BAAC,gBAAAY,EAAA,OAAA,EAAI,WAAU,gEAAgE,UAASZ,GAAA;AAAA,4BACxF,gBAAAuB,EAAC,OAAI,EAAA,WAAU,iCAAiC,UAAA;AAAA,8BAAAwI;AAAA,8BAAa;AAAA,8BAAOA,MAAiB,IAAI,MAAM;AAAA,4BAAA,GAAG;AAAA,0BAAA,GACpG;AAAA,wBAAA,GACF;AAAA,wBACA,gBAAAxI,EAAC,OAAI,EAAA,WAAU,uCACb,UAAA;AAAA,0BAAA,gBAAAX;AAAA,4BAAC;AAAA,4BAAA;AAAA,8BACC,SAAS,MAAM6F,EAAczG,CAAQ;AAAA,8BACrC,UAAU+J,MAAiB;AAAA,8BAC3B,WAAU;AAAA,8BACV,OAAM;AAAA,8BAEN,UAAA,gBAAAnJ,EAACwE,IAAM,EAAA,WAAU,kBAAkB,CAAA;AAAA,4BAAA;AAAA,0BACrC;AAAA,0BACA,gBAAAxE;AAAA,4BAAC;AAAA,4BAAA;AAAA,8BACC,SAAS,MAAM4F,GAAWxG,CAAQ;AAAA,8BAClC,WAAU;AAAA,8BACV,OAAM;AAAA,8BAEN,UAAA,gBAAAY,EAACuE,IAAK,EAAA,WAAU,kBAAkB,CAAA;AAAA,4BAAA;AAAA,0BACpC;AAAA,wBAAA,GACF;AAAA,sBAAA,GACF;AAAA,sBAGC4E,IAAe,KACb,gBAAAxI,EAAA,OAAA,EAAI,WAAU,6CACb,UAAA;AAAA,wBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,0DACb,UAAA;AAAA,0BAAC,gBAAAX,EAAA,QAAA,EAAK,WAAU,iDAAgD,UAAU,cAAA;AAAA,0BAC1E,gBAAAW,EAAC,QAAK,EAAA,WAAU,4CAA4C,UAAA;AAAA,4BAAA2I;AAAA,4BAAY;AAAA,0BAAA,GAAE;AAAA,wBAAA,GAC5E;AAAA,wBACA,gBAAAtJ;AAAA,0BAAC;AAAA,0BAAA;AAAA,4BACC,MAAK;AAAA,4BACL,KAAI;AAAA,4BACJ,KAAI;AAAA,4BACJ,OAAOsJ;AAAA,4BACP,UAAU,CAACjI,MAAMqF,KAAA,gBAAAA,EAAoBtH,GAAU,SAASiC,EAAE,OAAO,KAAK;AAAA,4BACtE,WAAU;AAAA,4BACV,OAAO;AAAA,8BACL,YAAY,sEAAuEiI,IAAc,MAAM,KAAM,GAAG,0BAA2BA,IAAc,MAAM,KAAM,GAAG;AAAA,4BAC1K;AAAA,0BAAA;AAAA,wBACF;AAAA,sBAAA,GACF;AAAA,oBAAA;AAAA,kBAAA;AAAA,kBAlDGlK;AAAA,gBAAA;AAAA,cAoDP,CAEH;AAAA,cAGD,gBAAAuB;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,SAAS,MAAMgG,MAAA,gBAAAA;AAAA,kBACf,WAAU;AAAA,kBAEV,UAAA;AAAA,oBAAC,gBAAA3G,EAAAuJ,IAAA,EAAU,WAAU,kBAAkB,CAAA;AAAA,oBACvC,gBAAAvJ,EAAC,UAAK,UAAe,kBAAA,CAAA;AAAA,kBAAA;AAAA,gBAAA;AAAA,cACvB;AAAA,YAAA,GACF;AAAA,UAAA,GACF;AAAA,QAAA,GAEJ;AAAA,QAGC,gBAAAW,EAAA,OAAA,EAAI,KAAK2G,GAAa,WAAU,gBAC/B,UAAA;AAAA,UAAA,gBAAA3G;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAM;AACb,gBAAAiH,EAAkB,CAACD,CAAc,GACjCD,EAAmB,EAAK;AAAA,cAC1B;AAAA,cACA,WAAU;AAAA,cAEV,UAAA;AAAA,gBAAC,gBAAA1H,EAAA5D,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,kCACnC,QAAK,EAAA,UAAA;AAAA,kBAAA;AAAA,kBAAOmG,GAAWiB,EAAc,IAAI;AAAA,gBAAA,GAAE;AAAA,cAAA;AAAA,YAAA;AAAA,UAC9C;AAAA,UAECmE,KACC,gBAAAhH,EAAC,OAAI,EAAA,WAAU,qJACb,UAAA;AAAA,YAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,qFACb,UAAA,gBAAAA,EAAC,UAAK,WAAU,iCAAgC,wBAAU,EAC5D,CAAA;AAAA,YAGA,gBAAAW,EAAC,OAAI,EAAA,WAAU,yBACb,UAAA;AAAA,cAAA,gBAAAX,EAAC,SAAI,WAAU,sBACZ,UAAYqF,GAAA,IAAI,CAACmE,MAAe;AACzB,sBAAAC,IAAWjG,EAAc,SAASgG;AAEtC,uBAAA,gBAAAxJ;AAAA,kBAAC;AAAA,kBAAA;AAAA,oBAEC,SAAS,MAAM;AACb,sBAAA8F,GAAkB0D,CAAU,GAC5BtB,GAAiB,EAAK;AAAA,oBACxB;AAAA,oBACA,WAAW,kEACTuB,KAAY,CAACxB,IACT,wCACA,6CACN;AAAA,oBAEC,aAAWuB,CAAU;AAAA,kBAAA;AAAA,kBAXjBA;AAAA,gBAAA;AAAA,cAcV,CAAA,GACH;AAAA,cAGA,gBAAA7I;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,SAAS,MAAMuH,GAAiB,CAACD,CAAa;AAAA,kBAC9C,WAAW,gFACTA,IACI,uCACA,yGACN;AAAA,kBAEA,UAAA;AAAA,oBAAC,gBAAAtH,EAAA,OAAA,EAAI,WAAU,uCACb,UAAA;AAAA,sBAAC,gBAAAX,EAAA,QAAA,EAAK,WAAU,iCAAgC,UAAQ,YAAA;AAAA,sBACvD,gBAAAA,EAAA,QAAA,EAAK,WAAU,qDAAoD,UAAM,UAAA;AAAA,oBAAA,GAC5E;AAAA,sCACC0J,IAAa,EAAA,WAAW,gCAAgCzB,IAAgB,cAAc,EAAE,IAAI;AAAA,kBAAA;AAAA,gBAAA;AAAA,cAC/F;AAAA,cAGA,gBAAAjI,EAAC,OAAI,EAAA,WAAW,2DACdiI,IAAgB,yBAAyB,mBAC3C,IACE,UAAA,gBAAAtH,EAAC,OAAI,EAAA,WAAU,2DAEb,UAAA;AAAA,gBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iBACb,UAAA;AAAA,kBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,oBAAC,gBAAAX,EAAA,SAAA,EAAM,WAAU,mFAAkF,UAEnG,SAAA;AAAA,oBACA,gBAAAW,EAAC,QAAK,EAAA,WAAU,2FACb,UAAA;AAAA,sBAAAwH;AAAA,sBAAY;AAAA,oBAAA,GACf;AAAA,kBAAA,GACF;AAAA,kBACA,gBAAAnI;AAAA,oBAAC;AAAA,oBAAA;AAAA,sBACC,MAAK;AAAA,sBACL,KAAI;AAAA,sBACJ,KAAI;AAAA,sBACJ,MAAK;AAAA,sBACL,OAAOmI;AAAA,sBACP,UAAU,CAAC9G,MAAM;AACf,8BAAMsI,IAAW,SAAStI,EAAE,OAAO,KAAK;AACxC,wBAAA+G,EAAeuB,CAAQ,GACvB3D,EAAkB2D,GAAUtB,CAAY;AAAA,sBAC1C;AAAA,sBACA,WAAU;AAAA,sBACV,OAAO;AAAA,wBACL,YAAY,sEAAuEF,KAAc,MAAM,MAAO,GAAG,0BAA2BA,KAAc,MAAM,MAAO,GAAG;AAAA,sBAC5K;AAAA,oBAAA;AAAA,kBACF;AAAA,gBAAA,GACF;AAAA,gBAGA,gBAAAxH,EAAC,OAAI,EAAA,WAAU,iBACb,UAAA;AAAA,kBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,oBAAC,gBAAAX,EAAA,SAAA,EAAM,WAAU,mFAAkF,UAEnG,UAAA;AAAA,oBACA,gBAAAW,EAAC,QAAK,EAAA,WAAU,2FACb,UAAA;AAAA,sBAAA0H;AAAA,sBAAa;AAAA,oBAAA,GAChB;AAAA,kBAAA,GACF;AAAA,kBACA,gBAAArI;AAAA,oBAAC;AAAA,oBAAA;AAAA,sBACC,MAAK;AAAA,sBACL,KAAI;AAAA,sBACJ,KAAI;AAAA,sBACJ,MAAK;AAAA,sBACL,OAAOqI;AAAA,sBACP,UAAU,CAAChH,MAAM;AACf,8BAAMuI,IAAY,SAASvI,EAAE,OAAO,KAAK;AACzC,wBAAAiH,EAAgBsB,CAAS,GACzB5D,EAAkBmC,IAAayB,CAAS;AAAA,sBAC1C;AAAA,sBACA,WAAU;AAAA,sBACV,OAAO;AAAA,wBACL,YAAY,sEAAuEvB,IAAe,MAAM,MAAO,GAAG,0BAA2BA,IAAe,MAAM,MAAO,GAAG;AAAA,sBAC9K;AAAA,oBAAA;AAAA,kBACF;AAAA,gBAAA,GACF;AAAA,gBAGC,gBAAArI,EAAA,KAAA,EAAE,WAAU,iDAAgD,UAE7D,mCAAA;AAAA,cAAA,EAAA,CACF,EACF,CAAA;AAAA,YAAA,GACF;AAAA,UAAA,GACF;AAAA,QAAA,GAEJ;AAAA,QAGA,gBAAAW,EAAC,OAAI,EAAA,WAAU,sHACb,UAAA;AAAA,UAAC,gBAAAX,EAAA,QAAA,EAAK,WAAU,mFAAkF,UAAK,SAAA;AAAA,UACvG,gBAAAA;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,MAAK;AAAA,cACL,OAAOwD,EAAc;AAAA,cACrB,UAAU,CAACvD,MAAU8F,EAAkB9F,EAAM,OAAO,KAAK;AAAA,cACzD,WAAU;AAAA,cACV,aAAY;AAAA,YAAA;AAAA,UACd;AAAA,QAAA,GACF;AAAA,MAAA,GACF;AAAA,MAIDuF,KAEG,gBAAA7E,EAAAY,IAAA,EAAA,UAAA;AAAA,QAAC,gBAAAvB,EAAA,OAAA,EAAI,WAAU,+BAA+B,CAAA;AAAA,QAG7C,gBAAAW,EAAA,OAAA,EAAI,KAAK4G,GAAmB,WAAU,gBACrC,UAAA;AAAA,UAAA,gBAAA5G;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAMmH,EAAwB,CAACD,CAAoB;AAAA,cAC5D,WAAW,wBACTrC,EAAe,SAAS,QAAQ,mDAChCA,EAAe,SAAS,YAAY,mDACpC,4CACF;AAAA,cAEE,UAAA;AAAA,iBAAM,MAAA;AACA,wBAAAzE,IAAOxE,GAAaiJ,EAAe,IAAI;AACtC,yBAAA,gBAAAxF,EAACe,GAAK,EAAA,WAAU,kBAAkB,CAAA;AAAA,gBAAA,GACxC;AAAA,kCACF,QAAK,EAAA,UAAA;AAAA,kBAAA;AAAA,kBAAQpE,GAAc6I,EAAe,IAAI;AAAA,gBAAA,GAAE;AAAA,cAAA;AAAA,YAAA;AAAA,UACnD;AAAA,UAECqC,KACC,gBAAAlH,EAAC,OAAI,EAAA,WAAU,qJACb,UAAA;AAAA,YAAA,gBAAAX,EAAC,SAAI,WAAW,GACdwF,EAAe,SAAS,QAAQ,mDAChCA,EAAe,SAAS,YAAY,mDACpC,4CACF,yBACE,UAAA,gBAAAxF,EAAC,UAAK,WAAU,iCAAgC,yBAAW,EAC7D,CAAA;AAAA,YAEA,gBAAAW,EAAC,OAAI,EAAA,WAAU,yBAEb,UAAA;AAAA,cAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iBACb,UAAA;AAAA,gBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,kBAAC,gBAAAX,EAAA,SAAA,EAAM,WAAU,mFAAkF,UAEnG,SAAA;AAAA,kBACC,gBAAAW,EAAA,QAAA,EAAK,WAAW,yCACf6E,EAAe,SAAS,QAAQ,kCAChCA,EAAe,SAAS,YAAY,kCACpC,2BACF,IACG,UAAA;AAAA,oBAAA+C;AAAA,oBAAY;AAAA,kBAAA,GACf;AAAA,gBAAA,GACF;AAAA,gBACA,gBAAAvI;AAAA,kBAAC;AAAA,kBAAA;AAAA,oBACC,MAAK;AAAA,oBACL,KAAI;AAAA,oBACJ,KAAI;AAAA,oBACJ,MAAK;AAAA,oBACL,OAAOuI;AAAA,oBACP,UAAU,CAAClH,MAAM;AACf,4BAAMsI,IAAW,SAAStI,EAAE,OAAO,KAAK;AACxC,sBAAAmH,GAAemB,CAAQ,GACvBzD,GAAeyD,GAAUlB,CAAY;AAAA,oBACvC;AAAA,oBACA,WAAU;AAAA,oBACV,OAAO;AAAA,sBACL,YAAY,6BACVjD,EAAe,SAAS,QAAQ,sBAChCA,EAAe,SAAS,YAAY,sBACpC,kBACF,QACEA,EAAe,SAAS,QAAQ,sBAChCA,EAAe,SAAS,YAAY,sBACpC,kBACF,KAAM+C,IAAc,MAAM,MAAO,GAAG,0BAA2BA,IAAc,MAAM,MAAO,GAAG;AAAA,oBAC/F;AAAA,kBAAA;AAAA,gBACF;AAAA,cAAA,GACF;AAAA,cAGA,gBAAA5H,EAAC,OAAI,EAAA,WAAU,iBACb,UAAA;AAAA,gBAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,kBAAC,gBAAAX,EAAA,SAAA,EAAM,WAAU,mFAAkF,UAEnG,UAAA;AAAA,kBACC,gBAAAW,EAAA,QAAA,EAAK,WAAW,yCACf6E,EAAe,SAAS,QAAQ,kCAChCA,EAAe,SAAS,YAAY,kCACpC,2BACF,IACG,UAAA;AAAA,oBAAAiD;AAAA,oBAAa;AAAA,kBAAA,GAChB;AAAA,gBAAA,GACF;AAAA,gBACA,gBAAAzI;AAAA,kBAAC;AAAA,kBAAA;AAAA,oBACC,MAAK;AAAA,oBACL,KAAI;AAAA,oBACJ,KAAI;AAAA,oBACJ,MAAK;AAAA,oBACL,OAAOyI;AAAA,oBACP,UAAU,CAACpH,MAAM;AACf,4BAAMuI,IAAY,SAASvI,EAAE,OAAO,KAAK;AACzC,sBAAAqH,GAAgBkB,CAAS,GACzB1D,GAAeqC,GAAaqB,CAAS;AAAA,oBACvC;AAAA,oBACA,WAAU;AAAA,oBACV,OAAO;AAAA,sBACL,YAAY,6BACVpE,EAAe,SAAS,QAAQ,sBAChCA,EAAe,SAAS,YAAY,sBACpC,kBACF,QACEA,EAAe,SAAS,QAAQ,sBAChCA,EAAe,SAAS,YAAY,sBACpC,kBACF,KAAMiD,IAAe,MAAM,MAAO,GAAG,0BAA2BA,IAAe,MAAM,MAAO,GAAG;AAAA,oBACjG;AAAA,kBAAA;AAAA,gBACF;AAAA,cAAA,GACF;AAAA,cAGC,gBAAAzI,EAAA,KAAA,EAAE,WAAU,iDAAgD,UAE7D,qCAAA;AAAA,YAAA,GACF;AAAA,UAAA,GACF;AAAA,QAAA,GAEJ;AAAA,QAGA,gBAAAW;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAAS,MAAM;AACb,oBAAMkJ,MAAgBrE,EAAe,YAAY,KAAK,MAAM;AAC5D,cAAAqB,MAAA,QAAAA,GAAiBgD;AAAA,YACnB;AAAA,YACA,WAAW,wBACTrE,EAAe,SAAS,QAAQ,mDAChCA,EAAe,SAAS,YAAY,mDACpC,4CACF;AAAA,YACA,OAAM;AAAA,YAEN,UAAA;AAAA,cAAC,gBAAAxF,EAAAuJ,IAAA,EAAU,WAAU,kBAAkB,CAAA;AAAA,cACvC,gBAAAvJ,EAAC,UAAK,UAAM,SAAA,CAAA;AAAA,YAAA;AAAA,UAAA;AAAA,QACd;AAAA,QAGA,gBAAAW;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAASwF;AAAA,YACT,WAAU;AAAA,YACV,OAAM;AAAA,YAEN,UAAA;AAAA,cAAC,gBAAAnG,EAAAiF,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,cACpC,gBAAAjF,EAAC,UAAK,UAAM,SAAA,CAAA;AAAA,YAAA;AAAA,UAAA;AAAA,QACd;AAAA,QAGA,gBAAAW,EAAC,OAAI,EAAA,WAAU,sHACb,UAAA;AAAA,UAAC,gBAAAX,EAAA,QAAA,EAAK,WAAU,mFAAkF,UAAK,SAAA;AAAA,UACvG,gBAAAA;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,MAAK;AAAA,cACL,OAAOwF,EAAe;AAAA,cACtB,UAAU,CAACvF,MAAUgG,EAAmBhG,EAAM,OAAO,KAAK;AAAA,cAC1D,WAAU;AAAA,cACV,aAAY;AAAA,YAAA;AAAA,UACd;AAAA,QAAA,GACF;AAAA,MAAA,GACF;AAAA,MAIDwF,KAEG,gBAAA9E,EAAAY,IAAA,EAAA,UAAA;AAAA,QAAC,gBAAAvB,EAAA,OAAA,EAAI,WAAU,+BAA+B,CAAA;AAAA,QAG7CuG,MACC,gBAAA5F,EAAC,OAAI,EAAA,WAAU,4GACb,UAAA;AAAA,UAAA,gBAAAX;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAMuG,GAAkB,MAAM;AAAA,cACvC,WAAW,4DACTd,EAAa,SAAS,SAClB,qCACA,iCACN;AAAA,cACA,OAAM;AAAA,cACP,UAAA;AAAA,YAAA;AAAA,UAED;AAAA,UACA,gBAAAzF;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAMuG,GAAkB,MAAM;AAAA,cACvC,WAAW,4DACTd,EAAa,SAAS,SAClB,sCACA,iCACN;AAAA,cACA,OAAM;AAAA,cACP,UAAA;AAAA,YAAA;AAAA,UAED;AAAA,UACA,gBAAAzF;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAMuG,GAAkB,QAAQ;AAAA,cACzC,WAAW,4DACTd,EAAa,SAAS,WAClB,qCACA,iCACN;AAAA,cACA,OAAM;AAAA,cACP,UAAA;AAAA,YAAA;AAAA,UAED;AAAA,QAAA,GACF;AAAA,QAIDa,MACC,gBAAA3F,EAAC,OAAI,EAAA,WAAU,uCACb,UAAA;AAAA,UAAC,gBAAAX,EAAA,QAAA,EAAK,WAAU,mDAAkD,UAAU,cAAA;AAAA,UAC5E,gBAAAW;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,OAAO8E,EAAa;AAAA,cACpB,UAAU,CAACpE,MAAMiF,GAAsB,OAAOjF,EAAE,OAAO,KAAK,CAAC;AAAA,cAC7D,WAAU;AAAA,cAEV,UAAA;AAAA,gBAAC,gBAAArB,EAAA,UAAA,EAAO,OAAO,GAAG,UAAU,cAAA;AAAA,gBAC3B,gBAAAA,EAAA,UAAA,EAAO,OAAO,GAAG,UAAY,gBAAA;AAAA,gBAC7B,gBAAAA,EAAA,UAAA,EAAO,OAAO,IAAI,UAAY,gBAAA;AAAA,gBAC9B,gBAAAA,EAAA,UAAA,EAAO,OAAO,IAAI,UAAiB,qBAAA;AAAA,cAAA;AAAA,YAAA;AAAA,UACtC;AAAA,QAAA,GACF;AAAA,QAIF,gBAAAW,EAAC,OAAI,EAAA,WAAU,sHACb,UAAA;AAAA,UAAA,gBAAAX,EAAC,UAAK,WAAU,mFACb,UAAYnD,GAAA4I,EAAa,IAAI,GAChC;AAAA,UACA,gBAAA9E,EAAC,QAAK,EAAA,WAAU,iCACb,UAAA;AAAA,YAAA,KAAK,MAAM,KAAK;AAAA,cACf,KAAK,IAAI8E,EAAa,OAAOA,EAAa,QAAQ,CAAC,IACnD,KAAK,IAAIA,EAAa,OAAOA,EAAa,QAAQ,CAAC;AAAA,YAAA,CACpD;AAAA,YAAE;AAAA,UAAA,GACL;AAAA,QAAA,GACF;AAAA,QAGA,gBAAA9E;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAASyF;AAAA,YACT,WAAU;AAAA,YACV,OAAM;AAAA,YAEN,UAAA;AAAA,cAAC,gBAAApG,EAAAiF,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,cACpC,gBAAAjF,EAAC,UAAK,UAAM,SAAA,CAAA;AAAA,YAAA;AAAA,UAAA;AAAA,QACd;AAAA,MAAA,GACF;AAAA,MAID0F,KAEG,gBAAA/E,EAAAY,IAAA,EAAA,UAAA;AAAA,QAAC,gBAAAvB,EAAA,OAAA,EAAI,WAAU,+BAA+B,CAAA;AAAA,QAG7C,gBAAAA,EAAA,OAAA,EAAI,WAAU,sHACb,UAAC,gBAAAA,EAAA,QAAA,EAAK,WAAU,mFACb,UAAqB/C,GAAAyI,EAAqB,IAAI,EACjD,CAAA,GACF;AAAA,QAGCe,KACE,gBAAA9F,EAAA,OAAA,EAAI,KAAK6G,GAAyB,WAAU,gBAC3C,UAAA;AAAA,UAAA,gBAAA7G;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAMqH,GAA8B,CAACD,CAA0B;AAAA,cACxE,WAAU;AAAA,cAEV,UAAA;AAAA,gBAAC,gBAAA/H,EAAA5D,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,gBACpC,gBAAA4D,EAAC,UAAK,UAAM,SAAA,CAAA;AAAA,cAAA;AAAA,YAAA;AAAA,UACd;AAAA,UAEC+H,uBACE,OAAI,EAAA,WAAU,8IACb,UAAC,gBAAApH,EAAA,OAAA,EAAI,WAAU,iBAEb,UAAA;AAAA,YAAA,gBAAAA,EAAC,OACC,EAAA,UAAA;AAAA,cAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,0DACb,UAAA;AAAA,gBAAC,gBAAAX,EAAA,SAAA,EAAM,WAAU,mDAAkD,UAAK,SAAA;AAAA,gBACxE,gBAAAW,EAAC,QAAK,EAAA,WAAU,+CAA+C,UAAA;AAAA,kBAAAgI;AAAA,kBAAkB;AAAA,gBAAA,GAAE;AAAA,cAAA,GACrF;AAAA,cACA,gBAAA3I;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,MAAK;AAAA,kBACL,KAAI;AAAA,kBACJ,KAAI;AAAA,kBACJ,OAAO2I;AAAA,kBACP,UAAU,CAACtH,MAAM;AACf,0BAAMsI,IAAW,SAAStI,EAAE,OAAO,KAAK;AACxC,oBAAAuH,EAAqBe,CAAQ,GAC7BlD,EAAqBkD,GAAUd,CAAkB;AAAA,kBACnD;AAAA,kBACA,WAAU;AAAA,gBAAA;AAAA,cACZ;AAAA,cACA,gBAAAlI,EAAC,OAAI,EAAA,WAAU,uEACb,UAAA;AAAA,gBAAA,gBAAAX,EAAC,UAAK,UAAI,OAAA,CAAA;AAAA,gBACV,gBAAAA,EAAC,UAAK,UAAK,QAAA,CAAA;AAAA,cAAA,GACb;AAAA,YAAA,GACF;AAAA,8BAGC,OACC,EAAA,UAAA;AAAA,cAAC,gBAAAW,EAAA,OAAA,EAAI,WAAU,0DACb,UAAA;AAAA,gBAAC,gBAAAX,EAAA,SAAA,EAAM,WAAU,mDAAkD,UAAM,UAAA;AAAA,gBACzE,gBAAAW,EAAC,QAAK,EAAA,WAAU,+CAA+C,UAAA;AAAA,kBAAAkI;AAAA,kBAAmB;AAAA,gBAAA,GAAE;AAAA,cAAA,GACtF;AAAA,cACA,gBAAA7I;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,MAAK;AAAA,kBACL,KAAI;AAAA,kBACJ,KAAI;AAAA,kBACJ,OAAO6I;AAAA,kBACP,UAAU,CAACxH,MAAM;AACf,0BAAMuI,IAAY,SAASvI,EAAE,OAAO,KAAK;AACzC,oBAAAyH,GAAsBc,CAAS,GAC/BnD,EAAqBkC,GAAmBiB,CAAS;AAAA,kBACnD;AAAA,kBACA,WAAU;AAAA,gBAAA;AAAA,cACZ;AAAA,cACA,gBAAAjJ,EAAC,OAAI,EAAA,WAAU,uEACb,UAAA;AAAA,gBAAA,gBAAAX,EAAC,UAAK,UAAI,OAAA,CAAA;AAAA,gBACV,gBAAAA,EAAC,UAAK,UAAK,QAAA,CAAA;AAAA,cAAA,GACb;AAAA,YAAA,GACF;AAAA,8BAGC,OAAI,EAAA,WAAU,6CACb,UAAC,gBAAAW,EAAA,OAAA,EAAI,WAAU,mBACb,UAAA;AAAA,cAAC,gBAAAX,EAAA,QAAA,EAAK,WAAU,iCAAgC,UAAc,kBAAA;AAAA,cAC9D,gBAAAW,EAAC,QAAK,EAAA,WAAU,+CAA+C,UAAA;AAAA,gBAAAgI;AAAA,gBAAkB;AAAA,gBAAIE;AAAA,gBAAmB;AAAA,cAAA,GAAE;AAAA,YAAA,EAAA,CAC5G,EACF,CAAA;AAAA,UAAA,EAAA,CACF,EACF,CAAA;AAAA,QAAA,GAEJ;AAAA,QAIF,gBAAAlI;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAAS0F;AAAA,YACT,WAAU;AAAA,YACV,OAAM;AAAA,YAEN,UAAA;AAAA,cAAC,gBAAArG,EAAAiF,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,cACpC,gBAAAjF,EAAC,UAAK,UAAM,SAAA,CAAA;AAAA,YAAA;AAAA,UAAA;AAAA,QACd;AAAA,MAAA,GACF;AAAA,IAAA,GAEJ;AAAA,IAGA,gBAAAW,EAAC,OAAI,EAAA,WAAU,qDAEb,UAAA;AAAA,MAAA,gBAAAA;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,SAASiG;AAAA,UACT,WAAU;AAAA,UAEV,UAAA;AAAA,YAAC,gBAAA5G,EAAA8J,IAAA,EAAI,WAAU,kBAAkB,CAAA;AAAA,YAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAErC;AAAA,MAEA,gBAAAnJ,EAAC,OAAI,EAAA,WAAU,6FACb,UAAA;AAAA,QAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,kDAAkD,CAAA;AAAA,QACjE,gBAAAW,EAAC,QAAK,EAAA,WAAU,oCAAmC,UAAA;AAAA,UAAA;AAAA,UAASmG;AAAA,QAAA,GAAW;AAAA,MAAA,GACzE;AAAA,MACA,gBAAAnG,EAAC,OAAI,EAAA,WAAU,2FACb,UAAA;AAAA,QAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,gDAAgD,CAAA;AAAA,QAC/D,gBAAAW,EAAC,QAAK,EAAA,WAAU,kCAAiC,UAAA;AAAA,UAAA;AAAA,UAASoG;AAAA,QAAA,GAAW;AAAA,MAAA,GACvE;AAAA,MACA,gBAAApG,EAAC,OAAI,EAAA,WAAU,gGACb,UAAA;AAAA,QAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,qDAAqD,CAAA;AAAA,QACpE,gBAAAW,EAAC,QAAK,EAAA,WAAU,uCAAsC,UAAA;AAAA,UAAA;AAAA,UAAUqG;AAAA,QAAA,GAAY;AAAA,MAAA,GAC9E;AAAA,MACCG,KACC,gBAAAxG,EAAC,OAAI,EAAA,WAAU,8FACb,UAAA;AAAA,QAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,iEAAiE,CAAA;AAAA,QAChF,gBAAAW,EAAC,QAAK,EAAA,WAAU,oDAAmD,UAAA;AAAA,UAAA;AAAA,UAAWwG;AAAA,QAAA,GAAoB;AAAA,MAAA,GACpG;AAAA,IAAA,GAEJ;AAAA,EAAA,EACF,CAAA,EACF,CAAA;AAEJ,GClxBM4C,KAAe;AAAA,EACnB,SAAS;AAAA,IACP,UAAU,EAAE,GAAG,MAAM,GAAG,KAAK,GAAG,KAAK;AAAA;AAAA,IACrC,QAAQ,EAAE,GAAG,GAAG,GAAG,KAAK,GAAG,EAAE;AAAA,IAC7B,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AAAA,EACA,KAAK;AAAA,IACH,UAAU,EAAE,GAAG,GAAG,GAAG,MAAM,GAAG,EAAE;AAAA;AAAA,IAChC,QAAQ,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,IAC3B,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AAAA,EACA,OAAO;AAAA,IACL,UAAU,EAAE,GAAG,GAAG,GAAG,KAAK,GAAG,IAAK;AAAA;AAAA,IAClC,QAAQ,EAAE,GAAG,GAAG,GAAG,KAAK,GAAG,EAAE;AAAA,IAC7B,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AAAA,EACA,MAAM;AAAA,IACJ,UAAU,EAAE,GAAG,KAAM,GAAG,KAAK,GAAG,EAAE;AAAA;AAAA,IAClC,QAAQ,EAAE,GAAG,GAAG,GAAG,KAAK,GAAG,EAAE;AAAA,IAC7B,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AAAA,EACA,QAAQ;AAAA,IACN,UAAU,EAAE,GAAG,MAAM,GAAG,KAAK,GAAG,KAAK;AAAA;AAAA,IACrC,QAAQ,EAAE,GAAG,GAAG,GAAG,KAAK,GAAG,EAAE;AAAA,IAC7B,MAAM;AAAA,IACN,MAAM;AAAA,EACR;AACF,GAEaC,KAAgD,CAAC,EAAE,OAAA7F,GAAO,QAAA8F,GAAQ,SAAAC,QAAc;AACrF,QAAAC,IAAe9C,GAAuB,IAAI,GAC1C+C,IAAW/C,GAA2B,IAAI,GAC1CgD,IAAYhD,GAAuC,IAAI,GACvDiD,IAAcjD,GAAmC,IAAI,GACrDkD,KAAoBlD,GAAsB,IAAI,GAC9C,CAACmD,GAAYC,EAAa,IAAItJ,EAAS,EAAK,GAC5C,CAACuJ,GAAaC,CAAc,IAAIxJ,EAAoC,SAAS,GAC7E,CAACyJ,GAAiBC,EAAkB,IAAI1J,EAAS,EAAK,GACtD2J,KAAmBzD,GAAO,IAAK,GAC/B0D,IAAgB1D,GAMZ,IAAI,GAGR2D,KAAyB,CAACC,MAAuC;AACjE,QAAA,CAACZ,EAAU,WAAWO;AAAiB;AAErC,UAAAM,IAAOnB,GAAakB,CAAO,GAC3BE,IAASd,EAAU;AAEzB,IAAAU,EAAc,UAAU;AAAA,MACtB,UAAUI,EAAO,SAAS,MAAM;AAAA,MAChC,QAAQ,IAAIC,EAAM,QAAQF,EAAK,SAAS,GAAGA,EAAK,SAAS,GAAGA,EAAK,SAAS,CAAC;AAAA,MAC3E,aAAa,IAAIE,EAAM,QAAQ,GAAG,KAAK,CAAC;AAAA,MACxC,WAAW,IAAIA,EAAM,QAAQF,EAAK,OAAO,GAAGA,EAAK,OAAO,GAAGA,EAAK,OAAO,CAAC;AAAA,MACxE,UAAU;AAAA,IAAA,GAGZL,GAAmB,EAAI,GACvBF,EAAeM,CAAO,GACtBR,GAAc,EAAK;AAAA,EAAA,GAIfY,KAAe,CAACC,MAAgD;AAChE,QAAA,CAACjB,EAAU,WAAWO;AAAiB;AAE3C,UAAMO,IAASd,EAAU,SACnBkB,IAAS,KAAK,KAAKJ,EAAO,SAAS,KAAK,IAAIA,EAAO,SAAS,KAAK,CAAC,GAClEK,KAAe,KAAK,MAAML,EAAO,SAAS,GAAGA,EAAO,SAAS,CAAC;AAEpE,YAAOG,GAAW;AAAA,MAChB,KAAK;AACH,cAAMG,KAAYD,KAAe;AACjC,QAAAL,EAAO,SAAS,IAAII,IAAS,KAAK,IAAIE,EAAS,GAC/CN,EAAO,SAAS,IAAII,IAAS,KAAK,IAAIE,EAAS;AAC/C;AAAA,MACF,KAAK;AACH,cAAMC,KAAaF,KAAe;AAClC,QAAAL,EAAO,SAAS,IAAII,IAAS,KAAK,IAAIG,EAAU,GAChDP,EAAO,SAAS,IAAII,IAAS,KAAK,IAAIG,EAAU;AAChD;AAAA,MACF,KAAK;AACI,QAAAP,EAAA,SAAS,IAAI,KAAK,IAAIA,EAAO,SAAS,IAAI,IAAI,GAAG;AACxD;AAAA,MACF,KAAK;AACI,QAAAA,EAAA,SAAS,IAAI,KAAK,IAAIA,EAAO,SAAS,IAAI,IAAI,GAAG;AACxD;AAAA,IACJ;AAEO,IAAAA,EAAA,OAAO,GAAG,KAAK,CAAC;AAAA,EAAA,GAGnBQ,KAAa,CAACC,MAAmB;AACjC,IAAA,CAACvB,EAAU,WAAWO,MAChBP,EAAA,QAAQ,SAAS,eAAeuB,CAAM,GAChDvB,EAAU,QAAQ,OAAO,GAAG,KAAK,CAAC;AAAA,EAAA;AA8iDpC,SA3iDAtB,GAAU,MAAM;AACV,QAAA,CAACkB,KAAU,CAACE,EAAa;AAAS;AAGhC,UAAA0B,IAAQ,IAAIT,EAAM;AACxB,IAAAS,EAAM,aAAa,IAAIT,EAAM,MAAM,QAAQ,GAC3ChB,EAAS,UAAUyB;AAGb,UAAAV,IAAS,IAAIC,EAAM;AAAA,MACvB;AAAA,MACAjB,EAAa,QAAQ,cAAcA,EAAa,QAAQ;AAAA,MACxD;AAAA,MACA;AAAA,IAAA;AAEF,IAAAgB,EAAO,SAAS,IAAI,MAAM,KAAK,IAAI,GAC5BA,EAAA,OAAO,GAAG,KAAK,CAAC,GACvBd,EAAU,UAAUc;AAGd,UAAAW,IAAW,IAAIV,EAAM,cAAc,EAAE,WAAW,IAAM,OAAO,GAAA,CAAM;AACzE,IAAAU,EAAS,QAAQ3B,EAAa,QAAQ,aAAaA,EAAa,QAAQ,YAAY,GACpF2B,EAAS,UAAU,UAAU,IACpBA,EAAA,UAAU,OAAOV,EAAM,kBAChCU,EAAS,cAAcV,EAAM,uBAC7BU,EAAS,sBAAsB,KAClB3B,EAAA,QAAQ,YAAY2B,EAAS,UAAU,GACpDxB,EAAY,UAAUwB;AAGtB,UAAMC,KAAiB,IAAIX,EAAM,eAAeU,CAAQ,GAClDE,KAAW,IAAIZ,EAAM;AAC3B,IAAAY,GAAS,aAAa,IAAIZ,EAAM,MAAM,QAAQ;AAC9C,UAAMa,KAAaF,GAAe,UAAUC,EAAQ,EAAE;AACtD,IAAAH,EAAM,cAAcI,IACpBF,GAAe,QAAQ,GAGvBF,EAAM,IAAI,IAAIT,EAAM,aAAa,UAAU,GAAG,CAAC;AAE/C,UAAMc,KAAY,IAAId,EAAM,iBAAiB,UAAU,GAAG;AAC1D,IAAAc,GAAU,SAAS,IAAI,KAAK,KAAK,GAAG,GACpCA,GAAU,aAAa,IACbA,GAAA,OAAO,QAAQ,QAAQ,MACvBA,GAAA,OAAO,QAAQ,SAAS,MAClCA,GAAU,OAAO,OAAO,OAAOA,GAAU,OAAO,OAAO,SAAS,MAChEA,GAAU,OAAO,OAAO,QAAQA,GAAU,OAAO,OAAO,MAAM,KAC9DA,GAAU,OAAO,OAAO,OACxBL,EAAM,IAAIK,EAAS;AAEnB,UAAMC,KAAY,IAAIf,EAAM,iBAAiB,UAAU,GAAG;AAC1D,IAAAe,GAAU,SAAS,IAAI,MAAM,KAAK,IAAI,GACtCN,EAAM,IAAIM,EAAS;AAEnB,UAAMC,IAAW,IAAIhB,EAAM,iBAAiB,UAAU,GAAG;AACzD,IAAAgB,EAAS,SAAS,IAAI,GAAG,KAAK,IAAI,GAClCP,EAAM,IAAIO,CAAQ;AAGZ,UAAAC,KAAY,IAAIjB,EAAM;AAAA,MAC1B,IAAIA,EAAM,cAAc,MAAM,IAAI;AAAA,MAClC,IAAIA,EAAM,qBAAqB,EAAE,OAAO,UAAU,WAAW,KAAK,WAAW,KAAK;AAAA;AAAA,IAAA;AAEpF,IAAAiB,GAAU,SAAS,IAAI,CAAC,KAAK,KAAK,GAClCA,GAAU,gBAAgB,IAC1BR,EAAM,IAAIQ,EAAS;AAEnB,UAAMC,IAAO,IAAIlB,EAAM,WAAW,KAAM,KAAK,UAAU,QAAQ;AAC/D,IAAAkB,EAAK,SAAS,IAAI,GAClBT,EAAM,IAAIS,CAAI,GAGRnI,EAAA,MAAM,QAAQ,CAAQ1C,MAAA;AAC1B,YAAME,IAAS,KAAK,KAAK,KAAK,IAAIF,EAAK,OAAOA,EAAK,QAAQ,CAAC,IAAI,KAAK,IAAIA,EAAK,OAAOA,EAAK,QAAQ,CAAC,CAAC,GAC9FG,IAAQ,KAAK,MAAMH,EAAK,OAAOA,EAAK,QAAQA,EAAK,OAAOA,EAAK,MAAM,GACnE8K,IAAa9K,EAAK,SAAS,WAAW,KAAK,KAC3C+K,IAAQ/K,EAAK,UAAUA,EAAK,OAAOA,EAAK,UAAU,IAAI,KACtDgL,IAAQ,EAAEhL,EAAK,UAAUA,EAAK,OAAOA,EAAK,UAAU,IAAI;AAE1D,UAAAA,EAAK,SAAS,QAAQ;AAElB,cAAAiL,IAAY,IAAItB,EAAM,SACtBuB,IAAYhL,GACZiL,IAAaL,GACbM,IAAgBpL,EAAK,YAAY,KAGjCqL,KAAW,IAAI1B,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEK2B,IAAiB,GAGjBC,KAAW,IAAI5B,EAAM;AAAA,UACzB,IAAIA,EAAM,YAAYuB,GAAWI,GAAgBtL,EAAK,YAAY,CAAC;AAAA,UACnEqL;AAAA,QAAA;AAEF,QAAAE,GAAS,SAAS,IAAIJ,IAAa,IAAIG,IAAiB,GACxDL,EAAU,IAAIM,EAAQ;AAEhB,cAAAC,KAAc,IAAI7B,EAAM;AAAA,UAC5B,IAAIA,EAAM,YAAYuB,GAAWI,GAAgBtL,EAAK,YAAY,CAAC;AAAA,UACnEqL;AAAA,QAAA;AAEF,QAAAG,GAAY,SAAS,IAAI,CAACL,IAAa,IAAIG,IAAiB,GAC5DL,EAAU,IAAIO,EAAW;AAEnB,cAAAC,IAAY,IAAI9B,EAAM;AAAA,UAC1B,IAAIA,EAAM,YAAY2B,GAAgBH,GAAYnL,EAAK,YAAY,CAAC;AAAA,UACpEqL;AAAA,QAAA;AAEF,QAAAI,EAAU,SAAS,IAAI,CAACP,IAAY,IAAII,IAAiB,GACzDL,EAAU,IAAIQ,CAAS;AAEjB,cAAAC,IAAaD,EAAU;AAC7B,QAAAC,EAAW,SAAS,IAAIR,IAAY,IAAII,IAAiB,GACzDL,EAAU,IAAIS,CAAU;AAGlB,cAAAC,IAAU,IAAIhC,EAAM,qBAAqB;AAAA,UAC7C,OAAO;AAAA;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEKiC,IAAW,IAAIjC,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA;AAAA,UACP,aAAa;AAAA,UACb,SAAS;AAAA;AAAA,UACT,WAAW;AAAA;AAAA,UACX,WAAW;AAAA;AAAA,QAAA,CACZ,GAEKkC,MAAmBX,IAAYI,IAAiB,IAAI,KAAK,GACzDQ,IAAkBX,IAAaG,IAAiB,IAAI,GAEpDS,KAAW,CAACC,OAAoB;AAC9B,gBAAAC,KAAQ,IAAItC,EAAM,SAGlBuC,KAAa,IAAIvC,EAAM;AAAA,YAC3B,IAAIA,EAAM,YAAYkC,IAAiBC,GAAiBV,CAAa;AAAA,YACrEO;AAAA,UAAA;AAEF,UAAAM,GAAM,IAAIC,EAAU;AAGd,gBAAAC,KAAQ,IAAIxC,EAAM;AAAA,YACtB,IAAIA,EAAM,cAAckC,KAAkB,KAAKC,IAAkB,IAAI;AAAA,YACrEF;AAAA,UAAA;AAEF,UAAAO,GAAM,SAAS,IAAI,GAAG,GAAGf,IAAgB,IAAI,GAAG,GAChDa,GAAM,IAAIE,EAAK;AAGT,gBAAAC,IAAY,IAAIzC,EAAM,qBAAqB;AAAA,YAC/C,OAAO;AAAA,YACP,WAAW;AAAA,YACX,WAAW;AAAA,UAAA,CACZ,GAEK0C,KAAS,IAAI1C,EAAM;AAAA,YACvB,IAAIA,EAAM,iBAAiB,KAAK,KAAK,IAAI,EAAE;AAAA,YAC3CyC;AAAA,UAAA;AAEK,iBAAAC,GAAA,SAAS,IAAI,KAAK,KAAK,GAC9BA,GAAO,SAAS,IAAIL,KAAU,IAAI,CAACH,KAAkB,OAAOA,KAAkB,MAAM,GAAGT,IAAgB,IAAI,GAAG,GAC9Ga,GAAM,IAAII,EAAM,GAEhBJ,GAAM,SAAS,IAAID,IACZC;AAAA,QAAA,GAIHK,IAAWP,GAAS,CAACF,KAAkB,CAAC,GACxCU,IAAYR,GAASF,KAAkB,CAAC;AAC9C,QAAAZ,EAAU,IAAIqB,CAAQ,GACtBrB,EAAU,IAAIsB,CAAS;AAGvB,cAAMC,IAAa,IACbC,KAAe,IAAI9C,EAAM,cAAcuB,IAAY,KAAKsB,CAAU,GAClEE,IAAS,SAAS,cAAc,QAAQ;AAC9C,QAAAA,EAAO,QAAQ,KACfA,EAAO,SAAS;AACV,cAAAC,IAAMD,EAAO,WAAW,IAAI;AAElC,QAAIC,MAEFA,EAAI,YAAY,WAChBA,EAAI,SAAS,GAAG,GAAGD,EAAO,OAAOA,EAAO,MAAM,GAG9CC,EAAI,OAAO,mBACXA,EAAI,YAAY,WAChBA,EAAI,YAAY,UAChBA,EAAI,eAAe,UACnBA,EAAI,SAAS,WAAWD,EAAO,QAAQ,GAAGA,EAAO,SAAS,CAAC;AAG7D,cAAME,KAAc,IAAIjD,EAAM,cAAc+C,CAAM,GAC5CG,IAAe,IAAIlD,EAAM,qBAAqB;AAAA,UAClD,KAAKiD;AAAA,UACL,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEKE,IAAO,IAAInD,EAAM,KAAK8C,IAAcI,CAAY;AACtD,QAAAC,EAAK,SAAS,IAAI,GAAG3B,IAAa,IAAIG,IAAiBkB,IAAa,IAAI,GAAGxM,EAAK,YAAY,IAAI,CAAC,GACjGiL,EAAU,IAAI6B,CAAI,GAGlB7B,EAAU,SAAS,IAAIF,GAAOI,IAAa,GAAGH,CAAK,GACzCC,EAAA,SAAS,IAAI,CAAC9K,GACxB8K,EAAU,aAAa,IACvBA,EAAU,gBAAgB,IAC1Bb,EAAM,IAAIa,CAAS;AAAA,MAAA,WAEVjL,EAAK,SAAS,UAAU;AAI3B,cAAA+M,IAAe7M,IAAS,KAAKA,IAAS,KACtC8M,IAAelC,GAGfmC,IAAKD,IAAe,MACpBE,IAAKF,IAAe,MACpBG,KAAKH,IAAe,KACpBI,IAAKJ,IAAe,KAGpBK,KAAU,IAAI1D,EAAM,qBAAqB;AAAA,UAC7C,OAAO;AAAA;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAGK0B,KAAW,IAAI1B,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,UACX,WAAW;AAAA,UACX,oBAAoB;AAAA,QAAA,CACrB,GAGKiC,IAAW,IAAIjC,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,aAAa;AAAA,UACb,SAAS;AAAA,UACT,cAAc;AAAA,UACd,WAAW;AAAA,UACX,WAAW;AAAA,UACX,WAAW;AAAA,UACX,KAAK;AAAA,UACL,iBAAiB;AAAA,UACjB,WAAW;AAAA,UACX,oBAAoB;AAAA,UACpB,cAAc;AAAA,QAAA,CACf,GAGK2D,IAAO,IAAI3D,EAAM;AAAA,UACrB,IAAIA,EAAM,YAAYoD,GAAcE,GAAIjN,EAAK,SAAS;AAAA,UACtDqN;AAAA,QAAA;AAEF,QAAAC,EAAK,SAAS,IAAIvC,GAAOkC,IAAK,GAAGjC,CAAK,GACjCsC,EAAA,SAAS,IAAI,CAACnN,GACnBmN,EAAK,gBAAgB,IACrBA,EAAK,aAAa,IAClBlD,EAAM,IAAIkD,CAAI;AAGR,cAAAC,IAAON,IAAKC,IAAK,GACjB5B,IAAiB,GACjBkC,KAAW,KAAK,IAAI,GAAG,KAAK,MAAMT,IAAe,EAAE,CAAC,GACpDU,KAAaV,IAAezB,KAAkBkC,KAAW,MAAMA;AAGrE,iBAASE,IAAI,GAAGA,IAAIF,IAAUE,KAAK;AAC3B,gBAAAC,IAAQ,CAACZ,IAAe,IAAIzB,IAAiBmC,IAAY,IAAIC,KAAKD,IAAYnC,IAC9EsC,KAAS7C,IAAQ4C,IAAQ,KAAK,IAAI,CAACxN,CAAK,GACxC0N,IAAS7C,IAAQ2C,IAAQ,KAAK,IAAI,CAACxN,CAAK,GAGxCgM,IAAQ,IAAIxC,EAAM;AAAA,YACtB,IAAIA,EAAM,YAAY8D,IAAY,GAAGP,IAAK5B,IAAiB,GAAG,CAAC;AAAA,YAC/DM;AAAA,UAAA;AASE,cAPJO,EAAM,SAAS,IAAIyB,IAAQL,GAAMM,CAAM,GACjC1B,EAAA,SAAS,IAAI,CAAChM,GACpBgM,EAAM,aAAa,IACnBA,EAAM,gBAAgB,IACtB/B,EAAM,IAAI+B,CAAK,GAGXuB,IAAIF,KAAW,GAAG;AACd,kBAAAM,KAAO,CAACf,IAAe,IAAIzB,KAAkBoC,IAAI,KAAKD,KAAaC,IAAI,OAAOpC,GAC9EyC,KAAYhD,IAAQ+C,KAAO,KAAK,IAAI,CAAC3N,CAAK,GAC1C6N,KAAYhD,IAAQ8C,KAAO,KAAK,IAAI,CAAC3N,CAAK,GAE1C8N,KAAU,IAAItE,EAAM;AAAA,cACxB,IAAIA,EAAM,YAAY2B,GAAgB4B,GAAIlN,EAAK,YAAY,CAAC;AAAA,cAC5DqL;AAAA,YAAA;AAEF,YAAA4C,GAAQ,SAAS,IAAIF,IAAWR,GAAMS,EAAS,GACvCC,GAAA,SAAS,IAAI,CAAC9N,GACtB8N,GAAQ,aAAa,IACrB7D,EAAM,IAAI6D,EAAO;AAAA,UACnB;AAAA,QACF;AAGM,cAAAC,KAAOjB,IAAKC,IAAKC,KAAK,GAEtBgB,IAAe,IAAIxE,EAAM;AAAA,UAC7B,IAAIA,EAAM,YAAYoD,IAAezB,IAAiB,GAAG6B,KAAK7B,GAAgB,CAAC;AAAA,UAC/EM;AAAA,QAAA;AAEF,QAAAuC,EAAa,SAAS,IAAIpD,GAAOmD,IAAMlD,CAAK,GAC/BmD,EAAA,SAAS,IAAI,CAAChO,GAC3BgO,EAAa,aAAa,IAC1B/D,EAAM,IAAI+D,CAAY;AAGhB,cAAAC,IAAe,IAAIzE,EAAM;AAAA,UAC7B,IAAIA,EAAM,YAAYoD,GAAczB,GAAgBtL,EAAK,YAAY,CAAC;AAAA,UACtEqL;AAAA,QAAA;AAEF,QAAA+C,EAAa,SAAS,IAAIrD,GAAOkC,IAAKC,IAAK5B,IAAiB,GAAGN,CAAK,GACvDoD,EAAA,SAAS,IAAI,CAACjO,GAC3BiO,EAAa,aAAa,IAC1BhE,EAAM,IAAIgE,CAAY;AAGhB,cAAAC,IAAkB,IAAI1E,EAAM;AAAA,UAChC,IAAIA,EAAM,YAAYoD,GAAczB,GAAgBtL,EAAK,YAAY,CAAC;AAAA,UACtEqL;AAAA,QAAA;AAEc,QAAAgD,EAAA,SAAS,IAAItD,GAAOkC,IAAKC,IAAKC,KAAK7B,IAAiB,GAAGN,CAAK,GAC5DqD,EAAA,SAAS,IAAI,CAAClO,GAC9BkO,EAAgB,aAAa,IAC7BjE,EAAM,IAAIiE,CAAe;AAGnB,cAAAC,KAAU,IAAI3E,EAAM;AAAA,UACxB,IAAIA,EAAM,YAAYoD,GAAcK,GAAIpN,EAAK,SAAS;AAAA,UACtDqN;AAAA,QAAA;AAEM,QAAAiB,GAAA,SAAS,IAAIvD,GAAOkC,IAAKC,IAAKC,KAAKC,IAAK,GAAGpC,CAAK,GAChDsD,GAAA,SAAS,IAAI,CAACnO,GACtBmO,GAAQ,aAAa,IACrBA,GAAQ,gBAAgB,IACxBlE,EAAM,IAAIkE,EAAO;AAAA,MAAA,OAEZ;AAEC,cAAAC,IAAW,IAAI5E,EAAM;AAAA,UACzB,IAAIA,EAAM,YAAYzJ,GAAQ4K,GAAY9K,EAAK,SAAS;AAAA,UACxD,IAAI2J,EAAM,qBAAqB,EAAE,OAAO,UAAU,WAAW,KAAK,WAAW,MAAM;AAAA,QAAA;AAErF,QAAA4E,EAAS,SAAS,IAAIxD,GAAOD,IAAa,GAAGE,CAAK,GACzCuD,EAAA,SAAS,IAAI,CAACpO,GACvBoO,EAAS,aAAa,IACtBA,EAAS,gBAAgB,IACzBnE,EAAM,IAAImE,CAAQ;AAAA,MACpB;AAAA,IAAA,CACD,GAGK7L,EAAA,cAAc,QAAQ,CAAW/B,MAAA;AACrC,YAAMoK,IAAQpK,EAAQ,IAAI,MAAMA,EAAQ,QAAQ,GAC1CqK,IAAQ,EAAErK,EAAQ,IAAI,MAAMA,EAAQ,SAAS;AAE/C,UAAAA,EAAQ,SAAS,UAAU;AAC7B,cAAMmJ,IAAS,KAAK,IAAInJ,EAAQ,OAAOA,EAAQ,MAAM,IAAI,GAGnD6N,IAAS,IAAI7E,EAAM;AAAA,UACvB,IAAIA,EAAM,iBAAiBG,GAAQA,IAAS,KAAK,KAAK,EAAE;AAAA,UACxD,IAAIH,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK,WAAW,KAAK;AAAA,QAAA;AAEpF,QAAA6E,EAAO,SAAS,IAAIzD,GAAO,IAAIC,CAAK,GACpCwD,EAAO,aAAa,IACpBpE,EAAM,IAAIoE,CAAM;AAGV,cAAAC,IAAU,IAAI9E,EAAM;AAAA,UACxB,IAAIA,EAAM,iBAAiBG,IAAS,KAAKA,IAAS,KAAK,IAAI,EAAE;AAAA,UAC7D,IAAIH,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK,WAAW,KAAK;AAAA,QAAA;AAEpF,QAAA8E,EAAQ,SAAS,IAAI1D,GAAO,KAAKC,CAAK,GACtCyD,EAAQ,aAAa,IACrBrE,EAAM,IAAIqE,CAAO;AAGX,cAAAC,IAAO,IAAI/E,EAAM;AAAA,UACrB,IAAIA,EAAM,iBAAiBG,IAAS,KAAKA,IAAS,KAAK,IAAI,EAAE;AAAA,UAC7D,IAAIH,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK,WAAW,KAAK;AAAA,QAAA;AAEpF,QAAA+E,EAAK,SAAS,IAAI3D,GAAO,GAAGC,CAAK,GACjC0D,EAAK,aAAa,IAClBtE,EAAM,IAAIsE,CAAI;AAAA,MAAA,WAEL/N,EAAQ,SAAS,UAAU;AAC9B,cAAAgO,IAAS,IAAIhF,EAAM;AAAA,UACvB,IAAIA,EAAM,YAAYhJ,EAAQ,OAAO,KAAKA,EAAQ,MAAM;AAAA,UACxD,IAAIgJ,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK,WAAW,KAAK;AAAA,QAAA;AAEpF,QAAAgF,EAAO,SAAS,IAAI5D,GAAO,IAAIC,CAAK,GACpC2D,EAAO,aAAa,IACpBvE,EAAM,IAAIuE,CAAM;AAGV,cAAAC,IAAQ,IAAIjF,EAAM;AAAA,UACtB,IAAIA,EAAM,cAAcgF,EAAO,QAAQ;AAAA,UACvC,IAAIhF,EAAM,kBAAkB,EAAE,OAAO,SAAU;AAAA,QAAA;AAE3C,QAAAiF,EAAA,SAAS,KAAKD,EAAO,QAAQ,GACnCvE,EAAM,IAAIwE,CAAK;AAAA,MAAA,OAEV;AAGC,cAAAC,IAAYlO,EAAQ,SAAS;AAEnC,iBAAS+M,IAAI,GAAGA,IAAI,GAAWA,KAAK;AAC5B,gBAAA7M,IAAO,IAAI8I,EAAM;AAAA,YACrB,IAAIA,EAAM,YAAYhJ,EAAQ,OAAO,MAAYkO,KAAa,IAAYnB,EAAE;AAAA,YAC5E,IAAI/D,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK;AAAA,UAAA;AAE/D,UAAA9I,EAAA,SAAS,IAAIkK,GAAO,OAAa,IAAI2C,IAAI,MAAY1C,IAAQ0C,IAAImB,IAAY,CAAC,GACnFhO,EAAK,aAAa,IAClBuJ,EAAM,IAAIvJ,CAAI;AAER,gBAAA+N,IAAQ,IAAIjF,EAAM;AAAA,YACtB,IAAIA,EAAM,cAAc9I,EAAK,QAAQ;AAAA,YACrC,IAAI8I,EAAM,kBAAkB,EAAE,OAAO,SAAU;AAAA,UAAA;AAE3C,UAAAiF,EAAA,SAAS,KAAK/N,EAAK,QAAQ,GACjCuJ,EAAM,IAAIwE,CAAK;AAAA,QACjB;AAAA,MACF;AAAA,IAAA,CACD,GAGKlM,EAAA,QAAQ,QAAQ,CAAOoM,MAAA;AAC3B,YAAM/D,IAAQ+D,EAAI,IAAI,MAAMA,EAAI,QAAQ,GAClC9D,IAAQ,EAAE8D,EAAI,IAAI,MAAMA,EAAI,SAAS,IACrCC,IAAW,EAAED,EAAI,WAAW,KAAK,KAAK;AAGxC,UAAAA,EAAI,SAAS,OAAO;AACtB,cAAM/D,IAAQ+D,EAAI,IAAI,MAAMA,EAAI,QAAQ,GAClC9D,IAAQ,EAAE8D,EAAI,IAAI,MAAMA,EAAI,SAAS,IACrCC,IAAW,EAAED,EAAI,WAAW,KAAK,KAAK,MACtCE,IAAY,IAGZC,IAAU,IAAItF,EAAM,qBAAqB;AAAA,UAC7C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,UACX,WAAW;AAAA,UACX,oBAAoB;AAAA,QAAA,CACrB,GAEK+E,IAAO,IAAI/E,EAAM;AAAA,UACrB,IAAIA,EAAM,YAAYmF,EAAI,OAAOE,GAAWF,EAAI,MAAM;AAAA,UACtDG;AAAA,QAAA;AAEF,QAAAP,EAAK,SAAS,IAAI3D,GAAOiE,IAAY,GAAGhE,CAAK,GAC7C0D,EAAK,SAAS,IAAIK,GAClBL,EAAK,aAAa,IAClBA,EAAK,gBAAgB,IACrBtE,EAAM,IAAIsE,CAAI;AAGd,cAAMQ,KAAc,CAAC,SAAU,UAAU,SAAU,SAAU,OAAQ,GAC/DC,IAAaD,GAAY,KAAK,MAAM,KAAK,WAAWA,GAAY,MAAM,CAAC,GAEvEE,KAAc,IAAIzF,EAAM,qBAAqB;AAAA,UACjD,OAAOwF;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,UACX,cAAc;AAAA;AAAA,UACd,WAAW;AAAA,UACX,KAAK;AAAA,UACL,cAAc;AAAA,UACd,WAAW;AAAA,UACX,oBAAoB;AAAA,QAAA,CACrB,GAEKE,KAAW,IAAI1F,EAAM;AAAA,UACzB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,GAAG,GAAGA,EAAI,SAAS,CAAC;AAAA,UACtDM;AAAA,QAAA;AAEF,QAAAC,GAAS,SAAS,IAAItE,GAAOiE,IAAY,GAAGhE,CAAK,GACjDqE,GAAS,SAAS,IAAIN,GACtBM,GAAS,aAAa,IACtBjF,EAAM,IAAIiF,EAAQ;AAGZ,cAAAC,IAAa,IAAI3F,EAAM,qBAAqB;AAAA,UAChD,UAAU;AAAA;AAAA,UACV,mBAAmB;AAAA,UACnB,OAAO;AAAA,QAAA,CACR,GACK4F,IAAW,IAAI5F,EAAM;AAAA,UACzB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,GAAG,KAAKA,EAAI,SAAS,CAAC;AAAA,UACxDQ;AAAA,QAAA;AAEF,QAAAC,EAAS,SAAS,IAAIxE,GAAOiE,IAAY,GAAGhE,CAAK,GACjDuE,EAAS,SAAS,IAAIR,GACtB3E,EAAM,IAAImF,CAAQ;AAGZ,cAAAC,IAAYL,MAAe,UAAW,WAAW,UACjDM,IAAO,IAAI9F,EAAM;AAAA,UACrB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,GAAG,KAAKA,EAAI,SAAS,CAAC;AAAA,UACxD,IAAInF,EAAM,qBAAqB;AAAA,YAC7B,OAAO6F;AAAA,YACP,WAAW;AAAA,YACX,WAAW;AAAA,UAAA,CACZ;AAAA,QAAA;AAEH,QAAAC,EAAK,SAAS,IAAI1E,GAAOiE,IAAY,KAAKhE,CAAK,GAC/CyE,EAAK,SAAS,IAAIV,GAClB3E,EAAM,IAAIqF,CAAI;AAGR,cAAAC,KAAS,IAAI/F,EAAM,qBAAqB;AAAA,UAC5C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GACKgG,IAAS,IAAIhG,EAAM,iBAAiB,GAAG,GAAGqF,GAAW,EAAE;AAO7D,QANmB;AAAA,UACjB,CAACF,EAAI,QAAQ,IAAI,GAAGA,EAAI,SAAS,IAAI,CAAC;AAAA,UACtC,CAAC,CAACA,EAAI,QAAQ,IAAI,GAAGA,EAAI,SAAS,IAAI,CAAC;AAAA,UACvC,CAACA,EAAI,QAAQ,IAAI,GAAG,CAACA,EAAI,SAAS,IAAI,CAAC;AAAA,UACvC,CAAC,CAACA,EAAI,QAAQ,IAAI,GAAG,CAACA,EAAI,SAAS,IAAI,CAAC;AAAA,QAAA,EAE/B,QAAQ,CAAC,CAACc,IAAIC,EAAE,MAAM;AAC/B,gBAAMC,KAAM,IAAInG,EAAM,KAAKgG,GAAQD,EAAM;AACzC,UAAAI,GAAI,SAAS;AAAA,YACX/E,IAAQ6E,KAAK,KAAK,IAAIb,CAAQ,IAAIc,KAAK,KAAK,IAAId,CAAQ;AAAA,YACxDC,IAAY;AAAA,YACZhE,IAAQ4E,KAAK,KAAK,IAAIb,CAAQ,IAAIc,KAAK,KAAK,IAAId,CAAQ;AAAA,UAAA,GAE1De,GAAI,aAAa,IACjB1F,EAAM,IAAI0F,EAAG;AAAA,QAAA,CACd;AAGD,cAAMC,IAAW,IAAIpG,EAAM,WAAWwF,GAAY,KAAK,GAAG;AAC1D,QAAAY,EAAS,SAAS,IAAIhF,GAAOiE,IAAY,IAAIhE,CAAK,GAClDZ,EAAM,IAAI2F,CAAQ;AAGlB,cAAMC,IAAe,KACfC,IAAc,IAAItG,EAAM,SAGxBuG,KAAW,IAAIvG,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,UACX,WAAW;AAAA,UACX,oBAAoB;AAAA,QAAA,CACrB,GAEKwG,IAAa,IAAIxG,EAAM;AAAA,UAC3B,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,IAAI,IAAIA,EAAI,SAAS,EAAE;AAAA,UACzDoB;AAAA,QAAA;AAEF,QAAAC,EAAW,aAAa,IACxBA,EAAW,gBAAgB,IAC3BF,EAAY,IAAIE,CAAU;AAGpB,cAAAC,IAAgB,IAAIzG,EAAM,qBAAqB;AAAA,UACnD,OAAO;AAAA;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,UACX,cAAc;AAAA,UACd,WAAW;AAAA,UACX,KAAK;AAAA,UACL,WAAW;AAAA,UACX,oBAAoB;AAAA,QAAA,CACrB,GACK0G,KAAa,IAAI1G,EAAM;AAAA,UAC3B,IAAIA,EAAM,cAAcmF,EAAI,QAAQ,IAAIA,EAAI,SAAS,EAAE;AAAA,UACvDsB;AAAA,QAAA;AAEF,QAAAC,GAAW,SAAS,IAAI,CAAC,KAAK,KAAK,GACnCA,GAAW,SAAS,IAAI,IACxBJ,EAAY,IAAII,EAAU;AAGpB,cAAAC,IAAS,IAAI3G,EAAM,qBAAqB;AAAA,UAC5C,UAAU;AAAA,UACV,mBAAmB;AAAA,UACnB,OAAO;AAAA,QAAA,CACR,GACK4G,IAAU,IAAI5G,EAAM,YAAY,GAAG,GAAGmF,EAAI,SAAS,EAAE,GACrD0B,KAAU,IAAI7G,EAAM,KAAK4G,GAASD,CAAM,GACxCG,KAAWD,GAAQ;AACjB,QAAAA,GAAA,SAAS,IAAI,EAAE1B,EAAI,QAAQ,MAAM,GAAG,IAAI,CAAC,GACjD2B,GAAS,SAAS,KAAK3B,EAAI,QAAQ,MAAM,GAAG,IAAI,CAAC,GACrCmB,EAAA,IAAIO,IAASC,EAAQ;AAG3B,cAAAC,KAAa,IAAI/G,EAAM,SACvBgH,KAAe,CAAC,UAAU,UAAU,SAAU,OAAU,OAAQ;AACtE,iBAASjD,KAAI,IAAIA,MAAK,GAAGA,MAAK;AACtB,gBAAAkD,KAAQD,GAAa,KAAK,MAAM,KAAK,WAAWA,GAAa,MAAM,CAAC,GACpEE,KAAY,IAAIlH,EAAM,qBAAqB;AAAA,YAC/C,OAAAiH;AAAA,YACA,WAAW;AAAA,YACX,cAAc;AAAA,YACd,WAAW;AAAA,YACX,KAAK;AAAA,YACL,WAAW;AAAA,YACX,oBAAoB;AAAA,UAAA,CACrB,GAEKE,IAAS,IAAInH,EAAM;AAAA,YACvB,IAAIA,EAAM,iBAAiB,GAAG,GAAG,IAAI,EAAE;AAAA,YACvCkH;AAAA,UAAA;AAEF,UAAAC,EAAO,SAAS,IAAIpD,KAAI,IAAI,KAAK,CAAC,GAClCgD,GAAW,IAAII,CAAM;AAGf,gBAAAC,IAAO,IAAIpH,EAAM;AAAA,YACrB,IAAIA,EAAM,iBAAiB,KAAK,KAAK,GAAG,EAAE;AAAA,YAC1CkH;AAAA,UAAA;AAEF,UAAAE,EAAK,SAAS,IAAIrD,KAAI,IAAI,IAAI,CAAC,GAC/BgD,GAAW,IAAIK,CAAI;AAAA,QACrB;AACA,QAAAL,GAAW,SAAS,IAAI,KACxBT,EAAY,IAAIS,EAAU;AAGpB,cAAA9E,IAAW,IAAIjC,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,cAAc;AAAA,UACd,WAAW;AAAA,UACX,KAAK;AAAA,QAAA,CACN;AACD,iBAAS+D,KAAI,IAAIA,MAAK,GAAGA,MAAK;AACtB,gBAAAvB,KAAQ,IAAIxC,EAAM;AAAA,YACtB,IAAIA,EAAM,eAAe,KAAK,IAAI,IAAI,GAAG,KAAK,EAAE;AAAA;AAAA,YAChDiC;AAAA,UAAA;AAEF,UAAAO,GAAM,SAAS,IAAIuB,KAAI,IAAI,KAAK,CAAC,GACjCvB,GAAM,MAAM,IAAI,KAChB8D,EAAY,IAAI9D,EAAK;AAAA,QACvB;AAGM,cAAA6E,KAAS,IAAIrH,EAAM,qBAAqB;AAAA,UAC5C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GACKsH,KAAS,IAAItH,EAAM,iBAAiB,KAAK,KAAKqG,IAAe,IAAI,EAAE;AACzE;AAAA,UACE,CAAClB,EAAI,QAAQ,IAAI,IAAIA,EAAI,SAAS,IAAI,EAAE;AAAA,UACxC,CAAC,CAACA,EAAI,QAAQ,IAAI,IAAIA,EAAI,SAAS,IAAI,EAAE;AAAA,UACzC,CAACA,EAAI,QAAQ,IAAI,IAAI,CAACA,EAAI,SAAS,IAAI,EAAE;AAAA,UACzC,CAAC,CAACA,EAAI,QAAQ,IAAI,IAAI,CAACA,EAAI,SAAS,IAAI,EAAE;AAAA,UAC1C,QAAQ,CAAC,CAACc,IAAIC,EAAE,MAAM;AACtB,gBAAMqB,KAAM,IAAIvH,EAAM,KAAKsH,IAAQD,EAAM;AACzC,UAAAE,GAAI,SAAS,IAAItB,IAAI,EAAEI,IAAe,MAAM,GAAGH,EAAE,GAC7CqB,GAAA,SAAS,IAAI,KAAK,KAAK,GAC3BjB,EAAY,IAAIiB,EAAG;AAAA,QAAA,CACpB,GAGDjB,EAAY,SAAS,IAAIlF,GAAOiF,GAAchF,CAAK,GACnDiF,EAAY,SAAS,IAAIlB,GACzB3E,EAAM,IAAI6F,CAAW;AAGrB,cAAMkB,KAAY,IAAIxH,EAAM,WAAW,UAAU,KAAK,GAAG;AACzD,QAAAwH,GAAU,SAAS,IAAIpG,GAAOiF,IAAe,IAAIhF,CAAK,GACtDZ,EAAM,IAAI+G,EAAS;AAAA,MAAA,WAEVrC,EAAI,SAAS,WAAW;AAE3B,cAAAsC,IAAe,IAAIzH,EAAM,SAGzB0H,IAAW,IAAI1H,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,UACX,iBAAiB;AAAA,UACjB,WAAW;AAAA,UACX,oBAAoB;AAAA,QAAA,CACrB,GAEKiC,IAAW,IAAIjC,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,cAAc;AAAA,UACd,WAAW;AAAA,UACX,WAAW;AAAA,UACX,iBAAiB;AAAA,QAAA,CAClB,GAGK2H,IAAU,IAAI3H,EAAM;AAAA,UACxB,IAAIA,EAAM,YAAYmF,EAAI,OAAO,IAAIA,EAAI,MAAM;AAAA,UAC/CuC;AAAA,QAAA;AAEF,QAAAC,EAAQ,SAAS,IAAI,GAAG,IAAI,CAAC,GAC7BA,EAAQ,aAAa,IACrBA,EAAQ,gBAAgB,IACxBF,EAAa,IAAIE,CAAO;AAGlB,cAAAjC,IAAW,IAAI1F,EAAM;AAAA,UACzB,IAAIA,EAAM,YAAYmF,EAAI,OAAO,GAAGA,EAAI,MAAM;AAAA,UAC9ClD;AAAA,QAAA;AAEF,QAAAyD,EAAS,SAAS,IAAI,GAAG,IAAI,CAAC,GAC9B+B,EAAa,IAAI/B,CAAQ;AAGnB,cAAAkC,IAAQ,IAAI5H,EAAM;AAAA,UACtB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,KAAK,IAAIA,EAAI,SAAS,GAAG;AAAA,UAC3D,IAAInF,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK;AAAA,QAAA;AAEpE,QAAA4H,EAAM,SAAS,IAAI,CAACzC,EAAI,QAAQ,KAAK,IAAI,CAAC,GAC1CsC,EAAa,IAAIG,CAAK;AAGhB,cAAAC,KAAY,IAAI7H,EAAM,qBAAqB;AAAA,UAC/C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ;AAOD,QANwB;AAAA,UACtB,CAAC,CAACmF,EAAI,QAAQ,MAAMA,EAAI,SAAS,IAAI;AAAA,UACrC,CAAC,CAACA,EAAI,QAAQ,MAAMA,EAAI,SAAS,IAAI;AAAA,UACrC,CAAC,CAACA,EAAI,QAAQ,MAAM,CAACA,EAAI,SAAS,IAAI;AAAA,UACtC,CAAC,CAACA,EAAI,QAAQ,MAAM,CAACA,EAAI,SAAS,IAAI;AAAA,QAAA,EAExB,QAAQ,CAAC,CAAC2C,GAAIC,CAAE,MAAM;AAC9B,gBAAAC,IAAS,IAAIhI,EAAM;AAAA,YACvB,IAAIA,EAAM,iBAAiB,GAAG,GAAG,GAAG,EAAE;AAAA,YACtC6H;AAAA,UAAA;AAEK,UAAAG,EAAA,SAAS,IAAI,KAAK,KAAK,GAC9BA,EAAO,SAAS,IAAIF,GAAI,IAAIC,CAAE,GAC9BN,EAAa,IAAIO,CAAM;AAAA,QAAA,CACxB;AAGK,cAAAC,KAAO,IAAIjI,EAAM;AAAA,UACrB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,KAAK,IAAIA,EAAI,SAAS,IAAI;AAAA,UAC5D,IAAInF,EAAM,qBAAqB;AAAA,YAC7B,OAAO;AAAA,YACP,WAAW;AAAA,YACX,WAAW;AAAA,YACX,iBAAiB;AAAA,UAAA,CAClB;AAAA,QAAA;AAEH,QAAAiI,GAAK,SAAS,IAAI,CAAC9C,EAAI,QAAQ,KAAK,IAAI,CAAC,GACzC8C,GAAK,aAAa,IAClBR,EAAa,IAAIQ,EAAI;AAGf,cAAAC,KAAW,IAAIlI,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ;AACD,iBAAS+D,IAAI,GAAGA,IAAI,GAAGA,KAAK;AACpB,gBAAAoE,IAAQ,IAAInI,EAAM;AAAA,YACtB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,KAAK,GAAGA,EAAI,SAAS,GAAG;AAAA,YAC1D+C;AAAA,UAAA;AAEI,UAAAC,EAAA,SAAS,IAAIhD,EAAI,QAAQ,MAAM,KAAKpB,IAAI,IAAIoB,EAAI,SAAS,IAAI,GACnEgD,EAAM,aAAa,IACnBV,EAAa,IAAIU,CAAK;AAAA,QACxB;AAGM,cAAA1F,IAAY,IAAIzC,EAAM,qBAAqB;AAAA,UAC/C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ;AACD,iBAAS+D,IAAI,IAAIA,KAAK,GAAGA,KAAK;AACtB,gBAAArB,IAAS,IAAI1C,EAAM;AAAA,YACvB,IAAIA,EAAM,iBAAiB,KAAK,KAAK,IAAI,EAAE;AAAA,YAC3CyC;AAAA,UAAA;AAEK,UAAAC,EAAA,SAAS,IAAI,KAAK,KAAK,GACvBA,EAAA,SAAS,IAAIqB,IAAIoB,EAAI,QAAQ,KAAK,IAAIA,EAAI,SAAS,IAAI,GAC9DsC,EAAa,IAAI/E,CAAM;AAAA,QACzB;AAGA,cAAM0F,IAAe,IAAIpI,EAAM,WAAW,UAAU,KAAK,GAAG;AAC5D,QAAAoI,EAAa,SAAS,IAAI,GAAG,KAAK,CAAC,GACnCA,EAAa,aAAa,IAC1BX,EAAa,IAAIW,CAAY;AAGvB,cAAAC,IAAa,SAAS,cAAc,QAAQ;AAClD,QAAAA,EAAW,QAAQ,MACnBA,EAAW,SAAS;AACd,cAAAC,IAAUD,EAAW,WAAW,IAAI;AAC1C,QAAIC,MAEFA,EAAQ,YAAY,WACpBA,EAAQ,SAAS,GAAG,GAAGD,EAAW,OAAOA,EAAW,MAAM,GAG1DC,EAAQ,cAAc,WACtBA,EAAQ,YAAY,IACZA,EAAA,WAAW,IAAI,IAAID,EAAW,QAAQ,IAAIA,EAAW,SAAS,EAAE,GAGxEC,EAAQ,cAAc,WACtBA,EAAQ,YAAY,IACZA,EAAA,WAAW,IAAI,IAAID,EAAW,QAAQ,KAAKA,EAAW,SAAS,GAAG,GAG1EC,EAAQ,cAAc,sBACtBA,EAAQ,aAAa,IACrBA,EAAQ,gBAAgB,GACxBA,EAAQ,gBAAgB,GAGxBA,EAAQ,OAAO,oBACfA,EAAQ,YAAY,UACpBA,EAAQ,eAAe,UACvBA,EAAQ,YAAY,WACZA,EAAA,SAAS,SAASD,EAAW,QAAQ,GAAGA,EAAW,SAAS,IAAI,GAAG,GAG3EC,EAAQ,YAAY,WACpBA,EAAQ,OAAO,8CACPA,EAAA,SAAS,QAAQD,EAAW,QAAQ,GAAGA,EAAW,SAAS,IAAI,GAAG,GAG1EC,EAAQ,cAAc,WACtBA,EAAQ,YAAY,IACZA,EAAA,WAAW,QAAQD,EAAW,QAAQ,GAAGA,EAAW,SAAS,IAAI,GAAG,GAG5EC,EAAQ,cAAc,WACtBA,EAAQ,YAAY,GACZA,EAAA,WAAW,QAAQD,EAAW,QAAQ,GAAGA,EAAW,SAAS,IAAI,GAAG;AAE9E,cAAME,KAAc,IAAIvI,EAAM,cAAcqI,CAAU,GAGhDG,IAAe,IAAIxI,EAAM;AAAA,UAC7B,IAAIA,EAAM,cAAcmF,EAAI,SAAS,KAAKA,EAAI,SAAS,IAAI;AAAA,UAC3D,IAAInF,EAAM,qBAAqB;AAAA,YAC7B,KAAKuI;AAAA,YACL,WAAW;AAAA,YACX,WAAW;AAAA,YACX,UAAU;AAAA,YACV,mBAAmB;AAAA,UAAA,CACpB;AAAA,QAAA;AAEU,QAAAC,EAAA,SAAS,IAAI,CAACrD,EAAI,QAAQ,IAAI,GAAG,IAAI,CAAC,GACtCqD,EAAA,SAAS,IAAI,KAAK,KAAK,GACpCf,EAAa,IAAIe,CAAY;AAGvB,cAAAC,KAAgB,IAAIzI,EAAM;AAAA,UAC9B,IAAIA,EAAM,cAAcmF,EAAI,SAAS,KAAKA,EAAI,SAAS,IAAI;AAAA,UAC3D,IAAInF,EAAM,qBAAqB;AAAA,YAC7B,KAAKuI;AAAA,YACL,WAAW;AAAA,YACX,WAAW;AAAA,YACX,UAAU;AAAA,YACV,mBAAmB;AAAA,UAAA,CACpB;AAAA,QAAA;AAEH,QAAAE,GAAc,SAAS,IAAItD,EAAI,QAAQ,IAAI,GAAG,IAAI,CAAC,GACnDsD,GAAc,SAAS,IAAI,CAAC,KAAK,KAAK,GACtChB,EAAa,IAAIgB,EAAa,GAG9BhB,EAAa,SAAS,IAAIrG,GAAO,GAAGC,CAAK,GACzCoG,EAAa,SAAS,IAAIrC,GAC1B3E,EAAM,IAAIgH,CAAY;AAAA,MAAA,WAEbtC,EAAI,SAAS,UAAU;AAC1B,cAAAuD,IAAc,IAAI1I,EAAM,SAGxB2I,IAAY,IAAI3I,EAAM,qBAAqB;AAAA,UAC/C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEKgC,IAAU,IAAIhC,EAAM,qBAAqB;AAAA,UAC7C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEK4I,IAAW,IAAI5I,EAAM,qBAAqB;AAAA,UAC9C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEK6I,IAAe,IAAI7I,EAAM,qBAAqB;AAAA,UAClD,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEK8I,IAAa,KAGb/P,KAAQ,IAAIiH,EAAM;AAAA,UACtB,IAAIA,EAAM,YAAYmF,EAAI,OAAO,GAAGA,EAAI,MAAM;AAAA,UAC9C0D;AAAA,QAAA;AAEF9P,QAAAA,GAAM,SAAS,IAAI,GACnBA,GAAM,gBAAgB,IACtB2P,EAAY,IAAI3P,EAAK;AAGf,cAAAgQ,IAAW,IAAI/I,EAAM;AAAA,UACzB,IAAIA,EAAM,YAAYmF,EAAI,OAAO2D,GAAY,CAAC;AAAA,UAC9CH;AAAA,QAAA;AAEO,QAAAI,EAAA,SAAS,IAAI,GAAGD,IAAa,GAAG,CAAC3D,EAAI,SAAS,CAAC,GACxD4D,EAAS,aAAa,IACtBL,EAAY,IAAIK,CAAQ;AAGlB,cAAAC,KAAW,IAAIhJ,EAAM;AAAA,UACzB,IAAIA,EAAM,YAAY,GAAG8I,GAAY3D,EAAI,MAAM;AAAA,UAC/CwD;AAAA,QAAA;AAEO,QAAAK,GAAA,SAAS,IAAI,CAAC7D,EAAI,QAAQ,GAAG2D,IAAa,GAAG,CAAC,GACvDE,GAAS,aAAa,IACtBN,EAAY,IAAIM,EAAQ;AAElB,cAAAC,KAAY,IAAIjJ,EAAM;AAAA,UAC1B,IAAIA,EAAM,YAAY,GAAG8I,GAAY3D,EAAI,MAAM;AAAA,UAC/CwD;AAAA,QAAA;AAEF,QAAAM,GAAU,SAAS,IAAI9D,EAAI,QAAQ,GAAG2D,IAAa,GAAG,CAAC,GACvDG,GAAU,aAAa,IACvBP,EAAY,IAAIO,EAAS;AAInB,cAAAC,IAAgB,IAAIlJ,EAAM;AAAA,UAC9B,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,MAAM2D,GAAY,CAAC;AAAA,UACrDH;AAAA,QAAA;AAEF,QAAAO,EAAc,SAAS,IAAI,GAAGJ,IAAa,GAAG3D,EAAI,SAAS,CAAC,GAC5D+D,EAAc,aAAa,IAC3BR,EAAY,IAAIQ,CAAa;AAGvB,cAAAC,IAAc,IAAInJ,EAAM;AAAA,UAC5B,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,OAAO2D,GAAY,CAAC;AAAA,UACtDH;AAAA,QAAA;AAEU,QAAAQ,EAAA,SAAS,IAAI,CAAChE,EAAI,QAAQ,QAAQ2D,IAAa,GAAG3D,EAAI,SAAS,CAAC,GAC5EgE,EAAY,aAAa,IACzBT,EAAY,IAAIS,CAAW;AAGrB,cAAAC,IAAe,IAAIpJ,EAAM;AAAA,UAC7B,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,OAAO2D,GAAY,CAAC;AAAA,UACtDH;AAAA,QAAA;AAEW,QAAAS,EAAA,SAAS,IAAIjE,EAAI,QAAQ,QAAQ2D,IAAa,GAAG3D,EAAI,SAAS,CAAC,GAC5EiE,EAAa,aAAa,IAC1BV,EAAY,IAAIU,CAAY;AAGtB,cAAAC,IAAe,IAAIrJ,EAAM;AAAA,UAC7B,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,MAAM2D,IAAa,IAAI,CAAC;AAAA,UAC1DH;AAAA,QAAA;AAEW,QAAAU,EAAA,SAAS,IAAIlE,EAAI,QAAQ,OAAO,MAAM2D,IAAa,MAAM,GAAG3D,EAAI,SAAS,CAAC,GACvFkE,EAAa,aAAa,IAC1BX,EAAY,IAAIW,CAAY;AAGtB,cAAAC,KAAc,IAAItJ,EAAM;AAAA,UAC5B,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,MAAM2D,IAAa,IAAI,CAAC;AAAA,UAC1DH;AAAA,QAAA;AAEF,QAAAW,GAAY,SAAS,IAAI,CAACnE,EAAI,QAAQ,OAAO,MAAM2D,IAAa,MAAM,GAAG3D,EAAI,SAAS,CAAC,GACvFmE,GAAY,aAAa,IACzBZ,EAAY,IAAIY,EAAW;AAIrB,cAAAC,IAAO,IAAIvJ,EAAM;AAAA,UACrB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,MAAM,IAAI,CAAC;AAAA,UAC7CnD;AAAA,QAAA;AAEG,QAAAuH,EAAA,SAAS,IAAIpE,EAAI,QAAQ,OAAO,MAAMA,EAAI,SAAS,IAAI,CAAC,GAC7DoE,EAAK,aAAa,IAClBb,EAAY,IAAIa,CAAI;AAEd,cAAA9G,KAAY,IAAIzC,EAAM,qBAAqB;AAAA,UAC/C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GACK0C,IAAS,IAAI1C,EAAM;AAAA,UACvB,IAAIA,EAAM,iBAAiB,KAAK,KAAK,IAAI,EAAE;AAAA,UAC3CyC;AAAA,QAAA;AAEK,QAAAC,EAAA,SAAS,IAAI,KAAK,KAAK,GAC9BA,EAAO,SAAS,IAAIyC,EAAI,QAAQ,QAASA,EAAI,QAAQ,OAAQ,MAAMA,EAAI,SAAS,IAAI,CAAC,GACrFuD,EAAY,IAAIhG,CAAM;AAGhB,cAAA8G,IAAa,SAAS,cAAc,QAAQ;AAClD,QAAAA,EAAW,QAAQ,KACnBA,EAAW,SAAS;AACd,cAAAC,IAAUD,EAAW,WAAW,IAAI;AAC1C,YAAIC,GAAS;AAEX,gBAAMC,KAAWD,EAAQ,qBAAqB,GAAG,GAAG,GAAGD,EAAW,MAAM;AAC/D,UAAAE,GAAA,aAAa,GAAG,SAAS,GACzBA,GAAA,aAAa,GAAG,SAAS,GAClCD,EAAQ,YAAYC,IACpBD,EAAQ,SAAS,GAAG,GAAGD,EAAW,OAAOA,EAAW,MAAM,GAG1DC,EAAQ,cAAc,WACtBA,EAAQ,YAAY,IACZA,EAAA,WAAW,IAAI,IAAID,EAAW,QAAQ,IAAIA,EAAW,SAAS,EAAE,GAGxEC,EAAQ,cAAc,4BACtBA,EAAQ,YAAY,GACZA,EAAA,WAAW,IAAI,IAAID,EAAW,QAAQ,IAAIA,EAAW,SAAS,EAAE,GAGxEC,EAAQ,cAAc,sBACtBA,EAAQ,aAAa,IACrBA,EAAQ,gBAAgB,GACxBA,EAAQ,gBAAgB,GAGxBA,EAAQ,YAAY,WACpBA,EAAQ,OAAO,6BACfA,EAAQ,YAAY,UACpBA,EAAQ,eAAe,UACfA,EAAA,SAAS,QAAQD,EAAW,QAAQ,GAAGA,EAAW,SAAS,IAAI,GAAG,GAG1EC,EAAQ,cAAc,WACtBA,EAAQ,YAAY,GACpBA,EAAQ,UAAU,GAClBA,EAAQ,OAAO,KAAKD,EAAW,SAAS,CAAC,GACzCC,EAAQ,OAAOD,EAAW,QAAQ,KAAKA,EAAW,SAAS,CAAC,GAC5DC,EAAQ,OAAO;AAGT,gBAAAE,KAAeF,EAAQ,qBAAqB,GAAGD,EAAW,SAAS,GAAG,GAAGA,EAAW,SAAS,IAAI,GAAG;AAC7F,UAAAG,GAAA,aAAa,GAAG,SAAS,GACzBA,GAAA,aAAa,KAAK,SAAS,GAC3BA,GAAA,aAAa,GAAG,SAAS,GACtCF,EAAQ,YAAYE,IACpBF,EAAQ,OAAO,6BACPA,EAAA,SAAS,QAAQD,EAAW,QAAQ,GAAGA,EAAW,SAAS,IAAI,GAAG,GAG1EC,EAAQ,cAAc,WACtBA,EAAQ,YAAY,GACZA,EAAA,WAAW,QAAQD,EAAW,QAAQ,GAAGA,EAAW,SAAS,IAAI,GAAG;AAAA,QAC9E;AACA,cAAMI,KAAc,IAAI5J,EAAM,cAAcwJ,CAAU,GAChDK,IAAW,IAAI7J,EAAM;AAAA,UACzB,IAAIA,EAAM,cAAcmF,EAAI,QAAQ,MAAMA,EAAI,QAAQ,KAAK;AAAA,UAC3D,IAAInF,EAAM,qBAAqB;AAAA,YAC7B,KAAK4J;AAAA,YACL,WAAW;AAAA,YACX,WAAW;AAAA,YACX,UAAU;AAAA,YACV,mBAAmB;AAAA,UAAA,CACpB;AAAA,QAAA;AAEM,QAAAC,EAAA,SAAS,IAAI1E,EAAI,QAAQ,OAAO,MAAMA,EAAI,SAAS,IAAI,GAAG,GACnEuD,EAAY,IAAImB,CAAQ;AAGlB,cAAAC,IAAQ,IAAI9J,EAAM;AAAA,UACtB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,MAAM,IAAI,CAAC;AAAA,UAC7CyD;AAAA,QAAA;AAEI,QAAAkB,EAAA,SAAS,IAAI,CAAC3E,EAAI,QAAQ,OAAO,MAAMA,EAAI,SAAS,IAAI,CAAC,GAC/D2E,EAAM,aAAa,IACnBpB,EAAY,IAAIoB,CAAK;AAEf,cAAAC,KAAUrH,EAAO;AACvB,QAAAqH,GAAQ,SAAS,IAAI,CAAC5E,EAAI,QAAQ,QAASA,EAAI,QAAQ,OAAQ,MAAMA,EAAI,SAAS,IAAI,CAAC,GACvFuD,EAAY,IAAIqB,EAAO;AAGjB,cAAAC,IAAe,SAAS,cAAc,QAAQ;AACpD,QAAAA,EAAa,QAAQ,KACrBA,EAAa,SAAS;AAChB,cAAAC,IAAYD,EAAa,WAAW,IAAI;AAC9C,YAAIC,GAAW;AAEb,gBAAMP,KAAWO,EAAU,qBAAqB,GAAG,GAAG,GAAGD,EAAa,MAAM;AACnE,UAAAN,GAAA,aAAa,GAAG,SAAS,GACzBA,GAAA,aAAa,GAAG,SAAS,GAClCO,EAAU,YAAYP,IACtBO,EAAU,SAAS,GAAG,GAAGD,EAAa,OAAOA,EAAa,MAAM,GAGhEC,EAAU,cAAc,WACxBA,EAAU,YAAY,IACZA,EAAA,WAAW,IAAI,IAAID,EAAa,QAAQ,IAAIA,EAAa,SAAS,EAAE,GAG9EC,EAAU,cAAc,4BACxBA,EAAU,YAAY,GACZA,EAAA,WAAW,IAAI,IAAID,EAAa,QAAQ,IAAIA,EAAa,SAAS,EAAE,GAG9EC,EAAU,cAAc,sBACxBA,EAAU,aAAa,IACvBA,EAAU,gBAAgB,GAC1BA,EAAU,gBAAgB,GAG1BA,EAAU,YAAY,WACtBA,EAAU,OAAO,6BACjBA,EAAU,YAAY,UACtBA,EAAU,eAAe,UACfA,EAAA,SAAS,QAAQD,EAAa,QAAQ,GAAGA,EAAa,SAAS,IAAI,GAAG,GAGhFC,EAAU,cAAc,WACxBA,EAAU,YAAY,GACtBA,EAAU,UAAU,GACpBA,EAAU,OAAO,KAAKD,EAAa,SAAS,CAAC,GAC7CC,EAAU,OAAOD,EAAa,QAAQ,KAAKA,EAAa,SAAS,CAAC,GAClEC,EAAU,OAAO;AAGX,gBAAAC,KAAmBD,EAAU,qBAAqB,GAAGD,EAAa,SAAS,GAAG,GAAGA,EAAa,SAAS,IAAI,GAAG;AACnG,UAAAE,GAAA,aAAa,GAAG,SAAS,GACzBA,GAAA,aAAa,KAAK,SAAS,GAC3BA,GAAA,aAAa,GAAG,SAAS,GAC1CD,EAAU,YAAYC,IACtBD,EAAU,OAAO,6BACPA,EAAA,SAAS,UAAUD,EAAa,QAAQ,GAAGA,EAAa,SAAS,IAAI,GAAG,GAGlFC,EAAU,cAAc,WACxBA,EAAU,YAAY,GACZA,EAAA,WAAW,UAAUD,EAAa,QAAQ,GAAGA,EAAa,SAAS,IAAI,GAAG;AAAA,QACtF;AACA,cAAMG,KAAgB,IAAInK,EAAM,cAAcgK,CAAY,GACpDI,KAAa,IAAIpK,EAAM;AAAA,UAC3B,IAAIA,EAAM,cAAcmF,EAAI,QAAQ,MAAMA,EAAI,QAAQ,KAAK;AAAA,UAC3D,IAAInF,EAAM,qBAAqB;AAAA,YAC7B,KAAKmK;AAAA,YACL,WAAW;AAAA,YACX,WAAW;AAAA,YACX,UAAU;AAAA,YACV,mBAAmB;AAAA,UAAA,CACpB;AAAA,QAAA;AAEQ,QAAAC,GAAA,SAAS,IAAI,CAACjF,EAAI,QAAQ,OAAO,MAAMA,EAAI,SAAS,IAAI,GAAG,GACtEuD,EAAY,IAAI0B,EAAU;AAGpB,cAAArH,KAAS,SAAS,cAAc,QAAQ;AAC9C,QAAAA,GAAO,QAAQ,KACfA,GAAO,SAAS;AACV,cAAAC,KAAMD,GAAO,WAAW,IAAI;AAClC,QAAIC,OACFA,GAAI,YAAY,WAChBA,GAAI,SAAS,GAAG,GAAGD,GAAO,OAAOA,GAAO,MAAM,GAC9CC,GAAI,YAAY,WAChBA,GAAI,OAAO,oBACXA,GAAI,YAAY,UAChBA,GAAI,eAAe,UACnBA,GAAI,SAAS,QAAQD,GAAO,QAAQ,GAAGA,GAAO,SAAS,CAAC;AAG1D,cAAMsH,IAAY,IAAIrK,EAAM,cAAc+C,EAAM,GAC1CuH,KAAS,IAAItK,EAAM;AAAA,UACvB,IAAIA,EAAM,cAAcmF,EAAI,QAAQ,KAAKA,EAAI,QAAQ,GAAG;AAAA,UACxD,IAAInF,EAAM,qBAAqB;AAAA,YAC7B,KAAKqK;AAAA,YACL,WAAW;AAAA,YACX,WAAW;AAAA,UAAA,CACZ;AAAA,QAAA;AAEI,QAAAC,GAAA,SAAS,IAAI,GAAG,KAAK,CAACnF,EAAI,SAAS,IAAI,GAAG,GACjDuD,EAAY,IAAI4B,EAAM;AAGhB,cAAAC,KAAa,IAAIvK,EAAM,qBAAqB;AAAA,UAChD,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GACK2H,KAAU,IAAI3H,EAAM;AAAA,UACxB,IAAIA,EAAM,YAAYmF,EAAI,QAAQ,KAAK,IAAIA,EAAI,SAAS,IAAI;AAAA,UAC5DoF;AAAA,QAAA;AAEF,QAAA5C,GAAQ,SAAS,IAAI,GAAG,IAAI,CAACxC,EAAI,SAAS,GAAG,GAC7CwC,GAAQ,aAAa,IACrBe,EAAY,IAAIf,EAAO;AAGjB,cAAA6C,KAAU,IAAIxK,EAAM,qBAAqB;AAAA,UAC7C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GACKyK,KAAO,IAAIzK,EAAM;AAAA,UACrB,IAAIA,EAAM,iBAAiB,IAAI,IAAI,GAAG,EAAE;AAAA,UACxCwK;AAAA,QAAA;AAEF,QAAAC,GAAK,SAAS,IAAI,GAAG,IAAI,CAACtF,EAAI,SAAS,GAAG,GAC1CuD,EAAY,IAAI+B,EAAI;AAGd,cAAAC,KAAY,IAAI1K,EAAM,qBAAqB;AAAA,UAC/C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GACK2K,IAAS,IAAI3K,EAAM;AAAA,UACvB,IAAIA,EAAM,cAAc,GAAG,GAAG,GAAG,IAAI,KAAK,EAAE;AAAA,UAC5C0K;AAAA,QAAA;AAEK,QAAAC,EAAA,SAAS,IAAI,KAAK,KAAK,GAC9BA,EAAO,SAAS,IAAI,GAAG,IAAI,CAACxF,EAAI,SAAS,IAAI,GAC7CuD,EAAY,IAAIiC,CAAM;AAGhB,cAAAC,IAAY,IAAI5K,EAAM,qBAAqB;AAAA,UAC/C,OAAO;AAAA,UACP,WAAW;AAAA,UACX,WAAW;AAAA,QAAA,CACZ,GAEK6K,IAAa,IAAI7K,EAAM;AAAA,UAC3B,IAAIA,EAAM,iBAAiB,IAAI,GAAG,IAAI,EAAE;AAAA,UACxC4K;AAAA,QAAA;AAES,QAAAC,EAAA,SAAS,IAAI,CAAC1F,EAAI,QAAQ,MAAM,GAAGA,EAAI,SAAS,IAAI,GAC/DuD,EAAY,IAAImC,CAAU;AAEpB,cAAAC,IAAa,IAAI9K,EAAM;AAAA,UAC3B,IAAIA,EAAM,cAAc,GAAG,GAAG,IAAI,EAAE;AAAA,UACpC4K;AAAA,QAAA;AAES,QAAAE,EAAA,SAAS,IAAI,KAAK,KAAK,GACvBA,EAAA,SAAS,IAAI,CAAC3F,EAAI,QAAQ,MAAM,IAAIA,EAAI,SAAS,IAAI,GAChEuD,EAAY,IAAIoC,CAAU;AAEpB,cAAAC,IAAa,IAAI/K,EAAM;AAAA,UAC3B,IAAIA,EAAM,YAAY,IAAI,IAAI,CAAC;AAAA,UAC/B4K;AAAA,QAAA;AAES,QAAAG,EAAA,SAAS,IAAI,CAAC5F,EAAI,QAAQ,MAAM,IAAIA,EAAI,SAAS,OAAO,EAAE,GACrEuD,EAAY,IAAIqC,CAAU;AAEpB,cAAAC,IAAc,IAAIhL,EAAM;AAAA,UAC5B,IAAIA,EAAM,YAAY,GAAG,GAAG,CAAC;AAAA,UAC7B0K;AAAA,QAAA;AAEU,QAAAM,EAAA,SAAS,IAAI,CAAC7F,EAAI,QAAQ,OAAO,GAAG,IAAIA,EAAI,SAAS,OAAO,EAAE,GAC1EuD,EAAY,IAAIsC,CAAW;AAGrB,cAAAC,IAAS,IAAIjL,EAAM;AAAA,UACvB,IAAIA,EAAM,eAAe,GAAG,IAAI,IAAI,GAAG,KAAK,KAAK,GAAG,GAAG,KAAK,KAAK,GAAG;AAAA,UACpE4K;AAAA,QAAA;AAEK,QAAAK,EAAA,SAAS,IAAI9F,EAAI,QAAQ,MAAM,IAAIA,EAAI,SAAS,IAAI,GACpD8F,EAAA,SAAS,IAAI,KAAK,KAAK,GAC9BvC,EAAY,IAAIuC,CAAM;AAEhB,cAAAC,KAAc,IAAIlL,EAAM;AAAA,UAC5B,IAAIA,EAAM,iBAAiB,KAAK,KAAK,GAAG,EAAE;AAAA,UAC1C0K;AAAA,QAAA;AAEU,QAAAQ,GAAA,SAAS,IAAI/F,EAAI,QAAQ,MAAM,IAAIA,EAAI,SAAS,OAAO,CAAC,GACpEuD,EAAY,IAAIwC,EAAW;AAG3B,cAAMC,KAAY,IAAInL,EAAM,WAAW,UAAU,KAAK,GAAG;AACzD,QAAAmL,GAAU,SAAS,IAAI,GAAGrC,IAAa,IAAI,CAAC,GAC5CqC,GAAU,aAAa,IACvBzC,EAAY,IAAIyC,EAAS,GAGzBzC,EAAY,SAAS,IAAItH,GAAO,GAAGC,CAAK,GACxCqH,EAAY,SAAS,IAAItD,GACzB3E,EAAM,IAAIiI,CAAW;AAAA,MACvB;AAAA,IAAA,CACD,GAGK3P,EAAA,OAAO,QAAQ,CAAS3G,MAAA;AAG5B,YAAMC,IAAcD,EAAM,UAAU,cAAcA,EAAM,QAAQ,MAAMA,EAAM,OACtEgZ,IAAShZ,EAAM,IAAI,MAAMC,IAAc,GACvCgZ,IAAS,EAAEjZ,EAAM,IAAI,MAAMA,EAAM,SAAS,IAC1CkZ,IAAc,EAAElZ,EAAM,WAAW,KAAK,KAAK,MAG3CmZ,IAAgB,IAAIvL,EAAM,qBAAqB;AAAA,QACnD,OAAO;AAAA;AAAA,QACP,WAAW;AAAA,QACX,WAAW;AAAA,QACX,WAAW;AAAA;AAAA,QACX,oBAAoB;AAAA,QACpB,OAAO;AAAA;AAAA,QACP,YAAY,IAAIA,EAAM,MAAM,QAAQ;AAAA,MAAA,CACrC,GAGKwL,IACJpZ,EAAM,UAAU,WACZ,IAAI4N,EAAM,iBAAiB3N,IAAc,GAAGA,IAAc,GAAG,GAAgB,EAAE,IAC/E,IAAI2N,EAAM,YAAY3N,GAAa,GAAgBD,EAAM,MAAM,GAE/DqZ,IAAY,IAAIzL,EAAM,KAAKwL,GAAeD,CAAa;AAQzD,UAPJE,EAAU,SAAS,IAAIL,GAAQ,KAAY,IAAiB,GAAGC,CAAM,GACrEI,EAAU,SAAS,IAAIH,GACvBG,EAAU,aAAa,IACvBA,EAAU,gBAAgB,IAC1BhL,EAAM,IAAIgL,CAAS,GAGfrZ,EAAM,UAAU,UAAU;AACtB,cAAAsZ,IAAW,IAAI1L,EAAM;AAAA,UACzB,IAAIA,EAAM,cAAc3N,IAAc,IAAI,GAAG,KAAK,IAAI,EAAE;AAAA,UACxD,IAAI2N,EAAM,qBAAqB;AAAA,YAC7B,OAAO;AAAA;AAAA,YACP,WAAW;AAAA,YACX,WAAW;AAAA,UAAA,CACZ;AAAA,QAAA;AAEH,QAAA0L,EAAS,SAAS,IAAIN,GAAQ,KAAY,IAAiB,IAAI,KAAKC,CAAM,GACjEK,EAAA,SAAS,IAAI,KAAK,KAAK,GAChCjL,EAAM,IAAIiL,CAAQ;AAAA,MAAA,OACb;AACC,cAAAzG,IAAQ,IAAIjF,EAAM;AAAA,UACtB,IAAIA,EAAM,cAAcwL,CAAa;AAAA,UACrC,IAAIxL,EAAM,kBAAkB,EAAE,OAAO,UAAU,WAAW,GAAG;AAAA,QAAA;AAEzD,QAAAiF,EAAA,SAAS,KAAKwG,EAAU,QAAQ,GACtCxG,EAAM,SAAS,IAAIqG,GACnB7K,EAAM,IAAIwE,CAAK;AAAA,MACjB;AAGM,YAAA0G,KAAc,IAAI3L,EAAM,qBAAqB;AAAA,QACjD,OAAO;AAAA,QACP,WAAW;AAAA,QACX,WAAW;AAAA,MAAA,CACZ,GAEK4L,IAAY;AAgBlB,OAdExZ,EAAM,UAAU,WACZ;AAAA,QACE,CAACC,IAAc,KAAKA,IAAc,GAAG;AAAA,QACrC,CAAC,CAACA,IAAc,KAAKA,IAAc,GAAG;AAAA,QACtC,CAACA,IAAc,KAAK,CAACA,IAAc,GAAG;AAAA,QACtC,CAAC,CAACA,IAAc,KAAK,CAACA,IAAc,GAAG;AAAA,MAAA,IAEzC;AAAA,QACE,CAACA,IAAc,IAAI,IAAID,EAAM,SAAS,IAAI,EAAE;AAAA,QAC5C,CAAC,CAACC,IAAc,IAAI,IAAID,EAAM,SAAS,IAAI,EAAE;AAAA,QAC7C,CAACC,IAAc,IAAI,IAAI,CAACD,EAAM,SAAS,IAAI,EAAE;AAAA,QAC7C,CAAC,CAACC,IAAc,IAAI,IAAI,CAACD,EAAM,SAAS,IAAI,EAAE;AAAA,MAAA,GAG3C,QAAQ,CAAC,CAAC6T,GAAIC,CAAE,MAAM;AACzB,cAAAC,IAAM,IAAInG,EAAM;AAAA,UACpB,IAAIA,EAAM,iBAAiB4L,GAAWA,GAAW,IAAW,EAAE;AAAA,UAC9DD;AAAA,QAAA;AAEF,QAAAxF,EAAI,SAAS;AAAA,UACXiF,IAASnF,IAAK,KAAK,IAAIqF,CAAW,IAAIpF,IAAK,KAAK,IAAIoF,CAAW;AAAA,UAC/D,KAAY;AAAA,UACZD,IAASpF,IAAK,KAAK,IAAIqF,CAAW,IAAIpF,IAAK,KAAK,IAAIoF,CAAW;AAAA,QAAA,GAEjEnF,EAAI,aAAa,IACjB1F,EAAM,IAAI0F,CAAG;AAAA,MAAA,CACd;AAGK,YAAA0F,KAAc9S,EAAM,OAAO,OAAO,OAAKiF,EAAE,YAAY5L,EAAM,EAAE;AAEnE,MAAAyZ,GAAY,QAAQ,CAASzY,MAAA;AACrB,cAAAO,IAAYP,EAAM,QAAQ,IAC1B0Y,IAAc,IAGdC,IAAe,IAAI/L,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK,WAAW,IAAK,CAAA,GACjGgM,KAAkB,IAAIhM,EAAM,qBAAqB,EAAE,OAAO,UAAU,WAAW,KAAK,WAAW,KAAM,CAAA,GAGrGiM,IAAcJ,GAAY,OAAO,CAAA7N,OAAKA,GAAE,aAAa5K,EAAM,QAAQ,EAAE,QAErE8Y,KADU,CAAC,OAAO,QAAQ,EAAE,SAAS9Y,EAAM,QAAQ,IAAIf,IAAcD,EAAM,UACpDuB,IAAYsY,GACnCE,IAAMF,IAAc,IAAIC,KAAcD,IAAc,KAAKC,IAAa,GACtEE,IAASD,IAAM/Y,EAAM,SAASO,IAAYwY,KAAOxY,IAAY,GAC7DC,KAAUD,IAAY;AAExB,YAAA0Y,IAAO,GAAGC,IAAO;AACjB,QAAAlZ,EAAM,aAAa,SACrBiZ,IAAOD,IAAS/Z,IAAc,GAC9Bia,IAAOla,EAAM,SAAS,IAAIwB,KAAUD,IAAY,KACvCP,EAAM,aAAa,YAC5BiZ,IAAOD,IAAS/Z,IAAc,GAC9Bia,IAAO,EAAEla,EAAM,SAAS,IAAIwB,KAAUD,IAAY,MACzCP,EAAM,aAAa,UAC5BiZ,IAAO,EAAEha,IAAc,IAAIuB,KAAUD,IAAY,IAC1C2Y,IAAAF,IAASha,EAAM,SAAS,MAExBia,IAAAha,IAAc,IAAIuB,KAAUD,IAAY,GACxC2Y,IAAAF,IAASha,EAAM,SAAS;AAI3B,cAAAma,KAAOF,IAAO,KAAK,IAAIf,CAAW,IAAIgB,IAAO,KAAK,IAAIhB,CAAW,GACjEkB,IAAOH,IAAO,KAAK,IAAIf,CAAW,IAAIgB,IAAO,KAAK,IAAIhB,CAAW,GAGjEmB,IAAO,IAAIzM,EAAM;AAAA,UACrB,IAAIA,EAAM,YAAYrM,IAAY,MAAM,GAAGA,IAAY,IAAI;AAAA,UAC3DqY;AAAA,QAAA,GAEIU,KAAaZ,IAAc;AACjC,QAAAW,EAAK,SAAS,IAAIrB,IAASmB,IAAMG,IAAYrB,IAASmB,CAAI;AAG1D,cAAMG,KAAU;AAAA,UACd,KAAK;AAAA,UACL,QAAQ,KAAK;AAAA,UACb,MAAM,KAAK,KAAK;AAAA,UAChB,OAAO,CAAC,KAAK,KAAK;AAAA,QAAA,EAClBvZ,EAAM,QAAQ,KAAK;AAChB,QAAAqZ,EAAA,SAAS,IAAIE,KAAUrB,GAC5BmB,EAAK,aAAa,IAClBhM,EAAM,IAAIgM,CAAI;AAGR,cAAAG,KAAO,IAAI5M,EAAM;AAAA,UACrB,IAAIA,EAAM,YAAYrM,IAAY,MAAMmY,IAAc,MAAM,CAAC;AAAA,UAC7DC;AAAA,QAAA,GAEIc,KAAUlZ,IAAY,OAAO,IAAI;AACvC,QAAAiZ,GAAK,SAAS;AAAA,UACZH,EAAK,SAAS,IAAI,KAAK,IAAIA,EAAK,SAAS,CAAC,IAAII;AAAA,UAC9Cf,IAAc;AAAA,UACdW,EAAK,SAAS,IAAI,KAAK,IAAIA,EAAK,SAAS,CAAC,IAAII;AAAA,QAAA,GAE3CD,GAAA,SAAS,IAAIH,EAAK,SAAS,GAChCG,GAAK,aAAa,IAClBnM,EAAM,IAAImM,EAAI;AAIRE,cAAAA,KAAYJ,KADI,IACyB,GACzC1G,KAAS,IAAIhG,EAAM,iBAAiB,GAAG,GAAG8M,IAAW,CAAC,GACtD/G,KAAS,IAAI/F,EAAM,qBAAqB,EAAE,OAAO,SAAU,WAAW,KAAK,WAAW,IAAK,CAAA;AAEjG;AAAA,UAAC,CAACrM,IAAY,KAAKA,IAAY,GAAG;AAAA,UAAG,CAACA,IAAY,KAAK,CAACA,IAAY,GAAG;AAAA,UACtE,CAAC,CAACA,IAAY,KAAKA,IAAY,GAAG;AAAA,UAAG,CAAC,CAACA,IAAY,KAAK,CAACA,IAAY,GAAG;AAAA,UACvE,QAAQ,CAAC,CAACsS,IAAIC,EAAE,MAAM;AACtB,gBAAMC,KAAM,IAAInG,EAAM,KAAKgG,IAAQD,EAAM,GACnCgH,IAAM,KAAK,IAAIN,EAAK,SAAS,CAAC,GAC9BO,IAAM,KAAK,IAAIP,EAAK,SAAS,CAAC;AACpC,UAAAtG,GAAI,SAAS;AAAA,YACXsG,EAAK,SAAS,IAAIxG,KAAK8G,IAAM7G,KAAK8G;AAAA,YAClCF,KAAY;AAAA;AAAA,YACZL,EAAK,SAAS,IAAIxG,KAAK+G,IAAM9G,KAAK6G;AAAA,UAAA,GAEpC5G,GAAI,aAAa,IACjB1F,EAAM,IAAI0F,EAAG;AAAA,QAAA,CACd;AAAA,MAAA,CACF;AAAA,IAAA,CACF;AAGD,UAAM8G,IAAU,MAAM;;AAIpB,UAHkB9N,GAAA,UAAU,sBAAsB8N,CAAO,GAGrDtN,EAAc,WAAWA,EAAc,QAAQ,WAAW,GAAG;AAC/D,cAAMuN,IAAIvN,EAAc;AACxB,QAAAuN,EAAE,YAAY,MAEVA,EAAE,YAAY,MAChBA,EAAE,WAAW,GACbzN,GAAmB,EAAK,GACxBE,EAAc,UAAU;AAQpB,cAAAwN,KAJiB,CAACC,MACfA,IAAI,MAAM,IAAIA,IAAIA,IAAIA,IAAI,IAAI,KAAK,IAAI,KAAKA,IAAI,GAAG,CAAC,IAAI,GAG5BF,EAAE,QAAQ;AAE/C,YAAIjO,EAAU,SAAS;AACrB,UAAAA,EAAU,QAAQ,SAAS,YAAYiO,EAAE,UAAUA,EAAE,QAAQC,CAAa;AACpE,gBAAAE,IAAgB,IAAIrN,EAAM;AAChC,UAAAqN,EAAc,YAAYH,EAAE,aAAaA,EAAE,WAAWC,CAAa,GACzDlO,EAAA,QAAQ,OAAOoO,CAAa;AAAA,QACxC;AAAA,MACF;AAGA,UAAIjO,KAAcH,EAAU,WAAW,CAACO,GAAiB;AACvD,cAAM8N,IAAI,KAAK,KAAKrO,EAAU,QAAQ,SAAS,KAAK,IAAIA,EAAU,QAAQ,SAAS,KAAK,CAAC,GACnFsO,IAAI,KAAK,MAAMtO,EAAU,QAAQ,SAAS,GAAGA,EAAU,QAAQ,SAAS,CAAC,IAAIS,GAAiB;AACpG,QAAAT,EAAU,QAAQ,SAAS,IAAIqO,IAAI,KAAK,IAAIC,CAAC,GAC7CtO,EAAU,QAAQ,SAAS,IAAIqO,IAAI,KAAK,IAAIC,CAAC,GAC7CtO,EAAU,QAAQ,OAAO,GAAG,KAAK,CAAC;AAAA,MACpC;AAEY,OAAAuO,IAAAtO,EAAA,YAAA,QAAAsO,EAAS,OAAO/M,GAAOV;AAAA,IAAM;AAEnC,IAAAkN;AAER,UAAMQ,KAAe,MAAM;AACzB,MAAI1O,EAAa,WAAWE,EAAU,WAAWC,EAAY,YAC3DD,EAAU,QAAQ,SAASF,EAAa,QAAQ,cAAcA,EAAa,QAAQ,cACnFE,EAAU,QAAQ,0BAClBC,EAAY,QAAQ,QAAQH,EAAa,QAAQ,aAAaA,EAAa,QAAQ,YAAY;AAAA,IACjG;AAEK,kBAAA,iBAAiB,UAAU0O,EAAY,GAEvC,MAAM;AACJ,aAAA,oBAAoB,UAAUA,EAAY,GAC7CtO,GAAkB,WAAS,qBAAqBA,GAAkB,OAAO,GACzED,EAAY,WAAWH,EAAa,YACtCA,EAAa,QAAQ,YAAYG,EAAY,QAAQ,UAAU,GAC/DA,EAAY,QAAQ;IACtB;AAAA,KAED,CAACL,GAAQ9F,GAAOqG,GAAYI,CAAe,CAAC,GAE1CX,sBAGF,OAAI,EAAA,WAAU,mHACb,UAAC,gBAAAtJ,EAAA,OAAA,EAAI,WAAU,6MAEb,UAAA;AAAA,IAAA,gBAAAX,EAAC,SAAI,WAAU,qEACb,UAAC,gBAAAW,EAAA,OAAA,EAAI,WAAU,mFACb,UAAA;AAAA,MAAA,gBAAAA,EAAC,OACC,EAAA,UAAA;AAAA,QAAC,gBAAAA,EAAA,MAAA,EAAG,WAAU,iFACZ,UAAA;AAAA,UAAA,gBAAAX,EAAC,SAAI,WAAU,wEACb,4BAAC8Y,IAAO,EAAA,WAAU,mBAAkB,EACtC,CAAA;AAAA,UAAM;AAAA,QAAA,GAER;AAAA,QACA,gBAAAnY,EAAC,KAAE,EAAA,WAAU,0CAAyC,UAAA;AAAA,UAAA;AAAA,UAAgCwD,EAAM;AAAA,QAAA,GAAK;AAAA,MAAA,GACnG;AAAA,MACA,gBAAAnE;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,SAASkK;AAAA,UACT,WAAU;AAAA,UAEV,UAAA,gBAAAlK,EAAC+Y,IAAE,EAAA,WAAU,kBAAkB,CAAA;AAAA,QAAA;AAAA,MACjC;AAAA,IAAA,EAAA,CACF,EACF,CAAA;AAAA,IAGA,gBAAApY,EAAC,OAAI,EAAA,WAAU,qDAEb,UAAA;AAAA,MAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,qKAEb,UAAA;AAAA,QAAA,gBAAAX;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAAS,MAAMgL,GAAuB,SAAS;AAAA,YAC/C,WAAU;AAAA,YACX,UAAA;AAAA,UAAA;AAAA,QAED;AAAA,QAGA,gBAAArK,EAAC,OAAI,EAAA,WAAU,mCACb,UAAA;AAAA,UAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,2JACb,UAAA;AAAA,YAAC,gBAAAX,EAAA8Y,IAAA,EAAO,WAAU,sCAAsC,CAAA;AAAA,YAAE;AAAA,UAAA,GAE5D;AAAA,4BAGC,OAAI,EAAA,WAAU,+BACb,UAAC,gBAAAnY,EAAA,OAAA,EAAI,WAAU,mCACb,UAAA;AAAA,YAAA,gBAAAX;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,SAAS,MAAMqL,GAAa,IAAI;AAAA,gBAChC,WAAU;AAAA,gBACV,UAAUT;AAAA,gBACV,OAAM;AAAA,gBAEN,UAAA,gBAAA5K,EAAC,SAAI,WAAU,mBAAkB,MAAK,QAAO,QAAO,gBAAe,SAAQ,aACzE,4BAAC,QAAK,EAAA,eAAc,SAAQ,gBAAe,SAAQ,aAAa,GAAG,GAAE,iBAAgB,EACvF,CAAA;AAAA,cAAA;AAAA,YACF;AAAA,YACA,gBAAAW,EAAC,OAAI,EAAA,WAAU,yCACb,UAAA;AAAA,cAAA,gBAAAX;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,SAAS,MAAMqL,GAAa,MAAM;AAAA,kBAClC,WAAU;AAAA,kBACV,UAAUT;AAAA,kBACV,OAAM;AAAA,kBAEN,UAAA,gBAAA5K,EAAC,SAAI,WAAU,mBAAkB,MAAK,QAAO,QAAO,gBAAe,SAAQ,aACzE,4BAAC,QAAK,EAAA,eAAc,SAAQ,gBAAe,SAAQ,aAAa,GAAG,GAAE,mBAAkB,EACzF,CAAA;AAAA,gBAAA;AAAA,cACF;AAAA,cACA,gBAAAA,EAAC,SAAI,WAAU,+HACb,4BAAC8Y,IAAO,EAAA,WAAU,kCAAiC,EACrD,CAAA;AAAA,cACA,gBAAA9Y;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,SAAS,MAAMqL,GAAa,OAAO;AAAA,kBACnC,WAAU;AAAA,kBACV,UAAUT;AAAA,kBACV,OAAM;AAAA,kBAEN,UAAA,gBAAA5K,EAAC,SAAI,WAAU,mBAAkB,MAAK,QAAO,QAAO,gBAAe,SAAQ,aACzE,4BAAC,QAAK,EAAA,eAAc,SAAQ,gBAAe,SAAQ,aAAa,GAAG,GAAE,gBAAe,EACtF,CAAA;AAAA,gBAAA;AAAA,cACF;AAAA,YAAA,GACF;AAAA,YACA,gBAAAA;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,SAAS,MAAMqL,GAAa,MAAM;AAAA,gBAClC,WAAU;AAAA,gBACV,UAAUT;AAAA,gBACV,OAAM;AAAA,gBAEN,UAAA,gBAAA5K,EAAC,SAAI,WAAU,mBAAkB,MAAK,QAAO,QAAO,gBAAe,SAAQ,aACzE,4BAAC,QAAK,EAAA,eAAc,SAAQ,gBAAe,SAAQ,aAAa,GAAG,GAAE,kBAAiB,EACxF,CAAA;AAAA,cAAA;AAAA,YACF;AAAA,UAAA,EAAA,CACF,EACF,CAAA;AAAA,QAAA,GACF;AAAA,QAGA,gBAAAW,EAAC,OAAI,EAAA,WAAU,mCACb,UAAA;AAAA,UAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,2JACb,UAAA;AAAA,YAAC,gBAAAX,EAAAgZ,IAAA,EAAO,WAAU,qCAAqC,CAAA;AAAA,YAAE;AAAA,UAAA,GAE3D;AAAA,UAEA,gBAAArY,EAAC,OAAI,EAAA,WAAU,mCACb,UAAA;AAAA,YAAA,gBAAAA;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,SAAS,MAAMgL,GAAW,IAAI;AAAA,gBAC9B,WAAU;AAAA,gBACV,UAAUf;AAAA,gBAEV,UAAA;AAAA,kBAAC,gBAAA5K,EAAAgZ,IAAA,EAAO,WAAU,kBAAkB,CAAA;AAAA,kBAAE;AAAA,gBAAA;AAAA,cAAA;AAAA,YAExC;AAAA,YACA,gBAAArY;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,SAAS,MAAMgL,GAAW,IAAI;AAAA,gBAC9B,WAAU;AAAA,gBACV,UAAUf;AAAA,gBAEV,UAAA;AAAA,kBAAC,gBAAA5K,EAAAiZ,IAAA,EAAQ,WAAU,kBAAkB,CAAA;AAAA,kBAAE;AAAA,gBAAA;AAAA,cAAA;AAAA,YAEzC;AAAA,YACA,gBAAAtY;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,SAAS,MAAM8J,GAAc,CAACD,CAAU;AAAA,gBACxC,WAAW,4GACTA,IACI,wEACA,8DACN;AAAA,gBAEA,UAAA;AAAA,kBAAA,gBAAAxK,EAACuJ,MAAU,WAAW,WAAWiB,IAAa,iBAAiB,EAAE,IAAI;AAAA,kBACpEA,IAAa,kBAAkB;AAAA,gBAAA;AAAA,cAAA;AAAA,YAClC;AAAA,UAAA,GACF;AAAA,QAAA,GACF;AAAA,QAGA,gBAAA7J,EAAC,OAAI,EAAA,WAAU,2CACb,UAAA;AAAA,UAAA,gBAAAA;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,SAAS,MAAMqK,GAAuB,SAAS;AAAA,cAC/C,WAAU;AAAA,cAEV,UAAA;AAAA,gBAAC,gBAAAhL,EAAAkZ,IAAA,EAAU,WAAU,kBAAkB,CAAA;AAAA,gBAAE;AAAA,cAAA;AAAA,YAAA;AAAA,UAE3C;AAAA,UAGA,gBAAAvY,EAAC,OAAI,EAAA,WAAU,wEACb,UAAA;AAAA,YAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,kEACb,UAAA;AAAA,cAAC,gBAAAX,EAAAmZ,IAAA,EAAK,WAAU,kBAAkB,CAAA;AAAA,cACjC,gBAAAnZ,EAAA,QAAA,EAAK,WAAU,+BAA8B,UAAgB,oBAAA;AAAA,YAAA,GAChE;AAAA,YACA,gBAAAW,EAAC,OAAI,EAAA,WAAU,8CACb,UAAA;AAAA,cAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,uCACb,UAAA;AAAA,gBAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,oEAAoE,CAAA;AAAA,gBACnF,gBAAAW,EAAC,QAAK,EAAA,WAAU,qBAAqB,UAAA;AAAA,kBAAAwD,EAAM,OAAO;AAAA,kBAAO;AAAA,gBAAA,GAAO;AAAA,cAAA,GAClE;AAAA,cACA,gBAAAxD,EAAC,OAAI,EAAA,WAAU,uCACb,UAAA;AAAA,gBAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,kEAAkE,CAAA;AAAA,gBACjF,gBAAAW,EAAC,QAAK,EAAA,WAAU,qBAAqB,UAAA;AAAA,kBAAAwD,EAAM,OAAO;AAAA,kBAAO;AAAA,gBAAA,GAAO;AAAA,cAAA,GAClE;AAAA,cACA,gBAAAxD,EAAC,OAAI,EAAA,WAAU,uCACb,UAAA;AAAA,gBAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,uEAAuE,CAAA;AAAA,gBACtF,gBAAAW,EAAC,QAAK,EAAA,WAAU,qBAAqB,UAAA;AAAA,kBAAAwD,EAAM,QAAQ;AAAA,kBAAO;AAAA,gBAAA,GAAQ;AAAA,cAAA,GACpE;AAAA,cACA,gBAAAxD,EAAC,OAAI,EAAA,WAAU,uCACb,UAAA;AAAA,gBAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,qEAAqE,CAAA;AAAA,gBACpF,gBAAAW,EAAC,QAAK,EAAA,WAAU,qBAAqB,UAAA;AAAA,kBAAAwD,EAAM,MAAM;AAAA,kBAAO;AAAA,gBAAA,GAAM;AAAA,cAAA,GAChE;AAAA,YAAA,GACF;AAAA,UAAA,GACF;AAAA,QAAA,GACF;AAAA,MAAA,GACF;AAAA,MAGA,gBAAAxD,EAAC,OAAI,EAAA,WAAU,6JACb,UAAA;AAAA,QAAA,gBAAAX,EAAC,OAAI,EAAA,KAAKmK,GAAc,WAAU,yBAAwB;AAAA,QAGzDS,KACC,gBAAA5K,EAAC,OAAI,EAAA,WAAU,6EACb,UAAA,gBAAAA,EAAC,OAAI,EAAA,WAAU,2GACb,UAAA,gBAAAW,EAAC,OAAI,EAAA,WAAU,uCACb,UAAA;AAAA,UAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,oGAAoG,CAAA;AAAA,UAClH,gBAAAA,EAAA,QAAA,EAAK,WAAU,8CAA6C,UAAuB,2BAAA;AAAA,QAAA,EACtF,CAAA,EACF,CAAA,GACF;AAAA,MAAA,GAEJ;AAAA,IAAA,GACF;AAAA,sBAGC,OAAI,EAAA,WAAU,+GACb,UAAC,gBAAAW,EAAA,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,MAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,uCACb,UAAA;AAAA,QAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,uCACb,UAAA;AAAA,UAAC,gBAAAX,EAAAsE,IAAA,EAAO,WAAU,oCAAoC,CAAA;AAAA,UACtD,gBAAA3D,EAAC,QAAK,EAAA,WAAU,iCAAgC,UAAA;AAAA,YAAA;AAAA,YACpC,gBAAAX,EAAA,QAAA,EAAK,WAAU,oCAAoC,YAAM,MAAK;AAAA,UAAA,GAC1E;AAAA,QAAA,GACF;AAAA,QACA,gBAAAW,EAAC,OAAI,EAAA,WAAU,iCAAgC,UAAA;AAAA,UAAA;AAAA,4BACpC,QAAK,EAAA,WAAU,oCAAoC,UAAaoJ,GAAAW,CAAW,EAAE,MAAK;AAAA,QAAA,GAC7F;AAAA,MAAA,GACF;AAAA,MACA,gBAAA/J,EAAC,OAAI,EAAA,WAAU,qEACb,UAAA;AAAA,QAAA,gBAAAX,EAAC,UAAK,UAAqB,wBAAA,CAAA;AAAA,QAC3B,gBAAAA,EAAC,OAAI,EAAA,WAAU,sEAAsE,CAAA;AAAA,MAAA,GACvF;AAAA,IAAA,EAAA,CACF,EACF,CAAA;AAAA,EAAA,EACF,CAAA,EACF,CAAA,IApNkB;AAsNtB,GCz1DMoZ,KAAmC,MAAM;AAC7C,QAAM,CAAC3W,GAAQ4W,CAAS,IAAIlY,EAAkB;AAAA,IAC5C;AAAA,MACE,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,UAAU;AAAA,MACV,QAAQ,CAAC;AAAA,MACT,QAAQ,CAAC;AAAA,MACT,SAAS,CAAC;AAAA,MACV,OAAO,CAAC;AAAA,MACR,eAAe,CAAC;AAAA,IAClB;AAAA,EAAA,CACD,GACK,CAACuB,GAAc4W,CAAe,IAAInY,EAAiB,SAAS,GAC5D,CAACoY,GAAiBC,CAAkB,IAAIrY,EAAiC,IAAI,GAC7E,CAACF,GAAYC,EAAa,IAAIC,EAAkB,EAAK,GACrD,CAACsY,GAAYC,EAAa,IAAIvY,EAAmC,EAAE,GAAG,GAAG,GAAG,EAAA,CAAG,GAC/EwY,IAAO,GACP,CAACpU,GAAUqU,CAAW,IAAIzY,EAAkB,EAAI,GAChD,CAAC0Y,IAAeC,EAAgB,IAAI3Y,EAAkB,EAAK,GAG3D,CAAC4Y,GAAeC,EAAgB,IAAI7Y,EAAkB,EAAK,GAC3D,CAAC2D,IAAUmV,EAAW,IAAI9Y,EAA0B,IAAI,GACxD,CAAC+Y,GAAgBC,CAAiB,IAAIhZ,EAA0C,IAAI,GACpF,CAACiZ,GAAkBC,EAAmB,IAAIlZ,EAA0C,IAAI,GAGxF,CAACmZ,IAAgBC,EAAiB,IAAIpZ,EAAkB,EAAK,GAC7D,CAACqZ,IAAoBC,EAAqB,IAAItZ,EAAiC,IAAI,GACnF,CAACuZ,GAAmBC,EAAoB,IAAIxZ,EAKxC,IAAI,GAERyZ,IAAYvT,GAAuB,IAAI,GACvCwT,IAAiBxT,GAA4C,IAAI,GACjEyT,KAASzT,GAAsB,IAAI;AAGzC,EAAA0B,GAAU,MAAM;AACV,SAAAwQ,KAAA,gBAAAA,EAAiB,UAAS,SAAS;AACrC,YAAMpV,IAAQ4W;AACd,UAAI,CAAC5W;AAAO;AAEN,YAAA8S,IAAc9S,EAAM,OAAO,OAAO,OAAK,EAAE,YAAYoV,EAAgB,EAAE;AAGzE,UAFsBtC,EAAY,OAAO,CAAK,MAAA,EAAE,SAAS,MAAS,EAEhD,SAAS,GAAG;AAEhC,cAAM+D,IAAgD,CAAA;AAEtD,QAAA/D,EAAY,QAAQ,CAASzY,MAAA;AAC3B,UAAIA,EAAM,SAAS,UAAa,CAACwc,EAAexc,EAAM,QAAQ,MAC7Cwc,EAAAxc,EAAM,QAAQ,IAAIA,EAAM;AAAA,QACzC,CACD,GAED6a,EAAU,OAAQ4B,EAAK;AAAA,UAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,YACE,GAAGyB;AAAAA,YACH,QAAQA,EAAM,OAAO,IAAI,CAAS3F,MAAA;AAChC,kBAAIA,EAAM,YAAY+a,EAAgB,MAAM/a,EAAM,SAAS,QAAW;AAEpE,sBAAM0c,KAAcF,EAAexc,EAAM,QAAQ,KAAK;AACtD,uBAAO,EAAE,GAAGA,GAAO,MAAM0c,GAAY;AAAA,cACvC;AACO,qBAAA1c;AAAA,YAAA,CACR;AAAA,UAAA,IAEH2F;AAAAA,QAAA,CACL;AAAA,MACH;AAAA,IACF;AAAA,EAAA,GACC,CAACoV,CAAe,CAAC;AAEpB,QAAMwB,IAAkB,MAAyBtY,EAAO,KAAK,CAAS0B,MAAAA,EAAM,OAAOzB,CAAY,GAEzFyY,IAAW,CAACrd,GAAuBC,IAAkB,aAAa;AACtE,UAAMoG,IAAQ4W;AACd,QAAI,CAAC5W;AAAO;AAEZ,UAAM,EAAE,OAAAnG,GAAO,QAAAC,EAAA,IAAWJ,GAAuBC,GAAOC,CAAI,GACtDqd,IAAkB;AAAA,MACtB,IAAI9d,GAAW;AAAA,MACf,MAAM,SAAS6G,EAAM,OAAO,SAAS,CAAC;AAAA,MACtC,OAAArG;AAAA,MACA,MAAAC;AAAA,MACA,GAAG,MAAMoG,EAAM,OAAO,SAAS;AAAA,MAC/B,GAAG,MAAMA,EAAM,OAAO,SAAS;AAAA,MAC/B,OAAAnG;AAAA,MACA,QAAAC;AAAA,MACA,UAAU;AAAA,IAAA;AAGZ,IAAAob,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT,EAAE,GAAGyB,IAAO,QAAQ,CAAC,GAAGA,GAAM,QAAQiX,CAAQ,EAC9CjX,IAAAA;AAAAA,IAAA,CACL,GACDqV,EAAmB,EAAE,MAAM,SAAS,IAAI4B,EAAS,IAAI;AAAA,EAAA,GAGjDC,IAAY,CAACC,MAAqB;AACtC,UAAMnX,IAAQ4W;AACd,QAAI,CAAC5W;AAAO;AAEZ,UAAMoX,IAAyB;AAAA,MAC7B,IAAIje,GAAW;AAAA,MACf,MAAM,GAAGX,GAAc2e,CAAI,CAAC,IAAInX,EAAM,QAAQ,SAAS,CAAC;AAAA,MACxD,MAAAmX;AAAA,MACA,GAAG,MAAMnX,EAAM,QAAQ,SAAS;AAAA,MAChC,GAAG,MAAMA,EAAM,QAAQ,SAAS;AAAA,MAChC,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,UAAU;AAAA,IAAA;AAGZ,IAAAkV,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT,EAAE,GAAGyB,GAAO,SAAS,CAAC,GAAGA,EAAM,SAASoX,CAAS,EACjDpX,IAAAA;AAAAA,IAAA,CACL,GACDqV,EAAmB,EAAE,MAAM,UAAU,IAAI+B,EAAU,IAAI;AAAA,EAAA,GAGnDC,IAAW,CAACpc,MAA4B;AACxC,QAAA,CAACma,KAAmBA,EAAgB,SAAS;AAAS;AAE1D,UAAMpV,IAAQ4W;AACd,QAAI,CAAC5W;AAAO;AAGN,UAAAsX,IAAuBtX,EAAM,OAAO;AAAA,MAAO,QAC/C3F,GAAM,YAAY+a,EAAgB,MAAM/a,GAAM,aAAaY;AAAA,IAAA,GAIvDsc,IAAYD,EAAqB,QAGjCE,IAAwBF,EAAqB,KAAK,CAAKrS,OAAAA,GAAE,SAAS,MAAS,GAG3EwS,KAAcD,KAAA,gBAAAA,EAAuB,SAAQ,IAE7CE,IAAkB;AAAA,MACtB,IAAIve,GAAW;AAAA,MACf,SAASic,EAAgB;AAAA,MACzB,UAAAna;AAAA,MACA,OAAOsc;AAAA,MACP,GAAG;AAAA,MACH,GAAG;AAAA,MACH,MAAME;AAAA;AAAA,IAAA;AAGR,IAAAvC,EAAU,QAAQ4B,GAAK;AAAA,MAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT,EAAE,GAAGyB,IAAO,QAAQ,CAAC,GAAGA,GAAM,QAAQ0X,CAAQ,EAC9C1X,IAAAA;AAAAA,IAAA,CACL;AAAA,EAAA,GAGG2X,IAAc,CAAC1c,MAA4B;AAC3C,QAAA,CAACma,KAAmBA,EAAgB,SAAS;AAAS;AAE1D,UAAMpV,IAAQ4W;AACd,QAAI,CAAC5W;AAAO;AAGN,UAAAgF,IAAehF,EAAM,OAAO;AAAA,MAAO,OACvC3F,EAAM,YAAY+a,EAAgB,MAAM/a,EAAM,aAAaY;AAAA,IAAA;AAG7D,QAAI+J,EAAa,WAAW;AAAG;AAG/B,UAAM4S,IAAgB5S,EAAa;AAAA,MAAO,CAAC8R,GAAMe,MAC/CA,EAAQ,QAAQf,EAAK,QAAQe,IAAUf;AAAA,IAAA;AAGzC,IAAA5B,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAAA,QACH,QAAQA,EAAM,OAAO,OAAO,OAAS3F,EAAM,OAAOud,EAAc,EAAE;AAAA,MAAA,IAEpE5X;AAAAA,IAAA,CACL;AAAA,EAAA,GAGG8X,IAAkB,CAAC7c,GAAyBrB,MAAiB;AAIjE,IAHI,CAACwb,KAAmBA,EAAgB,SAAS,WAG7C,CADUwB,OAId1B,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAAA,QACH,QAAQA,EAAM,OAAO;AAAA,UAAI,CACvB3F,MAAAA,EAAM,YAAY+a,EAAgB,MAAM/a,EAAM,aAAaY,IACvD,EAAE,GAAGZ,GAAO,MAAAT,EACZ,IAAAS;AAAA,QACN;AAAA,MAAA,IAEF2F;AAAAA,IAAA,CACL;AAAA,EAAA,GAGG+X,IAAkB,MAAM;AAI5B,IAHI,CAAC3C,KAAmBA,EAAgB,SAAS,WAG7C,CADUwB,OAId1B,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAAA,QACH,QAAQA,EAAM,OAAO,IAAI,CAAS3F,MAAA;AAC5B,cAAAA,EAAM,YAAY+a,EAAgB,IAAI;AACxC,kBAAM,EAAE,MAAAxb,GAAM,GAAGoe,EAAA,IAAqB3d;AAC/B,mBAAA2d;AAAA,UACT;AACO,iBAAA3d;AAAA,QAAA,CACR;AAAA,MAAA,IAEH2F;AAAAA,IAAA,CACL;AAAA,EAAA,GAGGiY,IAAgB,MAAM;AAC1B,IAAK7C,MAEDA,EAAgB,SAAS,UAC3BF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,QAAQA,EAAM,OAAO,OAAO,OAAKmU,EAAE,OAAOiB,EAAgB,EAAE;AAAA,QAC5D,QAAQpV,EAAM,OAAO,OAAO,OAAKiF,EAAE,YAAYmQ,EAAgB,EAAE;AAAA,MAAA,IAEnEpV;AAAA,IAAA,CACL,IACQoV,EAAgB,SAAS,WAClCF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,SAASA,EAAM,QAAQ,OAAO,OAAKkY,EAAE,OAAO9C,EAAgB,EAAE;AAAA,MAAA,IAEhEpV;AAAA,IAAA,CACL,IACQoV,EAAgB,SAAS,SAClCF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,OAAOA,EAAM,MAAM,OAAO,OAAKmY,EAAE,OAAO/C,EAAgB,EAAE;AAAA,MAAA,IAE5DpV;AAAA,IAAA,CACL,IACQoV,EAAgB,SAAS,kBAClCF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,eAAeA,EAAM,cAAc,OAAO,OAAMoY,EAAG,OAAOhD,EAAgB,EAAE;AAAA,MAAA,IAE9EpV;AAAA,IAAA,CACL,GAGHqV,EAAmB,IAAI;AAAA,EAAA,GAGnBgD,IAAsB,CAACC,MAAsB;AAC7C,IAAA,CAAClD,KAAmBA,EAAgB,SAAS,UAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,OAAOA,EAAM,MAAM;AAAA,UAAI,CAAA1C,MACrBA,EAAK,OAAO8X,EAAgB,KACxB,EAAE,GAAG9X,GAAM,WAAAgb,EAAA,IACXhb;AAAA,QACN;AAAA,MAAA,IAEF0C;AAAA,IAAA,CACL;AAAA,EAAA,GAGGuY,IAAkB,CAACpB,MAAmB;AACtC,IAAA,CAAC/B,KAAmBA,EAAgB,SAAS,UAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,OAAOA,EAAM,MAAM;AAAA,UAAI,CAAA1C,MACrBA,EAAK,OAAO8X,EAAgB,KACxB,EAAE,GAAG9X,GAAM,MAAA6Z,EAAA,IACX7Z;AAAA,QACN;AAAA,MAAA,IAEF0C;AAAA,IAAA,CACL;AAAA,EAAA,GAGGwY,KAAc,MAAM;AACpB,IAAA,CAACpD,KAAmBA,EAAgB,SAAS,WAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,QAAQA,EAAM,OAAO;AAAA,UAAI,CACvB3G,MAAAA,EAAM,OAAO+b,EAAgB,KACzB,EAAE,GAAG/b,GAAO,WAAWA,EAAM,YAAY,KAAK,GAC9C,IAAAA;AAAA,QACN;AAAA,MAAA,IAEF2G;AAAA,IAAA,CACL;AAAA,EAAA,GAGGyY,IAAiB,MAAM;AACvB,QAAA,CAACrD,KAAmBA,EAAgB,SAAS;AAAS;AAE1D,UAAMpV,IAAQ4W;AACd,QAAI,CAAC5W;AAAO;AAEN,UAAA0Y,IAAgB1Y,EAAM,OAAO,KAAK,OAAKmU,EAAE,OAAOiB,EAAgB,EAAE;AACxE,QAAI,CAACsD;AAAe;AAEpB,UAAMzB,IAAkB;AAAA,MACtB,GAAGyB;AAAA,MACH,IAAIvf,GAAW;AAAA,MACf,MAAM,GAAGuf,EAAc,IAAI;AAAA,MAC3B,GAAGA,EAAc,IAAI;AAAA,MACrB,GAAGA,EAAc,IAAI;AAAA,IAAA,GAIjBC,IADiB3Y,EAAM,OAAO,OAAO,OAAKiF,EAAE,YAAYyT,EAAc,EAAE,EACpC,IAAI,CAAUre,OAAA;AAAA,MACtD,GAAGA;AAAA,MACH,IAAIlB,GAAW;AAAA,MACf,SAAS8d,EAAS;AAAA,IAClB,EAAA;AAEF,IAAA/B,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAAA,QACH,QAAQ,CAAC,GAAGA,EAAM,QAAQiX,CAAQ;AAAA,QAClC,QAAQ,CAAC,GAAGjX,EAAM,QAAQ,GAAG2Y,CAAS;AAAA,MAAA,IAExC3Y;AAAAA,IAAA,CACL,GAEDqV,EAAmB,EAAE,MAAM,SAAS,IAAI4B,EAAS,IAAI;AAAA,EAAA,GAGjD2B,KAAsBC,GAAY,CAACC,MAAqC;AACxE,IAAA,CAAC1D,KAAmBA,EAAgB,SAAS,WAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,QAAQA,EAAM,OAAO;AAAA,UAAI,OACvB3G,EAAM,OAAO+b,EAAgB,KAAK0D,EAAQzf,CAAK,IAAIA;AAAA,QACrD;AAAA,MAAA,IAEF2G;AAAA,IAAA,CACL;AAAA,EAAA,GACA,CAACoV,GAAiB7W,CAAY,CAAC,GAE5Bwa,KAAwB,CAACnf,MAAwB;AACrD,IAAAgf,GAAoB,CAASvf,MAAA;AAC3B,YAAM,EAAE,OAAAQ,GAAO,QAAAC,MAAWJ,GAAuBL,EAAM,OAAOO,CAAI;AAClE,aAAO,EAAE,GAAGP,GAAO,MAAAO,GAAM,OAAAC,GAAO,QAAAC,EAAO;AAAA,IAAA,CACxC;AAAA,EAAA,GAGGkf,IAAwB,CAACnf,GAAeC,MAAmB;AAC/D,IAAA8e,GAAoB,CAAUvf,OAAA;AAAA,MAC5B,GAAGA;AAAA,MACH,OAAAQ;AAAA,MACA,QAAAC;AAAA;AAAA,MAEA,MAAM;AAAA;AAAA,IACN,EAAA;AAAA,EAAA,GAGEmf,IAAyB,CAACC,MAAiB;AAC3C,IAAA,CAAC9D,KAAmBA,EAAgB,SAAS,YAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,SAASA,EAAM,QAAQ;AAAA,UAAI,CAAAoM,MACzBA,EAAI,OAAOgJ,EAAgB,KAAK,EAAE,GAAGhJ,GAAK,MAAA8M,EAAA,IAAS9M;AAAA,QACrD;AAAA,MAAA,IAEFpM;AAAA,IAAA,CACL;AAAA,EAAA,GAGGmZ,IAAqB,CAACtf,GAAeC,MAAmB;AACxD,IAAA,CAACsb,KAAmBA,EAAgB,SAAS,YAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,SAASA,EAAM,QAAQ;AAAA,UAAI,CAAAoM,MACzBA,EAAI,OAAOgJ,EAAgB,KAAK,EAAE,GAAGhJ,GAAK,OAAAvS,GAAO,QAAAC,EAAA,IAAWsS;AAAA,QAC9D;AAAA,MAAA,IAEFpM;AAAA,IAAA,CACL;AAAA,EAAA,GAGGoZ,IAAqB,CAAC/M,MAAqB;AAC3C,IAAA,CAAC+I,KAAmBA,EAAgB,SAAS,YAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,SAASA,EAAM,QAAQ;AAAA,UAAI,CAAAoM,MACzBA,EAAI,OAAOgJ,EAAgB,KAAK,EAAE,GAAGhJ,GAAK,UAAAC,EAAA,IAAaD;AAAA,QACzD;AAAA,MAAA,IAEFpM;AAAA,IAAA,CACL;AAAA,EAAA,GAGGqZ,KAA2B,CAACxf,GAAeC,MAAmB;AAC9D,IAAA,CAACsb,KAAmBA,EAAgB,SAAS,kBAEjDF,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT;AAAA,QACE,GAAGyB;AAAA,QACH,eAAeA,EAAM,cAAc;AAAA,UAAI,CAAA/B,MACrCA,EAAQ,OAAOmX,EAAgB,KAAK,EAAE,GAAGnX,GAAS,OAAApE,GAAO,QAAAC,EAAA,IAAWmE;AAAA,QACtE;AAAA,MAAA,IAEF+B;AAAA,IAAA,CACL;AAAA,EAAA,GAGGsZ,IAAwB,CAACJ,MAAiB;AAC9C,IAAAN,GAAoB,CAAUvf,OAAA,EAAE,GAAGA,GAAO,MAAA6f,EAAO,EAAA;AAAA,EAAA,GAG7CK,KAAoB,CAACrc,MAAwB;AACjD,QAAKuZ,EAAU,WAGX,CAAAN,IAGJ;AAAA,UAAIP,KAAiBjV,IAAU;AACvB,cAAA6Y,IAAO/C,EAAU,QAAQ,sBAAsB,GAC/CpC,IAAI,KAAK,OAAQnX,EAAE,UAAUsc,EAAK,QAAQhE,IAAQ1d,CAAS,IAAIA,GAC/D2hB,IAAI,KAAK,OAAQvc,EAAE,UAAUsc,EAAK,OAAOhE,IAAQ1d,CAAS,IAAIA;AAEpE,YAAI,CAACie;AAEe,UAAAC,EAAA,EAAE,GAAA3B,GAAG,GAAAoF,EAAA,CAAG;AAAA,aACrB;AAGL,cAAI,CADU7C;AACF;AAGZ,gBAAM8C,IAAa3f,GAAWgc,GAAgB,EAAE,GAAA1B,GAAG,GAAAoF,GAAG,GAEhDE,IAAgB;AAAA,YACpB,IAAIxgB,GAAW;AAAA,YACf,MAAMwH;AAAA,YACN,QAAQoV,EAAe;AAAA,YACvB,QAAQA,EAAe;AAAA,YACvB,MAAM2D,EAAW;AAAA,YACjB,MAAMA,EAAW;AAAA,YACjB,WAAW;AAAA,UAAA;AAGb,UAAAxE,EAAU,QAAQ4B,GAAK;AAAA,YAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT,EAAE,GAAGyB,IAAO,OAAO,CAAC,GAAGA,GAAM,OAAO2Z,CAAO,EAC3C3Z,IAAAA;AAAAA,UAAA,CACL,GAGDgW,EAAkB,IAAI,GACtBE,GAAoB,IAAI,GACxBL,GAAiB,EAAK,GACtBC,GAAY,IAAI;AAAA,QAClB;AACA;AAAA,MACF;AAEA,MAAAT,EAAmB,IAAI;AAAA;AAAA,EAAA,GAGnBuE,IAAsB,CAACzC,GAA8D0C,MAAe;AACrF,IAAAxE,EAAA,EAAE,MAAA8B,GAAM,IAAA0C,EAAA,CAAI;AAAA,EAAA,GAG3BC,IAAkB,CAAC5c,GAAqB2c,MAAe;AAC3D,QAAI,CAACpD,EAAU;AAAS;AAExB,IAAAvZ,EAAE,eAAe,GACjBA,EAAE,gBAAgB;AAEZ,UAAAsc,IAAO/C,EAAU,QAAQ,sBAAsB,GAC/CpC,KAAKnX,EAAE,UAAUsc,EAAK,QAAQhE,GAC9B,KAAKtY,EAAE,UAAUsc,EAAK,OAAOhE,GAE7BxV,IAAQ4W;AACd,QAAI,CAAC5W;AAAO;AAGZ,UAAM3G,IAAQ2G,EAAM,OAAO,KAAK,CAAKmU,OAAAA,GAAE,OAAO0F,CAAE,GAC1Cnd,KAASsD,EAAM,QAAQ,KAAK,CAAKkY,OAAAA,GAAE,OAAO2B,CAAE,GAC5CE,KAAe/Z,EAAM,cAAc,KAAK,CAAMoY,OAAAA,GAAG,OAAOyB,CAAE,GAC1Dvc,KAAO0C,EAAM,MAAM,KAAK,CAAKmY,OAAAA,GAAE,OAAO0B,CAAE;AAE9C,QAAIvc;AAEY,MAAAiY,GAAA;AAAA,QACZ,GAAGlB,IAAI/W,GAAK;AAAA,QACZ,GAAG,IAAIA,GAAK;AAAA,MAAA,CACb,GACDoZ,EAAe,UAAU,EAAE,IAAAmD,GAAI,MAAM,OAAO;AAAA,SACvC;AACC,YAAA5b,KAAU5E,KAASqD,MAAUqd;AACnC,MAAI9b,MACYsX,GAAA;AAAA,QACZ,GAAGlB,IAAIpW,GAAQ;AAAA,QACf,GAAG,IAAIA,GAAQ;AAAA,MAAA,CAChB;AAIH,YAAMkZ,KAAO9d,IAAQ,UAAUqD,KAAS,WAAWqd,KAAe,iBAAiB;AACpE,MAAArD,EAAA,UAAU,EAAE,IAAAmD,GAAI,MAAA1C,GAAK;AAAA,IACtC;AAEA,IAAApa,GAAc,EAAI;AAAA,EAAA,GAGdid,IAAanB,GAAY,CAAC3b,MAAkB;AAC3C,IAAA,CAACJ,KAAc,CAACqZ,MAAmB,CAACO,EAAe,WAAW,CAACD,EAAU,YAG1EE,GAAO,WACT,qBAAqBA,GAAO,OAAO,GAI9BA,GAAA,UAAU,sBAAsB,MAAM;;AAC3C,UAAI,CAACF,EAAU;AAAS;AAElB,YAAAwD,IAAaxD,EAAU,QAAQ,sBAAsB,GACrDpC,KAAKnX,EAAE,UAAU+c,EAAW,QAAQzE,GACpCiE,KAAKvc,EAAE,UAAU+c,EAAW,OAAOzE,GAEnC0E,IAAW,KAAK,MAAM7F,IAAIvc,CAAS,IAAIA,GACvCqiB,IAAW,KAAK,MAAMV,IAAI3hB,CAAS,IAAIA;AAE7C,UAAIqe,QAAkB1B,IAAAiC,EAAe,YAAf,gBAAAjC,EAAwB,UAAS,QAAQ;AAE7D,cAAM2F,KAAmB9b,EAAO,KAAK,CAAK+b,OAAAA,GAAE,OAAO9b,CAAY,GACzD+b,KAAcF,MAAAA,gBAAAA,GAAkB,MAAM,KAAK;;AAAK,iBAAAjC,GAAE,SAAO1D,KAAAiC,EAAe,YAAf,gBAAAjC,GAAwB;AAAA;AAEvF,YAAI6F,IAAa;AAEf,gBAAMC,KAAalE,OAAuB,UACtC,EAAE,GAAGiE,GAAY,MAAM,GAAGA,GAAY,SACtC,EAAE,GAAGA,GAAY,QAAQ,GAAGA,GAAY,UAGtCE,KAAezgB,GAAWwgB,IAAY,EAAE,GAAGL,GAAU,GAAGC,GAAU;AAExE,UAAAjF,EAAU,QAAQ4B,GAAK;AAAA,YAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT;AAAA,cACE,GAAGyB;AAAA,cACH,OAAOA,GAAM,MAAM;AAAA,gBAAI,CAAA1C,OACrB;;AAAA,yBAAAA,GAAK,SAAOmX,KAAAiC,EAAe,YAAf,gBAAAjC,GAAwB,MAChC4B,OAAuB,UACrB,EAAE,GAAG/Y,IAAM,QAAQkd,GAAa,GAAG,QAAQA,GAAa,MACxD,EAAE,GAAGld,IAAM,MAAMkd,GAAa,GAAG,MAAMA,GAAa,EACtD,IAAAld;AAAA;AAAA,cACN;AAAA,YAAA,IAEF0C;AAAA,UAAA,CACL;AAAA,QACH;AAAA,MACS,aAAAya,KAAA/D,EAAe,YAAf,gBAAA+D,GAAwB,UAAS,SAAS;AAC7C,cAAAC,KAAYrG,IAAIiB,EAAW,GAC3BqF,KAAYlB,IAAInE,EAAW,GAC3BsF,KAAgB,KAAK,MAAMF,KAAY5iB,CAAS,IAAIA,GACpD+iB,KAAgB,KAAK,MAAMF,KAAY7iB,CAAS,IAAIA;AAE1D,QAAAod,EAAU,QAAQ4B,GAAK;AAAA,UAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT;AAAA,YACE,GAAGyB;AAAA,YACH,QAAQA,GAAM,OAAO;AAAA,cAAI,CACvB3G,OAAA;;AAAA,uBAAAA,GAAM,SAAOob,KAAAiC,EAAe,YAAf,gBAAAjC,GAAwB,MACjC,EAAE,GAAGpb,IAAO,GAAGuhB,IAAe,GAAGC,GACjC,IAAAxhB;AAAA;AAAA,YACN;AAAA,UAAA,IAEF2G;AAAA,QAAA,CACL;AAAA,MACQ,aAAA8a,KAAApE,EAAe,YAAf,gBAAAoE,GAAwB,UAAS,UAAU;AAC9C,cAAAJ,KAAYrG,IAAIiB,EAAW,GAC3BqF,KAAYlB,IAAInE,EAAW,GAC3ByF,KAAiB,KAAK,MAAML,KAAY5iB,CAAS,IAAIA,GACrDkjB,KAAiB,KAAK,MAAML,KAAY7iB,CAAS,IAAIA;AAE3D,QAAAod,EAAU,QAAQ4B,GAAK;AAAA,UAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT;AAAA,YACE,GAAGyB;AAAA,YACH,SAASA,GAAM,QAAQ;AAAA,cAAI,CACzBtD,OAAA;;AAAA,uBAAAA,GAAO,SAAO+X,KAAAiC,EAAe,YAAf,gBAAAjC,GAAwB,MAClC,EAAE,GAAG/X,IAAQ,GAAGqe,IAAgB,GAAGC,GACnC,IAAAte;AAAA;AAAA,YACN;AAAA,UAAA,IAEFsD;AAAA,QAAA,CACL;AAAA,MACQ,aAAAib,KAAAvE,EAAe,YAAf,gBAAAuE,GAAwB,UAAS,gBAAgB;AACpD,cAAAP,KAAYrG,IAAIiB,EAAW,GAC3BqF,KAAYlB,IAAInE,EAAW,GAC3B4F,KAAkB,KAAK,MAAMR,KAAY5iB,CAAS,IAAIA,GACtDqjB,KAAkB,KAAK,MAAMR,KAAY7iB,CAAS,IAAIA;AAE5D,QAAAod,EAAU,QAAQ4B,GAAK;AAAA,UAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT;AAAA,YACE,GAAGyB;AAAA,YACH,eAAeA,GAAM,cAAc;AAAA,cAAI,CACrC/B,OAAA;;AAAA,uBAAAA,GAAQ,SAAOwW,KAAAiC,EAAe,YAAf,gBAAAjC,GAAwB,MACnC,EAAE,GAAGxW,IAAS,GAAGid,IAAiB,GAAGC,GACrC,IAAAld;AAAA;AAAA,YACN;AAAA,UAAA,IAEF+B;AAAA,QAAA,CACL;AAAA,MAAA,aACQob,KAAA1E,EAAe,YAAf,gBAAA0E,GAAwB,UAAS,UAAU,CAACjF,IAAgB;AAE/D,cAAAuE,KAAYrG,IAAIiB,EAAW,GAC3BqF,KAAYlB,IAAInE,EAAW,GAC3B+F,KAAe,KAAK,MAAMX,KAAY5iB,CAAS,IAAIA,GACnDwjB,KAAe,KAAK,MAAMX,KAAY7iB,CAAS,IAAIA;AAEzD,QAAAod,EAAU,QAAQ4B,GAAK;AAAA,UAAI,CAAA9W,OACzBA,GAAM,OAAOzB,IACT;AAAA,YACE,GAAGyB;AAAA,YACH,OAAOA,GAAM,MAAM,IAAI,CAAQ1C,OAAA;;AACzB,kBAAAA,GAAK,SAAOmX,KAAAiC,EAAe,YAAf,gBAAAjC,GAAwB;AAAW,uBAAAnX;AAG7C,oBAAAie,KAASF,KAAe/d,GAAK,QAC7Bke,KAASF,KAAehe,GAAK;AAG5B,qBAAA;AAAA,gBACL,GAAGA;AAAA,gBACH,QAAQA,GAAK,SAASie;AAAA,gBACtB,QAAQje,GAAK,SAASke;AAAA,gBACtB,MAAMle,GAAK,OAAOie;AAAA,gBAClB,MAAMje,GAAK,OAAOke;AAAA,cAAA;AAAA,YACpB,CACD;AAAA,UAAA,IAEHxb;AAAA,QAAA,CACL;AAAA,MACH;AAAA,IAAA,CACD;AAAA,EAAA,GACA,CAAClD,GAAYqZ,IAAgBE,IAAoBf,GAAY/W,GAAciX,GAAMlX,CAAM,CAAC,GAErFmd,KAAgB,MAAM;AAE1B,IAAI9E,GAAO,YACT,qBAAqBA,GAAO,OAAO,GACnCA,GAAO,UAAU,OAEnB5Z,GAAc,EAAK,GACnB2Z,EAAe,UAAU,MAGzBN,GAAkB,EAAK,GACvBE,GAAsB,IAAI,GAC1BE,GAAqB,IAAI;AAAA,EAAA,GAGrBkF,IAAuB,CAACxe,GAAqBye,GAAgBC,MAAgC;AACjG,IAAA1e,EAAE,eAAe,GACjBA,EAAE,gBAAgB,GAElBkZ,GAAkB,EAAI,GACtBE,GAAsBsF,CAAU,GAChClF,EAAe,UAAU,EAAE,IAAIiF,GAAQ,MAAM;EAAO,GAGhDE,IAAW,MAAM;AACrB,UAAMC,IAAkB;AAAA,MACtB,IAAI3iB,GAAW;AAAA,MACf,MAAM,SAASmF,EAAO,SAAS,CAAC;AAAA,MAChC,UAAU;AAAA,MACV,QAAQ,CAAC;AAAA,MACT,QAAQ,CAAC;AAAA,MACT,SAAS,CAAC;AAAA,MACV,OAAO,CAAC;AAAA,MACR,eAAe,CAAC;AAAA,IAAA;AAElB,IAAA4W,EAAU,CAAQ4B,MAAA,CAAC,GAAGA,GAAMgF,CAAQ,CAAC,GACrCC,EAAYD,EAAS,EAAE;AAAA,EAAA,GAGnBE,KAAc,MAAM;AACxB,QAAI1d,EAAO,UAAU;AAAG;AAExB,UAAM2d,IAAY3d,EAAO,OAAO,CAAK+b,MAAAA,EAAE,OAAO9b,CAAY;AAC1D,IAAA2W,EAAU+G,CAAS,GACH9G,EAAA8G,EAAU,CAAC,EAAE,EAAE;AAAA,EAAA,GAG3BF,IAAc,CAACG,MAAoB;AAC7B,IAAAhH,EAAA,CAAA4B,MAAQA,EAAK,IAAI,CAAU9W,OAAA;AAAA,MACnC,GAAGA;AAAA,MACH,UAAUA,EAAM,OAAOkc;AAAA,MACvB,CAAC,GACH/G,EAAgB+G,CAAO,GACvB7G,EAAmB,IAAI;AAAA,EAAA,GAGnB8G,IAAc,CAACD,GAAiBE,MAAoB;AACxD,IAAAlH,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOkc,IACT,EAAE,GAAGlc,GAAO,MAAMoc,EAAA,IAClBpc;AAAA,IAAA,CACL;AAAA,EAAA,GAGGqc,KAAmB,CAAClF,MAAmB;AAC3C,IAAAtB,GAAiB,EAAI,GACrBC,GAAYqB,CAAI,GAChBnB,EAAkB,IAAI,GACtBE,GAAoB,IAAI,GACxBb,EAAmB,IAAI;AAAA,EAAA,GAGnBiH,KAAkB,CAACnF,MAA2B;AAClD,UAAMnX,IAAQ4W;AACd,QAAI,CAAC5W;AAAO;AAEZ,UAAMuc,IAA2B;AAAA,MAC/B,IAAIpjB,GAAW;AAAA,MACf,MAAM,GAAGge,EAAK,OAAO,CAAC,EAAE,gBAAgBA,EAAK,MAAM,CAAC,CAAC,IAAInX,EAAM,cAAc,SAAS,CAAC;AAAA,MACvF,MAAAmX;AAAA,MACA,GAAG,MAAMnX,EAAM,cAAc,SAAS;AAAA,MACtC,GAAG,MAAMA,EAAM,cAAc,SAAS;AAAA,MACtC,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,UAAU;AAAA,IAAA;AAGZ,IAAAkV,EAAU,OAAQ4B,EAAK;AAAA,MAAI,CAAA9W,MACzBA,EAAM,OAAOzB,IACT,EAAE,GAAGyB,GAAO,eAAe,CAAC,GAAGA,EAAM,eAAeuc,CAAU,EAC9Dvc,IAAAA;AAAAA,IAAA,CACL,GACDqV,EAAmB,EAAE,MAAM,gBAAgB,IAAIkH,EAAW,IAAI;AAAA,EAAA,GAG1DC,KAAgB,MAAM;AAC1B,UAAMC,IAAgB;AAAA,MACpB,QAAAne;AAAA,MACA,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,IAAA;AAG5B,YAAA,IAAI,sBAAsBme,CAAa,GAC/C,MAAM,4CAA4C;AAAA,EAAA;AA6CpD,EAAA7X,GAAU,MAAM;AACd,UAAM8X,IAAkB,CAACxf,MAAkB8c,EAAW9c,CAAC,GACjDC,IAAgB,MAAMse;AAE5B,YAAI3e,KAAcqZ,QACP,SAAA,iBAAiB,aAAauG,CAAe,GAC7C,SAAA,iBAAiB,WAAWvf,CAAa,IAG7C,MAAM;AACF,eAAA,oBAAoB,aAAauf,CAAe,GAChD,SAAA,oBAAoB,WAAWvf,CAAa;AAAA,IAAA;AAAA,EAEtD,GAAA,CAACL,GAAYqZ,IAAgB6D,CAAU,CAAC;AAGrC,QAAA2C,KAAwB,CAACzf,MAAwB;;AACjD,QAAA0Y,KAAiBG,KAAkBU,EAAU,SAAS;AAClD,YAAA+C,IAAO/C,EAAU,QAAQ,sBAAsB,GAC/CpC,IAAI,KAAK,OAAQnX,EAAE,UAAUsc,EAAK,QAAQhE,IAAQ1d,CAAS,IAAIA,GAC/D,IAAI,KAAK,OAAQoF,EAAE,UAAUsc,EAAK,OAAOhE,IAAQ1d,CAAS,IAAIA,GAG9D0iB,IAAezgB,GAAWgc,GAAgB,EAAE,GAAA1B,GAAG,GAAG;AACxD,MAAA6B,GAAoBsE,CAAY;AAAA,IAAA,WACvBrE,QAAkB1B,IAAAiC,EAAe,YAAf,gBAAAjC,EAAwB,UAAS,UAAUgC,EAAU,SAAS;AAEnF,YAAA+C,IAAO/C,EAAU,QAAQ,sBAAsB,GAC/CpC,IAAI,KAAK,OAAQnX,EAAE,UAAUsc,EAAK,QAAQhE,IAAQ1d,CAAS,IAAIA,GAC/D,IAAI,KAAK,OAAQoF,EAAE,UAAUsc,EAAK,OAAOhE,IAAQ1d,CAAS,IAAIA,GAE9DsiB,IAAmBxD,KACnB0D,IAAcF,KAAAA,gBAAAA,EAAkB,MAAM,KAAK;;AAAK,eAAAjC,GAAE,SAAO1D,KAAAiC,EAAe,YAAf,gBAAAjC,GAAwB;AAAA;AAEvF,UAAI6F,GAAa;AACf,cAAMC,KAAalE,OAAuB,UACtC,EAAE,GAAGiE,EAAY,MAAM,GAAGA,EAAY,SACtC,EAAE,GAAGA,EAAY,QAAQ,GAAGA,EAAY,UAEtCE,KAAezgB,GAAWwgB,IAAY,EAAE,GAAAlG,GAAG,GAAG;AAEpD,QAAAmC;AAAA,UACEH,OAAuB,UACnB,EAAE,QAAQmE,GAAa,GAAG,QAAQA,GAAa,GAAG,MAAMF,EAAY,MAAM,MAAMA,EAAY,KAAK,IACjG,EAAE,QAAQA,EAAY,QAAQ,QAAQA,EAAY,QAAQ,MAAME,GAAa,GAAG,MAAMA,GAAa,EAAE;AAAA,QAAA;AAAA,MAE7G;AAAA,IACF;AAAA,EAAA;AAIF,EAAA5V,GAAU,MAAM;AACR,UAAA1E,IAAgB,CAAChD,MAAqB;AACtC,MAAAA,EAAE,QAAQ,YAAY0Y,MACxBC,GAAiB,EAAK,GACtBC,GAAY,IAAI,GAChBE,EAAkB,IAAI,GACtBE,GAAoB,IAAI;AAAA,IAC1B;AAGO,oBAAA,iBAAiB,WAAWhW,CAAa,GAC3C,MAAM,SAAS,oBAAoB,WAAWA,CAAa;AAAA,EAAA,GACjE,CAAC0V,CAAa,CAAC;AAElB,QAAMwE,IAAmBxD,KACnBvX,KAAgB+a,KAAA,gBAAAA,EAAkB,OAAO,KAAK,CAAAjG,OAAKiB,KAAA,gBAAAA,EAAiB,UAAS,WAAWjB,EAAE,OAAOiB,EAAgB,KACjH/T,KAAiB+Y,KAAA,gBAAAA,EAAkB,QAAQ,KAAK,CAAAlC,OAAK9C,KAAA,gBAAAA,EAAiB,UAAS,YAAY8C,EAAE,OAAO9C,EAAgB,KACpH9T,KAAe8Y,KAAA,gBAAAA,EAAkB,MAAM,KAAK,CAAAjC,OAAK/C,KAAA,gBAAAA,EAAiB,UAAS,UAAU+C,EAAE,OAAO/C,EAAgB,KAC9G7T,KAAuB6Y,KAAA,gBAAAA,EAAkB,cAAc,KAAK,CAAAhC,OAAMhD,KAAA,gBAAAA,EAAiB,UAAS,kBAAkBgD,EAAG,OAAOhD,EAAgB,KACxI9V,KAAsBD,MACvB+a,KAAA,gBAAAA,EAAkB,OAAO,OAAO,CAAAnV,MAAKA,EAAE,YAAY5F,GAAc,QAAO,CAAA,IACzE,CAAA,GACEud,KAAa/D,GAAY,MAAMpD,EAAY,CAACqB,MAAS,CAACA,CAAI,GAAG,CAAA,CAAE;AAGnE,SAAA,gBAAAta,EAAC,OAAI,EAAA,WAAU,iEACb,UAAA;AAAA,IAAA,gBAAAX,EAAC,SAAM,EAAA,yBAAyB,EAAE,QAAQhE,MAAgB;AAAA,IAE1D,gBAAAgE;AAAA,MAACwC;AAAA,MAAA;AAAA,QACC,QAAAC;AAAA,QACA,cAAc8b;AAAA,QACd,YAAYyB;AAAA,QACZ,eAAeG;AAAA,QACf,eAAeD;AAAA,QACf,eAAeI;AAAA,QACf,YAAYnF;AAAA,QACZ,aAAaE;AAAA,QACb,oBAAoBmF;AAAA,QACpB,mBAAmBC;AAAA,QACnB,eAAe9D;AAAA,QACf,kBAAkBC;AAAA,QAClB,eAAeR;AAAA,QACf,QAAQuE;AAAA,QACR,eAAend,MAAiB;AAAA,QAChC,qBAAAC;AAAA,MAAA;AAAA,IACF;AAAA,IAEA,gBAAA9C,EAAC,OAAI,EAAA,WAAU,wBAIb,UAAA;AAAA,MAAA,gBAAAX;AAAA,QAACsF;AAAA,QAAA;AAAA,UACC,UAAAC;AAAA,UACA,eAAe/B,MAAiB;AAAA,UAChC,gBAAgBgC,MAAkB;AAAA,UAClC,cAAcC,MAAgB;AAAA,UAC9B,sBAAsBC,MAAwB;AAAA,UAC9C,qBAAAjC;AAAA,UACA,aAAY8a,KAAA,gBAAAA,EAAkB,OAAO,WAAU;AAAA,UAC/C,aAAYA,KAAA,gBAAAA,EAAkB,OAAO,WAAU;AAAA,UAC/C,cAAaA,KAAA,gBAAAA,EAAkB,QAAQ,WAAU;AAAA,UACjD,YAAWA,KAAA,gBAAAA,EAAkB,MAAM,WAAU;AAAA,UAC7C,oBAAmBA,KAAA,gBAAAA,EAAkB,cAAc,WAAU;AAAA,UAC7D,sBAAqBhF,KAAA,gBAAAA,EAAiB,SAAQ;AAAA,UAC9C,cAAcwH;AAAA,UACd,YAAYvF;AAAA,UACZ,eAAeM;AAAA,UACf,mBAAmBoB;AAAA,UACnB,mBAAmBC;AAAA,UACnB,mBAAmBM;AAAA,UACnB,oBAAoBL;AAAA,UACpB,gBAAgBE;AAAA,UAChB,gBAAgBC;AAAA,UAChB,gBAAgBnB;AAAA,UAChB,cAAcA;AAAA,UACd,sBAAsBA;AAAA,UACtB,uBAAuBI;AAAA,UACvB,mBAAmBE;AAAA,UACnB,sBAAsBc;AAAA,UACtB,mBAAmBvB;AAAA,UACnB,mBAAmBC;AAAA,UACnB,aAAa,MAAMpC,GAAiB,EAAI;AAAA,QAAA;AAAA,MAC1C;AAAA,MAEA,gBAAAnZ,EAAC,OAAI,EAAA,WAAU,+CACb,UAAA;AAAA,QAAA,gBAAAA;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,KAAKia;AAAA,YACL,WAAW,0BACTb,IAAgB,qBAChBO,KAAiB,oBACjB,gBACF;AAAA,YACA,OAAO;AAAA,cACL,WAAW,SAASX,CAAI;AAAA,cACxB,iBAAiB;AAAA,cACjB,YAAYpU,IACR,0DACA;AAAA,cACJ,gBAAgB,GAAGtJ,IAAY0d,CAAI,MAAM1d,IAAY0d,CAAI;AAAA,YAC3D;AAAA,YACA,SAAS+D;AAAA,YACT,aAAaoD;AAAA,YAEZ,UAAA;AAAA,eAAkBvC,KAAA,gBAAAA,EAAA,OAAO,YAAW,KAClC,gBAAAve,EAAA,OAAA,EAAI,WAAU,yEACb,UAAA,gBAAAW,EAAC,OAAI,EAAA,WAAU,6BACb,UAAA;AAAA,gBAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,iBAAgB,UAAE,MAAA;AAAA,gBAChC,gBAAAA,EAAA,OAAA,EAAI,WAAU,4BAA2B,UAAmC,uCAAA;AAAA,gBAC5E,gBAAAA,EAAA,OAAA,EAAI,WAAU,WAAU,UAAoE,wEAAA;AAAA,gBAC7F,gBAAAW,EAAC,OAAI,EAAA,WAAU,0BACb,UAAA;AAAA,kBAAA,gBAAAX,EAAC,SAAI,UAAiC,oCAAA,CAAA;AAAA,kBACtC,gBAAAA,EAAC,SAAI,UAA4C,+CAAA,CAAA;AAAA,kBACjD,gBAAAA,EAAC,SAAI,UAA+D,kEAAA,CAAA;AAAA,kBACpE,gBAAAA,EAAC,SAAI,UAAyC,4CAAA,CAAA;AAAA,gBAAA,GAChD;AAAA,cAAA,EAAA,CACF,EACF,CAAA;AAAA,cAGDue,KAAA,gBAAAA,EAAkB,OAAO,IAAI,CAC5B/gB,MAAA,gBAAAwC;AAAA,gBAACG;AAAA,gBAAA;AAAA,kBAEC,OAAA3C;AAAA,kBACA,aAAY+b,KAAA,gBAAAA,EAAiB,UAAS,WAAWA,EAAgB,OAAO/b,EAAM;AAAA,kBAC9E,QAAQ+gB,EAAiB,OAAO,OAAO,OAAS/f,EAAM,YAAYhB,EAAM,EAAE;AAAA,kBAC1E,UAAU,MAAMugB,EAAoB,SAASvgB,EAAM,EAAE;AAAA,kBACrD,QAAQygB;AAAA,kBACR,WAAW2B;AAAA,gBAAA;AAAA,gBANNpiB,EAAM;AAAA,cAAA;AAAA,cAWd+gB,KAAA,gBAAAA,EAAkB,QAAQ,IAAI,CAC7B1d,MAAA,gBAAAb;AAAA,gBAACY;AAAA,gBAAA;AAAA,kBAEC,QAAAC;AAAA,kBACA,aAAY0Y,KAAA,gBAAAA,EAAiB,UAAS,YAAYA,EAAgB,OAAO1Y,EAAO;AAAA,kBAChF,UAAU,MAAMkd,EAAoB,UAAUld,EAAO,EAAE;AAAA,kBACvD,aAAa,CAACQ,MAAM4c,EAAgB5c,GAAGR,EAAO,EAAE;AAAA,gBAAA;AAAA,gBAJ3CA,EAAO;AAAA,cAAA;AAAA,cASf0d,KAAA,gBAAAA,EAAkB,MAAM,IAAI,CAC3B9c,MAAA,gBAAAzB;AAAA,gBAACwB;AAAA,gBAAA;AAAA,kBAEC,MAAAC;AAAA,kBACA,aAAY8X,KAAA,gBAAAA,EAAiB,UAAS,UAAUA,EAAgB,OAAO9X,EAAK;AAAA,kBAC5E,UAAU,MAAMsc,EAAoB,QAAQtc,EAAK,EAAE;AAAA,kBACnD,cAAc,CAACJ,GAAG0e,MAAeF,EAAqBxe,GAAGI,EAAK,IAAIse,CAAU;AAAA,kBAC5E,aAAa,CAAC1e,MAAM4c,EAAgB5c,GAAGI,EAAK,EAAE;AAAA,gBAAA;AAAA,gBALzCA,EAAK;AAAA,cAAA;AAAA,cAUbsY,KAAiBG,KAAkBE,KAAoBtV,MACtD,gBAAA9E;AAAA,gBAACwB;AAAA,gBAAA;AAAA,kBACC,MAAM;AAAA,oBACJ,IAAI;AAAA,oBACJ,MAAMsD;AAAA,oBACN,QAAQoV,EAAe;AAAA,oBACvB,QAAQA,EAAe;AAAA,oBACvB,MAAME,EAAiB;AAAA,oBACvB,MAAMA,EAAiB;AAAA,oBACvB,WAAW;AAAA,kBACb;AAAA,kBACA,YAAY;AAAA,kBACZ,UAAU,MAAM;AAAA,kBAAC;AAAA,gBAAA;AAAA,cACnB;AAAA,cAIDM,KACC,gBAAA1a;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,WAAU;AAAA,kBACV,OAAO;AAAA,oBACL,MAAM,GAAG0a,EAAkB,MAAM;AAAA,oBACjC,KAAK,GAAGA,EAAkB,MAAM;AAAA,oBAChC,OAAO,GAAG,KAAK;AAAA,sBACb,KAAK,IAAIA,EAAkB,OAAOA,EAAkB,QAAQ,CAAC,IAC7D,KAAK,IAAIA,EAAkB,OAAOA,EAAkB,QAAQ,CAAC;AAAA,oBAC9D,CAAA;AAAA,oBACD,QAAQ;AAAA,oBACR,WAAW,UAAU,KAAK;AAAA,sBACxBA,EAAkB,OAAOA,EAAkB;AAAA,sBAC3CA,EAAkB,OAAOA,EAAkB;AAAA,oBAC7C,KAAK,MAAM,KAAK,GAAG;AAAA,oBACnB,iBAAiB;AAAA,oBACjB,QAAQ;AAAA,kBACV;AAAA,kBAEA,UAAA,gBAAA1a,EAAC,OAAI,EAAA,WAAU,yFAAyF,CAAA;AAAA,gBAAA;AAAA,cAC1G;AAAA,cAIDue,KAAA,gBAAAA,EAAkB,cAAc,IAAI,CACnCnc,MAAA,gBAAApC;AAAA,gBAACmC;AAAA,gBAAA;AAAA,kBAEC,SAAAC;AAAA,kBACA,aAAYmX,KAAA,gBAAAA,EAAiB,UAAS,kBAAkBA,EAAgB,OAAOnX,EAAQ;AAAA,kBACvF,UAAU,MAAM2b,EAAoB,gBAAgB3b,EAAQ,EAAE;AAAA,kBAC9D,aAAa,CAACf,MAAM4c,EAAgB5c,GAAGe,EAAQ,EAAE;AAAA,gBAAA;AAAA,gBAJ5CA,EAAQ;AAAA,cAAA;AAAA,cAShBmc,KAAA,gBAAAA,EAAkB,OAAO,IAAI,CAAS/f,MAAA;AAC/B,sBAAAwiB,IAAazC,EAAiB,OAAO,KAAK,OAAKjG,EAAE,OAAO9Z,EAAM,OAAO;AAC3E,oBAAI,CAACwiB;AAAmB,yBAAA;AAGlB,sBAAAniB,IAAoB0f,EAAiB,OAAO;AAAA,kBAChD,OAAK,EAAE,YAAY/f,EAAM,WAAW,EAAE,aAAaA,EAAM;AAAA,gBACzD,EAAA;AAGA,uBAAA,gBAAAwB;AAAA,kBAACzB;AAAA,kBAAA;AAAA,oBAEC,OAAAC;AAAA,oBACA,OAAOwiB;AAAA,oBACP,mBAAAniB;AAAA,oBACA,YAAY;AAAA,oBACZ,UAAU,MAAM;AAAA,oBAAC;AAAA,oBACjB,QAAQ,MAAM;AAAA,oBAAC;AAAA,oBACf,WAAW,MAAM;AAAA,oBAAC;AAAA,kBAAA;AAAA,kBAPbL,EAAM;AAAA,gBAAA;AAAA,cAQb;AAAA,cAIH+a,KAAmBA,EAAgB,SAAS,WAAW/V,MACtD,gBAAAxD;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,WAAU;AAAA,kBACV,OAAO;AAAA,oBACL,MAAMwD,GAAc,IAAI;AAAA,oBACxB,KAAKA,GAAc,IAAI;AAAA,oBACvB,QAAQA,GAAc,UAAU,cAAcA,GAAc,QAAQ,MAAMA,GAAc,SAAS;AAAA,oBACjG,QAAQA,GAAc,SAAS;AAAA,oBAC/B,WAAW,UAAUA,GAAc,YAAY,CAAC;AAAA,kBAClD;AAAA,gBAAA;AAAA,cACF;AAAA,YAAA;AAAA,UAAA;AAAA,QAEJ;AAAA,0BAEC,OAAI,EAAA,WAAU,wFACb,UAAC,gBAAA7C,EAAA,OAAA,EAAI,WAAU,6CACb,UAAA;AAAA,UAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,2BACb,UAAA;AAAA,YAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,yCACb,UAAA;AAAA,cAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,oCAAoC,CAAA;AAAA,gCAClD,QAAK,EAAA,UAAA;AAAA,gBAAA;AAAA,gBAAQue,KAAA,gBAAAA,EAAkB;AAAA,cAAA,GAAK;AAAA,YAAA,GACvC;AAAA,YACCtd,KACC,gBAAAN,EAAC,OAAI,EAAA,WAAU,yCACb,UAAA;AAAA,cAAC,gBAAAX,EAAA,OAAA,EAAI,WAAU,iDAAiD,CAAA;AAAA,cAChE,gBAAAA,EAAC,UAAK,UAAW,cAAA,CAAA;AAAA,YAAA,GACnB;AAAA,UAAA,GAEJ;AAAA,UAEA,gBAAAW,EAAC,OAAI,EAAA,WAAU,2BACb,UAAA;AAAA,YAAC,gBAAAA,EAAA,OAAA,EAAI,WAAU,iBAAgB,UAAA;AAAA,cAAA;AAAA,cACtB,KAAK,MAAMgZ,IAAO,GAAG;AAAA,cAAE;AAAA,cAAWpU,IAAW,OAAO;AAAA,YAAA,GAC7D;AAAA,YACCgU,KACE,gBAAAvZ,EAAA,OAAA,EAAI,WAAU,6BACZ,YAAgB,SAAS,WAAWwD,KACjC,GAAGA,GAAc,IAAI,KAAKA,GAAc,KAAK,MAC7C,oBAEN;AAAA,UAAA,GAEJ;AAAA,QAAA,EAAA,CACF,EACF,CAAA;AAAA,MAAA,GACF;AAAA,IAAA,GACF;AAAA,IAGC+a,KACC,gBAAAve;AAAA,MAACgK;AAAA,MAAA;AAAA,QACC,OAAOuU;AAAA,QACP,QAAQ1E;AAAA,QACR,SAAS,MAAMC,GAAiB,EAAK;AAAA,MAAA;AAAA,IACvC;AAAA,EAEJ,EAAA,CAAA;AAEJ;"}