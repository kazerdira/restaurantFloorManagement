{"version":3,"file":"restaurant-floor-planner.umd.js","sources":["../src/floorPlanner/constants.ts","../src/floorPlanner/utils.ts","../src/floorPlanner/components/Chair.tsx","../src/floorPlanner/components/Table.tsx","../src/floorPlanner/components/FloorObject.tsx","../src/floorPlanner/components/Wall.tsx","../src/floorPlanner/components/FixedElement.tsx","../src/floorPlanner/components/Sidebar.tsx","../src/floorPlanner/components/Toolbar.tsx","../src/floorPlanner/components/Preview3DModal.tsx","../src/RestaurantFloorPlanner.tsx"],"sourcesContent":["import { Circle, Square, Wine, ChefHat, Bath, DoorOpen, RectangleVertical, Columns, Rows } from 'lucide-react';\r\nimport type { ChairPosition, TableShapeIconMap, TableSize, TableShape, ObjectType, ObjectIconMap, WallType, FixedElementType } from './types';\r\n\r\nexport const hexagonStyle = `\r\n  .hexagon-shape {\r\n    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);\r\n  }\r\n`;\r\n\r\nexport const GRID_SIZE = 20;\r\n\r\nexport const TABLE_SIZES: Record<TableSize, { width: number; height: number }> = {\r\n  small: { width: 50, height: 50 },\r\n  medium: { width: 90, height: 90 },\r\n  large: { width: 130, height: 130 }\r\n};\r\n\r\nexport const TABLE_SHAPES: TableShapeIconMap = {\r\n  square: Square,\r\n  circle: Circle,\r\n  rectangle: Square,\r\n  hexagon: Square\r\n};\r\n\r\nexport const SIZE_LABELS: Record<TableSize, string> = {\r\n  small: 'Small',\r\n  medium: 'Medium',\r\n  large: 'Big'\r\n};\r\n\r\nexport const CHAIR_POSITIONS: ChairPosition[] = ['top', 'bottom', 'left', 'right'];\r\n\r\nexport const TABLE_SHAPE_LABELS: Record<TableShape, string> = {\r\n  square: 'Square',\r\n  circle: 'Circle',\r\n  rectangle: 'Rectangle',\r\n  hexagon: 'Hexagon'\r\n};\r\n\r\nexport const OBJECT_ICONS: ObjectIconMap = {\r\n  bar: Wine,\r\n  kitchen: ChefHat,\r\n  toilet: Bath\r\n};\r\n\r\nexport const OBJECT_LABELS: Record<ObjectType, string> = {\r\n  bar: 'Bar',\r\n  kitchen: 'Kitchen',\r\n  toilet: 'Toilet'\r\n};\r\n\r\nexport const OBJECT_COLORS: Record<ObjectType, { bg: string; border: string; text: string }> = {\r\n  bar: {\r\n    bg: 'bg-gradient-to-br from-purple-500 to-purple-700',\r\n    border: 'border-purple-600',\r\n    text: 'text-purple-100'\r\n  },\r\n  kitchen: {\r\n    bg: 'bg-gradient-to-br from-orange-500 to-orange-700',\r\n    border: 'border-orange-600',\r\n    text: 'text-orange-100'\r\n  },\r\n  toilet: {\r\n    bg: 'bg-gradient-to-br from-cyan-500 to-cyan-700',\r\n    border: 'border-cyan-600',\r\n    text: 'text-cyan-100'\r\n  }\r\n};\r\n\r\nexport const WALL_LABELS: Record<WallType, string> = {\r\n  wall: 'Wall',\r\n  door: 'Door',\r\n  window: 'Window'\r\n};\r\n\r\nexport const WALL_ICONS = {\r\n  wall: RectangleVertical,\r\n  door: DoorOpen,\r\n  window: RectangleVertical\r\n};\r\n\r\nexport const WALL_COLORS: Record<WallType, { stroke: string; fill: string; hover: string }> = {\r\n  wall: {\r\n    stroke: 'stroke-gray-800',\r\n    fill: 'fill-gray-700',\r\n    hover: 'hover:stroke-gray-900'\r\n  },\r\n  door: {\r\n    stroke: 'stroke-amber-600',\r\n    fill: 'fill-amber-500',\r\n    hover: 'hover:stroke-amber-700'\r\n  },\r\n  window: {\r\n    stroke: 'stroke-blue-600',\r\n    fill: 'fill-blue-400',\r\n    hover: 'hover:stroke-blue-700'\r\n  }\r\n};\r\n\r\nexport const FIXED_ELEMENT_LABELS: Record<FixedElementType, string> = {\r\n  pillar: 'Pillar',\r\n  column: 'Column',\r\n  stairs: 'Stairs'\r\n};\r\n\r\nexport const FIXED_ELEMENT_ICONS = {\r\n  pillar: Columns,\r\n  column: Columns,\r\n  stairs: Rows\r\n};\r\n\r\nexport const FIXED_ELEMENT_COLORS: Record<FixedElementType, { bg: string; border: string; text: string }> = {\r\n  pillar: {\r\n    bg: 'bg-gradient-to-br from-gray-600 to-gray-800',\r\n    border: 'border-gray-700',\r\n    text: 'text-gray-100'\r\n  },\r\n  column: {\r\n    bg: 'bg-gradient-to-br from-slate-600 to-slate-800',\r\n    border: 'border-slate-700',\r\n    text: 'text-slate-100'\r\n  },\r\n  stairs: {\r\n    bg: 'bg-gradient-to-br from-stone-600 to-stone-800',\r\n    border: 'border-stone-700',\r\n    text: 'text-stone-100'\r\n  }\r\n};\r\n","import type { ChairPosition, Table, TableShape, TableSize } from './types';\r\nimport { TABLE_SIZES } from './constants';\r\n\r\nexport const generateId = (): string => Math.random().toString(36).slice(2, 11);\r\n\r\nexport const calculateChairSize = (table: Table): number => {\r\n  const actualWidth = table.shape === 'rectangle' ? table.width * 1.5 : table.width;\r\n  const limitingDimension = Math.min(actualWidth, table.height);\r\n  const scaled = Math.round(limitingDimension * 0.35);\r\n  return Math.max(18, Math.min(48, scaled));\r\n};\r\n\r\nexport const getActualTableWidth = (table: Table): number =>\r\n  table.shape === 'rectangle' ? table.width * 1.5 : table.width;\r\n\r\nexport const resolveTableDimensions = (\r\n  shape: TableShape,\r\n  size: TableSize\r\n): { width: number; height: number } => {\r\n  const { width, height } = TABLE_SIZES[size];\r\n  return {\r\n    width: shape === 'rectangle' ? width * 1.5 : width,\r\n    height\r\n  };\r\n};\r\n\r\nexport const getNextChairPosition = (\r\n  occupied: Set<ChairPosition>\r\n): ChairPosition | null => {\r\n  const candidates: ChairPosition[] = ['top', 'bottom', 'left', 'right'];\r\n  return candidates.find((position) => !occupied.has(position)) ?? null;\r\n};\r\n\r\n/**\r\n * Snap wall endpoint to horizontal or vertical axis\r\n * Makes drawing walls much easier and more professional\r\n */\r\nexport const snapToAxis = (\r\n  start: { x: number; y: number },\r\n  end: { x: number; y: number }\r\n): { x: number; y: number } => {\r\n  const dx = Math.abs(end.x - start.x);\r\n  const dy = Math.abs(end.y - start.y);\r\n\r\n  // If closer to horizontal, snap to horizontal\r\n  if (dx > dy) {\r\n    return { x: end.x, y: start.y };\r\n  } else {\r\n    // Snap to vertical\r\n    return { x: start.x, y: end.y };\r\n  }\r\n};\r\n","import React from 'react';\r\nimport { Armchair } from 'lucide-react';\r\n\r\nimport type { Chair, Table } from '../types';\r\nimport { calculateChairSize, getActualTableWidth } from '../utils';\r\n\r\nexport interface ChairComponentProps {\r\n  chair: Chair;\r\n  table: Table;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDrag: (event: React.MouseEvent, id: string) => void;\r\n  onDragEnd: () => void;\r\n  totalChairsOnSide: number; // Total chairs on this side\r\n}\r\n\r\nexport const ChairComponent: React.FC<ChairComponentProps> = ({\r\n  chair,\r\n  table,\r\n  isSelected,\r\n  onSelect,\r\n  onDrag,\r\n  onDragEnd,\r\n  totalChairsOnSide\r\n}) => {\r\n  // Use custom size if provided, otherwise calculate default and increase by 30%\r\n  const baseChairSize = calculateChairSize(table);\r\n  const chairSize = chair.size ?? Math.round(baseChairSize * 1.3);\r\n  const spacing = Math.max(10, Math.round(chairSize * 0.25));\r\n  const iconSize = Math.min(chairSize - 4, Math.max(20, Math.round(chairSize * 0.65)));\r\n  const tableWidth = getActualTableWidth(table);\r\n  const tableRotation = (table.rotation || 0) * (Math.PI / 180); // Convert to radians\r\n\r\n  const position = (() => {\r\n    // Determine side length based on chair position\r\n    const sideLength = chair.position === 'top' || chair.position === 'bottom' \r\n      ? tableWidth \r\n      : table.height;\r\n    \r\n    // Calculate spacing between chairs more accurately\r\n    const availableSpace = sideLength - (chairSize * totalChairsOnSide);\r\n    const gapBetweenChairs = totalChairsOnSide > 1 \r\n      ? availableSpace / (totalChairsOnSide + 1) \r\n      : availableSpace / 2;\r\n    \r\n    // Calculate the chair's offset along its side\r\n    const offsetAlongSide = gapBetweenChairs + (chair.index * (chairSize + gapBetweenChairs)) + chairSize / 2;\r\n    \r\n    // Calculate position relative to table center (before rotation)\r\n    let relativeX = 0;\r\n    let relativeY = 0;\r\n    \r\n    switch (chair.position) {\r\n      case 'top':\r\n        relativeX = offsetAlongSide - tableWidth / 2;\r\n        relativeY = -(table.height / 2 + spacing + chairSize / 2);\r\n        break;\r\n      case 'bottom':\r\n        relativeX = offsetAlongSide - tableWidth / 2;\r\n        relativeY = table.height / 2 + spacing + chairSize / 2;\r\n        break;\r\n      case 'left':\r\n        relativeX = -(tableWidth / 2 + spacing + chairSize / 2);\r\n        relativeY = offsetAlongSide - table.height / 2;\r\n        break;\r\n      case 'right':\r\n        relativeX = tableWidth / 2 + spacing + chairSize / 2;\r\n        relativeY = offsetAlongSide - table.height / 2;\r\n        break;\r\n    }\r\n    \r\n    // Apply rotation transformation around table center\r\n    const rotatedX = relativeX * Math.cos(tableRotation) - relativeY * Math.sin(tableRotation);\r\n    const rotatedY = relativeX * Math.sin(tableRotation) + relativeY * Math.cos(tableRotation);\r\n    \r\n    // Convert to absolute position\r\n    const tableCenterX = table.x + tableWidth / 2;\r\n    const tableCenterY = table.y + table.height / 2;\r\n    \r\n    return {\r\n      x: tableCenterX + rotatedX - chairSize / 2,\r\n      y: tableCenterY + rotatedY - chairSize / 2\r\n    };\r\n  })();\r\n\r\n  // Calculate chair rotation based on position and table rotation\r\n  const getChairRotation = () => {\r\n    let baseRotation = 0;\r\n    switch (chair.position) {\r\n      case 'top':\r\n        baseRotation = 0;\r\n        break;\r\n      case 'right':\r\n        baseRotation = 90;\r\n        break;\r\n      case 'bottom':\r\n        baseRotation = 180;\r\n        break;\r\n      case 'left':\r\n        baseRotation = 270;\r\n        break;\r\n    }\r\n    return baseRotation + (table.rotation || 0);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move transition-all duration-150 ${\r\n        isSelected ? 'ring-4 ring-amber-400 ring-offset-2' : ''\r\n      }`}\r\n      style={{\r\n        left: position.x,\r\n        top: position.y,\r\n        width: chairSize,\r\n        height: chairSize,\r\n        transform: `rotate(${getChairRotation()}deg)`,\r\n        zIndex: isSelected ? 100 : 50,\r\n        filter: 'drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2))'\r\n      }}\r\n      onMouseDown={(event) => {\r\n        event.stopPropagation();\r\n        onSelect();\r\n        onDrag(event, chair.id);\r\n      }}\r\n      onMouseUp={onDragEnd}\r\n    >\r\n      <div className=\"w-full h-full bg-gradient-to-br from-amber-500 to-amber-700 rounded-lg border-4 border-amber-800 flex items-center justify-center shadow-xl hover:shadow-2xl hover:scale-105 transition-all\">\r\n        <Armchair size={iconSize} strokeWidth={3.5} className=\"text-amber-50\" />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\n\r\nimport type { Chair, Table } from '../types';\r\nimport { getActualTableWidth } from '../utils';\r\n\r\nexport interface TableComponentProps {\r\n  table: Table;\r\n  chairs: Chair[];\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDrag: (event: React.MouseEvent, id: string) => void;\r\n  onDragEnd: () => void;\r\n}\r\n\r\nexport const TableComponent: React.FC<TableComponentProps> = ({\r\n  table,\r\n  chairs,\r\n  isSelected,\r\n  onSelect,\r\n  onDrag,\r\n  onDragEnd\r\n}) => {\r\n  const containerStyle: React.CSSProperties = {\r\n    left: table.x,\r\n    top: table.y,\r\n    width: getActualTableWidth(table),\r\n    height: table.height,\r\n    zIndex: isSelected ? 100 : 50,\r\n    transform: `rotate(${table.rotation || 0}deg)`\r\n  };\r\n\r\n  const baseClasses =\r\n    'w-full h-full flex items-center justify-center relative';\r\n\r\n  const tableClasses =\r\n    table.shape === 'circle'\r\n      ? `${baseClasses} rounded-full`\r\n      : table.shape === 'hexagon'\r\n      ? `${baseClasses} hexagon-shape`\r\n      : baseClasses;\r\n\r\n  const tableChairs = chairs.filter((chair) => chair.tableId === table.id);\r\n  const seatsCount = tableChairs.length;\r\n  const nameMatch = table.name.match(/\\d+/);\r\n  const tableLabel = nameMatch ? nameMatch[0] : table.name;\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move transition-all duration-150 ${\r\n        isSelected ? 'ring-2 ring-emerald-500 ring-offset-2' : ''\r\n      }`}\r\n      style={containerStyle}\r\n      onMouseDown={(event) => {\r\n        event.stopPropagation();\r\n        onSelect();\r\n        onDrag(event, table.id);\r\n      }}\r\n      onClick={(event) => {\r\n        event.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseUp={onDragEnd}\r\n    >\r\n      <div className={tableClasses}>\r\n        {/* 3D Table Effect */}\r\n        <div \r\n          className=\"absolute inset-0 rounded-[inherit]\"\r\n          style={{\r\n            background: 'linear-gradient(145deg, #059669 0%, #047857 50%, #065f46 100%)',\r\n            boxShadow: `\r\n              0 8px 16px rgba(0, 0, 0, 0.3),\r\n              0 4px 8px rgba(0, 0, 0, 0.2),\r\n              inset 0 2px 4px rgba(255, 255, 255, 0.2),\r\n              inset 0 -2px 4px rgba(0, 0, 0, 0.2)\r\n            `\r\n          }}\r\n        />\r\n        \r\n        {/* Wood grain effect overlay */}\r\n        <div \r\n          className=\"absolute inset-0 rounded-[inherit] opacity-20\"\r\n          style={{\r\n            background: `\r\n              repeating-linear-gradient(\r\n                90deg,\r\n                transparent,\r\n                transparent 2px,\r\n                rgba(0, 0, 0, 0.1) 2px,\r\n                rgba(0, 0, 0, 0.1) 4px\r\n              )\r\n            `\r\n          }}\r\n        />\r\n        \r\n        {/* Bevel edge highlight */}\r\n        <div \r\n          className=\"absolute inset-0 rounded-[inherit]\"\r\n          style={{\r\n            border: '3px solid transparent',\r\n            borderImage: 'linear-gradient(145deg, rgba(255,255,255,0.4), rgba(0,0,0,0.2)) 1',\r\n            pointerEvents: 'none'\r\n          }}\r\n        />\r\n        \r\n        {/* Content */}\r\n        <div className=\"relative z-10 flex flex-col items-center justify-center gap-1 text-white drop-shadow-lg\">\r\n          <span className=\"text-xs font-bold uppercase tracking-wide\">N: {tableLabel}</span>\r\n          <span className=\"text-xs font-bold uppercase tracking-wide\">S: {seatsCount}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport type { FloorObject as FloorObjectType } from '../types';\r\nimport { OBJECT_ICONS, OBJECT_COLORS } from '../constants';\r\n\r\ninterface FloorObjectProps {\r\n  object: FloorObjectType;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDragStart: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport const FloorObjectComponent: React.FC<FloorObjectProps> = ({\r\n  object,\r\n  isSelected,\r\n  onSelect,\r\n  onDragStart\r\n}) => {\r\n  const Icon = OBJECT_ICONS[object.type];\r\n  const colors = OBJECT_COLORS[object.type];\r\n  const [isDragging, setIsDragging] = useState(false);\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    setIsDragging(true);\r\n    onDragStart(e);\r\n    \r\n    const handleMouseUp = () => {\r\n      setIsDragging(false);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n    \r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move select-none ${!isDragging ? 'transition-all duration-75' : ''} ${colors.bg} ${colors.border} border-2 rounded-lg shadow-lg flex items-center justify-center ${\r\n        isSelected ? 'ring-4 ring-blue-400 ring-opacity-50 scale-105' : 'hover:scale-102'\r\n      }`}\r\n      style={{\r\n        left: `${object.x}px`,\r\n        top: `${object.y}px`,\r\n        width: `${object.width}px`,\r\n        height: `${object.height}px`,\r\n        transform: `rotate(${object.rotation}deg)`,\r\n        transformOrigin: 'center',\r\n        willChange: isDragging ? 'transform' : 'auto'\r\n      }}\r\n      onClick={(e) => {\r\n        e.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseDown={handleMouseDown}\r\n    >\r\n      <div className=\"flex flex-col items-center justify-center gap-2 pointer-events-none\">\r\n        <Icon className={`w-8 h-8 ${colors.text}`} strokeWidth={2} />\r\n        <span className={`text-sm font-bold ${colors.text} uppercase tracking-wide`}>\r\n          {object.name}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Resize handles when selected */}\r\n      {isSelected && (\r\n        <>\r\n          {/* Corner resize handles */}\r\n          <div className=\"absolute -top-1 -left-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white cursor-nw-resize\" />\r\n          <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white cursor-ne-resize\" />\r\n          <div className=\"absolute -bottom-1 -left-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white cursor-sw-resize\" />\r\n          <div className=\"absolute -bottom-1 -right-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white cursor-se-resize\" />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport type { Wall as WallType } from '../types';\r\nimport { WALL_LABELS } from '../constants';\r\n\r\ninterface WallProps {\r\n  wall: WallType;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDragHandle?: (e: React.MouseEvent, handleType: 'start' | 'end') => void;\r\n  onDragStart?: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport const WallComponent: React.FC<WallProps> = ({\r\n  wall,\r\n  isSelected,\r\n  onSelect,\r\n  onDragHandle,\r\n  onDragStart\r\n}) => {\r\n  const length = Math.sqrt(\r\n    Math.pow(wall.endX - wall.startX, 2) + Math.pow(wall.endY - wall.startY, 2)\r\n  );\r\n  const angle = Math.atan2(wall.endY - wall.startY, wall.endX - wall.startX) * (180 / Math.PI);\r\n\r\n  // Determine cursor based on wall orientation\r\n  const getCursorStyle = () => {\r\n    if (!isSelected) return 'pointer';\r\n    \r\n    // Calculate if wall is more horizontal or vertical\r\n    const dx = Math.abs(wall.endX - wall.startX);\r\n    const dy = Math.abs(wall.endY - wall.startY);\r\n    \r\n    return dx > dy ? 'ew-resize' : 'ns-resize';\r\n  };\r\n\r\n  const getWallColor = () => {\r\n    switch (wall.type) {\r\n      case 'wall':\r\n        return 'bg-gray-800';\r\n      case 'door':\r\n        return 'bg-amber-600';\r\n      case 'window':\r\n        return 'bg-blue-500';\r\n    }\r\n  };\r\n\r\n  const getWallPattern = () => {\r\n    if (wall.type === 'window') {\r\n      return 'bg-gradient-to-r from-blue-400 via-blue-300 to-blue-400';\r\n    }\r\n    if (wall.type === 'door') {\r\n      // Door gets custom rendering, return empty\r\n      return '';\r\n    }\r\n    return getWallColor();\r\n  };\r\n\r\n  // Render door as two angled panels\r\n  const renderDoor = () => {\r\n    const gapSize = length * 0.1; // 10% gap in the middle\r\n    const panelWidth = (length - gapSize) / 2;\r\n    \r\n    return (\r\n      <div className=\"w-full h-full relative\">\r\n        {/* Left door panel */}\r\n        <div\r\n          className=\"absolute left-0 bg-gradient-to-r from-amber-600 to-amber-700 shadow-md rounded-sm\"\r\n          style={{\r\n            width: `${panelWidth}px`,\r\n            height: `${wall.thickness}px`,\r\n            borderTop: '1px solid #fbbf24',\r\n            borderBottom: '1px solid #78350f',\r\n            borderRight: '2px solid #92400e'\r\n          }}\r\n        >\r\n          {/* Door handle/knob */}\r\n          <div \r\n            className=\"absolute right-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rounded-full shadow-sm\"\r\n          />\r\n        </div>\r\n        \r\n        {/* Gap in the middle */}\r\n        <div\r\n          className=\"absolute bg-transparent\"\r\n          style={{\r\n            left: `${panelWidth}px`,\r\n            width: `${gapSize}px`,\r\n            height: `${wall.thickness}px`\r\n          }}\r\n        />\r\n        \r\n        {/* Right door panel */}\r\n        <div\r\n          className=\"absolute right-0 bg-gradient-to-r from-amber-700 to-amber-600 shadow-md rounded-sm\"\r\n          style={{\r\n            width: `${panelWidth}px`,\r\n            height: `${wall.thickness}px`,\r\n            borderTop: '1px solid #fbbf24',\r\n            borderBottom: '1px solid #78350f',\r\n            borderLeft: '2px solid #92400e'\r\n          }}\r\n        >\r\n          {/* Door handle/knob */}\r\n          <div \r\n            className=\"absolute left-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rounded-full shadow-sm\"\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div\r\n      onClick={(e) => {\r\n        e.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseDown={(e) => {\r\n        // Only allow dragging the wall body when selected and not clicking handles\r\n        if (isSelected && onDragStart) {\r\n          e.stopPropagation();\r\n          onDragStart(e);\r\n        }\r\n      }}\r\n      className={`absolute transition-all ${\r\n        isSelected ? 'ring-4 ring-blue-400 ring-opacity-50 hover:ring-6 hover:ring-blue-300' : ''\r\n      }`}\r\n      style={{\r\n        left: `${wall.startX}px`,\r\n        top: `${wall.startY}px`,\r\n        width: `${length}px`,\r\n        height: `${wall.thickness}px`,\r\n        transform: `rotate(${angle}deg)`,\r\n        transformOrigin: 'top left',\r\n        zIndex: 10,\r\n        cursor: isSelected ? 'move' : 'pointer',\r\n        pointerEvents: 'auto'\r\n      }}\r\n    >\r\n      {wall.type === 'door' ? (\r\n        renderDoor()\r\n      ) : (\r\n        <div className={`w-full h-full ${getWallPattern()} shadow-lg hover:opacity-90 transition-opacity rounded-sm`}>\r\n          {isSelected && (\r\n            <div className=\"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded whitespace-nowrap shadow-lg z-30\">\r\n              {WALL_LABELS[wall.type]} - {Math.round(length)}px\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n      \r\n      {/* Label for door */}\r\n      {wall.type === 'door' && isSelected && (\r\n        <div className=\"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded whitespace-nowrap shadow-lg z-30\">\r\n          {WALL_LABELS[wall.type]} - {Math.round(length)}px\r\n        </div>\r\n      )}\r\n      \r\n      {/* End point handles */}\r\n      {isSelected && (\r\n        <>\r\n          <div \r\n            className=\"absolute -left-2 top-1/2 transform -translate-y-1/2 w-5 h-5 bg-blue-500 rounded-full border-2 border-white hover:bg-blue-600 hover:scale-125 transition-all shadow-xl z-30\"\r\n            style={{ cursor: getCursorStyle() }}\r\n            onMouseDown={(e) => {\r\n              e.stopPropagation();\r\n              onDragHandle?.(e, 'start');\r\n            }}\r\n            title=\"Drag to resize\"\r\n          />\r\n          <div \r\n            className=\"absolute -right-2 top-1/2 transform -translate-y-1/2 w-5 h-5 bg-blue-500 rounded-full border-2 border-white hover:bg-blue-600 hover:scale-125 transition-all shadow-xl z-30\"\r\n            style={{ cursor: getCursorStyle() }}\r\n            onMouseDown={(e) => {\r\n              e.stopPropagation();\r\n              onDragHandle?.(e, 'end');\r\n            }}\r\n            title=\"Drag to resize\"\r\n          />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React, { useState } from 'react';\r\nimport type { FixedElement as FixedElementType } from '../types';\r\n\r\ninterface FixedElementProps {\r\n  element: FixedElementType;\r\n  isSelected: boolean;\r\n  onSelect: () => void;\r\n  onDragStart: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport const FixedElementComponent: React.FC<FixedElementProps> = ({\r\n  element,\r\n  isSelected,\r\n  onSelect,\r\n  onDragStart\r\n}) => {\r\n  const [isDragging, setIsDragging] = useState(false);\r\n\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    setIsDragging(true);\r\n    onDragStart(e);\r\n    \r\n    const handleMouseUp = () => {\r\n      setIsDragging(false);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n    \r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  };\r\n\r\n  const renderContent = () => {\r\n    if (element.type === 'pillar') {\r\n      return (\r\n        <div className=\"w-full h-full relative\">\r\n          {/* Circular pillar with 3D effect */}\r\n          <div className=\"absolute inset-2 bg-gradient-to-br from-gray-400 via-gray-600 to-gray-800 rounded-full shadow-2xl\">\r\n            <div className=\"absolute inset-0 rounded-full bg-gradient-to-tr from-transparent via-white/10 to-white/20\" />\r\n            {/* Shadow effect */}\r\n            <div className=\"absolute inset-0 rounded-full shadow-inner\" style={{ boxShadow: 'inset -4px -4px 12px rgba(0,0,0,0.5), inset 4px 4px 12px rgba(255,255,255,0.2)' }} />\r\n          </div>\r\n          {/* Center highlight */}\r\n          <div className=\"absolute inset-0 flex items-center justify-center\">\r\n            <div className=\"w-1/3 h-1/3 bg-white/10 rounded-full blur-sm\" />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    if (element.type === 'column') {\r\n      return (\r\n        <div className=\"w-full h-full relative\">\r\n          {/* Square column with depth */}\r\n          <div className=\"absolute inset-2 bg-gradient-to-br from-slate-400 via-slate-600 to-slate-800 rounded-lg shadow-2xl\">\r\n            {/* Top face (3D effect) */}\r\n            <div className=\"absolute inset-0 rounded-lg bg-gradient-to-br from-white/20 via-transparent to-black/30\" />\r\n            {/* Edge highlights */}\r\n            <div className=\"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-white/30 to-transparent rounded-t-lg\" />\r\n            <div className=\"absolute top-0 bottom-0 left-0 w-1 bg-gradient-to-b from-transparent via-white/30 to-transparent rounded-l-lg\" />\r\n            {/* Inner shadow */}\r\n            <div className=\"absolute inset-0 rounded-lg\" style={{ boxShadow: 'inset 0 0 20px rgba(0,0,0,0.5)' }} />\r\n          </div>\r\n          {/* Decorative lines */}\r\n          <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n            <div className=\"w-0.5 h-2/3 bg-white/20\" />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    if (element.type === 'stairs') {\r\n      return (\r\n        <div className=\"w-full h-full relative bg-gradient-to-br from-amber-200 via-amber-300 to-amber-400 rounded-lg shadow-xl overflow-hidden\">\r\n          {/* Steps */}\r\n          {[0, 1, 2, 3, 4, 5].map((step) => (\r\n            <div\r\n              key={step}\r\n              className=\"absolute left-0 right-0 bg-gradient-to-r from-amber-400 to-amber-500 border-t border-amber-600\"\r\n              style={{\r\n                top: `${step * 16.66}%`,\r\n                height: '16.66%',\r\n                boxShadow: '0 2px 4px rgba(0,0,0,0.3)'\r\n              }}\r\n            >\r\n              {/* Step highlight */}\r\n              <div className=\"absolute inset-0 bg-gradient-to-b from-white/20 to-transparent h-1/2\" />\r\n              {/* Step edge shadow */}\r\n              <div className=\"absolute bottom-0 left-0 right-0 h-px bg-black/30\" />\r\n            </div>\r\n          ))}\r\n          {/* Arrow indicator */}\r\n          <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n            <div className=\"bg-white/80 rounded-full p-2 shadow-lg\">\r\n              <svg className=\"w-6 h-6 text-amber-800\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 15l7-7 7 7\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-move select-none ${!isDragging ? 'transition-all duration-75' : ''} rounded-lg ${\r\n        isSelected ? 'ring-4 ring-blue-400 ring-opacity-50 scale-105' : 'hover:scale-102'\r\n      }`}\r\n      style={{\r\n        left: `${element.x}px`,\r\n        top: `${element.y}px`,\r\n        width: `${element.width}px`,\r\n        height: `${element.height}px`,\r\n        transform: `rotate(${element.rotation}deg)`,\r\n        transformOrigin: 'center',\r\n        willChange: isDragging ? 'transform' : 'auto',\r\n        zIndex: 20\r\n      }}\r\n      onClick={(e) => {\r\n        e.stopPropagation();\r\n        onSelect();\r\n      }}\r\n      onMouseDown={handleMouseDown}\r\n    >\r\n      {renderContent()}\r\n      \r\n      {/* Label */}\r\n      {isSelected && (\r\n        <div className=\"absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded whitespace-nowrap shadow-lg z-30\">\r\n          {element.name}\r\n        </div>\r\n      )}\r\n      \r\n      {/* Selection indicators */}\r\n      {isSelected && (\r\n        <>\r\n          <div className=\"absolute -top-1 -left-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white\" />\r\n          <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white\" />\r\n          <div className=\"absolute -bottom-1 -left-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white\" />\r\n          <div className=\"absolute -bottom-1 -right-1 w-3 h-3 bg-blue-500 rounded-full border-2 border-white\" />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Layers, Minus, Plus, RotateCw, Save, Trash2, Upload, LayoutGrid, Package, Home } from 'lucide-react';\r\n\r\nimport { SIZE_LABELS, TABLE_SHAPES, OBJECT_ICONS, OBJECT_LABELS, OBJECT_COLORS, WALL_ICONS, WALL_LABELS, FIXED_ELEMENT_ICONS, FIXED_ELEMENT_LABELS, FIXED_ELEMENT_COLORS } from '../constants';\r\nimport type {\r\n  Chair,\r\n  Floor,\r\n  Table,\r\n  ObjectType,\r\n  WallType,\r\n  FixedElementType\r\n} from '../types';\r\n\r\ninterface SidebarProps {\r\n  floors: Floor[];\r\n  currentFloor?: Floor;\r\n  onAddFloor: () => void;\r\n  onRemoveFloor: () => void;\r\n  onSwitchFloor: (floorId: string) => void;\r\n  onRenameFloor: (floorId: string, newName: string) => void;\r\n  onAddTable: (shape: Table['shape']) => void;\r\n  onAddObject: (type: ObjectType) => void;\r\n  onStartWallDrawing: (type: WallType) => void;\r\n  onAddFixedElement: (type: FixedElementType) => void;\r\n  onRotateTable: () => void;\r\n  onDuplicateTable: () => void;\r\n  onRemoveTable: () => void;\r\n  onSave: () => void;\r\n  onLoad: () => void;\r\n  selectedTable: Table | null;\r\n  selectedTableChairs: Chair[];\r\n}\r\n\r\nconst sizeLabels = SIZE_LABELS;\r\n\r\nexport const Sidebar: React.FC<SidebarProps> = ({\r\n  floors,\r\n  currentFloor,\r\n  onAddFloor,\r\n  onRemoveFloor,\r\n  onSwitchFloor,\r\n  onRenameFloor,\r\n  onAddTable,\r\n  onAddObject,\r\n  onStartWallDrawing,\r\n  onAddFixedElement,\r\n  onRotateTable,\r\n  onDuplicateTable,\r\n  onRemoveTable,\r\n  onSave,\r\n  onLoad,\r\n  selectedTable,\r\n  selectedTableChairs\r\n}) => {\r\n  const [editingFloorId, setEditingFloorId] = React.useState<string | null>(null);\r\n  const [editingFloorName, setEditingFloorName] = React.useState<string>('');\r\n  const [activeTab, setActiveTab] = React.useState<'tables' | 'objects' | 'roomLayout'>('tables');\r\n  const inputRef = React.useRef<HTMLInputElement>(null);\r\n\r\n  // Focus input when editing starts\r\n  React.useEffect(() => {\r\n    if (editingFloorId && inputRef.current) {\r\n      inputRef.current.focus();\r\n      inputRef.current.select();\r\n    }\r\n  }, [editingFloorId]);\r\n\r\n  const handleDoubleClick = (floor: Floor) => {\r\n    setEditingFloorId(floor.id);\r\n    setEditingFloorName(floor.name);\r\n  };\r\n\r\n  const handleSaveFloorName = () => {\r\n    if (editingFloorId && editingFloorName.trim()) {\r\n      onRenameFloor(editingFloorId, editingFloorName.trim());\r\n    }\r\n    setEditingFloorId(null);\r\n    setEditingFloorName('');\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      handleSaveFloorName();\r\n    } else if (e.key === 'Escape') {\r\n      setEditingFloorId(null);\r\n      setEditingFloorName('');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-80 bg-white shadow-lg border-r border-gray-200 flex flex-col\">\r\n      <div className=\"p-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white\">\r\n        <h1 className=\"text-xl font-bold\">Restaurant Designer</h1>\r\n        <p className=\"text-blue-100 text-sm\">Professional Floor Planner</p>\r\n      </div>\r\n\r\n      <div className=\"p-4 border-b border-gray-200\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h2 className=\"text-lg font-semibold text-gray-800 flex items-center gap-2\">\r\n            <Layers className=\"w-5 h-5\" />\r\n            Floor Plans ({floors.length})\r\n          </h2>\r\n          <div className=\"flex gap-1\">\r\n            <button\r\n              onClick={onAddFloor}\r\n              className=\"p-2 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors\"\r\n              title=\"Add New Floor\"\r\n            >\r\n              <Plus className=\"w-4 h-4\" />\r\n            </button>\r\n            <button\r\n              onClick={onRemoveFloor}\r\n              disabled={floors.length <= 1}\r\n              className=\"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              title=\"Remove Current Floor\"\r\n            >\r\n              <Minus className=\"w-4 h-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-2 max-h-32 overflow-y-auto\">\r\n          {floors.map((floor) => (\r\n            <div\r\n              key={floor.id}\r\n              className={`w-full p-3 rounded-lg transition-all flex items-center justify-between ${\r\n                floor.isActive\r\n                  ? 'bg-blue-100 text-blue-800 border border-blue-200 shadow-sm'\r\n                  : 'text-gray-600 hover:bg-gray-100 border border-transparent'\r\n              }`}\r\n              onClick={() => {\r\n                if (editingFloorId !== floor.id) {\r\n                  onSwitchFloor(floor.id);\r\n                }\r\n              }}\r\n              onDoubleClick={() => handleDoubleClick(floor)}\r\n            >\r\n              <div className=\"flex-1\">\r\n                {editingFloorId === floor.id ? (\r\n                  <input\r\n                    ref={inputRef}\r\n                    type=\"text\"\r\n                    value={editingFloorName}\r\n                    onChange={(e) => setEditingFloorName(e.target.value)}\r\n                    onBlur={handleSaveFloorName}\r\n                    onKeyDown={handleKeyDown}\r\n                    className=\"w-full px-2 py-1 text-sm font-medium bg-white border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    onClick={(e) => e.stopPropagation()}\r\n                  />\r\n                ) : (\r\n                  <div className=\"font-medium cursor-pointer\">{floor.name}</div>\r\n                )}\r\n                <div className=\"text-xs text-gray-500 mt-0.5\">\r\n                  {floor.tables.length} tables, {floor.chairs.length} chairs\r\n                </div>\r\n              </div>\r\n              {floor.isActive && <div className=\"w-2 h-2 bg-blue-500 rounded-full\" />}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs for Tables, Objects, and Room Layout */}\r\n      <div className=\"border-b border-gray-200\">\r\n        <div className=\"flex\">\r\n          <button\r\n            onClick={() => setActiveTab('tables')}\r\n            className={`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${\r\n              activeTab === 'tables'\r\n                ? 'bg-white text-emerald-600 border-b-2 border-emerald-600'\r\n                : 'bg-gray-50 text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            <LayoutGrid className=\"w-4 h-4\" />\r\n            Tables\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('objects')}\r\n            className={`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${\r\n              activeTab === 'objects'\r\n                ? 'bg-white text-purple-600 border-b-2 border-purple-600'\r\n                : 'bg-gray-50 text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            <Package className=\"w-4 h-4\" />\r\n            Objects\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('roomLayout')}\r\n            className={`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${\r\n              activeTab === 'roomLayout'\r\n                ? 'bg-white text-gray-700 border-b-2 border-gray-700'\r\n                : 'bg-gray-50 text-gray-600 hover:bg-gray-100'\r\n            }`}\r\n          >\r\n            <Home className=\"w-4 h-4\" />\r\n            Room\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tables Tab Content */}\r\n      {activeTab === 'tables' && (\r\n        <div className=\"p-4 border-b border-gray-200\">\r\n          <h3 className=\"text-md font-semibold text-gray-800 mb-3\">Add Tables</h3>\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            {Object.entries(TABLE_SHAPES).map(([shape, Icon]) => (\r\n              <button\r\n                key={shape}\r\n                onClick={() => onAddTable(shape as Table['shape'])}\r\n                className=\"p-3 border-2 border-gray-200 rounded-lg hover:border-emerald-400 hover:bg-emerald-50 transition-all flex flex-col items-center gap-2 hover:shadow-md\"\r\n              >\r\n                <Icon className=\"w-6 h-6 text-emerald-600\" />\r\n                <span className=\"text-xs text-gray-700 capitalize font-medium\">{shape}</span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Objects Tab Content */}\r\n      {activeTab === 'objects' && (\r\n        <div className=\"p-4 border-b border-gray-200\">\r\n          <h3 className=\"text-md font-semibold text-gray-800 mb-3\">Add Objects</h3>\r\n          <div className=\"space-y-3\">\r\n            {(Object.keys(OBJECT_LABELS) as ObjectType[]).map((objectType) => {\r\n              const Icon = OBJECT_ICONS[objectType];\r\n              const colors = OBJECT_COLORS[objectType];\r\n              const label = OBJECT_LABELS[objectType];\r\n              \r\n              return (\r\n                <button\r\n                  key={objectType}\r\n                  onClick={() => onAddObject(objectType)}\r\n                  className={`w-full p-4 ${colors.bg} border-2 ${colors.border} rounded-xl hover:scale-105 transition-all flex items-center gap-3 shadow-lg hover:shadow-xl`}\r\n                >\r\n                  <div className=\"bg-white/20 p-2 rounded-lg\">\r\n                    <Icon className={`w-6 h-6 ${colors.text}`} strokeWidth={2.5} />\r\n                  </div>\r\n                  <div className=\"flex-1 text-left\">\r\n                    <span className={`text-base font-bold ${colors.text}`}>{label}</span>\r\n                    <div className=\"text-xs text-white/80 mt-0.5\">Click to add to floor</div>\r\n                  </div>\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Room Layout Tab Content */}\r\n      {activeTab === 'roomLayout' && (\r\n        <div className=\"p-4 border-b border-gray-200\">\r\n          {/* Walls Section */}\r\n          <div className=\"mb-6\">\r\n            <h3 className=\"text-md font-semibold text-gray-800 mb-3\">Draw Walls</h3>\r\n            <div className=\"space-y-2\">\r\n              {(['wall', 'door', 'window'] as WallType[]).map((wallType) => {\r\n                const Icon = WALL_ICONS[wallType];\r\n                const label = WALL_LABELS[wallType];\r\n                \r\n                const colorClasses = {\r\n                  wall: 'bg-gradient-to-br from-gray-600 to-gray-800 border-gray-700 text-white hover:from-gray-700 hover:to-gray-900',\r\n                  door: 'bg-gradient-to-br from-amber-500 to-amber-700 border-amber-600 text-white hover:from-amber-600 hover:to-amber-800',\r\n                  window: 'bg-gradient-to-br from-blue-500 to-blue-700 border-blue-600 text-white hover:from-blue-600 hover:to-blue-800'\r\n                };\r\n                \r\n                return (\r\n                  <button\r\n                    key={wallType}\r\n                    onClick={() => onStartWallDrawing(wallType)}\r\n                    className={`w-full p-3 border-2 rounded-lg transition-all flex items-center gap-3 shadow-md hover:shadow-lg ${colorClasses[wallType]}`}\r\n                  >\r\n                    <Icon className=\"w-5 h-5\" strokeWidth={2.5} />\r\n                    <span className=\"text-sm font-semibold\">{label}</span>\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Fixed Elements Section */}\r\n          <div>\r\n            <h3 className=\"text-md font-semibold text-gray-800 mb-3\">Add Elements</h3>\r\n            <div className=\"space-y-2\">\r\n              {(['pillar', 'column', 'stairs'] as FixedElementType[]).map((elementType) => {\r\n                const Icon = FIXED_ELEMENT_ICONS[elementType];\r\n                const colors = FIXED_ELEMENT_COLORS[elementType];\r\n                const label = FIXED_ELEMENT_LABELS[elementType];\r\n                \r\n                return (\r\n                  <button\r\n                    key={elementType}\r\n                    onClick={() => onAddFixedElement(elementType)}\r\n                    className={`w-full p-3 ${colors.bg} border-2 ${colors.border} rounded-lg hover:scale-105 transition-all flex items-center gap-3 shadow-md hover:shadow-lg`}\r\n                  >\r\n                    <div className=\"bg-white/10 p-1.5 rounded\">\r\n                      <Icon className={`w-5 h-5 ${colors.text}`} strokeWidth={2.5} />\r\n                    </div>\r\n                    <span className={`text-sm font-semibold ${colors.text}`}>{label}</span>\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {selectedTable && (\r\n        <div className=\"p-4 border-b border-gray-200\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h3 className=\"text-md font-semibold text-gray-800\">Table Properties</h3>\r\n            <div className=\"flex gap-1\">\r\n              <button\r\n                onClick={onRotateTable}\r\n                className=\"p-1 text-blue-600 hover:bg-blue-100 rounded transition-colors\"\r\n                title=\"Rotate Table\"\r\n              >\r\n                <RotateCw className=\"w-4 h-4\" />\r\n              </button>\r\n              <button\r\n                onClick={onDuplicateTable}\r\n                className=\"p-1 text-green-600 hover:bg-green-100 rounded transition-colors\"\r\n                title=\"Duplicate Table\"\r\n              >\r\n                <Plus className=\"w-4 h-4\" />\r\n              </button>\r\n              <button\r\n                onClick={onRemoveTable}\r\n                className=\"p-1 text-red-600 hover:bg-red-100 rounded transition-colors\"\r\n                title=\"Delete Table\"\r\n              >\r\n                <Trash2 className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-3 text-sm text-gray-600\">\r\n            <div className=\"grid grid-cols-2 gap-3\">\r\n              <div>\r\n                <div className=\"text-xs uppercase tracking-wide text-gray-400\">Name</div>\r\n                <div className=\"font-semibold text-gray-800\">{selectedTable.name}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-xs uppercase tracking-wide text-gray-400\">Shape</div>\r\n                <div className=\"font-semibold text-gray-800 capitalize\">{selectedTable.shape}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-xs uppercase tracking-wide text-gray-400\">Size</div>\r\n                <div className=\"font-semibold text-gray-800\">{sizeLabels[selectedTable.size]}</div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-xs uppercase tracking-wide text-gray-400\">Seats</div>\r\n                <div className=\"font-semibold text-gray-800\">{selectedTableChairs.length}</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-md p-3\">\r\n              <p className=\"text-xs text-blue-700\">\r\n                ðŸ’¡ <span className=\"font-semibold\">Tip:</span> Use the <span className=\"font-semibold\">Manage Chairs</span> button in the toolbar above to add or remove chairs from each side of the table.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"p-4 mt-auto space-y-3\">\r\n        <div className=\"bg-gray-50 p-3 rounded-lg\">\r\n          <h4 className=\"text-sm font-semibold text-gray-700 mb-2\">Current Floor Stats</h4>\r\n          <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n            <div>\r\n              <div className=\"text-gray-600\">Tables</div>\r\n              <div className=\"font-bold text-lg text-emerald-600\">\r\n                {currentFloor?.tables.length ?? 0}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-gray-600\">Total Seats</div>\r\n              <div className=\"font-bold text-lg text-amber-600\">\r\n                {currentFloor?.chairs.length ?? 0}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex gap-2\">\r\n          <button\r\n            onClick={onSave}\r\n            className=\"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-medium\"\r\n          >\r\n            <Save className=\"w-4 h-4\" />\r\n            Save\r\n          </button>\r\n          <button\r\n            onClick={onLoad}\r\n            className=\"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 font-medium\"\r\n          >\r\n            <Upload className=\"w-4 h-4\" />\r\n            Load\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Armchair, Box, ChevronRight, Eye, EyeOff, Minus, Plus, RotateCcw, Square, Trash2 } from 'lucide-react';\r\n\r\nimport type { Chair, ChairPosition, Table, TableSize, FloorObject, Wall, FixedElement } from '../types';\r\nimport { SIZE_LABELS, OBJECT_ICONS, OBJECT_LABELS, WALL_LABELS, FIXED_ELEMENT_LABELS } from '../constants';\r\n\r\ninterface ToolbarProps {\r\n  showGrid: boolean;\r\n  selectedTable: Table | null;\r\n  selectedObject: FloorObject | null;\r\n  selectedWall: Wall | null;\r\n  selectedFixedElement: FixedElement | null;\r\n  selectedTableChairs: Chair[];\r\n  tableCount: number;\r\n  chairCount: number;\r\n  objectCount: number;\r\n  wallCount: number;\r\n  fixedElementCount: number;\r\n  selectedElementType: string | null;\r\n  onToggleGrid: () => void;\r\n  onAddChair: (position: ChairPosition) => void;\r\n  onRemoveChair: (position: ChairPosition) => void;\r\n  onChangeTableSize: (size: TableSize) => void;\r\n  onTableNameChange: (name: string) => void;\r\n  onCustomTableSize: (width: number, height: number) => void;\r\n  onObjectNameChange: (name: string) => void;\r\n  onObjectResize: (width: number, height: number) => void;\r\n  onRemoveObject: () => void;\r\n  onRemoveWall: () => void;\r\n  onRemoveFixedElement: () => void;\r\n  onChangeWallThickness?: (thickness: number) => void;\r\n  onConvertWallType?: (type: 'wall' | 'door' | 'window') => void;\r\n  onFixedElementNameChange?: (name: string) => void;\r\n  onFixedElementResize?: (width: number, height: number) => void;\r\n  onChairSizeChange?: (position: ChairPosition, size: number) => void;\r\n  onResetChairSizes?: () => void;\r\n  on3DPreview?: () => void;\r\n  onObjectRotate?: (rotation: number) => void;\r\n}\r\n\r\nconst sizeLabels = SIZE_LABELS;\r\nconst chairPositions: ChairPosition[] = ['top', 'right', 'bottom', 'left'];\r\nconst sizeOptions: TableSize[] = ['small', 'medium', 'large'];\r\n\r\nexport const Toolbar: React.FC<ToolbarProps> = ({\r\n  showGrid,\r\n  selectedTable,\r\n  selectedObject,\r\n  selectedWall,\r\n  selectedFixedElement,\r\n  selectedTableChairs,\r\n  onToggleGrid,\r\n  onAddChair,\r\n  onRemoveChair,\r\n  onChangeTableSize,\r\n  onTableNameChange,\r\n  onCustomTableSize,\r\n  onObjectNameChange,\r\n  onObjectResize,\r\n  onRemoveObject,\r\n  onRemoveWall,\r\n  onRemoveFixedElement,\r\n  onChangeWallThickness,\r\n  onConvertWallType,\r\n  onFixedElementNameChange,\r\n  onFixedElementResize,\r\n  onChairSizeChange,\r\n  onResetChairSizes,\r\n  on3DPreview,\r\n  onObjectRotate,\r\n  tableCount,\r\n  chairCount,\r\n  objectCount,\r\n  wallCount,\r\n  fixedElementCount,\r\n  selectedElementType\r\n}) => {\r\n  const chairMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const sizeMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const objectSizeMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const fixedElementSizeMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const [isChairMenuOpen, setIsChairMenuOpen] = useState(false);\r\n  const [isSizeMenuOpen, setIsSizeMenuOpen] = useState(false);\r\n  const [isObjectSizeMenuOpen, setIsObjectSizeMenuOpen] = useState(false);\r\n  const [isFixedElementSizeMenuOpen, setIsFixedElementSizeMenuOpen] = useState(false);\r\n  const [showProSlider, setShowProSlider] = useState(false);\r\n  const [customWidth, setCustomWidth] = useState(90);\r\n  const [customHeight, setCustomHeight] = useState(90);\r\n  const [objectWidth, setObjectWidth] = useState(120);\r\n  const [objectHeight, setObjectHeight] = useState(80);\r\n  const [fixedElementWidth, setFixedElementWidth] = useState(60);\r\n  const [fixedElementHeight, setFixedElementHeight] = useState(60);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (chairMenuRef.current && !chairMenuRef.current.contains(event.target as Node)) {\r\n        setIsChairMenuOpen(false);\r\n      }\r\n      if (sizeMenuRef.current && !sizeMenuRef.current.contains(event.target as Node)) {\r\n        setIsSizeMenuOpen(false);\r\n      }\r\n      if (objectSizeMenuRef.current && !objectSizeMenuRef.current.contains(event.target as Node)) {\r\n        setIsObjectSizeMenuOpen(false);\r\n      }\r\n      if (fixedElementSizeMenuRef.current && !fixedElementSizeMenuRef.current.contains(event.target as Node)) {\r\n        setIsFixedElementSizeMenuOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!selectedTable) {\r\n      setIsChairMenuOpen(false);\r\n      setIsSizeMenuOpen(false);\r\n      setShowProSlider(false);\r\n    } else {\r\n      // Update custom sliders when table changes\r\n      setCustomWidth(selectedTable.width);\r\n      setCustomHeight(selectedTable.height);\r\n    }\r\n    \r\n    if (!selectedObject) {\r\n      setIsObjectSizeMenuOpen(false);\r\n    } else {\r\n      // Update object sliders when object changes\r\n      setObjectWidth(selectedObject.width);\r\n      setObjectHeight(selectedObject.height);\r\n    }\r\n    \r\n    if (!selectedFixedElement) {\r\n      setIsFixedElementSizeMenuOpen(false);\r\n    } else {\r\n      // Update fixed element sliders when element changes\r\n      setFixedElementWidth(selectedFixedElement.width);\r\n      setFixedElementHeight(selectedFixedElement.height);\r\n    }\r\n  }, [selectedTable, selectedObject, selectedFixedElement]);\r\n\r\n  return (\r\n    <div className=\"bg-white border-b border-gray-200 shadow-sm min-h-[72px]\">\r\n      <div className=\"px-4 py-3 flex items-center justify-between min-h-[72px]\">\r\n        {/* Left Section - Controls */}\r\n        <div className=\"flex items-center gap-3 flex-wrap\">\r\n          {/* Grid Toggle */}\r\n          <button\r\n            onClick={onToggleGrid}\r\n            className={`px-3 py-2 rounded-lg transition-all flex items-center gap-2 text-sm font-medium ${\r\n              showGrid \r\n                ? 'bg-blue-500 text-white shadow-md hover:bg-blue-600' \r\n                : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\r\n            }`}\r\n            title={showGrid ? 'Hide Grid' : 'Show Grid'}\r\n          >\r\n            {showGrid ? <Eye className=\"w-4 h-4\" /> : <EyeOff className=\"w-4 h-4\" />}\r\n            <span>Grid</span>\r\n          </button>\r\n\r\n          {selectedTable && (\r\n            <>\r\n              <div className=\"w-px h-8 bg-gray-300\" />\r\n\r\n              {/* Chair Management Dropdown */}\r\n              <div ref={chairMenuRef} className=\"relative\">\r\n                <button\r\n                  onClick={() => {\r\n                    setIsChairMenuOpen(!isChairMenuOpen);\r\n                    setIsSizeMenuOpen(false);\r\n                  }}\r\n                  className=\"px-3 py-2 rounded-lg bg-gradient-to-r from-amber-500 to-amber-600 text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold\"\r\n                >\r\n                  <Armchair className=\"w-4 h-4\" />\r\n                  <span>Manage Chairs</span>\r\n                  <span className=\"ml-1 px-1.5 py-0.5 bg-white/20 rounded text-xs\">\r\n                    {selectedTableChairs.length}\r\n                  </span>\r\n                </button>\r\n                \r\n                {isChairMenuOpen && (\r\n                  <div className=\"absolute top-full left-0 mt-2 w-72 bg-white border border-gray-200 rounded-xl shadow-2xl z-50 overflow-hidden\">\r\n                    <div className=\"bg-gradient-to-r from-amber-500 to-amber-600 px-4 py-3 text-white\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Armchair className=\"w-4 h-4\" />\r\n                          <span className=\"font-semibold text-sm\">Chair Positions</span>\r\n                        </div>\r\n                        <span className=\"text-xs bg-white/20 px-2 py-1 rounded\">\r\n                          Total: {selectedTableChairs.length}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"p-3 space-y-2\">\r\n                      {chairPositions.map((position) => {\r\n                        const chairsOnSide = selectedTableChairs.filter(c => c.position === position).length;\r\n                        const chairSample = selectedTableChairs.find(c => c.position === position);\r\n                        const currentSize = chairSample?.size || 40; // Default fallback\r\n                        \r\n                        return (\r\n                          <div\r\n                            key={position}\r\n                            className=\"bg-gray-50 rounded-lg px-3 py-2 border border-gray-200 hover:border-amber-300 transition-all space-y-2\"\r\n                          >\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-8 h-8 bg-gradient-to-br from-gray-600 to-gray-700 rounded-md flex items-center justify-center text-white text-xs font-bold uppercase\">\r\n                                  {position[0]}\r\n                                </div>\r\n                                <div>\r\n                                  <div className=\"text-sm font-medium text-gray-800 capitalize\">{position}</div>\r\n                                  <div className=\"text-xs text-gray-500\">{chairsOnSide} chair{chairsOnSide !== 1 ? 's' : ''}</div>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <button\r\n                                  onClick={() => onRemoveChair(position)}\r\n                                  disabled={chairsOnSide === 0}\r\n                                  className=\"w-7 h-7 rounded-md bg-red-50 text-red-600 hover:bg-red-100 disabled:opacity-30 disabled:cursor-not-allowed transition-all flex items-center justify-center\"\r\n                                  title=\"Remove chair\"\r\n                                >\r\n                                  <Minus className=\"w-4 h-4\" />\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => onAddChair(position)}\r\n                                  className=\"w-7 h-7 rounded-md bg-green-50 text-green-600 hover:bg-green-100 transition-all flex items-center justify-center\"\r\n                                  title=\"Add chair\"\r\n                                >\r\n                                  <Plus className=\"w-4 h-4\" />\r\n                                </button>\r\n                              </div>\r\n                            </div>\r\n                            \r\n                            {/* Size Slider */}\r\n                            {chairsOnSide > 0 && (\r\n                              <div className=\"pt-2 border-t border-gray-200\">\r\n                                <div className=\"flex items-center justify-between mb-1\">\r\n                                  <span className=\"text-xs font-medium text-gray-600\">Chair Size</span>\r\n                                  <span className=\"text-xs font-bold text-amber-600\">{currentSize}px</span>\r\n                                </div>\r\n                                <input\r\n                                  type=\"range\"\r\n                                  min=\"20\"\r\n                                  max=\"60\"\r\n                                  value={currentSize}\r\n                                  onChange={(e) => onChairSizeChange?.(position, parseInt(e.target.value))}\r\n                                  className=\"w-full h-2 bg-gradient-to-r from-amber-200 to-amber-400 rounded-full appearance-none cursor-pointer slider-thumb\"\r\n                                  style={{\r\n                                    background: `linear-gradient(to right, rgb(251, 191, 36) 0%, rgb(251, 191, 36) ${((currentSize - 20) / 40) * 100}%, rgb(253, 230, 138) ${((currentSize - 20) / 40) * 100}%, rgb(253, 230, 138) 100%)`\r\n                                  }}\r\n                                />\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        );\r\n                      })}\r\n                      \r\n                      {/* Reset Button */}\r\n                      <button\r\n                        onClick={() => onResetChairSizes?.()}\r\n                        className=\"w-full mt-3 px-3 py-2 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all flex items-center justify-center gap-2 text-sm font-medium\"\r\n                      >\r\n                        <RotateCcw className=\"w-4 h-4\" />\r\n                        <span>Reset All Sizes</span>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Table Size Dropdown */}\r\n              <div ref={sizeMenuRef} className=\"relative\">\r\n                <button\r\n                  onClick={() => {\r\n                    setIsSizeMenuOpen(!isSizeMenuOpen);\r\n                    setIsChairMenuOpen(false);\r\n                  }}\r\n                  className=\"px-3 py-2 rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold\"\r\n                >\r\n                  <Square className=\"w-4 h-4\" />\r\n                  <span>Size: {sizeLabels[selectedTable.size]}</span>\r\n                </button>\r\n                \r\n                {isSizeMenuOpen && (\r\n                  <div className=\"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 rounded-xl shadow-2xl z-50 overflow-hidden\">\r\n                    <div className=\"bg-gradient-to-r from-emerald-500 to-emerald-600 px-4 py-2 text-white\">\r\n                      <span className=\"font-semibold text-sm\">Table Size</span>\r\n                    </div>\r\n                    \r\n                    {/* Size Buttons */}\r\n                    <div className=\"p-3 space-y-2\">\r\n                      <div className=\"flex gap-2\">\r\n                        {sizeOptions.map((sizeOption) => {\r\n                          const isActive = selectedTable.size === sizeOption;\r\n                          return (\r\n                            <button\r\n                              key={sizeOption}\r\n                              onClick={() => {\r\n                                onChangeTableSize(sizeOption);\r\n                                setShowProSlider(false);\r\n                              }}\r\n                              className={`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-all ${\r\n                                isActive && !showProSlider\r\n                                  ? 'bg-emerald-500 text-white shadow-sm'\r\n                                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                              }`}\r\n                            >\r\n                              {sizeLabels[sizeOption]}\r\n                            </button>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                      \r\n                      {/* Pro Mode Toggle */}\r\n                      <button\r\n                        onClick={() => setShowProSlider(!showProSlider)}\r\n                        className={`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-all ${\r\n                          showProSlider\r\n                            ? 'bg-purple-500 text-white shadow-sm'\r\n                            : 'bg-gradient-to-r from-purple-100 to-purple-50 text-purple-700 hover:from-purple-200 hover:to-purple-100'\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className=\"text-sm font-semibold\">Pro Mode</span>\r\n                          <span className=\"text-xs bg-white/20 px-1.5 py-0.5 rounded\">Custom</span>\r\n                        </div>\r\n                        <ChevronRight className={`w-4 h-4 transition-transform ${showProSlider ? 'rotate-90' : ''}`} />\r\n                      </button>\r\n                      \r\n                      {/* Pro Sliders - Smooth Reveal */}\r\n                      <div className={`overflow-hidden transition-all duration-300 ease-in-out ${\r\n                        showProSlider ? 'max-h-48 opacity-100' : 'max-h-0 opacity-0'\r\n                      }`}>\r\n                        <div className=\"pt-2 space-y-3 border-t border-gray-200\">\r\n                          {/* Width Slider */}\r\n                          <div className=\"space-y-1\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <label className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide\">\r\n                                Width\r\n                              </label>\r\n                              <span className=\"text-xs font-mono bg-purple-100 text-purple-700 px-2 py-0.5 rounded\">\r\n                                {customWidth}px\r\n                              </span>\r\n                            </div>\r\n                            <input\r\n                              type=\"range\"\r\n                              min=\"40\"\r\n                              max=\"200\"\r\n                              step=\"5\"\r\n                              value={customWidth}\r\n                              onChange={(e) => {\r\n                                const newWidth = parseInt(e.target.value);\r\n                                setCustomWidth(newWidth);\r\n                                onCustomTableSize(newWidth, customHeight);\r\n                              }}\r\n                              className=\"w-full h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer slider-thumb\"\r\n                              style={{\r\n                                background: `linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${((customWidth - 40) / 160) * 100}%, rgb(233, 213, 255) ${((customWidth - 40) / 160) * 100}%, rgb(233, 213, 255) 100%)`\r\n                              }}\r\n                            />\r\n                          </div>\r\n                          \r\n                          {/* Height Slider */}\r\n                          <div className=\"space-y-1\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <label className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide\">\r\n                                Height\r\n                              </label>\r\n                              <span className=\"text-xs font-mono bg-purple-100 text-purple-700 px-2 py-0.5 rounded\">\r\n                                {customHeight}px\r\n                              </span>\r\n                            </div>\r\n                            <input\r\n                              type=\"range\"\r\n                              min=\"40\"\r\n                              max=\"200\"\r\n                              step=\"5\"\r\n                              value={customHeight}\r\n                              onChange={(e) => {\r\n                                const newHeight = parseInt(e.target.value);\r\n                                setCustomHeight(newHeight);\r\n                                onCustomTableSize(customWidth, newHeight);\r\n                              }}\r\n                              className=\"w-full h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer slider-thumb\"\r\n                              style={{\r\n                                background: `linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${((customHeight - 40) / 160) * 100}%, rgb(233, 213, 255) ${((customHeight - 40) / 160) * 100}%, rgb(233, 213, 255) 100%)`\r\n                              }}\r\n                            />\r\n                          </div>\r\n                          \r\n                          {/* Info Text */}\r\n                          <p className=\"text-xs text-gray-500 italic pt-1\">\r\n                            Drag sliders for precise sizing\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Table Name Input */}\r\n              <div className=\"flex items-center gap-2 bg-gray-50 border border-gray-300 rounded-lg px-3 py-2\">\r\n                <span className=\"text-xs font-semibold uppercase tracking-wide text-gray-500\">Name:</span>\r\n                <input\r\n                  type=\"text\"\r\n                  value={selectedTable.name}\r\n                  onChange={(event) => onTableNameChange(event.target.value)}\r\n                  className=\"bg-transparent text-sm text-gray-800 font-medium focus:outline-none w-32\"\r\n                  placeholder=\"Table name\"\r\n                />\r\n              </div>\r\n            </>\r\n          )}\r\n          \r\n          {/* Object Controls */}\r\n          {selectedObject && (\r\n            <>\r\n              <div className=\"w-px h-8 bg-gray-300\" />\r\n\r\n              {/* Object Size Control */}\r\n              <div ref={objectSizeMenuRef} className=\"relative\">\r\n                <button\r\n                  onClick={() => setIsObjectSizeMenuOpen(!isObjectSizeMenuOpen)}\r\n                  className={`px-3 py-2 rounded-lg ${\r\n                    selectedObject.type === 'bar' ? 'bg-gradient-to-r from-purple-500 to-purple-600' :\r\n                    selectedObject.type === 'kitchen' ? 'bg-gradient-to-r from-orange-500 to-orange-600' :\r\n                    'bg-gradient-to-r from-cyan-500 to-cyan-600'\r\n                  } text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`}\r\n                >\r\n                  {(() => {\r\n                    const Icon = OBJECT_ICONS[selectedObject.type];\r\n                    return <Icon className=\"w-4 h-4\" />;\r\n                  })()}\r\n                  <span>Resize {OBJECT_LABELS[selectedObject.type]}</span>\r\n                </button>\r\n                \r\n                {isObjectSizeMenuOpen && (\r\n                  <div className=\"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 rounded-xl shadow-2xl z-50 overflow-hidden\">\r\n                    <div className={`${\r\n                      selectedObject.type === 'bar' ? 'bg-gradient-to-r from-purple-500 to-purple-600' :\r\n                      selectedObject.type === 'kitchen' ? 'bg-gradient-to-r from-orange-500 to-orange-600' :\r\n                      'bg-gradient-to-r from-cyan-500 to-cyan-600'\r\n                    } px-4 py-2 text-white`}>\r\n                      <span className=\"font-semibold text-sm\">Custom Size</span>\r\n                    </div>\r\n                    \r\n                    <div className=\"p-3 space-y-3\">\r\n                      {/* Width Slider */}\r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <label className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide\">\r\n                            Width\r\n                          </label>\r\n                          <span className={`text-xs font-mono px-2 py-0.5 rounded ${\r\n                            selectedObject.type === 'bar' ? 'bg-purple-100 text-purple-700' :\r\n                            selectedObject.type === 'kitchen' ? 'bg-orange-100 text-orange-700' :\r\n                            'bg-cyan-100 text-cyan-700'\r\n                          }`}>\r\n                            {objectWidth}px\r\n                          </span>\r\n                        </div>\r\n                        <input\r\n                          type=\"range\"\r\n                          min=\"60\"\r\n                          max=\"1000\"\r\n                          step=\"10\"\r\n                          value={objectWidth}\r\n                          onChange={(e) => {\r\n                            const newWidth = parseInt(e.target.value);\r\n                            setObjectWidth(newWidth);\r\n                            onObjectResize(newWidth, objectHeight);\r\n                          }}\r\n                          className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb\"\r\n                          style={{\r\n                            background: `linear-gradient(to right, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } 0%, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } ${((objectWidth - 60) / 940) * 100}%, rgb(229, 231, 235) ${((objectWidth - 60) / 940) * 100}%, rgb(229, 231, 235) 100%)`\r\n                          }}\r\n                        />\r\n                      </div>\r\n                      \r\n                      {/* Height Slider */}\r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <label className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide\">\r\n                            Height\r\n                          </label>\r\n                          <span className={`text-xs font-mono px-2 py-0.5 rounded ${\r\n                            selectedObject.type === 'bar' ? 'bg-purple-100 text-purple-700' :\r\n                            selectedObject.type === 'kitchen' ? 'bg-orange-100 text-orange-700' :\r\n                            'bg-cyan-100 text-cyan-700'\r\n                          }`}>\r\n                            {objectHeight}px\r\n                          </span>\r\n                        </div>\r\n                        <input\r\n                          type=\"range\"\r\n                          min=\"60\"\r\n                          max=\"1000\"\r\n                          step=\"10\"\r\n                          value={objectHeight}\r\n                          onChange={(e) => {\r\n                            const newHeight = parseInt(e.target.value);\r\n                            setObjectHeight(newHeight);\r\n                            onObjectResize(objectWidth, newHeight);\r\n                          }}\r\n                          className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb\"\r\n                          style={{\r\n                            background: `linear-gradient(to right, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } 0%, ${\r\n                              selectedObject.type === 'bar' ? 'rgb(168, 85, 247)' :\r\n                              selectedObject.type === 'kitchen' ? 'rgb(249, 115, 22)' :\r\n                              'rgb(6, 182, 212)'\r\n                            } ${((objectHeight - 60) / 940) * 100}%, rgb(229, 231, 235) ${((objectHeight - 60) / 940) * 100}%, rgb(229, 231, 235) 100%)`\r\n                          }}\r\n                        />\r\n                      </div>\r\n                      \r\n                      {/* Info Text */}\r\n                      <p className=\"text-xs text-gray-500 italic pt-1\">\r\n                        Drag sliders to resize the object\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Rotate Object Button */}\r\n              <button\r\n                onClick={() => {\r\n                  const newRotation = ((selectedObject.rotation || 0) + 90) % 360;\r\n                  onObjectRotate?.(newRotation);\r\n                }}\r\n                className={`px-3 py-2 rounded-lg ${\r\n                  selectedObject.type === 'bar' ? 'bg-gradient-to-r from-purple-600 to-purple-700' :\r\n                  selectedObject.type === 'kitchen' ? 'bg-gradient-to-r from-orange-600 to-orange-700' :\r\n                  'bg-gradient-to-r from-cyan-600 to-cyan-700'\r\n                } text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`}\r\n                title=\"Rotate 90Â°\"\r\n              >\r\n                <RotateCcw className=\"w-4 h-4\" />\r\n                <span>Rotate</span>\r\n              </button>\r\n\r\n              {/* Delete Object Button */}\r\n              <button\r\n                onClick={onRemoveObject}\r\n                className=\"px-3 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold\"\r\n                title=\"Delete Object\"\r\n              >\r\n                <Trash2 className=\"w-4 h-4\" />\r\n                <span>Delete</span>\r\n              </button>\r\n\r\n              {/* Object Name Input */}\r\n              <div className=\"flex items-center gap-2 bg-gray-50 border border-gray-300 rounded-lg px-3 py-2\">\r\n                <span className=\"text-xs font-semibold uppercase tracking-wide text-gray-500\">Name:</span>\r\n                <input\r\n                  type=\"text\"\r\n                  value={selectedObject.name}\r\n                  onChange={(event) => onObjectNameChange(event.target.value)}\r\n                  className=\"bg-transparent text-sm text-gray-800 font-medium focus:outline-none w-32\"\r\n                  placeholder=\"Object name\"\r\n                />\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {/* Wall Controls */}\r\n          {selectedWall && (\r\n            <>\r\n              <div className=\"w-px h-8 bg-gray-300\" />\r\n\r\n              {/* Wall Type Converter */}\r\n              {onConvertWallType && (\r\n                <div className=\"flex items-center gap-1 bg-gray-50 border border-gray-300 rounded-lg p-1\">\r\n                  <button\r\n                    onClick={() => onConvertWallType('wall')}\r\n                    className={`px-3 py-1.5 rounded text-xs font-semibold transition-all ${\r\n                      selectedWall.type === 'wall'\r\n                        ? 'bg-gray-600 text-white shadow-md'\r\n                        : 'text-gray-600 hover:bg-gray-200'\r\n                    }`}\r\n                    title=\"Convert to Wall\"\r\n                  >\r\n                    Wall\r\n                  </button>\r\n                  <button\r\n                    onClick={() => onConvertWallType('door')}\r\n                    className={`px-3 py-1.5 rounded text-xs font-semibold transition-all ${\r\n                      selectedWall.type === 'door'\r\n                        ? 'bg-amber-600 text-white shadow-md'\r\n                        : 'text-gray-600 hover:bg-gray-200'\r\n                    }`}\r\n                    title=\"Convert to Door\"\r\n                  >\r\n                    Door\r\n                  </button>\r\n                  <button\r\n                    onClick={() => onConvertWallType('window')}\r\n                    className={`px-3 py-1.5 rounded text-xs font-semibold transition-all ${\r\n                      selectedWall.type === 'window'\r\n                        ? 'bg-blue-600 text-white shadow-md'\r\n                        : 'text-gray-600 hover:bg-gray-200'\r\n                    }`}\r\n                    title=\"Convert to Window\"\r\n                  >\r\n                    Window\r\n                  </button>\r\n                </div>\r\n              )}\r\n\r\n              {/* Wall Thickness Selector */}\r\n              {onChangeWallThickness && (\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-xs font-semibold text-gray-600\">Thickness:</span>\r\n                  <select\r\n                    value={selectedWall.thickness}\r\n                    onChange={(e) => onChangeWallThickness(Number(e.target.value))}\r\n                    className=\"px-2 py-1 text-sm border border-gray-300 rounded bg-white hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  >\r\n                    <option value={4}>Thin (4px)</option>\r\n                    <option value={8}>Normal (8px)</option>\r\n                    <option value={12}>Thick (12px)</option>\r\n                    <option value={16}>Very Thick (16px)</option>\r\n                  </select>\r\n                </div>\r\n              )}\r\n\r\n              {/* Wall Info */}\r\n              <div className=\"flex items-center gap-2 bg-gray-50 border border-gray-300 rounded-lg px-3 py-2\">\r\n                <span className=\"text-xs font-semibold uppercase tracking-wide text-gray-500\">\r\n                  {WALL_LABELS[selectedWall.type]}\r\n                </span>\r\n                <span className=\"text-sm text-gray-600\">\r\n                  {Math.round(Math.sqrt(\r\n                    Math.pow(selectedWall.endX - selectedWall.startX, 2) + \r\n                    Math.pow(selectedWall.endY - selectedWall.startY, 2)\r\n                  ))}px\r\n                </span>\r\n              </div>\r\n\r\n              {/* Delete Wall Button */}\r\n              <button\r\n                onClick={onRemoveWall}\r\n                className=\"px-3 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold\"\r\n                title=\"Delete Wall\"\r\n              >\r\n                <Trash2 className=\"w-4 h-4\" />\r\n                <span>Delete</span>\r\n              </button>\r\n            </>\r\n          )}\r\n\r\n          {/* Fixed Element Controls */}\r\n          {selectedFixedElement && (\r\n            <>\r\n              <div className=\"w-px h-8 bg-gray-300\" />\r\n\r\n              {/* Fixed Element Info */}\r\n              <div className=\"flex items-center gap-2 bg-gray-50 border border-gray-300 rounded-lg px-3 py-2\">\r\n                <span className=\"text-xs font-semibold uppercase tracking-wide text-gray-500\">\r\n                  {FIXED_ELEMENT_LABELS[selectedFixedElement.type]}\r\n                </span>\r\n              </div>\r\n\r\n              {/* Fixed Element Resize Controls */}\r\n              {onFixedElementResize && (\r\n                <div ref={fixedElementSizeMenuRef} className=\"relative\">\r\n                  <button\r\n                    onClick={() => setIsFixedElementSizeMenuOpen(!isFixedElementSizeMenuOpen)}\r\n                    className=\"px-3 py-2 rounded-lg bg-gray-600 hover:bg-gray-700 text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold\"\r\n                  >\r\n                    <Square className=\"w-4 h-4\" />\r\n                    <span>Resize</span>\r\n                  </button>\r\n                  \r\n                  {isFixedElementSizeMenuOpen && (\r\n                    <div className=\"absolute top-full left-0 mt-2 bg-white rounded-xl shadow-2xl border border-gray-200 p-4 z-50 min-w-[320px]\">\r\n                      <div className=\"space-y-4\">\r\n                        {/* Width Slider */}\r\n                        <div>\r\n                          <div className=\"flex justify-between items-center mb-2\">\r\n                            <label className=\"text-sm font-semibold text-gray-700\">Width</label>\r\n                            <span className=\"text-sm font-bold text-blue-600\">{fixedElementWidth}px</span>\r\n                          </div>\r\n                          <input\r\n                            type=\"range\"\r\n                            min=\"30\"\r\n                            max=\"200\"\r\n                            value={fixedElementWidth}\r\n                            onChange={(e) => {\r\n                              const newWidth = parseInt(e.target.value);\r\n                              setFixedElementWidth(newWidth);\r\n                              onFixedElementResize(newWidth, fixedElementHeight);\r\n                            }}\r\n                            className=\"w-full h-2 bg-gradient-to-r from-blue-200 to-blue-500 rounded-lg appearance-none cursor-pointer slider\"\r\n                          />\r\n                          <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\r\n                            <span>30px</span>\r\n                            <span>200px</span>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Height Slider */}\r\n                        <div>\r\n                          <div className=\"flex justify-between items-center mb-2\">\r\n                            <label className=\"text-sm font-semibold text-gray-700\">Height</label>\r\n                            <span className=\"text-sm font-bold text-blue-600\">{fixedElementHeight}px</span>\r\n                          </div>\r\n                          <input\r\n                            type=\"range\"\r\n                            min=\"30\"\r\n                            max=\"200\"\r\n                            value={fixedElementHeight}\r\n                            onChange={(e) => {\r\n                              const newHeight = parseInt(e.target.value);\r\n                              setFixedElementHeight(newHeight);\r\n                              onFixedElementResize(fixedElementWidth, newHeight);\r\n                            }}\r\n                            className=\"w-full h-2 bg-gradient-to-r from-green-200 to-green-500 rounded-lg appearance-none cursor-pointer slider\"\r\n                          />\r\n                          <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\r\n                            <span>30px</span>\r\n                            <span>200px</span>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Current Size Display */}\r\n                        <div className=\"pt-3 border-t border-gray-200\">\r\n                          <div className=\"text-center\">\r\n                            <span className=\"text-xs text-gray-600\">Current Size: </span>\r\n                            <span className=\"text-sm font-bold text-gray-800\">{fixedElementWidth} Ã— {fixedElementHeight}px</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Delete Fixed Element Button */}\r\n              <button\r\n                onClick={onRemoveFixedElement}\r\n                className=\"px-3 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold\"\r\n                title=\"Delete Element\"\r\n              >\r\n                <Trash2 className=\"w-4 h-4\" />\r\n                <span>Delete</span>\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Right Section - Stats */}\r\n        <div className=\"flex items-center gap-3 flex-wrap\">\r\n          {/* 3D Button */}\r\n          <button\r\n            onClick={on3DPreview}\r\n            className=\"px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:shadow-lg transition-all flex items-center gap-2 font-semibold text-sm\"\r\n          >\r\n            <Box className=\"w-4 h-4\" />\r\n            3D\r\n          </button>\r\n          \r\n          <div className=\"flex items-center gap-1.5 px-2 py-1 bg-emerald-50 rounded text-xs\">\r\n            <div className=\"w-2 h-2 bg-emerald-600 rounded-full\" />\r\n            <span className=\"font-medium text-emerald-800\">Tables: {tableCount}</span>\r\n          </div>\r\n          <div className=\"flex items-center gap-1.5 px-2 py-1 bg-amber-50 rounded text-xs\">\r\n            <div className=\"w-2 h-2 bg-amber-600 rounded-full\" />\r\n            <span className=\"font-medium text-amber-800\">Chairs: {chairCount}</span>\r\n          </div>\r\n          <div className=\"flex items-center gap-1.5 px-2 py-1 bg-purple-50 rounded text-xs\">\r\n            <div className=\"w-2 h-2 bg-purple-600 rounded-full\" />\r\n            <span className=\"font-medium text-purple-800\">Objects: {objectCount}</span>\r\n          </div>\r\n          {selectedElementType && (\r\n            <div className=\"flex items-center gap-1.5 px-2 py-1 bg-blue-50 rounded text-xs\">\r\n              <div className=\"w-1.5 h-1.5 bg-blue-600 rounded-full animate-pulse\" />\r\n              <span className=\"font-medium text-blue-800 capitalize\">Selected: {selectedElementType}</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport * as THREE from 'three';\r\nimport { X, RotateCcw, ZoomIn, ZoomOut, Maximize2, Move3d, Grid, Layers } from 'lucide-react';\r\nimport type { Floor } from '../types';\r\n\r\ninterface Preview3DModalProps {\r\n  floor: Floor;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\n// Predefined camera positions for smooth transitions\r\nconst CAMERA_VIEWS = {\r\n  default: { \r\n    position: { x: 1050, y: 800, z: 1050 }, // Slightly more zoomed out\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Default',\r\n    icon: 'ðŸ '\r\n  },\r\n  top: { \r\n    position: { x: 0, y: 1200, z: 1 }, // Higher for better top view\r\n    target: { x: 0, y: 0, z: 0 },\r\n    name: 'Top View',\r\n    icon: 'â¬‡'\r\n  },\r\n  front: { \r\n    position: { x: 0, y: 300, z: 1000 }, // Further back\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Front',\r\n    icon: 'â¬†'\r\n  },\r\n  side: { \r\n    position: { x: 1000, y: 300, z: 0 }, // Further to the side\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Side',\r\n    icon: 'âž¡'\r\n  },\r\n  corner: { \r\n    position: { x: -900, y: 700, z: -900 }, // More zoomed out corner\r\n    target: { x: 0, y: 100, z: 0 },\r\n    name: 'Corner',\r\n    icon: 'â†–'\r\n  }\r\n};\r\n\r\nexport const Preview3DModal: React.FC<Preview3DModalProps> = ({ floor, isOpen, onClose }) => {\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const sceneRef = useRef<THREE.Scene | null>(null);\r\n  const cameraRef = useRef<THREE.PerspectiveCamera | null>(null);\r\n  const rendererRef = useRef<THREE.WebGLRenderer | null>(null);\r\n  const animationFrameRef = useRef<number | null>(null);\r\n  const [autoRotate, setAutoRotate] = useState(false);\r\n  const [currentView, setCurrentView] = useState<keyof typeof CAMERA_VIEWS>('default');\r\n  const [isTransitioning, setIsTransitioning] = useState(false);\r\n  const rotationSpeedRef = useRef(0.003);\r\n  const transitionRef = useRef<{ \r\n    startPos: THREE.Vector3; \r\n    endPos: THREE.Vector3;\r\n    startTarget: THREE.Vector3;\r\n    endTarget: THREE.Vector3;\r\n    progress: number;\r\n  } | null>(null);\r\n\r\n  // Smooth camera transition function\r\n  const smoothCameraTransition = (viewKey: keyof typeof CAMERA_VIEWS) => {\r\n    if (!cameraRef.current || isTransitioning) return;\r\n    \r\n    const view = CAMERA_VIEWS[viewKey];\r\n    const camera = cameraRef.current;\r\n    \r\n    transitionRef.current = {\r\n      startPos: camera.position.clone(),\r\n      endPos: new THREE.Vector3(view.position.x, view.position.y, view.position.z),\r\n      startTarget: new THREE.Vector3(0, 100, 0),\r\n      endTarget: new THREE.Vector3(view.target.x, view.target.y, view.target.z),\r\n      progress: 0\r\n    };\r\n    \r\n    setIsTransitioning(true);\r\n    setCurrentView(viewKey);\r\n    setAutoRotate(false);\r\n  };\r\n\r\n  // Manual rotation controls\r\n  const rotateCamera = (direction: 'left' | 'right' | 'up' | 'down') => {\r\n    if (!cameraRef.current || isTransitioning) return;\r\n    \r\n    const camera = cameraRef.current;\r\n    const radius = Math.sqrt(camera.position.x ** 2 + camera.position.z ** 2);\r\n    const currentAngle = Math.atan2(camera.position.z, camera.position.x);\r\n    \r\n    switch(direction) {\r\n      case 'left':\r\n        const leftAngle = currentAngle + 0.2;\r\n        camera.position.x = radius * Math.cos(leftAngle);\r\n        camera.position.z = radius * Math.sin(leftAngle);\r\n        break;\r\n      case 'right':\r\n        const rightAngle = currentAngle - 0.2;\r\n        camera.position.x = radius * Math.cos(rightAngle);\r\n        camera.position.z = radius * Math.sin(rightAngle);\r\n        break;\r\n      case 'up':\r\n        camera.position.y = Math.min(camera.position.y + 50, 900);\r\n        break;\r\n      case 'down':\r\n        camera.position.y = Math.max(camera.position.y - 50, 100);\r\n        break;\r\n    }\r\n    \r\n    camera.lookAt(0, 100, 0);\r\n  };\r\n\r\n  const zoomCamera = (factor: number) => {\r\n    if (!cameraRef.current || isTransitioning) return;\r\n    cameraRef.current.position.multiplyScalar(factor);\r\n    cameraRef.current.lookAt(0, 100, 0);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!isOpen || !containerRef.current) return;\r\n\r\n    // Scene setup with light modern theme\r\n    const scene = new THREE.Scene();\r\n    scene.background = new THREE.Color(0xdee6ef); // Soft blue-grey for pleasant atmosphere\r\n    sceneRef.current = scene;\r\n\r\n    // Camera\r\n    const camera = new THREE.PerspectiveCamera(\r\n      45,\r\n      containerRef.current.clientWidth / containerRef.current.clientHeight,\r\n      0.1,\r\n      10000\r\n    );\r\n    camera.position.set(1050, 800, 1050); // Slightly more zoomed out default view\r\n    camera.lookAt(0, 100, 0); // Looking at mid-level\r\n    cameraRef.current = camera;\r\n\r\n    // Renderer with advanced settings\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\r\n    renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    renderer.toneMapping = THREE.ACESFilmicToneMapping;\r\n    renderer.toneMappingExposure = 1.2;\r\n    containerRef.current.appendChild(renderer.domElement);\r\n    rendererRef.current = renderer;\r\n    \r\n    // Add environment map for better reflections\r\n    const pmremGenerator = new THREE.PMREMGenerator(renderer);\r\n    const envScene = new THREE.Scene();\r\n    envScene.background = new THREE.Color(0xffffff);\r\n    const envTexture = pmremGenerator.fromScene(envScene).texture;\r\n    scene.environment = envTexture;\r\n    pmremGenerator.dispose();\r\n\r\n    // Professional lighting setup\r\n    scene.add(new THREE.AmbientLight(0xffffff, 0.6));\r\n    \r\n    const mainLight = new THREE.DirectionalLight(0xffffff, 0.8);\r\n    mainLight.position.set(400, 600, 300);\r\n    mainLight.castShadow = true;\r\n    mainLight.shadow.mapSize.width = 4096;\r\n    mainLight.shadow.mapSize.height = 4096;\r\n    mainLight.shadow.camera.left = mainLight.shadow.camera.bottom = -700;\r\n    mainLight.shadow.camera.right = mainLight.shadow.camera.top = 700;\r\n    mainLight.shadow.bias = -0.0001;\r\n    scene.add(mainLight);\r\n    \r\n    const fillLight = new THREE.DirectionalLight(0xffffff, 0.3);\r\n    fillLight.position.set(-400, 400, -300);\r\n    scene.add(fillLight);\r\n    \r\n    const rimLight = new THREE.DirectionalLight(0xffffff, 0.2);\r\n    rimLight.position.set(0, 300, -500);\r\n    scene.add(rimLight);\r\n\r\n    // Modern floor\r\n    const floorMesh = new THREE.Mesh(\r\n      new THREE.PlaneGeometry(1200, 1200),\r\n      new THREE.MeshStandardMaterial({ color: 0xd0d0d5, roughness: 0.8, metalness: 0.2 }) // Medium grey\r\n    );\r\n    floorMesh.rotation.x = -Math.PI / 2;\r\n    floorMesh.receiveShadow = true;\r\n    scene.add(floorMesh);\r\n\r\n    const grid = new THREE.GridHelper(3000, 150, 0xa0a0a8, 0xb8b8c0); // Much larger grid (3000x3000)\r\n    grid.position.y = 1;\r\n    scene.add(grid);\r\n\r\n    // WALLS - Premium styling\r\n    floor.walls.forEach(wall => {\r\n      const length = Math.sqrt(Math.pow(wall.endX - wall.startX, 2) + Math.pow(wall.endY - wall.startY, 2));\r\n      const angle = Math.atan2(wall.endY - wall.startY, wall.endX - wall.startX);\r\n      const wallHeight = wall.type === 'window' ? 80 : 120; // Windows are 80, walls and doors are 120\r\n      const baseX = wall.startX + (wall.endX - wall.startX) / 2 - 400;\r\n      const baseZ = -(wall.startY + (wall.endY - wall.startY) / 2 - 400);\r\n      \r\n      if (wall.type === 'door') {\r\n        // === RESTAURANT DOUBLE GLASS DOOR ===\r\n        const doorGroup = new THREE.Group();\r\n        const doorWidth = length; // Full wall width\r\n        const doorHeight = wallHeight; // Full wall height\r\n        const doorThickness = wall.thickness * 0.8;\r\n\r\n        // === FRAME (dark wood or metal) ===\r\n        const frameMat = new THREE.MeshStandardMaterial({\r\n          color: 0x3a2e25, // dark stained wood\r\n          roughness: 0.9,\r\n          metalness: 0.0,\r\n        });\r\n\r\n        const frameThickness = 8;\r\n\r\n        // Frame sides, top, and bottom - adjusted to fit within wall height\r\n        const topFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(doorWidth, frameThickness, wall.thickness + 4),\r\n          frameMat\r\n        );\r\n        topFrame.position.y = doorHeight / 2 - frameThickness / 2;\r\n        doorGroup.add(topFrame);\r\n\r\n        const bottomFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(doorWidth, frameThickness, wall.thickness + 4),\r\n          frameMat\r\n        );\r\n        bottomFrame.position.y = -doorHeight / 2 + frameThickness / 2;\r\n        doorGroup.add(bottomFrame);\r\n\r\n        const leftFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(frameThickness, doorHeight, wall.thickness + 4),\r\n          frameMat\r\n        );\r\n        leftFrame.position.x = -doorWidth / 2 + frameThickness / 2;\r\n        doorGroup.add(leftFrame);\r\n\r\n        const rightFrame = leftFrame.clone();\r\n        rightFrame.position.x = doorWidth / 2 - frameThickness / 2;\r\n        doorGroup.add(rightFrame);\r\n\r\n        // === LEFT + RIGHT DOOR PANELS ===\r\n        const doorMat = new THREE.MeshStandardMaterial({\r\n          color: 0x4e342e, // warm brown\r\n          roughness: 0.85,\r\n          metalness: 0.0,\r\n        });\r\n\r\n        const glassMat = new THREE.MeshStandardMaterial({\r\n          color: 0x9eb3b5, // subtle bluish-gray tint\r\n          transparent: true,\r\n          opacity: 0.5,     // semi-transparent\r\n          roughness: 0.95,  // frosted effect\r\n          metalness: 0.0,   // no mirror reflection\r\n        });\r\n\r\n        const singleDoorWidth = (doorWidth - frameThickness * 2 - 4) / 2;\r\n        const doorPanelHeight = doorHeight - frameThickness * 2 - 4; // Fit within top and bottom frame\r\n\r\n        const makeDoor = (xOffset: number) => {\r\n          const group = new THREE.Group();\r\n\r\n          // Wood border\r\n          const doorBorder = new THREE.Mesh(\r\n            new THREE.BoxGeometry(singleDoorWidth, doorPanelHeight, doorThickness),\r\n            doorMat\r\n          );\r\n          group.add(doorBorder);\r\n\r\n          // Glass inset (center window)\r\n          const glass = new THREE.Mesh(\r\n            new THREE.PlaneGeometry(singleDoorWidth * 0.8, doorPanelHeight * 0.85),\r\n            glassMat\r\n          );\r\n          glass.position.set(0, 0, doorThickness / 2 + 0.1);\r\n          group.add(glass);\r\n\r\n          // Handle (simple vertical metal bar)\r\n          const handleMat = new THREE.MeshStandardMaterial({\r\n            color: 0x888888,\r\n            metalness: 0.4,\r\n            roughness: 0.7,\r\n          });\r\n\r\n          const handle = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(0.6, 0.6, 12, 12),\r\n            handleMat\r\n          );\r\n          handle.rotation.z = Math.PI / 2;\r\n          handle.position.set(xOffset > 0 ? -singleDoorWidth * 0.35 : singleDoorWidth * 0.35, 0, doorThickness / 2 + 1.5);\r\n          group.add(handle);\r\n\r\n          group.position.x = xOffset;\r\n          return group;\r\n        };\r\n\r\n        // Left & Right doors\r\n        const leftDoor = makeDoor(-singleDoorWidth / 2);\r\n        const rightDoor = makeDoor(singleDoorWidth / 2);\r\n        doorGroup.add(leftDoor);\r\n        doorGroup.add(rightDoor);\r\n\r\n        // === WELCOME SIGN ===\r\n        const signHeight = 14;\r\n        const signGeometry = new THREE.PlaneGeometry(doorWidth * 0.9, signHeight);\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = 512;\r\n        canvas.height = 128;\r\n        const ctx = canvas.getContext('2d');\r\n\r\n        if (ctx) {\r\n          // Draw wooden background\r\n          ctx.fillStyle = '#3a2e25';\r\n          ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n          // Draw text\r\n          ctx.font = 'bold 60px Arial';\r\n          ctx.fillStyle = '#f5d590'; // warm golden lettering\r\n          ctx.textAlign = 'center';\r\n          ctx.textBaseline = 'middle';\r\n          ctx.fillText('WELCOME', canvas.width / 2, canvas.height / 2);\r\n        }\r\n\r\n        const signTexture = new THREE.CanvasTexture(canvas);\r\n        const signMaterial = new THREE.MeshStandardMaterial({\r\n          map: signTexture,\r\n          roughness: 0.8,\r\n          metalness: 0.1,\r\n        });\r\n\r\n        const sign = new THREE.Mesh(signGeometry, signMaterial);\r\n        sign.position.set(0, doorHeight / 2 - frameThickness - signHeight / 2 - 4, wall.thickness / 2 + 2);\r\n        doorGroup.add(sign);\r\n\r\n        // === FINAL POSITIONING ===\r\n        doorGroup.position.set(baseX, doorHeight / 2, baseZ);\r\n        doorGroup.rotation.y = -angle;\r\n        doorGroup.castShadow = true;\r\n        doorGroup.receiveShadow = true;\r\n        scene.add(doorGroup);\r\n        \r\n      } else if (wall.type === 'window') {\r\n        // === REALISTIC ARCHITECTURAL WINDOW (With top wall section) ===\r\n        \r\n        // Use standard size if length is too small\r\n        const windowLength = length > 20 ? length : 120;\r\n        const windowHeight = wallHeight;\r\n\r\n        // HEIGHT RATIOS\r\n        const h1 = windowHeight * 0.45;  // bottom wall/sill (increased)\r\n        const h2 = windowHeight * 0.65;  // main window area\r\n        const h3 = windowHeight * 0.10;  // top transom\r\n        const h4 = windowHeight * 0.30;  // top wall section\r\n\r\n        // === MATERIALS ===\r\n        const wallMat = new THREE.MeshStandardMaterial({\r\n          color: 0xc8c8d0, // Grey-blue for window sills and wall sections\r\n          roughness: 0.85,\r\n          metalness: 0.05\r\n        });\r\n\r\n        // Dark aluminum/black frame for contrast\r\n        const frameMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x2a2a2a,\r\n          metalness: 0.95,\r\n          roughness: 0.2,\r\n          clearcoat: 0.8,\r\n          clearcoatRoughness: 0.1,\r\n        });\r\n\r\n        // Realistic glass - visible but transparent with subtle blue tint\r\n        const glassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xe6f2ff,\r\n          transparent: true,\r\n          opacity: 0.4,\r\n          transmission: 0.85,\r\n          thickness: 1.5,\r\n          roughness: 0.05,\r\n          metalness: 0.05,\r\n          ior: 1.52,\r\n          envMapIntensity: 1.0,\r\n          clearcoat: 0.8,\r\n          clearcoatRoughness: 0.1,\r\n          reflectivity: 0.5,\r\n        });\r\n\r\n        // === BOTTOM WALL/SILL ===\r\n        const sill = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, h1, wall.thickness),\r\n          wallMat\r\n        );\r\n        sill.position.set(baseX, h1 / 2, baseZ);\r\n        sill.rotation.y = -angle;\r\n        sill.receiveShadow = true;\r\n        sill.castShadow = true;\r\n        scene.add(sill);\r\n\r\n        // === MAIN WINDOW AREA ===\r\n        const winY = h1 + h2 / 2;\r\n        const frameThickness = 4;\r\n        const numPanes = Math.max(2, Math.floor(windowLength / 80)); // At least 2 panes\r\n        const paneWidth = (windowLength - frameThickness * (numPanes + 1)) / numPanes;\r\n\r\n        // Individual glass panes WITH PROPER POSITIONING\r\n        for (let i = 0; i < numPanes; i++) {\r\n          const paneX = -windowLength / 2 + frameThickness + paneWidth / 2 + i * (paneWidth + frameThickness);\r\n          const localX = baseX + paneX * Math.cos(-angle);\r\n          const localZ = baseZ + paneX * Math.sin(-angle);\r\n\r\n          // Glass pane (positioned INSIDE the frame)\r\n          const glass = new THREE.Mesh(\r\n            new THREE.BoxGeometry(paneWidth - 2, h2 - frameThickness * 2, 1),\r\n            glassMat\r\n          );\r\n          glass.position.set(localX, winY, localZ);\r\n          glass.rotation.y = -angle;\r\n          glass.castShadow = false;\r\n          glass.receiveShadow = false;\r\n          scene.add(glass);\r\n\r\n          // Vertical divider (except after last pane)\r\n          if (i < numPanes - 1) {\r\n            const divX = -windowLength / 2 + frameThickness + (i + 1) * paneWidth + (i + 0.5) * frameThickness;\r\n            const divLocalX = baseX + divX * Math.cos(-angle);\r\n            const divLocalZ = baseZ + divX * Math.sin(-angle);\r\n            \r\n            const divider = new THREE.Mesh(\r\n              new THREE.BoxGeometry(frameThickness, h2, wall.thickness + 3),\r\n              frameMat\r\n            );\r\n            divider.position.set(divLocalX, winY, divLocalZ);\r\n            divider.rotation.y = -angle;\r\n            divider.castShadow = true;\r\n            scene.add(divider);\r\n          }\r\n        }\r\n\r\n        // === TOP TRANSOM WINDOW ===\r\n        const topY = h1 + h2 + h3 / 2;\r\n\r\n        const transomGlass = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength - frameThickness * 2, h3 - frameThickness, 1),\r\n          glassMat\r\n        );\r\n        transomGlass.position.set(baseX, topY, baseZ);\r\n        transomGlass.rotation.y = -angle;\r\n        transomGlass.castShadow = false;\r\n        scene.add(transomGlass);\r\n        \r\n        // Transom frame (between main window and transom)\r\n        const transomFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, frameThickness, wall.thickness + 2),\r\n          frameMat\r\n        );\r\n        transomFrame.position.set(baseX, h1 + h2 + frameThickness / 2, baseZ);\r\n        transomFrame.rotation.y = -angle;\r\n        transomFrame.castShadow = true;\r\n        scene.add(transomFrame);\r\n\r\n        // Frame between transom and top wall\r\n        const transomTopFrame = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, frameThickness, wall.thickness + 2),\r\n          frameMat\r\n        );\r\n        transomTopFrame.position.set(baseX, h1 + h2 + h3 + frameThickness / 2, baseZ);\r\n        transomTopFrame.rotation.y = -angle;\r\n        transomTopFrame.castShadow = true;\r\n        scene.add(transomTopFrame);\r\n\r\n        // === TOP WALL SECTION (same material as regular wall) ===\r\n        const topWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(windowLength, h4, wall.thickness),\r\n          wallMat\r\n        );\r\n        topWall.position.set(baseX, h1 + h2 + h3 + h4 / 2, baseZ);\r\n        topWall.rotation.y = -angle;\r\n        topWall.castShadow = true;\r\n        topWall.receiveShadow = true;\r\n        scene.add(topWall);\r\n        \r\n      } else {\r\n        // Regular walls - warmer grey-blue for better definition\r\n        const wallMesh = new THREE.Mesh(\r\n          new THREE.BoxGeometry(length, wallHeight, wall.thickness),\r\n          new THREE.MeshStandardMaterial({ color: 0xb8b8c0, roughness: 0.9, metalness: 0.05 })\r\n        );\r\n        wallMesh.position.set(baseX, wallHeight / 2, baseZ);\r\n        wallMesh.rotation.y = -angle;\r\n        wallMesh.castShadow = true;\r\n        wallMesh.receiveShadow = true;\r\n        scene.add(wallMesh);\r\n      }\r\n    });\r\n\r\n    // FIXED ELEMENTS - Premium styling\r\n    floor.fixedElements.forEach(element => {\r\n      const baseX = element.x - 400 + element.width / 2;\r\n      const baseZ = -(element.y - 400 + element.height / 2);\r\n      \r\n      if (element.type === 'pillar') {\r\n        const radius = Math.min(element.width, element.height) / 2;\r\n        \r\n        // Main pillar shaft\r\n        const pillar = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(radius, radius * 1.1, 140, 32),\r\n          new THREE.MeshStandardMaterial({ color: 0x4a4a5a, roughness: 0.6, metalness: 0.4 })\r\n        );\r\n        pillar.position.set(baseX, 70, baseZ);\r\n        pillar.castShadow = true;\r\n        scene.add(pillar);\r\n        \r\n        // Classical capital (top decoration)\r\n        const capital = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(radius * 1.3, radius * 1.1, 10, 32),\r\n          new THREE.MeshStandardMaterial({ color: 0x5a5a6a, roughness: 0.5, metalness: 0.5 })\r\n        );\r\n        capital.position.set(baseX, 135, baseZ);\r\n        capital.castShadow = true;\r\n        scene.add(capital);\r\n        \r\n        // Base\r\n        const base = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(radius * 1.2, radius * 1.3, 10, 32),\r\n          new THREE.MeshStandardMaterial({ color: 0x5a5a6a, roughness: 0.5, metalness: 0.5 })\r\n        );\r\n        base.position.set(baseX, 5, baseZ);\r\n        base.castShadow = true;\r\n        scene.add(base);\r\n        \r\n      } else if (element.type === 'column') {\r\n        const column = new THREE.Mesh(\r\n          new THREE.BoxGeometry(element.width, 140, element.height),\r\n          new THREE.MeshStandardMaterial({ color: 0x3a3a4a, roughness: 0.7, metalness: 0.3 })\r\n        );\r\n        column.position.set(baseX, 70, baseZ);\r\n        column.castShadow = true;\r\n        scene.add(column);\r\n        \r\n        // Edge highlights\r\n        const edges = new THREE.LineSegments(\r\n          new THREE.EdgesGeometry(column.geometry),\r\n          new THREE.LineBasicMaterial({ color: 0x6a6a7a })\r\n        );\r\n        edges.position.copy(column.position);\r\n        scene.add(edges);\r\n        \r\n      } else { // stairs - individual steps\r\n        const stepCount = 8;\r\n        const stepHeight = 50 / stepCount;\r\n        const stepDepth = element.height / stepCount;\r\n        \r\n        for (let i = 0; i < stepCount; i++) {\r\n          const step = new THREE.Mesh(\r\n            new THREE.BoxGeometry(element.width, stepHeight, stepDepth * (stepCount - i)),\r\n            new THREE.MeshStandardMaterial({ color: 0x654321, roughness: 0.8 })\r\n          );\r\n          step.position.set(baseX, stepHeight / 2 + i * stepHeight, baseZ + i * stepDepth / 2);\r\n          step.castShadow = true;\r\n          scene.add(step);\r\n          \r\n          const edges = new THREE.LineSegments(\r\n            new THREE.EdgesGeometry(step.geometry),\r\n            new THREE.LineBasicMaterial({ color: 0x3a2410 })\r\n          );\r\n          edges.position.copy(step.position);\r\n          scene.add(edges);\r\n        }\r\n      }\r\n    });\r\n\r\n    // OBJECTS (Bar, Kitchen, Toilet) - Ultra-realistic materials\r\n    floor.objects.forEach(obj => {\r\n      const baseX = obj.x - 400 + obj.width / 2;\r\n      const baseZ = -(obj.y - 400 + obj.height / 2);\r\n      const rotation = -(obj.rotation * Math.PI / 180);\r\n      \r\n      // === MODERN HOTEL BAR (Glass Top with Wine & Liquor Tones) ===\r\n      if (obj.type === 'bar') {\r\n        const baseX = obj.x - 400 + obj.width / 2;\r\n        const baseZ = -(obj.y - 400 + obj.height / 2);\r\n        const rotation = -(obj.rotation * Math.PI / 180);\r\n        const barHeight = 50;\r\n\r\n        // === Base Cabinet (dark brushed metal) ===\r\n        const baseMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x1a1a1a,\r\n          roughness: 0.5,\r\n          metalness: 0.8,\r\n          clearcoat: 0.2,\r\n          clearcoatRoughness: 0.4,\r\n        });\r\n\r\n        const base = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, barHeight, obj.height),\r\n          baseMat\r\n        );\r\n        base.position.set(baseX, barHeight / 2, baseZ);\r\n        base.rotation.y = rotation;\r\n        base.castShadow = true;\r\n        base.receiveShadow = true;\r\n        scene.add(base);\r\n\r\n        // === Translucent Glass Countertop ===\r\n        const glassColors = [0x7f0000, 0xa45a00, 0x661a00, 0x8b0000, 0x884400]; // wine, whiskey, rum tones\r\n        const glassColor = glassColors[Math.floor(Math.random() * glassColors.length)];\r\n\r\n        const glassTopMat = new THREE.MeshPhysicalMaterial({\r\n          color: glassColor,\r\n          metalness: 0.1,\r\n          roughness: 0.05,\r\n          transmission: 0.9,           // transparency\r\n          thickness: 2.0,\r\n          ior: 1.5,\r\n          reflectivity: 0.9,\r\n          clearcoat: 1.0,\r\n          clearcoatRoughness: 0.05,\r\n        });\r\n\r\n        const glassTop = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 6, 6, obj.height + 6),\r\n          glassTopMat\r\n        );\r\n        glassTop.position.set(baseX, barHeight + 3, baseZ);\r\n        glassTop.rotation.y = rotation;\r\n        glassTop.castShadow = true;\r\n        scene.add(glassTop);\r\n\r\n        // === Under Counter LED glow ===\r\n        const ledGlowMat = new THREE.MeshStandardMaterial({\r\n          emissive: 0xff0077,  // pinkish-red glow\r\n          emissiveIntensity: 0.6,\r\n          color: 0x000000,\r\n        });\r\n        const ledStrip = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 6, 0.5, obj.height + 6),\r\n          ledGlowMat\r\n        );\r\n        ledStrip.position.set(baseX, barHeight + 1, baseZ);\r\n        ledStrip.rotation.y = rotation;\r\n        scene.add(ledStrip);\r\n\r\n        // === Edge Trim (gold or chrome depending on glass tone) ===\r\n        const trimColor = glassColor === 0x7f0000 ? 0xd4af37 : 0xb0b0b0;\r\n        const trim = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 8, 0.6, obj.height + 8),\r\n          new THREE.MeshStandardMaterial({\r\n            color: trimColor,\r\n            metalness: 1.0,\r\n            roughness: 0.2,\r\n          })\r\n        );\r\n        trim.position.set(baseX, barHeight + 6.5, baseZ);\r\n        trim.rotation.y = rotation;\r\n        scene.add(trim);\r\n\r\n        // === Bar Legs (stainless steel) ===\r\n        const legMat = new THREE.MeshStandardMaterial({\r\n          color: 0xcccccc,\r\n          metalness: 1.0,\r\n          roughness: 0.1,\r\n        });\r\n        const legGeo = new THREE.CylinderGeometry(2, 2, barHeight, 16);\r\n        const legOffsets = [\r\n          [obj.width / 2 - 6, obj.height / 2 - 6],\r\n          [-obj.width / 2 + 6, obj.height / 2 - 6],\r\n          [obj.width / 2 - 6, -obj.height / 2 + 6],\r\n          [-obj.width / 2 + 6, -obj.height / 2 + 6],\r\n        ];\r\n        legOffsets.forEach(([lx, lz]) => {\r\n          const leg = new THREE.Mesh(legGeo, legMat);\r\n          leg.position.set(\r\n            baseX + lx * Math.cos(rotation) - lz * Math.sin(rotation),\r\n            barHeight / 2,\r\n            baseZ + lx * Math.sin(rotation) + lz * Math.cos(rotation)\r\n          );\r\n          leg.castShadow = true;\r\n          scene.add(leg);\r\n        });\r\n\r\n        // === Optional: Light reflection simulation (point light above the bar) ===\r\n        const barLight = new THREE.PointLight(glassColor, 0.4, 600);\r\n        barLight.position.set(baseX, barHeight + 70, baseZ); // Adjusted for lower canopy\r\n        scene.add(barLight);\r\n\r\n        // === PREMIUM MODERN BAR CANOPY ===\r\n        const canopyHeight = 120; // Lowered from 160 to 120\r\n        const canopyOuter = new THREE.Group();\r\n\r\n        // === Outer frame (brushed dark metal) ===\r\n        const outerMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x202020,\r\n          metalness: 1.0,\r\n          roughness: 0.25,\r\n          clearcoat: 0.6,\r\n          clearcoatRoughness: 0.1,\r\n        });\r\n\r\n        const outerShell = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width + 40, 10, obj.height + 40),\r\n          outerMat\r\n        );\r\n        outerShell.castShadow = true;\r\n        outerShell.receiveShadow = true;\r\n        canopyOuter.add(outerShell);\r\n\r\n        // === Inner glass ceiling panel (liquor-tinted glass) ===\r\n        const innerGlassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xa45a00, // whiskey amber\r\n          metalness: 0,\r\n          roughness: 0.05,\r\n          transmission: 0.95,\r\n          thickness: 1.5,\r\n          ior: 1.45,\r\n          clearcoat: 1.0,\r\n          clearcoatRoughness: 0.05,\r\n        });\r\n        const innerGlass = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width + 32, obj.height + 32),\r\n          innerGlassMat\r\n        );\r\n        innerGlass.rotation.x = -Math.PI / 2;\r\n        innerGlass.position.y = -3;\r\n        canopyOuter.add(innerGlass);\r\n\r\n        // === Embedded LED strips around the rim ===\r\n        const ledMat = new THREE.MeshStandardMaterial({\r\n          emissive: 0xffcc88,\r\n          emissiveIntensity: 1.6,\r\n          color: 0x000000,\r\n        });\r\n        const ledGeom = new THREE.BoxGeometry(4, 2, obj.height + 36);\r\n        const ledLeft = new THREE.Mesh(ledGeom, ledMat);\r\n        const ledRight = ledLeft.clone();\r\n        ledLeft.position.set(-(obj.width + 36) / 2, -2, 0);\r\n        ledRight.position.set((obj.width + 36) / 2, -2, 0);\r\n        canopyOuter.add(ledLeft, ledRight);\r\n\r\n        // === Hanging wine bottle rack ===\r\n        const bottleRack = new THREE.Group();\r\n        const bottleColors = [0xb22222, 0xe3a857, 0x8b4513, 0x006994, 0x772f1a];\r\n        for (let i = -3; i <= 3; i++) {\r\n          const color = bottleColors[Math.floor(Math.random() * bottleColors.length)];\r\n          const bottleMat = new THREE.MeshPhysicalMaterial({\r\n            color,\r\n            roughness: 0.1,\r\n            transmission: 0.95,\r\n            thickness: 0.6,\r\n            ior: 1.5,\r\n            clearcoat: 0.3,\r\n            clearcoatRoughness: 0.2,\r\n          });\r\n\r\n          const bottle = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(3, 3, 20, 32),\r\n            bottleMat\r\n          );\r\n          bottle.position.set(i * 12, -12, 0);\r\n          bottleRack.add(bottle);\r\n\r\n          // neck\r\n          const neck = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(1.2, 1.2, 6, 16),\r\n            bottleMat\r\n          );\r\n          neck.position.set(i * 12, -3, 0);\r\n          bottleRack.add(neck);\r\n        }\r\n        bottleRack.position.y = -15;\r\n        canopyOuter.add(bottleRack);\r\n\r\n        // === Hanging glass rack ===\r\n        const glassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xffffff,\r\n          roughness: 0.1,\r\n          transmission: 0.9,\r\n          thickness: 0.4,\r\n          ior: 1.45,\r\n        });\r\n        for (let i = -2; i <= 2; i++) {\r\n          const glass = new THREE.Mesh(\r\n            new THREE.SphereGeometry(2.5, 16, 16, 0, Math.PI), // half-sphere\r\n            glassMat\r\n          );\r\n          glass.position.set(i * 10, -25, 0);\r\n          glass.scale.y = 0.6;\r\n          canopyOuter.add(glass);\r\n        }\r\n\r\n        // === Support rods (chrome metal) ===\r\n        const rodMat = new THREE.MeshStandardMaterial({\r\n          color: 0xaaaaaa,\r\n          metalness: 1.0,\r\n          roughness: 0.2,\r\n        });\r\n        const rodGeo = new THREE.CylinderGeometry(1.5, 1.5, canopyHeight - 60, 16);\r\n        [\r\n          [obj.width / 2 - 10, obj.height / 2 - 10],\r\n          [-obj.width / 2 + 10, obj.height / 2 - 10],\r\n          [obj.width / 2 - 10, -obj.height / 2 + 10],\r\n          [-obj.width / 2 + 10, -obj.height / 2 + 10],\r\n        ].forEach(([lx, lz]) => {\r\n          const rod = new THREE.Mesh(rodGeo, rodMat);\r\n          rod.position.set(lx, -(canopyHeight - 80) / 2, lz);\r\n          rod.rotation.x = Math.PI / 2;\r\n          canopyOuter.add(rod);\r\n        });\r\n\r\n        // === Final canopy transform & light ===\r\n        canopyOuter.position.set(baseX, canopyHeight, baseZ);\r\n        canopyOuter.rotation.y = rotation;\r\n        scene.add(canopyOuter);\r\n\r\n        // Add soft ambient light matching liquor tone\r\n        const warmLight = new THREE.PointLight(0xffaa55, 0.8, 600);\r\n        warmLight.position.set(baseX, canopyHeight - 20, baseZ);\r\n        scene.add(warmLight);\r\n        \r\n      } else if (obj.type === 'kitchen') {\r\n        // === PROFESSIONAL COMMERCIAL KITCHEN ===\r\n        const kitchenGroup = new THREE.Group();\r\n        \r\n        // === MATERIALS ===\r\n        const steelMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xb0b0b0,\r\n          metalness: 1.0,\r\n          roughness: 0.25,\r\n          envMapIntensity: 1.0,\r\n          clearcoat: 1.0,\r\n          clearcoatRoughness: 0.05,\r\n        });\r\n\r\n        const glassMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0x99ccff,\r\n          roughness: 0.05,\r\n          transmission: 0.9,\r\n          thickness: 0.5,\r\n          metalness: 0.1,\r\n          envMapIntensity: 1.2,\r\n        });\r\n\r\n        // === COUNTERTOP (stainless steel base) ===\r\n        const counter = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, 50, obj.height),\r\n          steelMat\r\n        );\r\n        counter.position.set(0, 25, 0);\r\n        counter.castShadow = true;\r\n        counter.receiveShadow = true;\r\n        kitchenGroup.add(counter);\r\n\r\n        // === GLASS COVER on countertop ===\r\n        const glassTop = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, 4, obj.height),\r\n          glassMat\r\n        );\r\n        glassTop.position.set(0, 52, 0);\r\n        kitchenGroup.add(glassTop);\r\n\r\n        // === STOVE AREA (dark cooking surface) ===\r\n        const stove = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.4, 10, obj.height * 0.6),\r\n          new THREE.MeshStandardMaterial({ color: 0x222222, roughness: 0.4 })\r\n        );\r\n        stove.position.set(-obj.width * 0.2, 55, 0);\r\n        kitchenGroup.add(stove);\r\n\r\n        // === STOVE BURNERS (4 metal burners) ===\r\n        const burnerMat = new THREE.MeshStandardMaterial({ \r\n          color: 0x333333, \r\n          metalness: 0.8, \r\n          roughness: 0.2 \r\n        });\r\n        const burnerPositions = [\r\n          [-obj.width * 0.25, obj.height * 0.15],\r\n          [-obj.width * 0.15, obj.height * 0.15],\r\n          [-obj.width * 0.25, -obj.height * 0.15],\r\n          [-obj.width * 0.15, -obj.height * 0.15],\r\n        ];\r\n        burnerPositions.forEach(([bx, bz]) => {\r\n          const burner = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(6, 6, 2, 32), \r\n            burnerMat\r\n          );\r\n          burner.rotation.x = Math.PI / 2;\r\n          burner.position.set(bx, 61, bz);\r\n          kitchenGroup.add(burner);\r\n        });\r\n\r\n        // === RANGE HOOD (exhaust fan above stove) ===\r\n        const hood = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.5, 35, obj.height * 0.65),\r\n          new THREE.MeshPhysicalMaterial({\r\n            color: 0xc0c0c0,\r\n            metalness: 1.0,\r\n            roughness: 0.2,\r\n            envMapIntensity: 1.1,\r\n          })\r\n        );\r\n        hood.position.set(-obj.width * 0.2, 95, 0);\r\n        hood.castShadow = true;\r\n        kitchenGroup.add(hood);\r\n\r\n        // === SHELVES (3 wall-mounted shelves) ===\r\n        const shelfMat = new THREE.MeshPhysicalMaterial({\r\n          color: 0xdddddd,\r\n          roughness: 0.3,\r\n          metalness: 0.5,\r\n        });\r\n        for (let i = 0; i < 3; i++) {\r\n          const shelf = new THREE.Mesh(\r\n            new THREE.BoxGeometry(obj.width * 0.7, 4, obj.height * 0.2),\r\n            shelfMat\r\n          );\r\n          shelf.position.set(obj.width * 0.15, 75 + i * 22, obj.height * 0.35);\r\n          shelf.castShadow = true;\r\n          kitchenGroup.add(shelf);\r\n        }\r\n\r\n        // === CABINET HANDLES ===\r\n        const handleMat = new THREE.MeshStandardMaterial({ \r\n          color: 0x888888, \r\n          metalness: 0.9, \r\n          roughness: 0.2 \r\n        });\r\n        for (let i = -1; i <= 1; i++) {\r\n          const handle = new THREE.Mesh(\r\n            new THREE.CylinderGeometry(1.5, 1.5, 15, 16), \r\n            handleMat\r\n          );\r\n          handle.rotation.z = Math.PI / 2;\r\n          handle.position.set(i * obj.width * 0.2, 35, obj.height * 0.45);\r\n          kitchenGroup.add(handle);\r\n        }\r\n\r\n        // === OVERHEAD LIGHTS ===\r\n        const kitchenLight = new THREE.PointLight(0xffffff, 1.5, 400);\r\n        kitchenLight.position.set(0, 140, 0);\r\n        kitchenLight.castShadow = true;\r\n        kitchenGroup.add(kitchenLight);\r\n\r\n        // === CHEF SIGN on Left Side (BOLD & CLEAR Design) ===\r\n        const chefCanvas = document.createElement('canvas');\r\n        chefCanvas.width = 1024;\r\n        chefCanvas.height = 768;\r\n        const chefCtx = chefCanvas.getContext('2d');\r\n        if (chefCtx) {\r\n          // Bold red background\r\n          chefCtx.fillStyle = '#dc2626';\r\n          chefCtx.fillRect(0, 0, chefCanvas.width, chefCanvas.height);\r\n          \r\n          // Thick white border\r\n          chefCtx.strokeStyle = '#ffffff';\r\n          chefCtx.lineWidth = 25;\r\n          chefCtx.strokeRect(30, 30, chefCanvas.width - 60, chefCanvas.height - 60);\r\n          \r\n          // Inner black border for contrast\r\n          chefCtx.strokeStyle = '#000000';\r\n          chefCtx.lineWidth = 15;\r\n          chefCtx.strokeRect(50, 50, chefCanvas.width - 100, chefCanvas.height - 100);\r\n          \r\n          // Strong text shadow\r\n          chefCtx.shadowColor = 'rgba(0, 0, 0, 0.8)';\r\n          chefCtx.shadowBlur = 20;\r\n          chefCtx.shadowOffsetX = 8;\r\n          chefCtx.shadowOffsetY = 8;\r\n          \r\n          // Large chef hat emoji on top\r\n          chefCtx.font = 'bold 180px Arial';\r\n          chefCtx.textAlign = 'center';\r\n          chefCtx.textBaseline = 'middle';\r\n          chefCtx.fillStyle = '#ffffff';\r\n          chefCtx.fillText('ðŸ‘¨â€ðŸ³', chefCanvas.width / 2, chefCanvas.height / 2 - 150);\r\n          \r\n          // CHEF text - VERY LARGE and WHITE\r\n          chefCtx.fillStyle = '#ffffff';\r\n          chefCtx.font = 'bold 220px Impact, Arial Black, sans-serif';\r\n          chefCtx.fillText('CHEF', chefCanvas.width / 2, chefCanvas.height / 2 + 120);\r\n          \r\n          // Black outline for maximum contrast\r\n          chefCtx.strokeStyle = '#000000';\r\n          chefCtx.lineWidth = 12;\r\n          chefCtx.strokeText('CHEF', chefCanvas.width / 2, chefCanvas.height / 2 + 120);\r\n          \r\n          // Yellow/Gold inner stroke for style\r\n          chefCtx.strokeStyle = '#fbbf24';\r\n          chefCtx.lineWidth = 6;\r\n          chefCtx.strokeText('CHEF', chefCanvas.width / 2, chefCanvas.height / 2 + 120);\r\n        }\r\n        const chefTexture = new THREE.CanvasTexture(chefCanvas);\r\n        \r\n        // Left side sign - MUCH LARGER\r\n        const chefSignLeft = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.height * 0.6, obj.height * 0.45),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: chefTexture,\r\n            roughness: 0.4,\r\n            metalness: 0.1,\r\n            emissive: 0xdc2626,\r\n            emissiveIntensity: 0.3\r\n          })\r\n        );\r\n        chefSignLeft.position.set(-obj.width / 2 + 3, 50, 0);\r\n        chefSignLeft.rotation.y = Math.PI / 2;\r\n        kitchenGroup.add(chefSignLeft);\r\n        \r\n        // Right side sign (same design) - MUCH LARGER\r\n        const chefSignRight = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.height * 0.6, obj.height * 0.45),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: chefTexture,\r\n            roughness: 0.4,\r\n            metalness: 0.1,\r\n            emissive: 0xdc2626,\r\n            emissiveIntensity: 0.3\r\n          })\r\n        );\r\n        chefSignRight.position.set(obj.width / 2 - 3, 50, 0);\r\n        chefSignRight.rotation.y = -Math.PI / 2;\r\n        kitchenGroup.add(chefSignRight);\r\n\r\n        // === Position the entire kitchen ===\r\n        kitchenGroup.position.set(baseX, 0, baseZ);\r\n        kitchenGroup.rotation.y = rotation;\r\n        scene.add(kitchenGroup);\r\n        \r\n      } else if (obj.type === 'toilet') {\r\n        const toiletGroup = new THREE.Group();\r\n\r\n        // === MATERIALS (no excessive reflections) ===\r\n        const marbleMat = new THREE.MeshStandardMaterial({\r\n          color: 0xd5d5da,\r\n          roughness: 0.7,\r\n          metalness: 0.05,\r\n        });\r\n\r\n        const doorMat = new THREE.MeshStandardMaterial({\r\n          color: 0x3b82f6,\r\n          roughness: 0.6,\r\n          metalness: 0.1,\r\n        });\r\n\r\n        const door2Mat = new THREE.MeshStandardMaterial({\r\n          color: 0xef4444,\r\n          roughness: 0.6,\r\n          metalness: 0.1,\r\n        });\r\n\r\n        const tileFloorMat = new THREE.MeshStandardMaterial({\r\n          color: 0xd9d9d9,\r\n          roughness: 0.7,\r\n          metalness: 0.05,\r\n        });\r\n\r\n        const roomHeight = 120;\r\n\r\n        // === FLOOR ===\r\n        const floor = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, 4, obj.height), \r\n          tileFloorMat\r\n        );\r\n        floor.position.y = 2;\r\n        floor.receiveShadow = true;\r\n        toiletGroup.add(floor);\r\n\r\n        // === BACK WALL ===\r\n        const backWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        backWall.position.set(0, roomHeight / 2, -obj.height / 2);\r\n        backWall.castShadow = true;\r\n        toiletGroup.add(backWall);\r\n\r\n        // === SIDE WALLS ===\r\n        const leftWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(6, roomHeight, obj.height), \r\n          marbleMat\r\n        );\r\n        leftWall.position.set(-obj.width / 2, roomHeight / 2, 0);\r\n        leftWall.castShadow = true;\r\n        toiletGroup.add(leftWall);\r\n\r\n        const rightWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(6, roomHeight, obj.height), \r\n          marbleMat\r\n        );\r\n        rightWall.position.set(obj.width / 2, roomHeight / 2, 0);\r\n        rightWall.castShadow = true;\r\n        toiletGroup.add(rightWall);\r\n\r\n        // === FRONT WALL STRUCTURE ===\r\n        // Center divider\r\n        const centerDivider = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.24, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        centerDivider.position.set(0, roomHeight / 2, obj.height / 2);\r\n        centerDivider.castShadow = true;\r\n        toiletGroup.add(centerDivider);\r\n\r\n        // Left side section\r\n        const leftSection = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.055, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        leftSection.position.set(-obj.width * 0.4725, roomHeight / 2, obj.height / 2);\r\n        leftSection.castShadow = true;\r\n        toiletGroup.add(leftSection);\r\n\r\n        // Right side section\r\n        const rightSection = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.055, roomHeight, 6), \r\n          marbleMat\r\n        );\r\n        rightSection.position.set(obj.width * 0.4725, roomHeight / 2, obj.height / 2);\r\n        rightSection.castShadow = true;\r\n        toiletGroup.add(rightSection);\r\n\r\n        // Wall above right door (blue) - LARGER DOOR = 95 height, 33% width\r\n        const rightTopWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, roomHeight - 95, 6), \r\n          marbleMat\r\n        );\r\n        rightTopWall.position.set(obj.width * 0.285, 95 + (roomHeight - 95) / 2, obj.height / 2);\r\n        rightTopWall.castShadow = true;\r\n        toiletGroup.add(rightTopWall);\r\n\r\n        // Wall above left door (red)\r\n        const leftTopWall = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, roomHeight - 95, 6), \r\n          marbleMat\r\n        );\r\n        leftTopWall.position.set(-obj.width * 0.285, 95 + (roomHeight - 95) / 2, obj.height / 2);\r\n        leftTopWall.castShadow = true;\r\n        toiletGroup.add(leftTopWall);\r\n\r\n        // === DOORS (LARGER - 33% width, 95 height) ===\r\n        // Right door (Blue)\r\n        const door = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, 95, 4), \r\n          doorMat\r\n        );\r\n        door.position.set(obj.width * 0.285, 47.5, obj.height / 2 - 2);\r\n        door.castShadow = true;\r\n        toiletGroup.add(door);\r\n\r\n        const handleMat = new THREE.MeshStandardMaterial({ \r\n          color: 0xd4af37, \r\n          metalness: 0.1, \r\n          roughness: 0.8 \r\n        });\r\n        const handle = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(1.5, 1.5, 12, 16),\r\n          handleMat\r\n        );\r\n        handle.rotation.z = Math.PI / 2;\r\n        handle.position.set(obj.width * 0.285 - (obj.width * 0.132), 47.5, obj.height / 2 + 1);\r\n        toiletGroup.add(handle);\r\n\r\n        // === MALE SIGN on Blue Door (Very Stylish Design) ===\r\n        const maleCanvas = document.createElement('canvas');\r\n        maleCanvas.width = 512;\r\n        maleCanvas.height = 768;\r\n        const maleCtx = maleCanvas.getContext('2d');\r\n        if (maleCtx) {\r\n          // Gradient background\r\n          const gradient = maleCtx.createLinearGradient(0, 0, 0, maleCanvas.height);\r\n          gradient.addColorStop(0, '#3b82f6');\r\n          gradient.addColorStop(1, '#1e40af');\r\n          maleCtx.fillStyle = gradient;\r\n          maleCtx.fillRect(0, 0, maleCanvas.width, maleCanvas.height);\r\n          \r\n          // Border frame\r\n          maleCtx.strokeStyle = '#ffffff';\r\n          maleCtx.lineWidth = 12;\r\n          maleCtx.strokeRect(20, 20, maleCanvas.width - 40, maleCanvas.height - 40);\r\n          \r\n          // Inner shadow effect\r\n          maleCtx.strokeStyle = 'rgba(255, 255, 255, 0.3)';\r\n          maleCtx.lineWidth = 6;\r\n          maleCtx.strokeRect(30, 30, maleCanvas.width - 60, maleCanvas.height - 60);\r\n          \r\n          // Text shadow\r\n          maleCtx.shadowColor = 'rgba(0, 0, 0, 0.5)';\r\n          maleCtx.shadowBlur = 15;\r\n          maleCtx.shadowOffsetX = 4;\r\n          maleCtx.shadowOffsetY = 4;\r\n          \r\n          // W.C. text\r\n          maleCtx.fillStyle = '#ffffff';\r\n          maleCtx.font = 'bold 120px Georgia, serif';\r\n          maleCtx.textAlign = 'center';\r\n          maleCtx.textBaseline = 'middle';\r\n          maleCtx.fillText('W.C.', maleCanvas.width / 2, maleCanvas.height / 2 - 100);\r\n          \r\n          // Decorative line\r\n          maleCtx.strokeStyle = '#ffffff';\r\n          maleCtx.lineWidth = 4;\r\n          maleCtx.beginPath();\r\n          maleCtx.moveTo(100, maleCanvas.height / 2);\r\n          maleCtx.lineTo(maleCanvas.width - 100, maleCanvas.height / 2);\r\n          maleCtx.stroke();\r\n          \r\n          // MALE text with golden color\r\n          const goldGradient = maleCtx.createLinearGradient(0, maleCanvas.height / 2, 0, maleCanvas.height / 2 + 150);\r\n          goldGradient.addColorStop(0, '#ffd700');\r\n          goldGradient.addColorStop(0.5, '#ffed4e');\r\n          goldGradient.addColorStop(1, '#ffd700');\r\n          maleCtx.fillStyle = goldGradient;\r\n          maleCtx.font = 'bold 140px Georgia, serif';\r\n          maleCtx.fillText('MALE', maleCanvas.width / 2, maleCanvas.height / 2 + 120);\r\n          \r\n          // Add stroke to MALE text\r\n          maleCtx.strokeStyle = '#b8860b';\r\n          maleCtx.lineWidth = 3;\r\n          maleCtx.strokeText('MALE', maleCanvas.width / 2, maleCanvas.height / 2 + 120);\r\n        }\r\n        const maleTexture = new THREE.CanvasTexture(maleCanvas);\r\n        const maleSign = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width * 0.25, obj.width * 0.375),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: maleTexture,\r\n            roughness: 0.3,\r\n            metalness: 0.15,\r\n            emissive: 0x1e40af,\r\n            emissiveIntensity: 0.1\r\n          })\r\n        );\r\n        maleSign.position.set(obj.width * 0.285, 47.5, obj.height / 2 + 2.5);\r\n        toiletGroup.add(maleSign);\r\n\r\n        // Left door (Red)\r\n        const door2 = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.33, 95, 4),\r\n          door2Mat\r\n        );\r\n        door2.position.set(-obj.width * 0.285, 47.5, obj.height / 2 - 2);\r\n        door2.castShadow = true;\r\n        toiletGroup.add(door2);\r\n\r\n        const handle2 = handle.clone();\r\n        handle2.position.set(-obj.width * 0.285 + (obj.width * 0.132), 47.5, obj.height / 2 + 1);\r\n        toiletGroup.add(handle2);\r\n\r\n        // === FEMALE SIGN on Red Door (Very Stylish Design) ===\r\n        const femaleCanvas = document.createElement('canvas');\r\n        femaleCanvas.width = 512;\r\n        femaleCanvas.height = 768;\r\n        const femaleCtx = femaleCanvas.getContext('2d');\r\n        if (femaleCtx) {\r\n          // Gradient background\r\n          const gradient = femaleCtx.createLinearGradient(0, 0, 0, femaleCanvas.height);\r\n          gradient.addColorStop(0, '#ef4444');\r\n          gradient.addColorStop(1, '#b91c1c');\r\n          femaleCtx.fillStyle = gradient;\r\n          femaleCtx.fillRect(0, 0, femaleCanvas.width, femaleCanvas.height);\r\n          \r\n          // Border frame\r\n          femaleCtx.strokeStyle = '#ffffff';\r\n          femaleCtx.lineWidth = 12;\r\n          femaleCtx.strokeRect(20, 20, femaleCanvas.width - 40, femaleCanvas.height - 40);\r\n          \r\n          // Inner shadow effect\r\n          femaleCtx.strokeStyle = 'rgba(255, 255, 255, 0.3)';\r\n          femaleCtx.lineWidth = 6;\r\n          femaleCtx.strokeRect(30, 30, femaleCanvas.width - 60, femaleCanvas.height - 60);\r\n          \r\n          // Text shadow\r\n          femaleCtx.shadowColor = 'rgba(0, 0, 0, 0.5)';\r\n          femaleCtx.shadowBlur = 15;\r\n          femaleCtx.shadowOffsetX = 4;\r\n          femaleCtx.shadowOffsetY = 4;\r\n          \r\n          // W.C. text\r\n          femaleCtx.fillStyle = '#ffffff';\r\n          femaleCtx.font = 'bold 120px Georgia, serif';\r\n          femaleCtx.textAlign = 'center';\r\n          femaleCtx.textBaseline = 'middle';\r\n          femaleCtx.fillText('W.C.', femaleCanvas.width / 2, femaleCanvas.height / 2 - 100);\r\n          \r\n          // Decorative line\r\n          femaleCtx.strokeStyle = '#ffffff';\r\n          femaleCtx.lineWidth = 4;\r\n          femaleCtx.beginPath();\r\n          femaleCtx.moveTo(100, femaleCanvas.height / 2);\r\n          femaleCtx.lineTo(femaleCanvas.width - 100, femaleCanvas.height / 2);\r\n          femaleCtx.stroke();\r\n          \r\n          // FEMALE text with rose gold color\r\n          const roseGoldGradient = femaleCtx.createLinearGradient(0, femaleCanvas.height / 2, 0, femaleCanvas.height / 2 + 150);\r\n          roseGoldGradient.addColorStop(0, '#ffb6c1');\r\n          roseGoldGradient.addColorStop(0.5, '#ffd1dc');\r\n          roseGoldGradient.addColorStop(1, '#ffb6c1');\r\n          femaleCtx.fillStyle = roseGoldGradient;\r\n          femaleCtx.font = 'bold 120px Georgia, serif';\r\n          femaleCtx.fillText('FEMALE', femaleCanvas.width / 2, femaleCanvas.height / 2 + 120);\r\n          \r\n          // Add stroke to FEMALE text\r\n          femaleCtx.strokeStyle = '#dc143c';\r\n          femaleCtx.lineWidth = 3;\r\n          femaleCtx.strokeText('FEMALE', femaleCanvas.width / 2, femaleCanvas.height / 2 + 120);\r\n        }\r\n        const femaleTexture = new THREE.CanvasTexture(femaleCanvas);\r\n        const femaleSign = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width * 0.25, obj.width * 0.375),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: femaleTexture,\r\n            roughness: 0.3,\r\n            metalness: 0.15,\r\n            emissive: 0xb91c1c,\r\n            emissiveIntensity: 0.1\r\n          })\r\n        );\r\n        femaleSign.position.set(-obj.width * 0.285, 47.5, obj.height / 2 + 2.5);\r\n        toiletGroup.add(femaleSign);\r\n\r\n        // === W.C. SIGN ===\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = 512;\r\n        canvas.height = 256;\r\n        const ctx = canvas.getContext('2d');\r\n        if (ctx) {\r\n          ctx.fillStyle = '#d5d5da';\r\n          ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n          ctx.fillStyle = '#2a2a2a';\r\n          ctx.font = 'bold 140px Arial';\r\n          ctx.textAlign = 'center';\r\n          ctx.textBaseline = 'middle';\r\n          ctx.fillText('W.C.', canvas.width / 2, canvas.height / 2);\r\n        }\r\n        \r\n        const wcTexture = new THREE.CanvasTexture(canvas);\r\n        const wcSign = new THREE.Mesh(\r\n          new THREE.PlaneGeometry(obj.width * 0.4, obj.width * 0.2),\r\n          new THREE.MeshStandardMaterial({ \r\n            map: wcTexture,\r\n            roughness: 0.5,\r\n            metalness: 0.05\r\n          })\r\n        );\r\n        wcSign.position.set(0, 100, -obj.height / 2 + 3.5);\r\n        toiletGroup.add(wcSign);\r\n\r\n        // === SINK COUNTER ===\r\n        const counterMat = new THREE.MeshStandardMaterial({\r\n          color: 0xf5f5f5,\r\n          metalness: 0.1,\r\n          roughness: 0.5,\r\n        });\r\n        const counter = new THREE.Mesh(\r\n          new THREE.BoxGeometry(obj.width * 0.5, 12, obj.height * 0.25), \r\n          counterMat\r\n        );\r\n        counter.position.set(0, 32, -obj.height * 0.3);\r\n        counter.castShadow = true;\r\n        toiletGroup.add(counter);\r\n\r\n        // === SINK BASIN ===\r\n        const sinkMat = new THREE.MeshStandardMaterial({\r\n          color: 0xffffff,\r\n          roughness: 0.3,\r\n          metalness: 0.05,\r\n        });\r\n        const sink = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(12, 12, 6, 32), \r\n          sinkMat\r\n        );\r\n        sink.position.set(0, 40, -obj.height * 0.3);\r\n        toiletGroup.add(sink);\r\n\r\n        // === FAUCET ===\r\n        const faucetMat = new THREE.MeshStandardMaterial({\r\n          color: 0xc0c0c0,\r\n          metalness: 0.1,\r\n          roughness: 0.8,\r\n        });\r\n        const faucet = new THREE.Mesh(\r\n          new THREE.TorusGeometry(4, 1, 8, 24, Math.PI),\r\n          faucetMat\r\n        );\r\n        faucet.rotation.z = Math.PI / 2;\r\n        faucet.position.set(0, 48, -obj.height * 0.35);\r\n        toiletGroup.add(faucet);\r\n\r\n        // === TOILET BOWL ===\r\n        const toiletMat = new THREE.MeshStandardMaterial({\r\n          color: 0xffffff,\r\n          roughness: 0.25,\r\n          metalness: 0.05,\r\n        });\r\n\r\n        const toiletBowl = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(10, 8, 12, 32),\r\n          toiletMat\r\n        );\r\n        toiletBowl.position.set(-obj.width * 0.25, 6, obj.height * 0.25);\r\n        toiletGroup.add(toiletBowl);\r\n\r\n        const toiletSeat = new THREE.Mesh(\r\n          new THREE.TorusGeometry(9, 2, 16, 32),\r\n          toiletMat\r\n        );\r\n        toiletSeat.rotation.x = Math.PI / 2;\r\n        toiletSeat.position.set(-obj.width * 0.25, 13, obj.height * 0.25);\r\n        toiletGroup.add(toiletSeat);\r\n\r\n        const toiletTank = new THREE.Mesh(\r\n          new THREE.BoxGeometry(14, 20, 8),\r\n          toiletMat\r\n        );\r\n        toiletTank.position.set(-obj.width * 0.25, 22, obj.height * 0.25 - 10);\r\n        toiletGroup.add(toiletTank);\r\n\r\n        const flushHandle = new THREE.Mesh(\r\n          new THREE.BoxGeometry(2, 6, 1),\r\n          faucetMat\r\n        );\r\n        flushHandle.position.set(-obj.width * 0.25 + 8, 25, obj.height * 0.25 - 10);\r\n        toiletGroup.add(flushHandle);\r\n\r\n        // === URINAL ===\r\n        const urinal = new THREE.Mesh(\r\n          new THREE.SphereGeometry(7, 32, 32, 0, Math.PI * 2, 0, Math.PI / 1.5),\r\n          toiletMat\r\n        );\r\n        urinal.position.set(obj.width * 0.25, 25, obj.height * 0.25);\r\n        urinal.rotation.x = Math.PI / 6;\r\n        toiletGroup.add(urinal);\r\n\r\n        const urinalValve = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(1.5, 1.5, 8, 16),\r\n          faucetMat\r\n        );\r\n        urinalValve.position.set(obj.width * 0.25, 35, obj.height * 0.25 - 5);\r\n        toiletGroup.add(urinalValve);\r\n\r\n        // === LIGHTING (SOFT, NO GLOWING) ===\r\n        const softLight = new THREE.PointLight(0xffffff, 0.5, 280);\r\n        softLight.position.set(0, roomHeight - 15, 0);\r\n        softLight.castShadow = false;\r\n        toiletGroup.add(softLight);\r\n\r\n        // === Position the entire toilet room ===\r\n        toiletGroup.position.set(baseX, 0, baseZ);\r\n        toiletGroup.rotation.y = rotation;\r\n        scene.add(toiletGroup);\r\n      }\r\n    });\r\n\r\n    // TABLES - Realistic polished wood with subtle reflections\r\n    floor.tables.forEach(table => {\r\n      const tableTopHeight = 4; // Thin tabletop\r\n      const legHeight = 33; // Tall legs (increased from 30)\r\n      const actualWidth = table.shape === 'rectangle' ? table.width * 1.5 : table.width;\r\n      const tableX = table.x - 400 + actualWidth / 2;\r\n      const tableZ = -(table.y - 400 + table.height / 2);\r\n      const tableRotRad = -(table.rotation * Math.PI / 180);\r\n\r\n      // Advanced physical material (PBR wood)\r\n      const tableMaterial = new THREE.MeshPhysicalMaterial({\r\n        color: 0x6f4e37,             // rich brown wood tone\r\n        roughness: 0.35,\r\n        metalness: 0.1,\r\n        clearcoat: 0.4,              // shiny varnish layer\r\n        clearcoatRoughness: 0.2,\r\n        sheen: 0.5,                  // subtle velvet-like reflection\r\n        sheenColor: new THREE.Color(0x9c6b3c),\r\n      });\r\n\r\n      // THIN TABLETOP (not full height cube)\r\n      const tableGeometry =\r\n        table.shape === 'circle'\r\n          ? new THREE.CylinderGeometry(actualWidth / 2, actualWidth / 2, tableTopHeight, 64)\r\n          : new THREE.BoxGeometry(actualWidth, tableTopHeight, table.height);\r\n\r\n      const tableMesh = new THREE.Mesh(tableGeometry, tableMaterial);\r\n      tableMesh.position.set(tableX, legHeight + tableTopHeight / 2, tableZ);\r\n      tableMesh.rotation.y = tableRotRad;\r\n      tableMesh.castShadow = true;\r\n      tableMesh.receiveShadow = true;\r\n      scene.add(tableMesh);\r\n\r\n      // Subtle metallic edge trim\r\n      if (table.shape === 'circle') {\r\n        const edgeTrim = new THREE.Mesh(\r\n          new THREE.TorusGeometry(actualWidth / 2 + 1, 1.2, 16, 64),\r\n          new THREE.MeshStandardMaterial({\r\n            color: 0xd4af37,       // gold-like tone\r\n            metalness: 1.0,\r\n            roughness: 0.3,\r\n          })\r\n        );\r\n        edgeTrim.position.set(tableX, legHeight + tableTopHeight / 2 + 0.5, tableZ);\r\n        edgeTrim.rotation.x = Math.PI / 2;\r\n        scene.add(edgeTrim);\r\n      } else {\r\n        const edges = new THREE.LineSegments(\r\n          new THREE.EdgesGeometry(tableGeometry),\r\n          new THREE.LineBasicMaterial({ color: 0xd4af37, linewidth: 2 })\r\n        );\r\n        edges.position.copy(tableMesh.position);\r\n        edges.rotation.y = tableRotRad;\r\n        scene.add(edges);\r\n      }\r\n\r\n      // Table legs - realistic chrome or black metal (NOW VISIBLE!)\r\n      const legMaterial = new THREE.MeshStandardMaterial({\r\n        color: 0x222222,\r\n        metalness: 0.9,\r\n        roughness: 0.2,\r\n      });\r\n\r\n      const legRadius = 3.2; // Increased from 3 for better visibility\r\n      const legOffsets =\r\n        table.shape === 'circle'\r\n          ? [\r\n              [actualWidth * 0.3, actualWidth * 0.3],\r\n              [-actualWidth * 0.3, actualWidth * 0.3],\r\n              [actualWidth * 0.3, -actualWidth * 0.3],\r\n              [-actualWidth * 0.3, -actualWidth * 0.3],\r\n            ]\r\n          : [\r\n              [actualWidth / 2 - 10, table.height / 2 - 10],\r\n              [-actualWidth / 2 + 10, table.height / 2 - 10],\r\n              [actualWidth / 2 - 10, -table.height / 2 + 10],\r\n              [-actualWidth / 2 + 10, -table.height / 2 + 10],\r\n            ];\r\n\r\n      legOffsets.forEach(([lx, lz]) => {\r\n        const leg = new THREE.Mesh(\r\n          new THREE.CylinderGeometry(legRadius, legRadius, legHeight, 16),\r\n          legMaterial\r\n        );\r\n        leg.position.set(\r\n          tableX + lx * Math.cos(tableRotRad) - lz * Math.sin(tableRotRad),\r\n          legHeight / 2,\r\n          tableZ + lx * Math.sin(tableRotRad) + lz * Math.cos(tableRotRad)\r\n        );\r\n        leg.castShadow = true;\r\n        scene.add(leg);\r\n      });\r\n\r\n      // CHAIRS - Premium with 4 legs, cushioned seats, wood backs\r\n      const tableChairs = floor.chairs.filter(c => c.tableId === table.id);\r\n      \r\n      tableChairs.forEach(chair => {\r\n        const chairSize = chair.size || 40;\r\n        const chairHeight = 38; // Increased from 35\r\n        \r\n        // Materials\r\n        const woodMaterial = new THREE.MeshStandardMaterial({ color: 0x8b4513, roughness: 0.5, metalness: 0.1 });\r\n        const cushionMaterial = new THREE.MeshStandardMaterial({ color: 0xb8860b, roughness: 0.7, metalness: 0.05 });\r\n        \r\n        // Calculate position\r\n        const totalOnSide = tableChairs.filter(c => c.position === chair.position).length;\r\n        const sideLen = ['top', 'bottom'].includes(chair.position) ? actualWidth : table.height;\r\n        const availSpace = sideLen - chairSize * totalOnSide;\r\n        const gap = totalOnSide > 1 ? availSpace / (totalOnSide + 1) : availSpace / 2;\r\n        const offset = gap + chair.index * (chairSize + gap) + chairSize / 2;\r\n        const spacing = chairSize * 0.4;\r\n        \r\n        let relX = 0, relZ = 0;\r\n        if (chair.position === 'top') { \r\n          relX = offset - actualWidth / 2; \r\n          relZ = table.height / 2 + spacing + chairSize / 2; \r\n        } else if (chair.position === 'bottom') { \r\n          relX = offset - actualWidth / 2; \r\n          relZ = -(table.height / 2 + spacing + chairSize / 2); \r\n        } else if (chair.position === 'left') { \r\n          relX = -(actualWidth / 2 + spacing + chairSize / 2); \r\n          relZ = offset - table.height / 2; \r\n        } else { \r\n          relX = actualWidth / 2 + spacing + chairSize / 2; \r\n          relZ = offset - table.height / 2; \r\n        }\r\n        \r\n        // Apply table rotation\r\n        const rotX = relX * Math.cos(tableRotRad) - relZ * Math.sin(tableRotRad);\r\n        const rotZ = relX * Math.sin(tableRotRad) + relZ * Math.cos(tableRotRad);\r\n        \r\n        // Chair seat (cushioned)\r\n        const seat = new THREE.Mesh(\r\n          new THREE.BoxGeometry(chairSize * 0.75, 4, chairSize * 0.75),\r\n          cushionMaterial\r\n        );\r\n        const seatHeight = chairHeight * 0.4; // Seat position\r\n        seat.position.set(tableX + rotX, seatHeight, tableZ - rotZ);\r\n        \r\n        // FIXED ROTATION - chair faces table\r\n        const baseRot = { \r\n          top: 0, \r\n          bottom: Math.PI, \r\n          left: Math.PI / 2, \r\n          right: -Math.PI / 2 \r\n        }[chair.position] || 0;\r\n        seat.rotation.y = baseRot + tableRotRad;\r\n        seat.castShadow = true;\r\n        scene.add(seat);\r\n        \r\n        // Chair back (wood)\r\n        const back = new THREE.Mesh(\r\n          new THREE.BoxGeometry(chairSize * 0.75, chairHeight * 0.55, 3),\r\n          woodMaterial\r\n        );\r\n        const backOff = chairSize * 0.75 / 2 + 1.5;\r\n        back.position.set(\r\n          seat.position.x - Math.sin(seat.rotation.y) * backOff,\r\n          chairHeight * 0.65,\r\n          seat.position.z - Math.cos(seat.rotation.y) * backOff\r\n        );\r\n        back.rotation.y = seat.rotation.y;\r\n        back.castShadow = true;\r\n        scene.add(back);\r\n        \r\n        // 4 Chair legs (cylindrical, wood)\r\n        const seatThickness = 4;\r\n        const legHeight = seatHeight - seatThickness / 2; // Legs reach from floor to bottom of seat\r\n        const legGeo = new THREE.CylinderGeometry(2, 2, legHeight, 8);\r\n        const legMat = new THREE.MeshStandardMaterial({ color: 0x654321, roughness: 0.6, metalness: 0.2 });\r\n        \r\n        [[chairSize * 0.3, chairSize * 0.3], [chairSize * 0.3, -chairSize * 0.3],\r\n         [-chairSize * 0.3, chairSize * 0.3], [-chairSize * 0.3, -chairSize * 0.3]\r\n        ].forEach(([lx, lz]) => {\r\n          const leg = new THREE.Mesh(legGeo, legMat);\r\n          const cos = Math.cos(seat.rotation.y);\r\n          const sin = Math.sin(seat.rotation.y);\r\n          leg.position.set(\r\n            seat.position.x + lx * cos - lz * sin,\r\n            legHeight / 2, // Position legs so they sit on the floor\r\n            seat.position.z + lx * sin + lz * cos\r\n          );\r\n          leg.castShadow = true;\r\n          scene.add(leg);\r\n        });\r\n      });\r\n    });\r\n\r\n    // Animation\r\n    const animate = () => {\r\n      animationFrameRef.current = requestAnimationFrame(animate);\r\n      \r\n      // Handle smooth camera transitions\r\n      if (transitionRef.current && transitionRef.current.progress < 1) {\r\n        const t = transitionRef.current;\r\n        t.progress += 0.05;\r\n        \r\n        if (t.progress >= 1) {\r\n          t.progress = 1;\r\n          setIsTransitioning(false);\r\n          transitionRef.current = null;\r\n        }\r\n        \r\n        // Smooth easing function\r\n        const easeInOutCubic = (x: number): number => {\r\n          return x < 0.5 ? 4 * x * x * x : 1 - Math.pow(-2 * x + 2, 3) / 2;\r\n        };\r\n        \r\n        const easedProgress = easeInOutCubic(t.progress);\r\n        \r\n        if (cameraRef.current) {\r\n          cameraRef.current.position.lerpVectors(t.startPos, t.endPos, easedProgress);\r\n          const currentTarget = new THREE.Vector3();\r\n          currentTarget.lerpVectors(t.startTarget, t.endTarget, easedProgress);\r\n          cameraRef.current.lookAt(currentTarget);\r\n        }\r\n      }\r\n      \r\n      // Auto-rotation (only when enabled and not transitioning)\r\n      if (autoRotate && cameraRef.current && !isTransitioning) {\r\n        const r = Math.sqrt(cameraRef.current.position.x ** 2 + cameraRef.current.position.z ** 2);\r\n        const a = Math.atan2(cameraRef.current.position.z, cameraRef.current.position.x) + rotationSpeedRef.current;\r\n        cameraRef.current.position.x = r * Math.cos(a);\r\n        cameraRef.current.position.z = r * Math.sin(a);\r\n        cameraRef.current.lookAt(0, 100, 0);\r\n      }\r\n      \r\n      rendererRef.current?.render(scene, camera);\r\n    };\r\n    animate();\r\n\r\n    const handleResize = () => {\r\n      if (containerRef.current && cameraRef.current && rendererRef.current) {\r\n        cameraRef.current.aspect = containerRef.current.clientWidth / containerRef.current.clientHeight;\r\n        cameraRef.current.updateProjectionMatrix();\r\n        rendererRef.current.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\r\n      }\r\n    };\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n      if (animationFrameRef.current) cancelAnimationFrame(animationFrameRef.current);\r\n      if (rendererRef.current && containerRef.current) {\r\n        containerRef.current.removeChild(rendererRef.current.domElement);\r\n        rendererRef.current.dispose();\r\n      }\r\n    };\r\n  }, [isOpen, floor, autoRotate, isTransitioning]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-2\">\r\n      <div className=\"bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 rounded-3xl shadow-2xl w-full h-full max-w-[98vw] max-h-[98vh] flex flex-col overflow-hidden border border-gray-800\">\r\n        {/* Header */}\r\n        <div className=\"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 p-1\">\r\n          <div className=\"bg-gray-900 px-6 py-4 flex items-center justify-between\">\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold text-white flex items-center gap-3\">\r\n                <div className=\"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg\">\r\n                  <Move3d className=\"w-5 h-5\" />\r\n                </div>\r\n                3D Floor Plan Visualization\r\n              </h2>\r\n              <p className=\"text-gray-400 text-sm mt-1\">Professional Camera Controls â€¢ {floor.name}</p>\r\n            </div>\r\n            <button \r\n              onClick={onClose} \r\n              className=\"p-2.5 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-xl transition-all hover:scale-110\"\r\n            >\r\n              <X className=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content Area with Sidebar */}\r\n        <div className=\"flex-1 flex gap-3 p-3 min-h-0\">\r\n          {/* Smart Sidebar - Left */}\r\n          <div className=\"w-80 bg-black/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-700 p-5 flex flex-col gap-5 overflow-y-auto flex-shrink-0\">\r\n            {/* Default View Button */}\r\n            <button\r\n              onClick={() => smoothCameraTransition('default')}\r\n              className=\"px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl font-semibold transition-all hover:scale-105 hover:shadow-lg flex items-center justify-center gap-2\"\r\n            >\r\n              ðŸ  Default View\r\n            </button>\r\n\r\n            {/* Manual Controls Section */}\r\n            <div className=\"flex flex-col gap-3\">\r\n              <div className=\"text-white text-sm font-bold uppercase tracking-wider flex items-center gap-2 pb-2 border-b border-gray-700\">\r\n                <Move3d className=\"w-5 h-5 text-purple-400\" />\r\n                Manual Control\r\n              </div>\r\n              \r\n              {/* Directional Controls */}\r\n              <div className=\"flex justify-center\">\r\n                <div className=\"flex flex-col gap-1\">\r\n                  <button\r\n                    onClick={() => rotateCamera('up')}\r\n                    className=\"w-12 h-12 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all hover:scale-110 flex items-center justify-center disabled:opacity-30 mx-auto\"\r\n                    disabled={isTransitioning}\r\n                    title=\"Rotate Up\"\r\n                  >\r\n                    <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 15l7-7 7 7\" />\r\n                    </svg>\r\n                  </button>\r\n                  <div className=\"flex gap-1 justify-center\">\r\n                    <button\r\n                      onClick={() => rotateCamera('left')}\r\n                      className=\"w-12 h-12 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all hover:scale-110 flex items-center justify-center disabled:opacity-30\"\r\n                      disabled={isTransitioning}\r\n                      title=\"Rotate Left\"\r\n                    >\r\n                      <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n                      </svg>\r\n                    </button>\r\n                    <div className=\"w-12 h-12 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center\">\r\n                      <Move3d className=\"w-6 h-6 text-white\" />\r\n                    </div>\r\n                    <button\r\n                      onClick={() => rotateCamera('right')}\r\n                      className=\"w-12 h-12 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all hover:scale-110 flex items-center justify-center disabled:opacity-30\"\r\n                      disabled={isTransitioning}\r\n                      title=\"Rotate Right\"\r\n                    >\r\n                      <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => rotateCamera('down')}\r\n                    className=\"w-12 h-12 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all hover:scale-110 flex items-center justify-center disabled:opacity-30 mx-auto\"\r\n                    disabled={isTransitioning}\r\n                    title=\"Rotate Down\"\r\n                  >\r\n                    <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Zoom Controls Section */}\r\n            <div className=\"flex flex-col gap-3\">\r\n              <div className=\"text-white text-sm font-bold uppercase tracking-wider flex items-center gap-2 pb-2 border-b border-gray-700\">\r\n                <ZoomIn className=\"w-5 h-5 text-green-400\" />\r\n                Zoom & Rotation\r\n              </div>\r\n              \r\n              <div className=\"flex flex-col gap-2\">\r\n                <button\r\n                  onClick={() => zoomCamera(0.85)}\r\n                  className=\"px-4 py-3 bg-gray-800 hover:bg-gray-700 text-white rounded-xl transition-all hover:scale-105 flex items-center justify-center gap-2 font-semibold disabled:opacity-30\"\r\n                  disabled={isTransitioning}\r\n                >\r\n                  <ZoomIn className=\"w-5 h-5\" />\r\n                  Zoom In\r\n                </button>\r\n                <button\r\n                  onClick={() => zoomCamera(1.15)}\r\n                  className=\"px-4 py-3 bg-gray-800 hover:bg-gray-700 text-white rounded-xl transition-all hover:scale-105 flex items-center justify-center gap-2 font-semibold disabled:opacity-30\"\r\n                  disabled={isTransitioning}\r\n                >\r\n                  <ZoomOut className=\"w-5 h-5\" />\r\n                  Zoom Out\r\n                </button>\r\n                <button\r\n                  onClick={() => setAutoRotate(!autoRotate)}\r\n                  className={`px-4 py-3 rounded-xl transition-all hover:scale-105 flex items-center justify-center gap-2 font-semibold ${\r\n                    autoRotate \r\n                      ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg' \r\n                      : 'bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white'\r\n                  }`}\r\n                >\r\n                  <RotateCcw className={`w-5 h-5 ${autoRotate ? 'animate-spin' : ''}`} />\r\n                  {autoRotate ? 'Auto-Rotating' : 'Auto-Rotate'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Reset & Stats Section */}\r\n            <div className=\"flex flex-col gap-3 mt-auto\">\r\n              <button\r\n                onClick={() => smoothCameraTransition('default')}\r\n                className=\"px-4 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-xl transition-all hover:scale-105 hover:shadow-lg flex items-center justify-center gap-2 font-bold\"\r\n              >\r\n                <Maximize2 className=\"w-5 h-5\" />\r\n                Reset View\r\n              </button>\r\n\r\n              {/* Scene Stats */}\r\n              <div className=\"bg-gray-800/50 rounded-xl p-4 border border-gray-700\">\r\n                <div className=\"flex items-center gap-2 text-gray-400 mb-3\">\r\n                  <Grid className=\"w-4 h-4\" />\r\n                  <span className=\"font-medium text-sm\">Scene Statistics</span>\r\n                </div>\r\n                <div className=\"grid grid-cols-2 gap-2 text-sm\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-2 h-2 bg-emerald-500 rounded-full animate-pulse\" />\r\n                    <span className=\"text-gray-300\">{floor.tables.length} Tables</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-2 h-2 bg-amber-500 rounded-full animate-pulse\" />\r\n                    <span className=\"text-gray-300\">{floor.chairs.length} Chairs</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-2 h-2 bg-purple-500 rounded-full animate-pulse\" />\r\n                    <span className=\"text-gray-300\">{floor.objects.length} Objects</span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\" />\r\n                    <span className=\"text-gray-300\">{floor.walls.length} Walls</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* 3D Viewport - Right */}\r\n          <div className=\"flex-1 relative bg-gradient-to-br from-gray-100 via-gray-50 to-gray-100 rounded-2xl overflow-hidden shadow-2xl border border-gray-300\">\r\n            <div ref={containerRef} className=\"w-full h-full\" />\r\n\r\n            {/* Transition Indicator */}\r\n            {isTransitioning && (\r\n              <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2\">\r\n                <div className=\"bg-black/80 backdrop-blur-xl rounded-xl px-6 py-3 shadow-2xl border border-gray-700\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-2 border-gray-500 border-t-white\" />\r\n                    <span className=\"text-white text-sm font-medium\">Transitioning Camera...</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Bottom Status Bar */}\r\n        <div className=\"bg-gradient-to-r from-gray-900 via-slate-900 to-gray-900 px-6 py-3 border-t border-gray-800\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Layers className=\"w-4 h-4 text-gray-400\" />\r\n                <span className=\"text-sm text-gray-400\">\r\n                  Viewing: <span className=\"text-white font-semibold\">{floor.name}</span>\r\n                </span>\r\n              </div>\r\n              <div className=\"text-sm text-gray-400\">\r\n                Camera: <span className=\"text-white font-semibold\">{CAMERA_VIEWS[currentView].name}</span>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-2 text-xs text-gray-500\">\r\n              <span>High Performance Mode</span>\r\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","import React, { useState, useRef, useCallback, useEffect } from 'react';\r\n\r\nimport { ChairComponent } from './floorPlanner/components/Chair';\r\nimport { TableComponent } from './floorPlanner/components/Table';\r\nimport { FloorObjectComponent } from './floorPlanner/components/FloorObject';\r\nimport { WallComponent } from './floorPlanner/components/Wall';\r\nimport { FixedElementComponent } from './floorPlanner/components/FixedElement';\r\nimport { Sidebar } from './floorPlanner/components/Sidebar';\r\nimport { Toolbar } from './floorPlanner/components/Toolbar';\r\nimport { Preview3DModal } from './floorPlanner/components/Preview3DModal';\r\nimport {\r\n  hexagonStyle,\r\n  GRID_SIZE,\r\n  OBJECT_LABELS\r\n} from './floorPlanner/constants';\r\nimport { generateId, resolveTableDimensions, snapToAxis } from './floorPlanner/utils';\r\nimport type {\r\n  Chair,\r\n  ChairPosition,\r\n  FixedElement,\r\n  FixedElementType,\r\n  Floor,\r\n  FloorObject,\r\n  ObjectType,\r\n  SelectedElement,\r\n  Table,\r\n  TableSize,\r\n  Wall,\r\n  WallType\r\n} from './floorPlanner/types';\r\n\r\nconst RestaurantFloorPlanner: React.FC = () => {\r\n  const [floors, setFloors] = useState<Floor[]>([\r\n    { \r\n      id: 'floor-1', \r\n      name: 'Ground Floor', \r\n      isActive: true, \r\n      tables: [], \r\n      chairs: [], \r\n      objects: [],\r\n      walls: [],\r\n      fixedElements: []\r\n    }\r\n  ]);\r\n  const [currentFloor, setCurrentFloor] = useState<string>('floor-1');\r\n  const [selectedElement, setSelectedElement] = useState<SelectedElement | null>(null);\r\n  const [isDragging, setIsDragging] = useState<boolean>(false);\r\n  const [dragOffset, setDragOffset] = useState<{ x: number; y: number }>({ x: 0, y: 0 });\r\n  const zoom = 1; // Fixed zoom level\r\n  const [showGrid, setShowGrid] = useState<boolean>(true);\r\n  const [show3DPreview, setShow3DPreview] = useState<boolean>(false);\r\n  \r\n  // Wall drawing state\r\n  const [isDrawingWall, setIsDrawingWall] = useState<boolean>(false);\r\n  const [wallType, setWallType] = useState<WallType | null>(null);\r\n  const [wallStartPoint, setWallStartPoint] = useState<{ x: number; y: number } | null>(null);\r\n  const [tempWallEndPoint, setTempWallEndPoint] = useState<{ x: number; y: number } | null>(null);\r\n  \r\n  // Wall resizing state\r\n  const [isResizingWall, setIsResizingWall] = useState<boolean>(false);\r\n  const [resizingWallHandle, setResizingWallHandle] = useState<'start' | 'end' | null>(null);\r\n  const [wallResizePreview, setWallResizePreview] = useState<{\r\n    startX: number;\r\n    startY: number;\r\n    endX: number;\r\n    endY: number;\r\n  } | null>(null);\r\n  \r\n  const canvasRef = useRef<HTMLDivElement>(null);\r\n  const dragElementRef = useRef<{ id: string; type: string } | null>(null);\r\n  const rafRef = useRef<number | null>(null);\r\n\r\n  // Initialize chair sizes for existing chairs without explicit size\r\n  useEffect(() => {\r\n    if (selectedElement?.type === 'table') {\r\n      const floor = getCurrentFloor();\r\n      if (!floor) return;\r\n\r\n      const tableChairs = floor.chairs.filter(c => c.tableId === selectedElement.id);\r\n      const chairsWithoutSize = tableChairs.filter(c => c.size === undefined);\r\n      \r\n      if (chairsWithoutSize.length > 0) {\r\n        // Group by position to ensure chairs on same side get same size\r\n        const sizeByPosition: Record<ChairPosition, number> = {} as Record<ChairPosition, number>;\r\n        \r\n        tableChairs.forEach(chair => {\r\n          if (chair.size !== undefined && !sizeByPosition[chair.position]) {\r\n            sizeByPosition[chair.position] = chair.size;\r\n          }\r\n        });\r\n\r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                chairs: floor.chairs.map(chair => {\r\n                  if (chair.tableId === selectedElement.id && chair.size === undefined) {\r\n                    // Use existing size from same position, or default to 40px\r\n                    const defaultSize = sizeByPosition[chair.position] ?? 40;\r\n                    return { ...chair, size: defaultSize };\r\n                  }\r\n                  return chair;\r\n                })\r\n              }\r\n            : floor\r\n        ));\r\n      }\r\n    }\r\n  }, [selectedElement]); // Only run when selection changes\r\n\r\n  const getCurrentFloor = (): Floor | undefined => floors.find(floor => floor.id === currentFloor);\r\n\r\n  const addTable = (shape: Table['shape'], size: TableSize = 'medium') => {\r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n\r\n    const { width, height } = resolveTableDimensions(shape, size);\r\n    const newTable: Table = {\r\n      id: generateId(),\r\n      name: `Table ${floor.tables.length + 1}`,\r\n      shape,\r\n      size,\r\n      x: 200 + floor.tables.length * 20,\r\n      y: 200 + floor.tables.length * 20,\r\n      width,\r\n      height,\r\n      rotation: 0\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, tables: [...floor.tables, newTable] }\r\n        : floor\r\n    ));\r\n    setSelectedElement({ type: 'table', id: newTable.id });\r\n  };\r\n\r\n  const addObject = (type: ObjectType) => {\r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n\r\n    const newObject: FloorObject = {\r\n      id: generateId(),\r\n      name: `${OBJECT_LABELS[type]} ${floor.objects.length + 1}`,\r\n      type,\r\n      x: 300 + floor.objects.length * 30,\r\n      y: 300 + floor.objects.length * 30,\r\n      width: 120,\r\n      height: 80,\r\n      rotation: 0\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, objects: [...floor.objects, newObject] }\r\n        : floor\r\n    ));\r\n    setSelectedElement({ type: 'object', id: newObject.id });\r\n  };\r\n\r\n  const addChair = (position: ChairPosition) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Get existing chairs on this side\r\n    const existingChairsOnSide = floor.chairs.filter(chair => \r\n      chair.tableId === selectedElement.id && chair.position === position\r\n    );\r\n    \r\n    // Calculate the next index\r\n    const nextIndex = existingChairsOnSide.length;\r\n    \r\n    // Check if any existing chair on this side has a custom size\r\n    const existingChairWithSize = existingChairsOnSide.find(c => c.size !== undefined);\r\n    \r\n    // Determine initial size: inherit from existing chairs on this side, or use default 40px\r\n    const initialSize = existingChairWithSize?.size ?? 40;\r\n    \r\n    const newChair: Chair = {\r\n      id: generateId(),\r\n      tableId: selectedElement.id,\r\n      position,\r\n      index: nextIndex,\r\n      x: 0,\r\n      y: 0,\r\n      size: initialSize // Always set a size to prevent recalculation on table resize\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, chairs: [...floor.chairs, newChair] }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const removeChair = (position: ChairPosition) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Find chairs on this side\r\n    const chairsOnSide = floor.chairs.filter(chair => \r\n      chair.tableId === selectedElement.id && chair.position === position\r\n    );\r\n    \r\n    if (chairsOnSide.length === 0) return;\r\n    \r\n    // Remove the last chair (highest index)\r\n    const chairToRemove = chairsOnSide.reduce((prev, current) => \r\n      current.index > prev.index ? current : prev\r\n    );\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            chairs: floor.chairs.filter(chair => chair.id !== chairToRemove.id)\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const changeChairSize = (position: ChairPosition, size: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Update all chairs on this side with the new size\r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            chairs: floor.chairs.map(chair => \r\n              chair.tableId === selectedElement.id && chair.position === position\r\n                ? { ...chair, size }\r\n                : chair\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const resetChairSizes = () => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Remove custom size from all chairs of this table (revert to calculated default)\r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            chairs: floor.chairs.map(chair => {\r\n              if (chair.tableId === selectedElement.id) {\r\n                const { size, ...chairWithoutSize } = chair;\r\n                return chairWithoutSize;\r\n              }\r\n              return chair;\r\n            })\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const removeElement = () => {\r\n    if (!selectedElement) return;\r\n    \r\n    if (selectedElement.type === 'table') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              tables: floor.tables.filter(t => t.id !== selectedElement.id),\r\n              chairs: floor.chairs.filter(c => c.tableId !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    } else if (selectedElement.type === 'object') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              objects: floor.objects.filter(o => o.id !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    } else if (selectedElement.type === 'wall') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              walls: floor.walls.filter(w => w.id !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    } else if (selectedElement.type === 'fixedElement') {\r\n      setFloors(prev => prev.map(floor => \r\n        floor.id === currentFloor \r\n          ? { \r\n              ...floor, \r\n              fixedElements: floor.fixedElements.filter(fe => fe.id !== selectedElement.id)\r\n            }\r\n          : floor\r\n      ));\r\n    }\r\n    \r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const changeWallThickness = (thickness: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'wall') return;\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            walls: floor.walls.map(wall => \r\n              wall.id === selectedElement.id \r\n                ? { ...wall, thickness }\r\n                : wall\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const convertWallType = (type: WallType) => {\r\n    if (!selectedElement || selectedElement.type !== 'wall') return;\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            walls: floor.walls.map(wall => \r\n              wall.id === selectedElement.id \r\n                ? { ...wall, type }\r\n                : wall\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const rotateTable = () => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            tables: floor.tables.map(table => \r\n              table.id === selectedElement.id \r\n                ? { ...table, rotation: (table.rotation || 0) + 45 }\r\n                : table\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const duplicateTable = () => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    const originalTable = floor.tables.find(t => t.id === selectedElement.id);\r\n    if (!originalTable) return;\r\n    \r\n    const newTable: Table = {\r\n      ...originalTable,\r\n      id: generateId(),\r\n      name: `${originalTable.name} Copy`,\r\n      x: originalTable.x + 50,\r\n      y: originalTable.y + 50\r\n    };\r\n    \r\n    const originalChairs = floor.chairs.filter(c => c.tableId === originalTable.id);\r\n    const newChairs: Chair[] = originalChairs.map(chair => ({\r\n      ...chair,\r\n      id: generateId(),\r\n      tableId: newTable.id\r\n    }));\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { \r\n            ...floor, \r\n            tables: [...floor.tables, newTable],\r\n            chairs: [...floor.chairs, ...newChairs]\r\n          }\r\n        : floor\r\n    ));\r\n    \r\n    setSelectedElement({ type: 'table', id: newTable.id });\r\n  };\r\n\r\n  const updateSelectedTable = useCallback((updater: (table: Table) => Table) => {\r\n    if (!selectedElement || selectedElement.type !== 'table') return;\r\n\r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            tables: floor.tables.map(table =>\r\n              table.id === selectedElement.id ? updater(table) : table\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  }, [selectedElement, currentFloor]);\r\n\r\n  const handleTableSizeChange = (size: Table['size']) => {\r\n    updateSelectedTable(table => {\r\n      const { width, height } = resolveTableDimensions(table.shape, size);\r\n      return { ...table, size, width, height };\r\n    });\r\n  };\r\n\r\n  const handleCustomTableSize = (width: number, height: number) => {\r\n    updateSelectedTable(table => ({\r\n      ...table,\r\n      width,\r\n      height,\r\n      // Set size to a custom indicator or keep current\r\n      size: 'medium' as TableSize // Keep a valid size for the interface\r\n    }));\r\n  };\r\n\r\n  const handleObjectNameChange = (name: string) => {\r\n    if (!selectedElement || selectedElement.type !== 'object') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            objects: floor.objects.map(obj =>\r\n              obj.id === selectedElement.id ? { ...obj, name } : obj\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleObjectResize = (width: number, height: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'object') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            objects: floor.objects.map(obj =>\r\n              obj.id === selectedElement.id ? { ...obj, width, height } : obj\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleObjectRotate = (rotation: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'object') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            objects: floor.objects.map(obj =>\r\n              obj.id === selectedElement.id ? { ...obj, rotation } : obj\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleFixedElementResize = (width: number, height: number) => {\r\n    if (!selectedElement || selectedElement.type !== 'fixedElement') return;\r\n    \r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === currentFloor\r\n        ? {\r\n            ...floor,\r\n            fixedElements: floor.fixedElements.map(element =>\r\n              element.id === selectedElement.id ? { ...element, width, height } : element\r\n            )\r\n          }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const handleTableNameChange = (name: string) => {\r\n    updateSelectedTable(table => ({ ...table, name }));\r\n  };\r\n\r\n  const handleCanvasClick = (e: React.MouseEvent) => {\r\n    if (!canvasRef.current) return;\r\n    \r\n    // Don't do anything if we're resizing\r\n    if (isResizingWall) return;\r\n    \r\n    // If we're in wall drawing mode\r\n    if (isDrawingWall && wallType) {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const x = Math.round(((e.clientX - rect.left) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      const y = Math.round(((e.clientY - rect.top) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      if (!wallStartPoint) {\r\n        // First click - set start point\r\n        setWallStartPoint({ x, y });\r\n      } else {\r\n        // Second click - create the wall with snapped coordinates\r\n        const floor = getCurrentFloor();\r\n        if (!floor) return;\r\n        \r\n        // Apply snap to axis for the final wall\r\n        const snappedEnd = snapToAxis(wallStartPoint, { x, y });\r\n        \r\n        const newWall: Wall = {\r\n          id: generateId(),\r\n          type: wallType,\r\n          startX: wallStartPoint.x,\r\n          startY: wallStartPoint.y,\r\n          endX: snappedEnd.x,\r\n          endY: snappedEnd.y,\r\n          thickness: 8\r\n        };\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { ...floor, walls: [...floor.walls, newWall] }\r\n            : floor\r\n        ));\r\n        \r\n        // Reset wall drawing state\r\n        setWallStartPoint(null);\r\n        setTempWallEndPoint(null);\r\n        setIsDrawingWall(false);\r\n        setWallType(null);\r\n      }\r\n      return;\r\n    }\r\n    \r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const handleElementSelect = (type: 'table' | 'chair' | 'object' | 'wall' | 'fixedElement', id: string) => {\r\n    setSelectedElement({ type, id });\r\n  };\r\n\r\n  const handleDragStart = (e: React.MouseEvent, id: string) => {\r\n    if (!canvasRef.current) return;\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / zoom;\r\n    const y = (e.clientY - rect.top) / zoom;\r\n    \r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n    \r\n    // Find the element (table, object, fixedElement, or wall) being dragged\r\n    const table = floor.tables.find(t => t.id === id);\r\n    const object = floor.objects.find(o => o.id === id);\r\n    const fixedElement = floor.fixedElements.find(fe => fe.id === id);\r\n    const wall = floor.walls.find(w => w.id === id);\r\n    \r\n    if (wall) {\r\n      // For walls, store offset from startX/startY\r\n      setDragOffset({\r\n        x: x - wall.startX,\r\n        y: y - wall.startY\r\n      });\r\n      dragElementRef.current = { id, type: 'wall' };\r\n    } else {\r\n      const element = table || object || fixedElement;\r\n      if (element) {\r\n        setDragOffset({\r\n          x: x - element.x,\r\n          y: y - element.y\r\n        });\r\n      }\r\n      \r\n      // Determine the type based on what was found\r\n      const type = table ? 'table' : object ? 'object' : fixedElement ? 'fixedElement' : 'table';\r\n      dragElementRef.current = { id, type };\r\n    }\r\n    \r\n    setIsDragging(true);\r\n  };\r\n\r\n  const handleDrag = useCallback((e: MouseEvent) => {\r\n    if ((!isDragging && !isResizingWall) || !dragElementRef.current || !canvasRef.current) return;\r\n    \r\n    // Cancel any pending animation frame\r\n    if (rafRef.current) {\r\n      cancelAnimationFrame(rafRef.current);\r\n    }\r\n    \r\n    // Use requestAnimationFrame for smooth updates\r\n    rafRef.current = requestAnimationFrame(() => {\r\n      if (!canvasRef.current) return;\r\n      \r\n      const canvasRect = canvasRef.current.getBoundingClientRect();\r\n      const x = (e.clientX - canvasRect.left) / zoom;\r\n      const y = (e.clientY - canvasRect.top) / zoom;\r\n      \r\n      const snappedX = Math.round(x / GRID_SIZE) * GRID_SIZE;\r\n      const snappedY = Math.round(y / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      if (isResizingWall && dragElementRef.current?.type === 'wall') {\r\n        // Handle wall resizing with snap-to-axis\r\n        const currentFloorData = floors.find(f => f.id === currentFloor);\r\n        const currentWall = currentFloorData?.walls.find(w => w.id === dragElementRef.current?.id);\r\n        \r\n        if (currentWall) {\r\n          // Determine which point is fixed and which is moving\r\n          const fixedPoint = resizingWallHandle === 'start' \r\n            ? { x: currentWall.endX, y: currentWall.endY }\r\n            : { x: currentWall.startX, y: currentWall.startY };\r\n          \r\n          // Apply snap to axis based on fixed point\r\n          const snappedPoint = snapToAxis(fixedPoint, { x: snappedX, y: snappedY });\r\n          \r\n          setFloors(prev => prev.map(floor => \r\n            floor.id === currentFloor \r\n              ? { \r\n                  ...floor, \r\n                  walls: floor.walls.map(wall => \r\n                    wall.id === dragElementRef.current?.id \r\n                      ? resizingWallHandle === 'start'\r\n                        ? { ...wall, startX: snappedPoint.x, startY: snappedPoint.y }\r\n                        : { ...wall, endX: snappedPoint.x, endY: snappedPoint.y }\r\n                      : wall\r\n                  )\r\n                }\r\n              : floor\r\n          ));\r\n        }\r\n      } else if (dragElementRef.current?.type === 'table') {\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const tableSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const tableSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                tables: floor.tables.map(table => \r\n                  table.id === dragElementRef.current?.id \r\n                    ? { ...table, x: tableSnappedX, y: tableSnappedY }\r\n                    : table\r\n                )\r\n              }\r\n            : floor\r\n        ));\r\n      } else if (dragElementRef.current?.type === 'object') {\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const objectSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const objectSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                objects: floor.objects.map(object => \r\n                  object.id === dragElementRef.current?.id \r\n                    ? { ...object, x: objectSnappedX, y: objectSnappedY }\r\n                    : object\r\n                )\r\n              }\r\n            : floor\r\n        ));\r\n      } else if (dragElementRef.current?.type === 'fixedElement') {\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const elementSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const elementSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                fixedElements: floor.fixedElements.map(element => \r\n                  element.id === dragElementRef.current?.id \r\n                    ? { ...element, x: elementSnappedX, y: elementSnappedY }\r\n                    : element\r\n                )\r\n              }\r\n            : floor\r\n        ));\r\n      } else if (dragElementRef.current?.type === 'wall' && !isResizingWall) {\r\n        // Handle wall dragging (move entire wall - both endpoints)\r\n        const adjustedX = x - dragOffset.x;\r\n        const adjustedY = y - dragOffset.y;\r\n        const wallSnappedX = Math.round(adjustedX / GRID_SIZE) * GRID_SIZE;\r\n        const wallSnappedY = Math.round(adjustedY / GRID_SIZE) * GRID_SIZE;\r\n        \r\n        setFloors(prev => prev.map(floor => \r\n          floor.id === currentFloor \r\n            ? { \r\n                ...floor, \r\n                walls: floor.walls.map(wall => {\r\n                  if (wall.id !== dragElementRef.current?.id) return wall;\r\n                  \r\n                  // Calculate delta from original startX/startY\r\n                  const deltaX = wallSnappedX - wall.startX;\r\n                  const deltaY = wallSnappedY - wall.startY;\r\n                  \r\n                  // Move both endpoints by the same delta\r\n                  return {\r\n                    ...wall,\r\n                    startX: wall.startX + deltaX,\r\n                    startY: wall.startY + deltaY,\r\n                    endX: wall.endX + deltaX,\r\n                    endY: wall.endY + deltaY\r\n                  };\r\n                })\r\n              }\r\n            : floor\r\n        ));\r\n      }\r\n    });\r\n  }, [isDragging, isResizingWall, resizingWallHandle, dragOffset, currentFloor, zoom, floors]);\r\n\r\n  const handleDragEnd = () => {\r\n    // Cancel any pending animation frame\r\n    if (rafRef.current) {\r\n      cancelAnimationFrame(rafRef.current);\r\n      rafRef.current = null;\r\n    }\r\n    setIsDragging(false);\r\n    dragElementRef.current = null;\r\n    \r\n    // Reset wall resizing state\r\n    setIsResizingWall(false);\r\n    setResizingWallHandle(null);\r\n    setWallResizePreview(null);\r\n  };\r\n\r\n  const handleWallHandleDrag = (e: React.MouseEvent, wallId: string, handleType: 'start' | 'end') => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    setIsResizingWall(true);\r\n    setResizingWallHandle(handleType);\r\n    dragElementRef.current = { id: wallId, type: 'wall' };\r\n  };\r\n\r\n  const addFloor = () => {\r\n    const newFloor: Floor = {\r\n      id: generateId(),\r\n      name: `Floor ${floors.length + 1}`,\r\n      isActive: false,\r\n      tables: [],\r\n      chairs: [],\r\n      objects: [],\r\n      walls: [],\r\n      fixedElements: []\r\n    };\r\n    setFloors(prev => [...prev, newFloor]);\r\n    switchFloor(newFloor.id);\r\n  };\r\n\r\n  const removeFloor = () => {\r\n    if (floors.length <= 1) return;\r\n    \r\n    const newFloors = floors.filter(f => f.id !== currentFloor);\r\n    setFloors(newFloors);\r\n    setCurrentFloor(newFloors[0].id);\r\n  };\r\n\r\n  const switchFloor = (floorId: string) => {\r\n    setFloors(prev => prev.map(floor => ({\r\n      ...floor,\r\n      isActive: floor.id === floorId\r\n    })));\r\n    setCurrentFloor(floorId);\r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const renameFloor = (floorId: string, newName: string) => {\r\n    setFloors(prev => prev.map(floor =>\r\n      floor.id === floorId\r\n        ? { ...floor, name: newName }\r\n        : floor\r\n    ));\r\n  };\r\n\r\n  const startWallDrawing = (type: WallType) => {\r\n    setIsDrawingWall(true);\r\n    setWallType(type);\r\n    setWallStartPoint(null);\r\n    setTempWallEndPoint(null);\r\n    setSelectedElement(null);\r\n  };\r\n\r\n  const addFixedElement = (type: FixedElementType) => {\r\n    const floor = getCurrentFloor();\r\n    if (!floor) return;\r\n\r\n    const newElement: FixedElement = {\r\n      id: generateId(),\r\n      name: `${type.charAt(0).toUpperCase() + type.slice(1)} ${floor.fixedElements.length + 1}`,\r\n      type,\r\n      x: 400 + floor.fixedElements.length * 30,\r\n      y: 400 + floor.fixedElements.length * 30,\r\n      width: 60,\r\n      height: 60,\r\n      rotation: 0\r\n    };\r\n    \r\n    setFloors(prev => prev.map(floor => \r\n      floor.id === currentFloor \r\n        ? { ...floor, fixedElements: [...floor.fixedElements, newElement] }\r\n        : floor\r\n    ));\r\n    setSelectedElement({ type: 'fixedElement', id: newElement.id });\r\n  };\r\n\r\n  const saveFloorPlan = () => {\r\n    const floorPlanData = {\r\n      floors: floors,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n    \r\n    console.log('Saving floor plan:', floorPlanData);\r\n    alert('Floor plan saved! (Check console for data)');\r\n  };\r\n\r\n  const loadFloorPlan = () => {\r\n    // Simulate loading - in real app this would be from your backend API\r\n    const sampleData: Floor[] = [\r\n      {\r\n        id: 'floor-sample',\r\n        name: 'Sample Floor',\r\n        isActive: true,\r\n        tables: [\r\n          {\r\n            id: 'table-1',\r\n            name: 'Table 1',\r\n            shape: 'circle',\r\n            size: 'medium',\r\n            x: 200,\r\n            y: 200,\r\n            width: 120,\r\n            height: 120,\r\n            rotation: 0\r\n          }\r\n        ],\r\n        chairs: [\r\n          {\r\n            id: 'chair-1',\r\n            tableId: 'table-1',\r\n            position: 'top',\r\n            index: 0,\r\n            x: 0,\r\n            y: 0\r\n          }\r\n        ],\r\n        objects: [],\r\n        walls: [],\r\n        fixedElements: []\r\n      }\r\n    ];\r\n    \r\n    setFloors(sampleData);\r\n    setCurrentFloor('floor-sample');\r\n    setSelectedElement(null);\r\n    alert('Sample floor plan loaded!');\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleMouseMove = (e: MouseEvent) => handleDrag(e);\r\n    const handleMouseUp = () => handleDragEnd();\r\n    \r\n    if (isDragging || isResizingWall) {\r\n      document.addEventListener('mousemove', handleMouseMove);\r\n      document.addEventListener('mouseup', handleMouseUp);\r\n    }\r\n    \r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isDragging, isResizingWall, handleDrag]);\r\n\r\n  // Handle mouse move for wall drawing preview\r\n  const handleCanvasMouseMove = (e: React.MouseEvent) => {\r\n    if (isDrawingWall && wallStartPoint && canvasRef.current) {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const x = Math.round(((e.clientX - rect.left) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      const y = Math.round(((e.clientY - rect.top) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      // Apply snap to axis\r\n      const snappedPoint = snapToAxis(wallStartPoint, { x, y });\r\n      setTempWallEndPoint(snappedPoint);\r\n    } else if (isResizingWall && dragElementRef.current?.type === 'wall' && canvasRef.current) {\r\n      // Show preview while resizing wall\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const x = Math.round(((e.clientX - rect.left) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      const y = Math.round(((e.clientY - rect.top) / zoom) / GRID_SIZE) * GRID_SIZE;\r\n      \r\n      const currentFloorData = getCurrentFloor();\r\n      const currentWall = currentFloorData?.walls.find(w => w.id === dragElementRef.current?.id);\r\n      \r\n      if (currentWall) {\r\n        const fixedPoint = resizingWallHandle === 'start'\r\n          ? { x: currentWall.endX, y: currentWall.endY }\r\n          : { x: currentWall.startX, y: currentWall.startY };\r\n        \r\n        const snappedPoint = snapToAxis(fixedPoint, { x, y });\r\n        \r\n        setWallResizePreview(\r\n          resizingWallHandle === 'start'\r\n            ? { startX: snappedPoint.x, startY: snappedPoint.y, endX: currentWall.endX, endY: currentWall.endY }\r\n            : { startX: currentWall.startX, startY: currentWall.startY, endX: snappedPoint.x, endY: snappedPoint.y }\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  // Handle ESC key to cancel wall drawing\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape' && isDrawingWall) {\r\n        setIsDrawingWall(false);\r\n        setWallType(null);\r\n        setWallStartPoint(null);\r\n        setTempWallEndPoint(null);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [isDrawingWall]);\r\n\r\n  const currentFloorData = getCurrentFloor();\r\n  const selectedTable = currentFloorData?.tables.find(t => selectedElement?.type === 'table' && t.id === selectedElement.id);\r\n  const selectedObject = currentFloorData?.objects.find(o => selectedElement?.type === 'object' && o.id === selectedElement.id);\r\n  const selectedWall = currentFloorData?.walls.find(w => selectedElement?.type === 'wall' && w.id === selectedElement.id);\r\n  const selectedFixedElement = currentFloorData?.fixedElements.find(fe => selectedElement?.type === 'fixedElement' && fe.id === selectedElement.id);\r\n  const selectedTableChairs = selectedTable\r\n    ? (currentFloorData?.chairs.filter(c => c.tableId === selectedTable.id) ?? [])\r\n    : [];\r\n  const toggleGrid = useCallback(() => setShowGrid((prev) => !prev), []);\r\n\r\n  return (\r\n    <div className=\"flex h-screen bg-gray-50\">\r\n      <style dangerouslySetInnerHTML={{ __html: hexagonStyle }} />\r\n      \r\n      <Sidebar\r\n        floors={floors}\r\n        currentFloor={currentFloorData}\r\n        onAddFloor={addFloor}\r\n        onRemoveFloor={removeFloor}\r\n        onSwitchFloor={switchFloor}\r\n        onRenameFloor={renameFloor}\r\n        onAddTable={addTable}\r\n        onAddObject={addObject}\r\n        onStartWallDrawing={startWallDrawing}\r\n        onAddFixedElement={addFixedElement}\r\n        onRotateTable={rotateTable}\r\n        onDuplicateTable={duplicateTable}\r\n        onRemoveTable={removeElement}\r\n        onSave={saveFloorPlan}\r\n        onLoad={loadFloorPlan}\r\n        selectedTable={selectedTable ?? null}\r\n        selectedTableChairs={selectedTableChairs}\r\n      />\r\n\r\n      <div className=\"flex-1 flex flex-col\">\r\n        {/* Wall Drawing Mode Banner - Removed for cleaner UX */}\r\n        {/* Wall Resizing Mode Banner - Removed for cleaner UX */}\r\n        \r\n        <Toolbar\r\n          showGrid={showGrid}\r\n          selectedTable={selectedTable ?? null}\r\n          selectedObject={selectedObject ?? null}\r\n          selectedWall={selectedWall ?? null}\r\n          selectedFixedElement={selectedFixedElement ?? null}\r\n          selectedTableChairs={selectedTableChairs}\r\n          tableCount={currentFloorData?.tables.length ?? 0}\r\n          chairCount={currentFloorData?.chairs.length ?? 0}\r\n          objectCount={currentFloorData?.objects.length ?? 0}\r\n          wallCount={currentFloorData?.walls.length ?? 0}\r\n          fixedElementCount={currentFloorData?.fixedElements.length ?? 0}\r\n          selectedElementType={selectedElement?.type ?? null}\r\n          onToggleGrid={toggleGrid}\r\n          onAddChair={addChair}\r\n          onRemoveChair={removeChair}\r\n          onChangeTableSize={handleTableSizeChange}\r\n          onCustomTableSize={handleCustomTableSize}\r\n          onTableNameChange={handleTableNameChange}\r\n          onObjectNameChange={handleObjectNameChange}\r\n          onObjectResize={handleObjectResize}\r\n          onObjectRotate={handleObjectRotate}\r\n          onRemoveObject={removeElement}\r\n          onRemoveWall={removeElement}\r\n          onRemoveFixedElement={removeElement}\r\n          onChangeWallThickness={changeWallThickness}\r\n          onConvertWallType={convertWallType}\r\n          onFixedElementResize={handleFixedElementResize}\r\n          onChairSizeChange={changeChairSize}\r\n          onResetChairSizes={resetChairSizes}\r\n          on3DPreview={() => setShow3DPreview(true)}\r\n        />\r\n\r\n        <div className=\"flex-1 overflow-hidden bg-gray-100 relative\">\r\n          <div\r\n            ref={canvasRef}\r\n            className={`w-full h-full relative ${\r\n              isDrawingWall ? 'cursor-crosshair' : \r\n              isResizingWall ? 'cursor-grabbing' : \r\n              'cursor-default'\r\n            }`}\r\n            style={{ \r\n              transform: `scale(${zoom})`,\r\n              transformOrigin: 'top left',\r\n              background: showGrid \r\n                ? `radial-gradient(circle, #d1d5db 1px, transparent 1px)` \r\n                : 'white',\r\n              backgroundSize: `${GRID_SIZE * zoom}px ${GRID_SIZE * zoom}px`\r\n            }}\r\n            onClick={handleCanvasClick}\r\n            onMouseMove={handleCanvasMouseMove}\r\n          >\r\n            {currentFloorData?.tables.length === 0 && (\r\n              <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n                <div className=\"text-center text-gray-400\">\r\n                  <div className=\"text-6xl mb-4\">ðŸª</div>\r\n                  <div className=\"text-xl font-medium mb-2\">Welcome to Your Restaurant Designer</div>\r\n                  <div className=\"text-lg\">Click \"Add Tables\" in the sidebar to start designing your floor plan</div>\r\n                  <div className=\"mt-4 space-y-1 text-sm\">\r\n                    <div>â€¢ Drag tables to move them around</div>\r\n                    <div>â€¢ Click tables to select and edit properties</div>\r\n                    <div>â€¢ Add chairs from the top toolbar or the table properties panel</div>\r\n                    <div>â€¢ Use multiple floors for complex layouts</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {currentFloorData?.tables.map(table => (\r\n              <TableComponent\r\n                key={table.id}\r\n                table={table}\r\n                isSelected={selectedElement?.type === 'table' && selectedElement.id === table.id}\r\n                chairs={currentFloorData.chairs.filter(chair => chair.tableId === table.id)}\r\n                onSelect={() => handleElementSelect('table', table.id)}\r\n                onDrag={handleDragStart}\r\n                onDragEnd={handleDragEnd}\r\n              />\r\n            ))}\r\n\r\n            {/* Render floor objects */}\r\n            {currentFloorData?.objects.map(object => (\r\n              <FloorObjectComponent\r\n                key={object.id}\r\n                object={object}\r\n                isSelected={selectedElement?.type === 'object' && selectedElement.id === object.id}\r\n                onSelect={() => handleElementSelect('object', object.id)}\r\n                onDragStart={(e) => handleDragStart(e, object.id)}\r\n              />\r\n            ))}\r\n\r\n            {/* Render walls */}\r\n            {currentFloorData?.walls.map(wall => (\r\n              <WallComponent\r\n                key={wall.id}\r\n                wall={wall}\r\n                isSelected={selectedElement?.type === 'wall' && selectedElement.id === wall.id}\r\n                onSelect={() => handleElementSelect('wall', wall.id)}\r\n                onDragHandle={(e, handleType) => handleWallHandleDrag(e, wall.id, handleType)}\r\n                onDragStart={(e) => handleDragStart(e, wall.id)}\r\n              />\r\n            ))}\r\n\r\n            {/* Render temporary wall preview while drawing */}\r\n            {isDrawingWall && wallStartPoint && tempWallEndPoint && wallType && (\r\n              <WallComponent\r\n                wall={{\r\n                  id: 'temp-wall',\r\n                  type: wallType,\r\n                  startX: wallStartPoint.x,\r\n                  startY: wallStartPoint.y,\r\n                  endX: tempWallEndPoint.x,\r\n                  endY: tempWallEndPoint.y,\r\n                  thickness: 8\r\n                }}\r\n                isSelected={false}\r\n                onSelect={() => {}}\r\n              />\r\n            )}\r\n\r\n            {/* Render wall resize preview */}\r\n            {wallResizePreview && (\r\n              <div\r\n                className=\"absolute pointer-events-none\"\r\n                style={{\r\n                  left: `${wallResizePreview.startX}px`,\r\n                  top: `${wallResizePreview.startY}px`,\r\n                  width: `${Math.sqrt(\r\n                    Math.pow(wallResizePreview.endX - wallResizePreview.startX, 2) + \r\n                    Math.pow(wallResizePreview.endY - wallResizePreview.startY, 2)\r\n                  )}px`,\r\n                  height: '4px',\r\n                  transform: `rotate(${Math.atan2(\r\n                    wallResizePreview.endY - wallResizePreview.startY, \r\n                    wallResizePreview.endX - wallResizePreview.startX\r\n                  ) * (180 / Math.PI)}deg)`,\r\n                  transformOrigin: 'top left',\r\n                  zIndex: 15\r\n                }}\r\n              >\r\n                <div className=\"w-full h-full border-2 border-blue-400 border-dashed opacity-70 bg-blue-100 rounded-sm\" />\r\n              </div>\r\n            )}\r\n\r\n            {/* Render fixed elements */}\r\n            {currentFloorData?.fixedElements.map(element => (\r\n              <FixedElementComponent\r\n                key={element.id}\r\n                element={element}\r\n                isSelected={selectedElement?.type === 'fixedElement' && selectedElement.id === element.id}\r\n                onSelect={() => handleElementSelect('fixedElement', element.id)}\r\n                onDragStart={(e) => handleDragStart(e, element.id)}\r\n              />\r\n            ))}\r\n\r\n            {/* Render all chairs separately for better positioning */}\r\n            {currentFloorData?.chairs.map(chair => {\r\n              const chairTable = currentFloorData.tables.find(t => t.id === chair.tableId);\r\n              if (!chairTable) return null;\r\n              \r\n              // Count total chairs on this side for proper spacing\r\n              const totalChairsOnSide = currentFloorData.chairs.filter(\r\n                c => c.tableId === chair.tableId && c.position === chair.position\r\n              ).length;\r\n              \r\n              return (\r\n                <ChairComponent\r\n                  key={chair.id}\r\n                  chair={chair}\r\n                  table={chairTable}\r\n                  totalChairsOnSide={totalChairsOnSide}\r\n                  isSelected={false}\r\n                  onSelect={() => {}}\r\n                  onDrag={() => {}}\r\n                  onDragEnd={() => {}}\r\n                />\r\n              );\r\n            })}\r\n\r\n            {selectedElement && selectedElement.type === 'table' && selectedTable && (\r\n              <div\r\n                className=\"absolute border-2 border-blue-500 border-dashed rounded pointer-events-none\"\r\n                style={{\r\n                  left: selectedTable.x - 10,\r\n                  top: selectedTable.y - 10,\r\n                  width: (selectedTable.shape === 'rectangle' ? selectedTable.width * 1.5 : selectedTable.width) + 20,\r\n                  height: selectedTable.height + 20,\r\n                  transform: `rotate(${selectedTable.rotation || 0}deg)`\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"absolute bottom-0 left-0 right-0 bg-white bg-opacity-95 border-t border-gray-200 p-3\">\r\n            <div className=\"flex items-center justify-between text-sm\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"flex items-center gap-2 text-gray-600\">\r\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                  <span>Floor: {currentFloorData?.name}</span>\r\n                </div>\r\n                {isDragging && (\r\n                  <div className=\"flex items-center gap-2 text-blue-600\">\r\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\r\n                    <span>Dragging...</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"text-gray-500\">\r\n                  Zoom: {Math.round(zoom * 100)}% | Grid: {showGrid ? 'On' : 'Off'}\r\n                </div>\r\n                {selectedElement && (\r\n                  <div className=\"text-blue-600 font-medium\">\r\n                    {selectedElement.type === 'table' && selectedTable\r\n                      ? `${selectedTable.name} (${selectedTable.shape})`\r\n                      : 'Element Selected'\r\n                    }\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 3D Preview Modal */}\r\n      {currentFloorData && (\r\n        <Preview3DModal \r\n          floor={currentFloorData}\r\n          isOpen={show3DPreview}\r\n          onClose={() => setShow3DPreview(false)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RestaurantFloorPlanner;"],"names":["hexagonStyle","GRID_SIZE","TABLE_SIZES","TABLE_SHAPES","Square","Circle","SIZE_LABELS","OBJECT_ICONS","Wine","ChefHat","Bath","OBJECT_LABELS","OBJECT_COLORS","WALL_LABELS","WALL_ICONS","RectangleVertical","DoorOpen","FIXED_ELEMENT_LABELS","FIXED_ELEMENT_ICONS","Columns","Rows","FIXED_ELEMENT_COLORS","generateId","calculateChairSize","table","actualWidth","limitingDimension","scaled","getActualTableWidth","resolveTableDimensions","shape","size","width","height","snapToAxis","start","end","dx","dy","ChairComponent","chair","isSelected","onSelect","onDrag","onDragEnd","totalChairsOnSide","baseChairSize","chairSize","spacing","iconSize","tableWidth","tableRotation","position","availableSpace","gapBetweenChairs","offsetAlongSide","relativeX","relativeY","rotatedX","rotatedY","tableCenterX","tableCenterY","getChairRotation","baseRotation","jsx","event","Armchair","TableComponent","chairs","containerStyle","baseClasses","tableClasses","seatsCount","nameMatch","tableLabel","jsxs","FloorObjectComponent","object","onDragStart","Icon","colors","isDragging","setIsDragging","useState","handleMouseDown","e","handleMouseUp","Fragment","WallComponent","wall","onDragHandle","length","angle","getCursorStyle","getWallColor","getWallPattern","renderDoor","gapSize","panelWidth","FixedElementComponent","element","renderContent","step","sizeLabels","Sidebar","floors","currentFloor","onAddFloor","onRemoveFloor","onSwitchFloor","onRenameFloor","onAddTable","onAddObject","onStartWallDrawing","onAddFixedElement","onRotateTable","onDuplicateTable","onRemoveTable","onSave","onLoad","selectedTable","selectedTableChairs","editingFloorId","setEditingFloorId","React","editingFloorName","setEditingFloorName","activeTab","setActiveTab","inputRef","handleDoubleClick","floor","handleSaveFloorName","handleKeyDown","Layers","Plus","Minus","LayoutGrid","Package","Home","objectType","label","wallType","colorClasses","elementType","RotateCw","Trash2","Save","Upload","chairPositions","sizeOptions","Toolbar","showGrid","selectedObject","selectedWall","selectedFixedElement","onToggleGrid","onAddChair","onRemoveChair","onChangeTableSize","onTableNameChange","onCustomTableSize","onObjectNameChange","onObjectResize","onRemoveObject","onRemoveWall","onRemoveFixedElement","onChangeWallThickness","onConvertWallType","onFixedElementNameChange","onFixedElementResize","onChairSizeChange","onResetChairSizes","on3DPreview","onObjectRotate","tableCount","chairCount","objectCount","wallCount","fixedElementCount","selectedElementType","chairMenuRef","useRef","sizeMenuRef","objectSizeMenuRef","fixedElementSizeMenuRef","isChairMenuOpen","setIsChairMenuOpen","isSizeMenuOpen","setIsSizeMenuOpen","isObjectSizeMenuOpen","setIsObjectSizeMenuOpen","isFixedElementSizeMenuOpen","setIsFixedElementSizeMenuOpen","showProSlider","setShowProSlider","customWidth","setCustomWidth","customHeight","setCustomHeight","objectWidth","setObjectWidth","objectHeight","setObjectHeight","fixedElementWidth","setFixedElementWidth","fixedElementHeight","setFixedElementHeight","useEffect","handleClickOutside","Eye","EyeOff","chairsOnSide","c","chairSample","currentSize","RotateCcw","sizeOption","isActive","ChevronRight","newWidth","newHeight","newRotation","Box","CAMERA_VIEWS","Preview3DModal","isOpen","onClose","containerRef","sceneRef","cameraRef","rendererRef","animationFrameRef","autoRotate","setAutoRotate","currentView","setCurrentView","isTransitioning","setIsTransitioning","rotationSpeedRef","transitionRef","smoothCameraTransition","viewKey","view","camera","THREE","rotateCamera","direction","radius","currentAngle","leftAngle","rightAngle","zoomCamera","factor","scene","renderer","pmremGenerator","envScene","envTexture","mainLight","fillLight","rimLight","floorMesh","grid","wallHeight","baseX","baseZ","doorGroup","doorWidth","doorHeight","doorThickness","frameMat","frameThickness","topFrame","bottomFrame","leftFrame","rightFrame","doorMat","glassMat","singleDoorWidth","doorPanelHeight","makeDoor","xOffset","group","doorBorder","glass","handleMat","handle","leftDoor","rightDoor","signHeight","signGeometry","canvas","ctx","signTexture","signMaterial","sign","windowLength","windowHeight","h1","h2","h3","h4","wallMat","sill","winY","numPanes","paneWidth","i","paneX","localX","localZ","divX","divLocalX","divLocalZ","divider","topY","transomGlass","transomFrame","transomTopFrame","topWall","wallMesh","pillar","capital","base","column","edges","stepDepth","obj","rotation","barHeight","baseMat","glassColors","glassColor","glassTopMat","glassTop","ledGlowMat","ledStrip","trimColor","trim","legMat","legGeo","lx","lz","leg","barLight","canopyHeight","canopyOuter","outerMat","outerShell","innerGlassMat","innerGlass","ledMat","ledGeom","ledLeft","ledRight","bottleRack","bottleColors","color","bottleMat","bottle","neck","rodMat","rodGeo","rod","warmLight","kitchenGroup","steelMat","counter","stove","burnerMat","bx","bz","burner","hood","shelfMat","shelf","kitchenLight","chefCanvas","chefCtx","chefTexture","chefSignLeft","chefSignRight","toiletGroup","marbleMat","door2Mat","tileFloorMat","roomHeight","backWall","leftWall","rightWall","centerDivider","leftSection","rightSection","rightTopWall","leftTopWall","door","maleCanvas","maleCtx","gradient","goldGradient","maleTexture","maleSign","door2","handle2","femaleCanvas","femaleCtx","roseGoldGradient","femaleTexture","femaleSign","wcTexture","wcSign","counterMat","sinkMat","sink","faucetMat","faucet","toiletMat","toiletBowl","toiletSeat","toiletTank","flushHandle","urinal","urinalValve","softLight","tableX","tableZ","tableRotRad","tableMaterial","tableGeometry","tableMesh","edgeTrim","legMaterial","legRadius","tableChairs","chairHeight","woodMaterial","cushionMaterial","totalOnSide","availSpace","gap","offset","relX","relZ","rotX","rotZ","seat","seatHeight","baseRot","back","backOff","legHeight","cos","sin","animate","t","easedProgress","x","currentTarget","r","a","_a","handleResize","Move3d","X","ZoomIn","ZoomOut","Maximize2","Grid","RestaurantFloorPlanner","setFloors","setCurrentFloor","selectedElement","setSelectedElement","dragOffset","setDragOffset","zoom","setShowGrid","show3DPreview","setShow3DPreview","isDrawingWall","setIsDrawingWall","setWallType","wallStartPoint","setWallStartPoint","tempWallEndPoint","setTempWallEndPoint","isResizingWall","setIsResizingWall","resizingWallHandle","setResizingWallHandle","wallResizePreview","setWallResizePreview","canvasRef","dragElementRef","rafRef","getCurrentFloor","sizeByPosition","prev","defaultSize","addTable","newTable","addObject","type","newObject","addChair","existingChairsOnSide","nextIndex","existingChairWithSize","initialSize","newChair","removeChair","chairToRemove","current","changeChairSize","resetChairSizes","chairWithoutSize","removeElement","o","w","fe","changeWallThickness","thickness","convertWallType","rotateTable","duplicateTable","originalTable","newChairs","updateSelectedTable","useCallback","updater","handleTableSizeChange","handleCustomTableSize","handleObjectNameChange","name","handleObjectResize","handleObjectRotate","handleFixedElementResize","handleTableNameChange","handleCanvasClick","rect","y","snappedEnd","newWall","handleElementSelect","id","handleDragStart","fixedElement","handleDrag","canvasRect","snappedX","snappedY","currentFloorData","f","currentWall","fixedPoint","snappedPoint","_b","adjustedX","adjustedY","tableSnappedX","tableSnappedY","_c","objectSnappedX","objectSnappedY","_d","elementSnappedX","elementSnappedY","_e","wallSnappedX","wallSnappedY","deltaX","deltaY","handleDragEnd","handleWallHandleDrag","wallId","handleType","addFloor","newFloor","switchFloor","removeFloor","newFloors","floorId","renameFloor","newName","startWallDrawing","addFixedElement","newElement","saveFloorPlan","floorPlanData","loadFloorPlan","handleMouseMove","handleCanvasMouseMove","toggleGrid","chairTable"],"mappings":"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"}