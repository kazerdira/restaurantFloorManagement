(function(Ye,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("react/jsx-runtime"),require("react"),require("lucide-react"),require("three")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react","lucide-react","three"],e):(Ye=typeof globalThis<"u"?globalThis:Ye||self,e(Ye.RestaurantFloorPlanner={},Ye["react/jsx-runtime"],Ye.React,Ye.LucideReact,Ye.THREE))})(this,function(Ye,e,v,E,ir){"use strict";function lr(i){const c=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const p in i)if(p!=="default"){const d=Object.getOwnPropertyDescriptor(i,p);Object.defineProperty(c,p,d.get?d:{enumerable:!0,get:()=>i[p]})}}return c.default=i,Object.freeze(c)}const r=lr(ir),kr="",pr=`
  .hexagon-shape {
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
  }
`,O=20,dr={small:{width:50,height:50},medium:{width:90,height:90},large:{width:130,height:130}},fr={square:E.Square,circle:E.Circle,rectangle:E.Square,hexagon:E.Square},Ke={small:"Small",medium:"Medium",large:"Big"},Je={bar:E.Wine,kitchen:E.ChefHat,toilet:E.Bath},qe={bar:"Bar",kitchen:"Kitchen",toilet:"Toilet"},Qe={bar:{bg:"bg-gradient-to-br from-purple-500 to-purple-700",border:"border-purple-600",text:"text-purple-100"},kitchen:{bg:"bg-gradient-to-br from-orange-500 to-orange-700",border:"border-orange-600",text:"text-orange-100"},toilet:{bg:"bg-gradient-to-br from-cyan-500 to-cyan-700",border:"border-cyan-600",text:"text-cyan-100"}},Ve={wall:"Wall",door:"Door",window:"Window"},cr={wall:E.RectangleVertical,door:E.DoorOpen,window:E.RectangleVertical},je={pillar:"Pillar",column:"Column",stairs:"Stairs"},hr={pillar:E.Columns,column:E.Columns,stairs:E.Rows},gr={pillar:{bg:"bg-gradient-to-br from-gray-600 to-gray-800",border:"border-gray-700",text:"text-gray-100"},column:{bg:"bg-gradient-to-br from-slate-600 to-slate-800",border:"border-slate-700",text:"text-slate-100"},stairs:{bg:"bg-gradient-to-br from-stone-600 to-stone-800",border:"border-stone-700",text:"text-stone-100"}},_e=()=>Math.random().toString(36).slice(2,11),mr=i=>{const c=i.shape==="rectangle"?i.width*1.5:i.width,p=Math.min(c,i.height),d=Math.round(p*.35);return Math.max(18,Math.min(48,d))},Re=i=>i.shape==="rectangle"?i.width*1.5:i.width,er=(i,c)=>{const{width:p,height:d}=dr[c];return{width:i==="rectangle"?p*1.5:p,height:d}},Ue=(i,c)=>{const p=Math.abs(c.x-i.x),d=Math.abs(c.y-i.y);return p>d?{x:c.x,y:i.y}:{x:i.x,y:c.y}},xr=({chair:i,table:c,isSelected:p,onSelect:d,onDrag:se,onDragEnd:a,totalChairsOnSide:D})=>{const ee=mr(c),W=i.size??Math.round(ee*1.3),U=Math.max(10,Math.round(W*.25)),ke=Math.min(W-4,Math.max(20,Math.round(W*.65))),z=Re(c),_=(c.rotation||0)*(Math.PI/180),ue=(()=>{const Ge=(i.position==="top"||i.position==="bottom"?z:c.height)-W*D,me=D>1?Ge/(D+1):Ge/2,xe=me+i.index*(W+me)+W/2;let w=0,P=0;switch(i.position){case"top":w=xe-z/2,P=-(c.height/2+U+W/2);break;case"bottom":w=xe-z/2,P=c.height/2+U+W/2;break;case"left":w=-(z/2+U+W/2),P=xe-c.height/2;break;case"right":w=z/2+U+W/2,P=xe-c.height/2;break}const Z=w*Math.cos(_)-P*Math.sin(_),ye=w*Math.sin(_)+P*Math.cos(_),ve=c.x+z/2,fe=c.y+c.height/2;return{x:ve+Z-W/2,y:fe+ye-W/2}})(),De=()=>{let ae=0;switch(i.position){case"top":ae=0;break;case"right":ae=90;break;case"bottom":ae=180;break;case"left":ae=270;break}return ae+(c.rotation||0)};return e.jsx("div",{className:`absolute cursor-move transition-all duration-150 ${p?"ring-4 ring-amber-400 ring-offset-2":""}`,style:{left:ue.x,top:ue.y,width:W,height:W,transform:`rotate(${De()}deg)`,zIndex:p?100:50,filter:"drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2))"},onMouseDown:ae=>{ae.stopPropagation(),d(),se(ae,i.id)},onMouseUp:a,children:e.jsx("div",{className:"rfp-w-full rfp-h-full bg-gradient-to-br from-amber-500 to-amber-700 rfp-rounded-lg rfp-border-4 border-amber-800 rfp-flex rfp-items-center rfp-justify-center rfp-shadow-xl hover:shadow-2xl hover:scale-105 rfp-transition-all",children:e.jsx(E.Armchair,{size:ke,strokeWidth:3.5,className:"text-amber-50"})})})},wr=({table:i,chairs:c,isSelected:p,onSelect:d,onDrag:se,onDragEnd:a})=>{const D={left:i.x,top:i.y,width:Re(i),height:i.height,zIndex:p?100:50,transform:`rotate(${i.rotation||0}deg)`},ee="w-full h-full flex items-center justify-center relative",W=i.shape==="circle"?`${ee} rounded-full`:i.shape==="hexagon"?`${ee} hexagon-shape`:ee,ke=c.filter(ue=>ue.tableId===i.id).length,z=i.name.match(/\d+/),_=z?z[0]:i.name;return e.jsx("div",{className:`absolute cursor-move transition-all duration-150 ${p?"ring-2 ring-emerald-500 ring-offset-2":""}`,style:D,onMouseDown:ue=>{ue.stopPropagation(),d(),se(ue,i.id)},onClick:ue=>{ue.stopPropagation(),d()},onMouseUp:a,children:e.jsxs("div",{className:W,children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 rounded-[inherit]",style:{background:"linear-gradient(145deg, #059669 0%, #047857 50%, #065f46 100%)",boxShadow:`
              0 8px 16px rgba(0, 0, 0, 0.3),
              0 4px 8px rgba(0, 0, 0, 0.2),
              inset 0 2px 4px rgba(255, 255, 255, 0.2),
              inset 0 -2px 4px rgba(0, 0, 0, 0.2)
            `}}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rounded-[inherit] rfp-opacity-20",style:{background:`
              repeating-linear-gradient(
                90deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.1) 2px,
                rgba(0, 0, 0, 0.1) 4px
              )
            `}}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rounded-[inherit]",style:{border:"3px solid transparent",borderImage:"linear-gradient(145deg, rgba(255,255,255,0.4), rgba(0,0,0,0.2)) 1",pointerEvents:"none"}}),e.jsxs("div",{className:"rfp-relative z-10 rfp-flex rfp-flex-col rfp-items-center rfp-justify-center rfp-gap-1 rfp-text-white rfp-drop-shadow-lg",children:[e.jsxs("span",{className:"rfp-text-xs rfp-font-bold rfp-uppercase rfp-tracking-wide",children:["N: ",_]}),e.jsxs("span",{className:"rfp-text-xs rfp-font-bold rfp-uppercase rfp-tracking-wide",children:["S: ",ke]})]})]})})},br=({object:i,isSelected:c,onSelect:p,onDragStart:d})=>{const se=Je[i.type],a=Qe[i.type],[D,ee]=v.useState(!1),W=U=>{ee(!0),d(U);const ke=()=>{ee(!1),document.removeEventListener("mouseup",ke)};document.addEventListener("mouseup",ke)};return e.jsxs("div",{className:`absolute cursor-move select-none ${D?"":"transition-all duration-75"} ${a.bg} ${a.border} border-2 rounded-lg shadow-lg flex items-center justify-center ${c?"ring-4 ring-blue-400 ring-opacity-50 scale-105":"hover:scale-102"}`,style:{left:`${i.x}px`,top:`${i.y}px`,width:`${i.width}px`,height:`${i.height}px`,transform:`rotate(${i.rotation}deg)`,transformOrigin:"center",willChange:D?"transform":"auto"},onClick:U=>{U.stopPropagation(),p()},onMouseDown:W,children:[e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-items-center rfp-justify-center rfp-gap-2 rfp-pointer-events-none",children:[e.jsx(se,{className:`w-8 h-8 ${a.text}`,strokeWidth:2}),e.jsx("span",{className:`text-sm font-bold ${a.text} uppercase tracking-wide`,children:i.name})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rfp-absolute -top-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-nw-resize"}),e.jsx("div",{className:"rfp-absolute -top-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-ne-resize"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-sw-resize"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-se-resize"})]})]})},rr=({wall:i,isSelected:c,onSelect:p,onDragHandle:d,onDragStart:se})=>{const a=Math.sqrt(Math.pow(i.endX-i.startX,2)+Math.pow(i.endY-i.startY,2)),D=Math.atan2(i.endY-i.startY,i.endX-i.startX)*(180/Math.PI),ee=()=>{if(!c)return"pointer";const z=Math.abs(i.endX-i.startX),_=Math.abs(i.endY-i.startY);return z>_?"ew-resize":"ns-resize"},W=()=>{switch(i.type){case"wall":return"bg-gray-800";case"door":return"bg-amber-600";case"window":return"bg-blue-500"}},U=()=>i.type==="window"?"bg-gradient-to-r from-blue-400 via-blue-300 to-blue-400":i.type==="door"?"":W(),ke=()=>{const z=a*.1,_=(a-z)/2;return e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative",children:[e.jsx("div",{className:"rfp-absolute rfp-left-0 bg-gradient-to-r from-amber-600 to-amber-700 rfp-shadow-md rfp-rounded-sm",style:{width:`${_}px`,height:`${i.thickness}px`,borderTop:"1px solid #fbbf24",borderBottom:"1px solid #78350f",borderRight:"2px solid #92400e"},children:e.jsx("div",{className:"rfp-absolute right-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rfp-rounded-full rfp-shadow-sm"})}),e.jsx("div",{className:"rfp-absolute rfp-bg-transparent",style:{left:`${_}px`,width:`${z}px`,height:`${i.thickness}px`}}),e.jsx("div",{className:"rfp-absolute rfp-right-0 bg-gradient-to-r from-amber-700 to-amber-600 rfp-shadow-md rfp-rounded-sm",style:{width:`${_}px`,height:`${i.thickness}px`,borderTop:"1px solid #fbbf24",borderBottom:"1px solid #78350f",borderLeft:"2px solid #92400e"},children:e.jsx("div",{className:"rfp-absolute left-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rfp-rounded-full rfp-shadow-sm"})})]})};return e.jsxs("div",{onClick:z=>{z.stopPropagation(),p()},onMouseDown:z=>{c&&se&&(z.stopPropagation(),se(z))},className:`absolute transition-all ${c?"ring-4 ring-blue-400 ring-opacity-50 hover:ring-6 hover:ring-blue-300":""}`,style:{left:`${i.startX}px`,top:`${i.startY}px`,width:`${a}px`,height:`${i.thickness}px`,transform:`rotate(${D}deg)`,transformOrigin:"top left",zIndex:10,cursor:c?"move":"pointer",pointerEvents:"auto"},children:[i.type==="door"?ke():e.jsx("div",{className:`w-full h-full ${U()} shadow-lg hover:opacity-90 transition-opacity rounded-sm`,children:c&&e.jsxs("div",{className:"rfp-absolute -top-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30",children:[Ve[i.type]," - ",Math.round(a),"px"]})}),i.type==="door"&&c&&e.jsxs("div",{className:"rfp-absolute -top-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30",children:[Ve[i.type]," - ",Math.round(a),"px"]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rfp-absolute -left-2 top-1/2 transform -translate-y-1/2 rfp-w-5 rfp-h-5 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white hover:bg-blue-600 hover:scale-125 rfp-transition-all rfp-shadow-xl z-30",style:{cursor:ee()},onMouseDown:z=>{z.stopPropagation(),d==null||d(z,"start")},title:"Drag to resize"}),e.jsx("div",{className:"rfp-absolute -right-2 top-1/2 transform -translate-y-1/2 rfp-w-5 rfp-h-5 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white hover:bg-blue-600 hover:scale-125 rfp-transition-all rfp-shadow-xl z-30",style:{cursor:ee()},onMouseDown:z=>{z.stopPropagation(),d==null||d(z,"end")},title:"Drag to resize"})]})]})},ur=({element:i,isSelected:c,onSelect:p,onDragStart:d})=>{const[se,a]=v.useState(!1),D=W=>{a(!0),d(W);const U=()=>{a(!1),document.removeEventListener("mouseup",U)};document.addEventListener("mouseup",U)},ee=()=>i.type==="pillar"?e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative",children:[e.jsxs("div",{className:"rfp-absolute inset-2 bg-gradient-to-br from-gray-400 via-gray-600 to-gray-800 rfp-rounded-full shadow-2xl",children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-full bg-gradient-to-tr from-transparent via-white/10 to-white/20"}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-full shadow-inner",style:{boxShadow:"inset -4px -4px 12px rgba(0,0,0,0.5), inset 4px 4px 12px rgba(255,255,255,0.2)"}})]}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center",children:e.jsx("div",{className:"w-1/3 h-1/3 bg-white/10 rfp-rounded-full blur-sm"})})]}):i.type==="column"?e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative",children:[e.jsxs("div",{className:"rfp-absolute inset-2 bg-gradient-to-br from-slate-400 via-slate-600 to-slate-800 rfp-rounded-lg shadow-2xl",children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-lg bg-gradient-to-br from-white/20 via-transparent to-black/30"}),e.jsx("div",{className:"rfp-absolute rfp-top-0 rfp-left-0 rfp-right-0 rfp-h-1 bg-gradient-to-r from-transparent via-white/30 to-transparent rounded-t-lg"}),e.jsx("div",{className:"rfp-absolute rfp-top-0 rfp-bottom-0 rfp-left-0 rfp-w-1 bg-gradient-to-b from-transparent via-white/30 to-transparent rounded-l-lg"}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-lg",style:{boxShadow:"inset 0 0 20px rgba(0,0,0,0.5)"}})]}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center rfp-pointer-events-none",children:e.jsx("div",{className:"w-0.5 h-2/3 bg-white/20"})})]}):i.type==="stairs"?e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative bg-gradient-to-br from-amber-200 via-amber-300 to-amber-400 rfp-rounded-lg rfp-shadow-xl rfp-overflow-hidden",children:[[0,1,2,3,4,5].map(W=>e.jsxs("div",{className:"rfp-absolute rfp-left-0 rfp-right-0 bg-gradient-to-r from-amber-400 to-amber-500 rfp-border-t border-amber-600",style:{top:`${W*16.66}%`,height:"16.66%",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 bg-gradient-to-b from-white/20 to-transparent h-1/2"}),e.jsx("div",{className:"rfp-absolute rfp-bottom-0 rfp-left-0 rfp-right-0 h-px bg-black/30"})]},W)),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center rfp-pointer-events-none",children:e.jsx("div",{className:"bg-white/80 rfp-rounded-full rfp-p-2 rfp-shadow-lg",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6 text-amber-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 15l7-7 7 7"})})})})]}):null;return e.jsxs("div",{className:`absolute cursor-move select-none ${se?"":"transition-all duration-75"} rounded-lg ${c?"ring-4 ring-blue-400 ring-opacity-50 scale-105":"hover:scale-102"}`,style:{left:`${i.x}px`,top:`${i.y}px`,width:`${i.width}px`,height:`${i.height}px`,transform:`rotate(${i.rotation}deg)`,transformOrigin:"center",willChange:se?"transform":"auto",zIndex:20},onClick:W=>{W.stopPropagation(),p()},onMouseDown:D,children:[ee(),c&&e.jsx("div",{className:"rfp-absolute -bottom-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30",children:i.name}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rfp-absolute -top-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"}),e.jsx("div",{className:"rfp-absolute -top-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"})]})]})},yr=Ke,vr=({floors:i,currentFloor:c,onAddFloor:p,onRemoveFloor:d,onSwitchFloor:se,onRenameFloor:a,onAddTable:D,onAddObject:ee,onStartWallDrawing:W,onAddFixedElement:U,onRotateTable:ke,onDuplicateTable:z,onRemoveTable:_,onSave:ue,onLoad:De,selectedTable:ae,selectedTableChairs:Ge})=>{const[me,xe]=v.useState(null),[w,P]=v.useState(""),[Z,ye]=v.useState("tables"),ve=v.useRef(null);v.useEffect(()=>{me&&ve.current&&(ve.current.focus(),ve.current.select())},[me]);const fe=T=>{xe(T.id),P(T.name)},Me=()=>{me&&w.trim()&&a(me,w.trim()),xe(null),P("")},Ae=T=>{T.key==="Enter"?Me():T.key==="Escape"&&(xe(null),P(""))};return e.jsxs("div",{className:"rfp-w-80 rfp-bg-white rfp-shadow-lg rfp-border-r rfp-border-gray-200 rfp-flex rfp-flex-col",children:[e.jsxs("div",{className:"rfp-p-4 bg-gradient-to-r from-blue-600 to-purple-600 rfp-text-white",children:[e.jsx("h1",{className:"rfp-text-xl rfp-font-bold",children:"Restaurant Designer"}),e.jsx("p",{className:"rfp-text-blue-100 rfp-text-sm",children:"Professional Floor Planner"})]}),e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between rfp-mb-4",children:[e.jsxs("h2",{className:"rfp-text-lg rfp-font-semibold rfp-text-gray-800 rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx(E.Layers,{className:"rfp-w-5 rfp-h-5"}),"Floor Plans (",i.length,")"]}),e.jsxs("div",{className:"rfp-flex rfp-gap-1",children:[e.jsx("button",{onClick:p,className:"rfp-p-2 rfp-text-gray-600 hover:text-green-600 hover:bg-green-50 rfp-rounded-lg transition-colors",title:"Add New Floor",children:e.jsx(E.Plus,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:d,disabled:i.length<=1,className:"rfp-p-2 rfp-text-gray-600 hover:text-red-600 hover:bg-red-50 rfp-rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove Current Floor",children:e.jsx(E.Minus,{className:"rfp-w-4 rfp-h-4"})})]})]}),e.jsx("div",{className:"rfp-space-y-2 rfp-max-h-32 overflow-y-auto",children:i.map(T=>e.jsxs("div",{className:`w-full p-3 rounded-lg transition-all flex items-center justify-between ${T.isActive?"bg-blue-100 text-blue-800 border border-blue-200 shadow-sm":"text-gray-600 hover:bg-gray-100 border border-transparent"}`,onClick:()=>{me!==T.id&&se(T.id)},onDoubleClick:()=>fe(T),children:[e.jsxs("div",{className:"rfp-flex-1",children:[me===T.id?e.jsx("input",{ref:ve,type:"text",value:w,onChange:R=>P(R.target.value),onBlur:Me,onKeyDown:Ae,className:"rfp-w-full rfp-px-2 rfp-py-1 rfp-text-sm rfp-font-medium rfp-bg-white rfp-border rfp-border-blue-400 rfp-rounded focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:R=>R.stopPropagation()}):e.jsx("div",{className:"rfp-font-medium rfp-cursor-pointer",children:T.name}),e.jsxs("div",{className:"rfp-text-xs rfp-text-gray-500 mt-0.5",children:[T.tables.length," tables, ",T.chairs.length," chairs"]})]}),T.isActive&&e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-blue-500 rfp-rounded-full"})]},T.id))})]}),e.jsx("div",{className:"rfp-border-b rfp-border-gray-200",children:e.jsxs("div",{className:"rfp-flex",children:[e.jsxs("button",{onClick:()=>ye("tables"),className:`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${Z==="tables"?"bg-white text-emerald-600 border-b-2 border-emerald-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(E.LayoutGrid,{className:"rfp-w-4 rfp-h-4"}),"Tables"]}),e.jsxs("button",{onClick:()=>ye("objects"),className:`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${Z==="objects"?"bg-white text-purple-600 border-b-2 border-purple-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(E.Package,{className:"rfp-w-4 rfp-h-4"}),"Objects"]}),e.jsxs("button",{onClick:()=>ye("roomLayout"),className:`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${Z==="roomLayout"?"bg-white text-gray-700 border-b-2 border-gray-700":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(E.Home,{className:"rfp-w-4 rfp-h-4"}),"Room"]})]})}),Z==="tables"&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Add Tables"}),e.jsx("div",{className:"rfp-grid grid-cols-2 rfp-gap-3",children:Object.entries(fr).map(([T,R])=>e.jsxs("button",{onClick:()=>D(T),className:"rfp-p-3 rfp-border-2 rfp-border-gray-200 rfp-rounded-lg hover:border-emerald-400 hover:bg-emerald-50 rfp-transition-all rfp-flex rfp-flex-col rfp-items-center rfp-gap-2 hover:shadow-md",children:[e.jsx(R,{className:"rfp-w-6 rfp-h-6 text-emerald-600"}),e.jsx("span",{className:"rfp-text-xs rfp-text-gray-700 rfp-capitalize rfp-font-medium",children:T})]},T))})]}),Z==="objects"&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Add Objects"}),e.jsx("div",{className:"rfp-space-y-3",children:Object.keys(qe).map(T=>{const R=Je[T],Ne=Qe[T],ie=qe[T];return e.jsxs("button",{onClick:()=>ee(T),className:`w-full p-4 ${Ne.bg} border-2 ${Ne.border} rounded-xl hover:scale-105 transition-all flex items-center gap-3 shadow-lg hover:shadow-xl`,children:[e.jsx("div",{className:"bg-white/20 rfp-p-2 rfp-rounded-lg",children:e.jsx(R,{className:`w-6 h-6 ${Ne.text}`,strokeWidth:2.5})}),e.jsxs("div",{className:"rfp-flex-1 rfp-text-left",children:[e.jsx("span",{className:`text-base font-bold ${Ne.text}`,children:ie}),e.jsx("div",{className:"rfp-text-xs text-white/80 mt-0.5",children:"Click to add to floor"})]})]},T)})})]}),Z==="roomLayout"&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-mb-6",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Draw Walls"}),e.jsx("div",{className:"rfp-space-y-2",children:["wall","door","window"].map(T=>{const R=cr[T],Ne=Ve[T],ie={wall:"bg-gradient-to-br from-gray-600 to-gray-800 border-gray-700 text-white hover:from-gray-700 hover:to-gray-900",door:"bg-gradient-to-br from-amber-500 to-amber-700 border-amber-600 text-white hover:from-amber-600 hover:to-amber-800",window:"bg-gradient-to-br from-blue-500 to-blue-700 border-blue-600 text-white hover:from-blue-600 hover:to-blue-800"};return e.jsxs("button",{onClick:()=>W(T),className:`w-full p-3 border-2 rounded-lg transition-all flex items-center gap-3 shadow-md hover:shadow-lg ${ie[T]}`,children:[e.jsx(R,{className:"rfp-w-5 rfp-h-5",strokeWidth:2.5}),e.jsx("span",{className:"rfp-text-sm rfp-font-semibold",children:Ne})]},T)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Add Elements"}),e.jsx("div",{className:"rfp-space-y-2",children:["pillar","column","stairs"].map(T=>{const R=hr[T],Ne=gr[T],ie=je[T];return e.jsxs("button",{onClick:()=>U(T),className:`w-full p-3 ${Ne.bg} border-2 ${Ne.border} rounded-lg hover:scale-105 transition-all flex items-center gap-3 shadow-md hover:shadow-lg`,children:[e.jsx("div",{className:"bg-white/10 p-1.5 rfp-rounded",children:e.jsx(R,{className:`w-5 h-5 ${Ne.text}`,strokeWidth:2.5})}),e.jsx("span",{className:`text-sm font-semibold ${Ne.text}`,children:ie})]},T)})})]})]}),ae&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between rfp-mb-3",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800",children:"Table Properties"}),e.jsxs("div",{className:"rfp-flex rfp-gap-1",children:[e.jsx("button",{onClick:ke,className:"rfp-p-1 rfp-text-blue-600 hover:bg-blue-100 rfp-rounded transition-colors",title:"Rotate Table",children:e.jsx(E.RotateCw,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:z,className:"rfp-p-1 rfp-text-green-600 hover:bg-green-100 rfp-rounded transition-colors",title:"Duplicate Table",children:e.jsx(E.Plus,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:_,className:"rfp-p-1 rfp-text-red-600 hover:bg-red-100 rfp-rounded transition-colors",title:"Delete Table",children:e.jsx(E.Trash2,{className:"rfp-w-4 rfp-h-4"})})]})]}),e.jsxs("div",{className:"rfp-space-y-3 rfp-text-sm rfp-text-gray-600",children:[e.jsxs("div",{className:"rfp-grid grid-cols-2 rfp-gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Name"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800",children:ae.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Shape"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800 rfp-capitalize",children:ae.shape})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Size"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800",children:yr[ae.size]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Seats"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800",children:Ge.length})]})]}),e.jsx("div",{className:"rfp-bg-blue-50 rfp-border rfp-border-blue-200 rfp-rounded-md rfp-p-3",children:e.jsxs("p",{className:"rfp-text-xs rfp-text-blue-700",children:["ðŸ’¡ ",e.jsx("span",{className:"rfp-font-semibold",children:"Tip:"})," Use the ",e.jsx("span",{className:"rfp-font-semibold",children:"Manage Chairs"})," button in the toolbar above to add or remove chairs from each side of the table."]})})]})]}),e.jsxs("div",{className:"rfp-p-4 mt-auto rfp-space-y-3",children:[e.jsxs("div",{className:"rfp-bg-gray-50 rfp-p-3 rfp-rounded-lg",children:[e.jsx("h4",{className:"rfp-text-sm rfp-font-semibold rfp-text-gray-700 rfp-mb-2",children:"Current Floor Stats"}),e.jsxs("div",{className:"rfp-grid grid-cols-2 rfp-gap-4 rfp-text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-gray-600",children:"Tables"}),e.jsx("div",{className:"rfp-font-bold rfp-text-lg text-emerald-600",children:(c==null?void 0:c.tables.length)??0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-gray-600",children:"Total Seats"}),e.jsx("div",{className:"rfp-font-bold rfp-text-lg text-amber-600",children:(c==null?void 0:c.chairs.length)??0})]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-gap-2",children:[e.jsxs("button",{onClick:ue,className:"rfp-flex-1 rfp-bg-green-600 rfp-text-white rfp-py-3 rfp-px-4 rfp-rounded-lg hover:bg-green-700 transition-colors rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-medium",children:[e.jsx(E.Save,{className:"rfp-w-4 rfp-h-4"}),"Save"]}),e.jsxs("button",{onClick:De,className:"rfp-flex-1 rfp-bg-blue-600 rfp-text-white rfp-py-3 rfp-px-4 rfp-rounded-lg hover:bg-blue-700 transition-colors rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-medium",children:[e.jsx(E.Upload,{className:"rfp-w-4 rfp-h-4"}),"Load"]})]})]})]})},tr=Ke,Mr=["top","right","bottom","left"],Nr=["small","medium","large"],Sr=({showGrid:i,selectedTable:c,selectedObject:p,selectedWall:d,selectedFixedElement:se,selectedTableChairs:a,onToggleGrid:D,onAddChair:ee,onRemoveChair:W,onChangeTableSize:U,onTableNameChange:ke,onCustomTableSize:z,onObjectNameChange:_,onObjectResize:ue,onRemoveObject:De,onRemoveWall:ae,onRemoveFixedElement:Ge,onChangeWallThickness:me,onConvertWallType:xe,onFixedElementNameChange:w,onFixedElementResize:P,onChairSizeChange:Z,onResetChairSizes:ye,on3DPreview:ve,onObjectRotate:fe,tableCount:Me,chairCount:Ae,objectCount:T,wallCount:R,fixedElementCount:Ne,selectedElementType:ie})=>{const ne=v.useRef(null),t=v.useRef(null),$=v.useRef(null),q=v.useRef(null),[C,l]=v.useState(!1),[I,h]=v.useState(!1),[X,H]=v.useState(!1),[G,oe]=v.useState(!1),[V,ce]=v.useState(!1),[K,B]=v.useState(90),[k,L]=v.useState(90),[u,re]=v.useState(120),[Q,Ee]=v.useState(80),[F,N]=v.useState(60),[m,he]=v.useState(60);return v.useEffect(()=>{const g=M=>{ne.current&&!ne.current.contains(M.target)&&l(!1),t.current&&!t.current.contains(M.target)&&h(!1),$.current&&!$.current.contains(M.target)&&H(!1),q.current&&!q.current.contains(M.target)&&oe(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]),v.useEffect(()=>{c?(B(c.width),L(c.height)):(l(!1),h(!1),ce(!1)),p?(re(p.width),Ee(p.height)):H(!1),se?(N(se.width),he(se.height)):oe(!1)},[c,p,se]),e.jsx("div",{className:"rfp-bg-white rfp-border-b rfp-border-gray-200 rfp-shadow-sm min-h-[72px]",children:e.jsxs("div",{className:"rfp-px-4 rfp-py-3 rfp-flex rfp-items-center rfp-justify-between min-h-[72px]",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3 rfp-flex-wrap",children:[e.jsxs("button",{onClick:D,className:`px-3 py-2 rounded-lg transition-all flex items-center gap-2 text-sm font-medium ${i?"bg-blue-500 text-white shadow-md hover:bg-blue-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:i?"Hide Grid":"Show Grid",children:[i?e.jsx(E.Eye,{className:"rfp-w-4 rfp-h-4"}):e.jsx(E.EyeOff,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Grid"})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),e.jsxs("div",{ref:ne,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>{l(!C),h(!1)},className:"rfp-px-3 rfp-py-2 rfp-rounded-lg bg-gradient-to-r from-amber-500 to-amber-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",children:[e.jsx(E.Armchair,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Manage Chairs"}),e.jsx("span",{className:"rfp-ml-1 px-1.5 py-0.5 bg-white/20 rfp-rounded rfp-text-xs",children:a.length})]}),C&&e.jsxs("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-72 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-500 to-amber-600 rfp-px-4 rfp-py-3 rfp-text-white",children:e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx(E.Armchair,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{className:"rfp-font-semibold rfp-text-sm",children:"Chair Positions"})]}),e.jsxs("span",{className:"rfp-text-xs bg-white/20 rfp-px-2 rfp-py-1 rfp-rounded",children:["Total: ",a.length]})]})}),e.jsxs("div",{className:"rfp-p-3 rfp-space-y-2",children:[Mr.map(g=>{const M=a.filter(b=>b.position===g).length,Se=a.find(b=>b.position===g),Y=(Se==null?void 0:Se.size)||40;return e.jsxs("div",{className:"rfp-bg-gray-50 rfp-rounded-lg rfp-px-3 rfp-py-2 rfp-border rfp-border-gray-200 hover:border-amber-300 rfp-transition-all rfp-space-y-2",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3",children:[e.jsx("div",{className:"rfp-w-8 rfp-h-8 bg-gradient-to-br from-gray-600 to-gray-700 rfp-rounded-md rfp-flex rfp-items-center rfp-justify-center rfp-text-white rfp-text-xs rfp-font-bold rfp-uppercase",children:g[0]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-sm rfp-font-medium rfp-text-gray-800 rfp-capitalize",children:g}),e.jsxs("div",{className:"rfp-text-xs rfp-text-gray-500",children:[M," chair",M!==1?"s":""]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-1",children:[e.jsx("button",{onClick:()=>W(g),disabled:M===0,className:"rfp-w-7 rfp-h-7 rfp-rounded-md rfp-bg-red-50 rfp-text-red-600 hover:bg-red-100 disabled:opacity-30 disabled:cursor-not-allowed rfp-transition-all rfp-flex rfp-items-center rfp-justify-center",title:"Remove chair",children:e.jsx(E.Minus,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:()=>ee(g),className:"rfp-w-7 rfp-h-7 rfp-rounded-md rfp-bg-green-50 rfp-text-green-600 hover:bg-green-100 rfp-transition-all rfp-flex rfp-items-center rfp-justify-center",title:"Add chair",children:e.jsx(E.Plus,{className:"rfp-w-4 rfp-h-4"})})]})]}),M>0&&e.jsxs("div",{className:"rfp-pt-2 rfp-border-t rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between rfp-mb-1",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-medium rfp-text-gray-600",children:"Chair Size"}),e.jsxs("span",{className:"rfp-text-xs rfp-font-bold text-amber-600",children:[Y,"px"]})]}),e.jsx("input",{type:"range",min:"20",max:"60",value:Y,onChange:b=>Z==null?void 0:Z(g,parseInt(b.target.value)),className:"rfp-w-full rfp-h-2 bg-gradient-to-r from-amber-200 to-amber-400 rfp-rounded-full appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, rgb(251, 191, 36) 0%, rgb(251, 191, 36) ${(Y-20)/40*100}%, rgb(253, 230, 138) ${(Y-20)/40*100}%, rgb(253, 230, 138) 100%)`}})]})]},g)}),e.jsxs("button",{onClick:()=>ye==null?void 0:ye(),className:"rfp-w-full rfp-mt-3 rfp-px-3 rfp-py-2 bg-gradient-to-r from-gray-500 to-gray-600 rfp-text-white rfp-rounded-lg hover:from-gray-600 hover:to-gray-700 rfp-transition-all rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-text-sm rfp-font-medium",children:[e.jsx(E.RotateCcw,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Reset All Sizes"})]})]})]})]}),e.jsxs("div",{ref:t,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>{h(!I),l(!1)},className:"rfp-px-3 rfp-py-2 rfp-rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",children:[e.jsx(E.Square,{className:"rfp-w-4 rfp-h-4"}),e.jsxs("span",{children:["Size: ",tr[c.size]]})]}),I&&e.jsxs("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-64 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 rfp-px-4 rfp-py-2 rfp-text-white",children:e.jsx("span",{className:"rfp-font-semibold rfp-text-sm",children:"Table Size"})}),e.jsxs("div",{className:"rfp-p-3 rfp-space-y-2",children:[e.jsx("div",{className:"rfp-flex rfp-gap-2",children:Nr.map(g=>{const M=c.size===g;return e.jsx("button",{onClick:()=>{U(g),ce(!1)},className:`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-all ${M&&!V?"bg-emerald-500 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:tr[g]},g)})}),e.jsxs("button",{onClick:()=>ce(!V),className:`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-all ${V?"bg-purple-500 text-white shadow-sm":"bg-gradient-to-r from-purple-100 to-purple-50 text-purple-700 hover:from-purple-200 hover:to-purple-100"}`,children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("span",{className:"rfp-text-sm rfp-font-semibold",children:"Pro Mode"}),e.jsx("span",{className:"rfp-text-xs bg-white/20 px-1.5 py-0.5 rfp-rounded",children:"Custom"})]}),e.jsx(E.ChevronRight,{className:`w-4 h-4 transition-transform ${V?"rotate-90":""}`})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${V?"max-h-48 opacity-100":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"rfp-pt-2 rfp-space-y-3 rfp-border-t rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Width"}),e.jsxs("span",{className:"rfp-text-xs font-mono rfp-bg-purple-100 rfp-text-purple-700 rfp-px-2 py-0.5 rfp-rounded",children:[K,"px"]})]}),e.jsx("input",{type:"range",min:"40",max:"200",step:"5",value:K,onChange:g=>{const M=parseInt(g.target.value);B(M),z(M,k)},className:"rfp-w-full rfp-h-2 rfp-bg-purple-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${(K-40)/160*100}%, rgb(233, 213, 255) ${(K-40)/160*100}%, rgb(233, 213, 255) 100%)`}})]}),e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Height"}),e.jsxs("span",{className:"rfp-text-xs font-mono rfp-bg-purple-100 rfp-text-purple-700 rfp-px-2 py-0.5 rfp-rounded",children:[k,"px"]})]}),e.jsx("input",{type:"range",min:"40",max:"200",step:"5",value:k,onChange:g=>{const M=parseInt(g.target.value);L(M),z(K,M)},className:"rfp-w-full rfp-h-2 rfp-bg-purple-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${(k-40)/160*100}%, rgb(233, 213, 255) ${(k-40)/160*100}%, rgb(233, 213, 255) 100%)`}})]}),e.jsx("p",{className:"rfp-text-xs rfp-text-gray-500 italic rfp-pt-1",children:"Drag sliders for precise sizing"})]})})]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:"Name:"}),e.jsx("input",{type:"text",value:c.name,onChange:g=>ke(g.target.value),className:"rfp-bg-transparent rfp-text-sm rfp-text-gray-800 rfp-font-medium focus:outline-none rfp-w-32",placeholder:"Table name"})]})]}),p&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),e.jsxs("div",{ref:$,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>H(!X),className:`px-3 py-2 rounded-lg ${p.type==="bar"?"bg-gradient-to-r from-purple-500 to-purple-600":p.type==="kitchen"?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gradient-to-r from-cyan-500 to-cyan-600"} text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`,children:[(()=>{const g=Je[p.type];return e.jsx(g,{className:"rfp-w-4 rfp-h-4"})})(),e.jsxs("span",{children:["Resize ",qe[p.type]]})]}),X&&e.jsxs("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-64 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden",children:[e.jsx("div",{className:`${p.type==="bar"?"bg-gradient-to-r from-purple-500 to-purple-600":p.type==="kitchen"?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gradient-to-r from-cyan-500 to-cyan-600"} px-4 py-2 text-white`,children:e.jsx("span",{className:"rfp-font-semibold rfp-text-sm",children:"Custom Size"})}),e.jsxs("div",{className:"rfp-p-3 rfp-space-y-3",children:[e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Width"}),e.jsxs("span",{className:`text-xs font-mono px-2 py-0.5 rounded ${p.type==="bar"?"bg-purple-100 text-purple-700":p.type==="kitchen"?"bg-orange-100 text-orange-700":"bg-cyan-100 text-cyan-700"}`,children:[u,"px"]})]}),e.jsx("input",{type:"range",min:"60",max:"1000",step:"10",value:u,onChange:g=>{const M=parseInt(g.target.value);re(M),ue(M,Q)},className:"rfp-w-full rfp-h-2 rfp-bg-gray-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, ${p.type==="bar"?"rgb(168, 85, 247)":p.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} 0%, ${p.type==="bar"?"rgb(168, 85, 247)":p.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} ${(u-60)/940*100}%, rgb(229, 231, 235) ${(u-60)/940*100}%, rgb(229, 231, 235) 100%)`}})]}),e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Height"}),e.jsxs("span",{className:`text-xs font-mono px-2 py-0.5 rounded ${p.type==="bar"?"bg-purple-100 text-purple-700":p.type==="kitchen"?"bg-orange-100 text-orange-700":"bg-cyan-100 text-cyan-700"}`,children:[Q,"px"]})]}),e.jsx("input",{type:"range",min:"60",max:"1000",step:"10",value:Q,onChange:g=>{const M=parseInt(g.target.value);Ee(M),ue(u,M)},className:"rfp-w-full rfp-h-2 rfp-bg-gray-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, ${p.type==="bar"?"rgb(168, 85, 247)":p.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} 0%, ${p.type==="bar"?"rgb(168, 85, 247)":p.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} ${(Q-60)/940*100}%, rgb(229, 231, 235) ${(Q-60)/940*100}%, rgb(229, 231, 235) 100%)`}})]}),e.jsx("p",{className:"rfp-text-xs rfp-text-gray-500 italic rfp-pt-1",children:"Drag sliders to resize the object"})]})]})]}),e.jsxs("button",{onClick:()=>{const g=((p.rotation||0)+90)%360;fe==null||fe(g)},className:`px-3 py-2 rounded-lg ${p.type==="bar"?"bg-gradient-to-r from-purple-600 to-purple-700":p.type==="kitchen"?"bg-gradient-to-r from-orange-600 to-orange-700":"bg-gradient-to-r from-cyan-600 to-cyan-700"} text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`,title:"Rotate 90Â°",children:[e.jsx(E.RotateCcw,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Rotate"})]}),e.jsxs("button",{onClick:De,className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",title:"Delete Object",children:[e.jsx(E.Trash2,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Delete"})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:"Name:"}),e.jsx("input",{type:"text",value:p.name,onChange:g=>_(g.target.value),className:"rfp-bg-transparent rfp-text-sm rfp-text-gray-800 rfp-font-medium focus:outline-none rfp-w-32",placeholder:"Object name"})]})]}),d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),xe&&e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-1 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-p-1",children:[e.jsx("button",{onClick:()=>xe("wall"),className:`px-3 py-1.5 rounded text-xs font-semibold transition-all ${d.type==="wall"?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:bg-gray-200"}`,title:"Convert to Wall",children:"Wall"}),e.jsx("button",{onClick:()=>xe("door"),className:`px-3 py-1.5 rounded text-xs font-semibold transition-all ${d.type==="door"?"bg-amber-600 text-white shadow-md":"text-gray-600 hover:bg-gray-200"}`,title:"Convert to Door",children:"Door"}),e.jsx("button",{onClick:()=>xe("window"),className:`px-3 py-1.5 rounded text-xs font-semibold transition-all ${d.type==="window"?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:bg-gray-200"}`,title:"Convert to Window",children:"Window"})]}),me&&e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600",children:"Thickness:"}),e.jsxs("select",{value:d.thickness,onChange:g=>me(Number(g.target.value)),className:"rfp-px-2 rfp-py-1 rfp-text-sm rfp-border rfp-border-gray-300 rfp-rounded rfp-bg-white hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:4,children:"Thin (4px)"}),e.jsx("option",{value:8,children:"Normal (8px)"}),e.jsx("option",{value:12,children:"Thick (12px)"}),e.jsx("option",{value:16,children:"Very Thick (16px)"})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:Ve[d.type]}),e.jsxs("span",{className:"rfp-text-sm rfp-text-gray-600",children:[Math.round(Math.sqrt(Math.pow(d.endX-d.startX,2)+Math.pow(d.endY-d.startY,2))),"px"]})]}),e.jsxs("button",{onClick:ae,className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",title:"Delete Wall",children:[e.jsx(E.Trash2,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Delete"})]})]}),se&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),e.jsx("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:je[se.type]})}),P&&e.jsxs("div",{ref:q,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>oe(!G),className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-gray-600 hover:bg-gray-700 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",children:[e.jsx(E.Square,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Resize"})]}),G&&e.jsx("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-bg-white rfp-rounded-xl shadow-2xl rfp-border rfp-border-gray-200 rfp-p-4 z-50 min-w-[320px]",children:e.jsxs("div",{className:"rfp-space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-items-center rfp-mb-2",children:[e.jsx("label",{className:"rfp-text-sm rfp-font-semibold rfp-text-gray-700",children:"Width"}),e.jsxs("span",{className:"rfp-text-sm rfp-font-bold rfp-text-blue-600",children:[F,"px"]})]}),e.jsx("input",{type:"range",min:"30",max:"200",value:F,onChange:g=>{const M=parseInt(g.target.value);N(M),P(M,m)},className:"rfp-w-full rfp-h-2 bg-gradient-to-r from-blue-200 to-blue-500 rfp-rounded-lg appearance-none rfp-cursor-pointer slider"}),e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-text-xs rfp-text-gray-500 rfp-mt-1",children:[e.jsx("span",{children:"30px"}),e.jsx("span",{children:"200px"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-items-center rfp-mb-2",children:[e.jsx("label",{className:"rfp-text-sm rfp-font-semibold rfp-text-gray-700",children:"Height"}),e.jsxs("span",{className:"rfp-text-sm rfp-font-bold rfp-text-blue-600",children:[m,"px"]})]}),e.jsx("input",{type:"range",min:"30",max:"200",value:m,onChange:g=>{const M=parseInt(g.target.value);he(M),P(F,M)},className:"rfp-w-full rfp-h-2 bg-gradient-to-r from-green-200 to-green-500 rfp-rounded-lg appearance-none rfp-cursor-pointer slider"}),e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-text-xs rfp-text-gray-500 rfp-mt-1",children:[e.jsx("span",{children:"30px"}),e.jsx("span",{children:"200px"})]})]}),e.jsx("div",{className:"rfp-pt-3 rfp-border-t rfp-border-gray-200",children:e.jsxs("div",{className:"rfp-text-center",children:[e.jsx("span",{className:"rfp-text-xs rfp-text-gray-600",children:"Current Size: "}),e.jsxs("span",{className:"rfp-text-sm rfp-font-bold rfp-text-gray-800",children:[F," Ã— ",m,"px"]})]})})]})})]}),e.jsxs("button",{onClick:Ge,className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",title:"Delete Element",children:[e.jsx(E.Trash2,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Delete"})]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3 rfp-flex-wrap",children:[e.jsxs("button",{onClick:ve,className:"rfp-px-4 rfp-py-2 bg-gradient-to-r from-purple-600 to-blue-600 rfp-text-white rfp-rounded-lg hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-font-semibold rfp-text-sm",children:[e.jsx(E.Box,{className:"rfp-w-4 rfp-h-4"}),"3D"]}),e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 bg-emerald-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-emerald-600 rfp-rounded-full"}),e.jsxs("span",{className:"rfp-font-medium text-emerald-800",children:["Tables: ",Me]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 bg-amber-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-amber-600 rfp-rounded-full"}),e.jsxs("span",{className:"rfp-font-medium text-amber-800",children:["Chairs: ",Ae]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 rfp-bg-purple-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-purple-600 rfp-rounded-full"}),e.jsxs("span",{className:"rfp-font-medium rfp-text-purple-800",children:["Objects: ",T]})]}),ie&&e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 rfp-bg-blue-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"w-1.5 h-1.5 rfp-bg-blue-600 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-font-medium rfp-text-blue-800 rfp-capitalize",children:["Selected: ",ie]})]})]})]})})},sr={default:{position:{x:1050,y:800,z:1050},target:{x:0,y:100,z:0},name:"Default",icon:"ðŸ "},top:{position:{x:0,y:1200,z:1},target:{x:0,y:0,z:0},name:"Top View",icon:"â¬‡"},front:{position:{x:0,y:300,z:1e3},target:{x:0,y:100,z:0},name:"Front",icon:"â¬†"},side:{position:{x:1e3,y:300,z:0},target:{x:0,y:100,z:0},name:"Side",icon:"âž¡"},corner:{position:{x:-900,y:700,z:-900},target:{x:0,y:100,z:0},name:"Corner",icon:"â†–"}},ar=({floor:i,isOpen:c,onClose:p})=>{const d=v.useRef(null),se=v.useRef(null),a=v.useRef(null),D=v.useRef(null),ee=v.useRef(null),[W,U]=v.useState(!1),[ke,z]=v.useState("default"),[_,ue]=v.useState(!1),De=v.useRef(.003),ae=v.useRef(null),Ge=w=>{if(!a.current||_)return;const P=sr[w],Z=a.current;ae.current={startPos:Z.position.clone(),endPos:new r.Vector3(P.position.x,P.position.y,P.position.z),startTarget:new r.Vector3(0,100,0),endTarget:new r.Vector3(P.target.x,P.target.y,P.target.z),progress:0},ue(!0),z(w),U(!1)},me=w=>{if(!a.current||_)return;const P=a.current,Z=Math.sqrt(P.position.x**2+P.position.z**2),ye=Math.atan2(P.position.z,P.position.x);switch(w){case"left":const ve=ye+.2;P.position.x=Z*Math.cos(ve),P.position.z=Z*Math.sin(ve);break;case"right":const fe=ye-.2;P.position.x=Z*Math.cos(fe),P.position.z=Z*Math.sin(fe);break;case"up":P.position.y=Math.min(P.position.y+50,900);break;case"down":P.position.y=Math.max(P.position.y-50,100);break}P.lookAt(0,100,0)},xe=w=>{!a.current||_||(a.current.position.multiplyScalar(w),a.current.lookAt(0,100,0))};return v.useEffect(()=>{if(!c||!d.current)return;const w=new r.Scene;w.background=new r.Color(14608111),se.current=w;const P=new r.PerspectiveCamera(45,d.current.clientWidth/d.current.clientHeight,.1,1e4);P.position.set(1050,800,1050),P.lookAt(0,100,0),a.current=P;const Z=new r.WebGLRenderer({antialias:!0,alpha:!0});Z.setSize(d.current.clientWidth,d.current.clientHeight),Z.shadowMap.enabled=!0,Z.shadowMap.type=r.PCFSoftShadowMap,Z.toneMapping=r.ACESFilmicToneMapping,Z.toneMappingExposure=1.2,d.current.appendChild(Z.domElement),D.current=Z;const ye=new r.PMREMGenerator(Z),ve=new r.Scene;ve.background=new r.Color(16777215);const fe=ye.fromScene(ve).texture;w.environment=fe,ye.dispose(),w.add(new r.AmbientLight(16777215,.6));const Me=new r.DirectionalLight(16777215,.8);Me.position.set(400,600,300),Me.castShadow=!0,Me.shadow.mapSize.width=4096,Me.shadow.mapSize.height=4096,Me.shadow.camera.left=Me.shadow.camera.bottom=-700,Me.shadow.camera.right=Me.shadow.camera.top=700,Me.shadow.bias=-1e-4,w.add(Me);const Ae=new r.DirectionalLight(16777215,.3);Ae.position.set(-400,400,-300),w.add(Ae);const T=new r.DirectionalLight(16777215,.2);T.position.set(0,300,-500),w.add(T);const R=new r.Mesh(new r.PlaneGeometry(1200,1200),new r.MeshStandardMaterial({color:13684949,roughness:.8,metalness:.2}));R.rotation.x=-Math.PI/2,R.receiveShadow=!0,w.add(R);const Ne=new r.GridHelper(3e3,150,10526888,12105920);Ne.position.y=1,w.add(Ne),i.walls.forEach(t=>{const $=Math.sqrt(Math.pow(t.endX-t.startX,2)+Math.pow(t.endY-t.startY,2)),q=Math.atan2(t.endY-t.startY,t.endX-t.startX),C=t.type==="window"?80:120,l=t.startX+(t.endX-t.startX)/2-400,I=-(t.startY+(t.endY-t.startY)/2-400);if(t.type==="door"){const h=new r.Group,X=$,H=C,G=t.thickness*.8,oe=new r.MeshStandardMaterial({color:3812901,roughness:.9,metalness:0}),V=8,ce=new r.Mesh(new r.BoxGeometry(X,V,t.thickness+4),oe);ce.position.y=H/2-V/2,h.add(ce);const K=new r.Mesh(new r.BoxGeometry(X,V,t.thickness+4),oe);K.position.y=-H/2+V/2,h.add(K);const B=new r.Mesh(new r.BoxGeometry(V,H,t.thickness+4),oe);B.position.x=-X/2+V/2,h.add(B);const k=B.clone();k.position.x=X/2-V/2,h.add(k);const L=new r.MeshStandardMaterial({color:5125166,roughness:.85,metalness:0}),u=new r.MeshStandardMaterial({color:10400693,transparent:!0,opacity:.5,roughness:.95,metalness:0}),re=(X-V*2-4)/2,Q=H-V*2-4,Ee=ze=>{const Pe=new r.Group,le=new r.Mesh(new r.BoxGeometry(re,Q,G),L);Pe.add(le);const pe=new r.Mesh(new r.PlaneGeometry(re*.8,Q*.85),u);pe.position.set(0,0,G/2+.1),Pe.add(pe);const Ze=new r.MeshStandardMaterial({color:8947848,metalness:.4,roughness:.7}),x=new r.Mesh(new r.CylinderGeometry(.6,.6,12,12),Ze);return x.rotation.z=Math.PI/2,x.position.set(ze>0?-re*.35:re*.35,0,G/2+1.5),Pe.add(x),Pe.position.x=ze,Pe},F=Ee(-re/2),N=Ee(re/2);h.add(F),h.add(N);const m=14,he=new r.PlaneGeometry(X*.9,m),g=document.createElement("canvas");g.width=512,g.height=128;const M=g.getContext("2d");M&&(M.fillStyle="#3a2e25",M.fillRect(0,0,g.width,g.height),M.font="bold 60px Arial",M.fillStyle="#f5d590",M.textAlign="center",M.textBaseline="middle",M.fillText("WELCOME",g.width/2,g.height/2));const Se=new r.CanvasTexture(g),Y=new r.MeshStandardMaterial({map:Se,roughness:.8,metalness:.1}),b=new r.Mesh(he,Y);b.position.set(0,H/2-V-m/2-4,t.thickness/2+2),h.add(b),h.position.set(l,H/2,I),h.rotation.y=-q,h.castShadow=!0,h.receiveShadow=!0,w.add(h)}else if(t.type==="window"){const h=$>20?$:120,X=C,H=X*.45,G=X*.65,oe=X*.1,V=X*.3,ce=new r.MeshStandardMaterial({color:13158608,roughness:.85,metalness:.05}),K=new r.MeshPhysicalMaterial({color:2763306,metalness:.95,roughness:.2,clearcoat:.8,clearcoatRoughness:.1}),B=new r.MeshPhysicalMaterial({color:15135487,transparent:!0,opacity:.4,transmission:.85,thickness:1.5,roughness:.05,metalness:.05,ior:1.52,envMapIntensity:1,clearcoat:.8,clearcoatRoughness:.1,reflectivity:.5}),k=new r.Mesh(new r.BoxGeometry(h,H,t.thickness),ce);k.position.set(l,H/2,I),k.rotation.y=-q,k.receiveShadow=!0,k.castShadow=!0,w.add(k);const L=H+G/2,u=4,re=Math.max(2,Math.floor(h/80)),Q=(h-u*(re+1))/re;for(let g=0;g<re;g++){const M=-h/2+u+Q/2+g*(Q+u),Se=l+M*Math.cos(-q),Y=I+M*Math.sin(-q),b=new r.Mesh(new r.BoxGeometry(Q-2,G-u*2,1),B);if(b.position.set(Se,L,Y),b.rotation.y=-q,b.castShadow=!1,b.receiveShadow=!1,w.add(b),g<re-1){const ze=-h/2+u+(g+1)*Q+(g+.5)*u,Pe=l+ze*Math.cos(-q),le=I+ze*Math.sin(-q),pe=new r.Mesh(new r.BoxGeometry(u,G,t.thickness+3),K);pe.position.set(Pe,L,le),pe.rotation.y=-q,pe.castShadow=!0,w.add(pe)}}const Ee=H+G+oe/2,F=new r.Mesh(new r.BoxGeometry(h-u*2,oe-u,1),B);F.position.set(l,Ee,I),F.rotation.y=-q,F.castShadow=!1,w.add(F);const N=new r.Mesh(new r.BoxGeometry(h,u,t.thickness+2),K);N.position.set(l,H+G+u/2,I),N.rotation.y=-q,N.castShadow=!0,w.add(N);const m=new r.Mesh(new r.BoxGeometry(h,u,t.thickness+2),K);m.position.set(l,H+G+oe+u/2,I),m.rotation.y=-q,m.castShadow=!0,w.add(m);const he=new r.Mesh(new r.BoxGeometry(h,V,t.thickness),ce);he.position.set(l,H+G+oe+V/2,I),he.rotation.y=-q,he.castShadow=!0,he.receiveShadow=!0,w.add(he)}else{const h=new r.Mesh(new r.BoxGeometry($,C,t.thickness),new r.MeshStandardMaterial({color:12105920,roughness:.9,metalness:.05}));h.position.set(l,C/2,I),h.rotation.y=-q,h.castShadow=!0,h.receiveShadow=!0,w.add(h)}}),i.fixedElements.forEach(t=>{const $=t.x-400+t.width/2,q=-(t.y-400+t.height/2);if(t.type==="pillar"){const C=Math.min(t.width,t.height)/2,l=new r.Mesh(new r.CylinderGeometry(C,C*1.1,140,32),new r.MeshStandardMaterial({color:4868698,roughness:.6,metalness:.4}));l.position.set($,70,q),l.castShadow=!0,w.add(l);const I=new r.Mesh(new r.CylinderGeometry(C*1.3,C*1.1,10,32),new r.MeshStandardMaterial({color:5921386,roughness:.5,metalness:.5}));I.position.set($,135,q),I.castShadow=!0,w.add(I);const h=new r.Mesh(new r.CylinderGeometry(C*1.2,C*1.3,10,32),new r.MeshStandardMaterial({color:5921386,roughness:.5,metalness:.5}));h.position.set($,5,q),h.castShadow=!0,w.add(h)}else if(t.type==="column"){const C=new r.Mesh(new r.BoxGeometry(t.width,140,t.height),new r.MeshStandardMaterial({color:3816010,roughness:.7,metalness:.3}));C.position.set($,70,q),C.castShadow=!0,w.add(C);const l=new r.LineSegments(new r.EdgesGeometry(C.geometry),new r.LineBasicMaterial({color:6974074}));l.position.copy(C.position),w.add(l)}else{const I=t.height/8;for(let h=0;h<8;h++){const X=new r.Mesh(new r.BoxGeometry(t.width,6.25,I*(8-h)),new r.MeshStandardMaterial({color:6636321,roughness:.8}));X.position.set($,6.25/2+h*6.25,q+h*I/2),X.castShadow=!0,w.add(X);const H=new r.LineSegments(new r.EdgesGeometry(X.geometry),new r.LineBasicMaterial({color:3810320}));H.position.copy(X.position),w.add(H)}}}),i.objects.forEach(t=>{const $=t.x-400+t.width/2,q=-(t.y-400+t.height/2),C=-(t.rotation*Math.PI/180);if(t.type==="bar"){const l=t.x-400+t.width/2,I=-(t.y-400+t.height/2),h=-(t.rotation*Math.PI/180),X=50,H=new r.MeshPhysicalMaterial({color:1710618,roughness:.5,metalness:.8,clearcoat:.2,clearcoatRoughness:.4}),G=new r.Mesh(new r.BoxGeometry(t.width,X,t.height),H);G.position.set(l,X/2,I),G.rotation.y=h,G.castShadow=!0,G.receiveShadow=!0,w.add(G);const oe=[8323072,10770944,6691328,9109504,8930304],V=oe[Math.floor(Math.random()*oe.length)],ce=new r.MeshPhysicalMaterial({color:V,metalness:.1,roughness:.05,transmission:.9,thickness:2,ior:1.5,reflectivity:.9,clearcoat:1,clearcoatRoughness:.05}),K=new r.Mesh(new r.BoxGeometry(t.width+6,6,t.height+6),ce);K.position.set(l,X+3,I),K.rotation.y=h,K.castShadow=!0,w.add(K);const B=new r.MeshStandardMaterial({emissive:16711799,emissiveIntensity:.6,color:0}),k=new r.Mesh(new r.BoxGeometry(t.width+6,.5,t.height+6),B);k.position.set(l,X+1,I),k.rotation.y=h,w.add(k);const L=V===8323072?13938487:11579568,u=new r.Mesh(new r.BoxGeometry(t.width+8,.6,t.height+8),new r.MeshStandardMaterial({color:L,metalness:1,roughness:.2}));u.position.set(l,X+6.5,I),u.rotation.y=h,w.add(u);const re=new r.MeshStandardMaterial({color:13421772,metalness:1,roughness:.1}),Q=new r.CylinderGeometry(2,2,X,16);[[t.width/2-6,t.height/2-6],[-t.width/2+6,t.height/2-6],[t.width/2-6,-t.height/2+6],[-t.width/2+6,-t.height/2+6]].forEach(([ge,Ce])=>{const be=new r.Mesh(Q,re);be.position.set(l+ge*Math.cos(h)-Ce*Math.sin(h),X/2,I+ge*Math.sin(h)+Ce*Math.cos(h)),be.castShadow=!0,w.add(be)});const F=new r.PointLight(V,.4,600);F.position.set(l,X+70,I),w.add(F);const N=120,m=new r.Group,he=new r.MeshPhysicalMaterial({color:2105376,metalness:1,roughness:.25,clearcoat:.6,clearcoatRoughness:.1}),g=new r.Mesh(new r.BoxGeometry(t.width+40,10,t.height+40),he);g.castShadow=!0,g.receiveShadow=!0,m.add(g);const M=new r.MeshPhysicalMaterial({color:10770944,metalness:0,roughness:.05,transmission:.95,thickness:1.5,ior:1.45,clearcoat:1,clearcoatRoughness:.05}),Se=new r.Mesh(new r.PlaneGeometry(t.width+32,t.height+32),M);Se.rotation.x=-Math.PI/2,Se.position.y=-3,m.add(Se);const Y=new r.MeshStandardMaterial({emissive:16764040,emissiveIntensity:1.6,color:0}),b=new r.BoxGeometry(4,2,t.height+36),ze=new r.Mesh(b,Y),Pe=ze.clone();ze.position.set(-(t.width+36)/2,-2,0),Pe.position.set((t.width+36)/2,-2,0),m.add(ze,Pe);const le=new r.Group,pe=[11674146,14919767,9127187,27028,7810842];for(let ge=-3;ge<=3;ge++){const Ce=pe[Math.floor(Math.random()*pe.length)],be=new r.MeshPhysicalMaterial({color:Ce,roughness:.1,transmission:.95,thickness:.6,ior:1.5,clearcoat:.3,clearcoatRoughness:.2}),He=new r.Mesh(new r.CylinderGeometry(3,3,20,32),be);He.position.set(ge*12,-12,0),le.add(He);const s=new r.Mesh(new r.CylinderGeometry(1.2,1.2,6,16),be);s.position.set(ge*12,-3,0),le.add(s)}le.position.y=-15,m.add(le);const Ze=new r.MeshPhysicalMaterial({color:16777215,roughness:.1,transmission:.9,thickness:.4,ior:1.45});for(let ge=-2;ge<=2;ge++){const Ce=new r.Mesh(new r.SphereGeometry(2.5,16,16,0,Math.PI),Ze);Ce.position.set(ge*10,-25,0),Ce.scale.y=.6,m.add(Ce)}const x=new r.MeshStandardMaterial({color:11184810,metalness:1,roughness:.2}),we=new r.CylinderGeometry(1.5,1.5,N-60,16);[[t.width/2-10,t.height/2-10],[-t.width/2+10,t.height/2-10],[t.width/2-10,-t.height/2+10],[-t.width/2+10,-t.height/2+10]].forEach(([ge,Ce])=>{const be=new r.Mesh(we,x);be.position.set(ge,-(N-80)/2,Ce),be.rotation.x=Math.PI/2,m.add(be)}),m.position.set(l,N,I),m.rotation.y=h,w.add(m);const Oe=new r.PointLight(16755285,.8,600);Oe.position.set(l,N-20,I),w.add(Oe)}else if(t.type==="kitchen"){const l=new r.Group,I=new r.MeshPhysicalMaterial({color:11579568,metalness:1,roughness:.25,envMapIntensity:1,clearcoat:1,clearcoatRoughness:.05}),h=new r.MeshPhysicalMaterial({color:10079487,roughness:.05,transmission:.9,thickness:.5,metalness:.1,envMapIntensity:1.2}),X=new r.Mesh(new r.BoxGeometry(t.width,50,t.height),I);X.position.set(0,25,0),X.castShadow=!0,X.receiveShadow=!0,l.add(X);const H=new r.Mesh(new r.BoxGeometry(t.width,4,t.height),h);H.position.set(0,52,0),l.add(H);const G=new r.Mesh(new r.BoxGeometry(t.width*.4,10,t.height*.6),new r.MeshStandardMaterial({color:2236962,roughness:.4}));G.position.set(-t.width*.2,55,0),l.add(G);const oe=new r.MeshStandardMaterial({color:3355443,metalness:.8,roughness:.2});[[-t.width*.25,t.height*.15],[-t.width*.15,t.height*.15],[-t.width*.25,-t.height*.15],[-t.width*.15,-t.height*.15]].forEach(([F,N])=>{const m=new r.Mesh(new r.CylinderGeometry(6,6,2,32),oe);m.rotation.x=Math.PI/2,m.position.set(F,61,N),l.add(m)});const ce=new r.Mesh(new r.BoxGeometry(t.width*.5,35,t.height*.65),new r.MeshPhysicalMaterial({color:12632256,metalness:1,roughness:.2,envMapIntensity:1.1}));ce.position.set(-t.width*.2,95,0),ce.castShadow=!0,l.add(ce);const K=new r.MeshPhysicalMaterial({color:14540253,roughness:.3,metalness:.5});for(let F=0;F<3;F++){const N=new r.Mesh(new r.BoxGeometry(t.width*.7,4,t.height*.2),K);N.position.set(t.width*.15,75+F*22,t.height*.35),N.castShadow=!0,l.add(N)}const B=new r.MeshStandardMaterial({color:8947848,metalness:.9,roughness:.2});for(let F=-1;F<=1;F++){const N=new r.Mesh(new r.CylinderGeometry(1.5,1.5,15,16),B);N.rotation.z=Math.PI/2,N.position.set(F*t.width*.2,35,t.height*.45),l.add(N)}const k=new r.PointLight(16777215,1.5,400);k.position.set(0,140,0),k.castShadow=!0,l.add(k);const L=document.createElement("canvas");L.width=1024,L.height=768;const u=L.getContext("2d");u&&(u.fillStyle="#dc2626",u.fillRect(0,0,L.width,L.height),u.strokeStyle="#ffffff",u.lineWidth=25,u.strokeRect(30,30,L.width-60,L.height-60),u.strokeStyle="#000000",u.lineWidth=15,u.strokeRect(50,50,L.width-100,L.height-100),u.shadowColor="rgba(0, 0, 0, 0.8)",u.shadowBlur=20,u.shadowOffsetX=8,u.shadowOffsetY=8,u.font="bold 180px Arial",u.textAlign="center",u.textBaseline="middle",u.fillStyle="#ffffff",u.fillText("ðŸ‘¨â€ðŸ³",L.width/2,L.height/2-150),u.fillStyle="#ffffff",u.font="bold 220px Impact, Arial Black, sans-serif",u.fillText("CHEF",L.width/2,L.height/2+120),u.strokeStyle="#000000",u.lineWidth=12,u.strokeText("CHEF",L.width/2,L.height/2+120),u.strokeStyle="#fbbf24",u.lineWidth=6,u.strokeText("CHEF",L.width/2,L.height/2+120));const re=new r.CanvasTexture(L),Q=new r.Mesh(new r.PlaneGeometry(t.height*.6,t.height*.45),new r.MeshStandardMaterial({map:re,roughness:.4,metalness:.1,emissive:14427686,emissiveIntensity:.3}));Q.position.set(-t.width/2+3,50,0),Q.rotation.y=Math.PI/2,l.add(Q);const Ee=new r.Mesh(new r.PlaneGeometry(t.height*.6,t.height*.45),new r.MeshStandardMaterial({map:re,roughness:.4,metalness:.1,emissive:14427686,emissiveIntensity:.3}));Ee.position.set(t.width/2-3,50,0),Ee.rotation.y=-Math.PI/2,l.add(Ee),l.position.set($,0,q),l.rotation.y=C,w.add(l)}else if(t.type==="toilet"){const l=new r.Group,I=new r.MeshStandardMaterial({color:14013914,roughness:.7,metalness:.05}),h=new r.MeshStandardMaterial({color:3900150,roughness:.6,metalness:.1}),X=new r.MeshStandardMaterial({color:15680580,roughness:.6,metalness:.1}),H=new r.MeshStandardMaterial({color:14277081,roughness:.7,metalness:.05}),G=120,oe=new r.Mesh(new r.BoxGeometry(t.width,4,t.height),H);oe.position.y=2,oe.receiveShadow=!0,l.add(oe);const V=new r.Mesh(new r.BoxGeometry(t.width,G,6),I);V.position.set(0,G/2,-t.height/2),V.castShadow=!0,l.add(V);const ce=new r.Mesh(new r.BoxGeometry(6,G,t.height),I);ce.position.set(-t.width/2,G/2,0),ce.castShadow=!0,l.add(ce);const K=new r.Mesh(new r.BoxGeometry(6,G,t.height),I);K.position.set(t.width/2,G/2,0),K.castShadow=!0,l.add(K);const B=new r.Mesh(new r.BoxGeometry(t.width*.24,G,6),I);B.position.set(0,G/2,t.height/2),B.castShadow=!0,l.add(B);const k=new r.Mesh(new r.BoxGeometry(t.width*.055,G,6),I);k.position.set(-t.width*.4725,G/2,t.height/2),k.castShadow=!0,l.add(k);const L=new r.Mesh(new r.BoxGeometry(t.width*.055,G,6),I);L.position.set(t.width*.4725,G/2,t.height/2),L.castShadow=!0,l.add(L);const u=new r.Mesh(new r.BoxGeometry(t.width*.33,G-95,6),I);u.position.set(t.width*.285,95+(G-95)/2,t.height/2),u.castShadow=!0,l.add(u);const re=new r.Mesh(new r.BoxGeometry(t.width*.33,G-95,6),I);re.position.set(-t.width*.285,95+(G-95)/2,t.height/2),re.castShadow=!0,l.add(re);const Q=new r.Mesh(new r.BoxGeometry(t.width*.33,95,4),h);Q.position.set(t.width*.285,47.5,t.height/2-2),Q.castShadow=!0,l.add(Q);const Ee=new r.MeshStandardMaterial({color:13938487,metalness:.1,roughness:.8}),F=new r.Mesh(new r.CylinderGeometry(1.5,1.5,12,16),Ee);F.rotation.z=Math.PI/2,F.position.set(t.width*.285-t.width*.132,47.5,t.height/2+1),l.add(F);const N=document.createElement("canvas");N.width=512,N.height=768;const m=N.getContext("2d");if(m){const J=m.createLinearGradient(0,0,0,N.height);J.addColorStop(0,"#3b82f6"),J.addColorStop(1,"#1e40af"),m.fillStyle=J,m.fillRect(0,0,N.width,N.height),m.strokeStyle="#ffffff",m.lineWidth=12,m.strokeRect(20,20,N.width-40,N.height-40),m.strokeStyle="rgba(255, 255, 255, 0.3)",m.lineWidth=6,m.strokeRect(30,30,N.width-60,N.height-60),m.shadowColor="rgba(0, 0, 0, 0.5)",m.shadowBlur=15,m.shadowOffsetX=4,m.shadowOffsetY=4,m.fillStyle="#ffffff",m.font="bold 120px Georgia, serif",m.textAlign="center",m.textBaseline="middle",m.fillText("W.C.",N.width/2,N.height/2-100),m.strokeStyle="#ffffff",m.lineWidth=4,m.beginPath(),m.moveTo(100,N.height/2),m.lineTo(N.width-100,N.height/2),m.stroke();const Te=m.createLinearGradient(0,N.height/2,0,N.height/2+150);Te.addColorStop(0,"#ffd700"),Te.addColorStop(.5,"#ffed4e"),Te.addColorStop(1,"#ffd700"),m.fillStyle=Te,m.font="bold 140px Georgia, serif",m.fillText("MALE",N.width/2,N.height/2+120),m.strokeStyle="#b8860b",m.lineWidth=3,m.strokeText("MALE",N.width/2,N.height/2+120)}const he=new r.CanvasTexture(N),g=new r.Mesh(new r.PlaneGeometry(t.width*.25,t.width*.375),new r.MeshStandardMaterial({map:he,roughness:.3,metalness:.15,emissive:1982639,emissiveIntensity:.1}));g.position.set(t.width*.285,47.5,t.height/2+2.5),l.add(g);const M=new r.Mesh(new r.BoxGeometry(t.width*.33,95,4),X);M.position.set(-t.width*.285,47.5,t.height/2-2),M.castShadow=!0,l.add(M);const Se=F.clone();Se.position.set(-t.width*.285+t.width*.132,47.5,t.height/2+1),l.add(Se);const Y=document.createElement("canvas");Y.width=512,Y.height=768;const b=Y.getContext("2d");if(b){const J=b.createLinearGradient(0,0,0,Y.height);J.addColorStop(0,"#ef4444"),J.addColorStop(1,"#b91c1c"),b.fillStyle=J,b.fillRect(0,0,Y.width,Y.height),b.strokeStyle="#ffffff",b.lineWidth=12,b.strokeRect(20,20,Y.width-40,Y.height-40),b.strokeStyle="rgba(255, 255, 255, 0.3)",b.lineWidth=6,b.strokeRect(30,30,Y.width-60,Y.height-60),b.shadowColor="rgba(0, 0, 0, 0.5)",b.shadowBlur=15,b.shadowOffsetX=4,b.shadowOffsetY=4,b.fillStyle="#ffffff",b.font="bold 120px Georgia, serif",b.textAlign="center",b.textBaseline="middle",b.fillText("W.C.",Y.width/2,Y.height/2-100),b.strokeStyle="#ffffff",b.lineWidth=4,b.beginPath(),b.moveTo(100,Y.height/2),b.lineTo(Y.width-100,Y.height/2),b.stroke();const Te=b.createLinearGradient(0,Y.height/2,0,Y.height/2+150);Te.addColorStop(0,"#ffb6c1"),Te.addColorStop(.5,"#ffd1dc"),Te.addColorStop(1,"#ffb6c1"),b.fillStyle=Te,b.font="bold 120px Georgia, serif",b.fillText("FEMALE",Y.width/2,Y.height/2+120),b.strokeStyle="#dc143c",b.lineWidth=3,b.strokeText("FEMALE",Y.width/2,Y.height/2+120)}const ze=new r.CanvasTexture(Y),Pe=new r.Mesh(new r.PlaneGeometry(t.width*.25,t.width*.375),new r.MeshStandardMaterial({map:ze,roughness:.3,metalness:.15,emissive:12131356,emissiveIntensity:.1}));Pe.position.set(-t.width*.285,47.5,t.height/2+2.5),l.add(Pe);const le=document.createElement("canvas");le.width=512,le.height=256;const pe=le.getContext("2d");pe&&(pe.fillStyle="#d5d5da",pe.fillRect(0,0,le.width,le.height),pe.fillStyle="#2a2a2a",pe.font="bold 140px Arial",pe.textAlign="center",pe.textBaseline="middle",pe.fillText("W.C.",le.width/2,le.height/2));const Ze=new r.CanvasTexture(le),x=new r.Mesh(new r.PlaneGeometry(t.width*.4,t.width*.2),new r.MeshStandardMaterial({map:Ze,roughness:.5,metalness:.05}));x.position.set(0,100,-t.height/2+3.5),l.add(x);const we=new r.MeshStandardMaterial({color:16119285,metalness:.1,roughness:.5}),Oe=new r.Mesh(new r.BoxGeometry(t.width*.5,12,t.height*.25),we);Oe.position.set(0,32,-t.height*.3),Oe.castShadow=!0,l.add(Oe);const ge=new r.MeshStandardMaterial({color:16777215,roughness:.3,metalness:.05}),Ce=new r.Mesh(new r.CylinderGeometry(12,12,6,32),ge);Ce.position.set(0,40,-t.height*.3),l.add(Ce);const be=new r.MeshStandardMaterial({color:12632256,metalness:.1,roughness:.8}),He=new r.Mesh(new r.TorusGeometry(4,1,8,24,Math.PI),be);He.rotation.z=Math.PI/2,He.position.set(0,48,-t.height*.35),l.add(He);const s=new r.MeshStandardMaterial({color:16777215,roughness:.25,metalness:.05}),n=new r.Mesh(new r.CylinderGeometry(10,8,12,32),s);n.position.set(-t.width*.25,6,t.height*.25),l.add(n);const o=new r.Mesh(new r.TorusGeometry(9,2,16,32),s);o.rotation.x=Math.PI/2,o.position.set(-t.width*.25,13,t.height*.25),l.add(o);const f=new r.Mesh(new r.BoxGeometry(14,20,8),s);f.position.set(-t.width*.25,22,t.height*.25-10),l.add(f);const y=new r.Mesh(new r.BoxGeometry(2,6,1),be);y.position.set(-t.width*.25+8,25,t.height*.25-10),l.add(y);const S=new r.Mesh(new r.SphereGeometry(7,32,32,0,Math.PI*2,0,Math.PI/1.5),s);S.position.set(t.width*.25,25,t.height*.25),S.rotation.x=Math.PI/6,l.add(S);const A=new r.Mesh(new r.CylinderGeometry(1.5,1.5,8,16),be);A.position.set(t.width*.25,35,t.height*.25-5),l.add(A);const j=new r.PointLight(16777215,.5,280);j.position.set(0,G-15,0),j.castShadow=!1,l.add(j),l.position.set($,0,q),l.rotation.y=C,w.add(l)}}),i.tables.forEach(t=>{const C=t.shape==="rectangle"?t.width*1.5:t.width,l=t.x-400+C/2,I=-(t.y-400+t.height/2),h=-(t.rotation*Math.PI/180),X=new r.MeshPhysicalMaterial({color:7294519,roughness:.35,metalness:.1,clearcoat:.4,clearcoatRoughness:.2,sheen:.5,sheenColor:new r.Color(10251068)}),H=t.shape==="circle"?new r.CylinderGeometry(C/2,C/2,4,64):new r.BoxGeometry(C,4,t.height),G=new r.Mesh(H,X);if(G.position.set(l,33+4/2,I),G.rotation.y=h,G.castShadow=!0,G.receiveShadow=!0,w.add(G),t.shape==="circle"){const B=new r.Mesh(new r.TorusGeometry(C/2+1,1.2,16,64),new r.MeshStandardMaterial({color:13938487,metalness:1,roughness:.3}));B.position.set(l,33+4/2+.5,I),B.rotation.x=Math.PI/2,w.add(B)}else{const B=new r.LineSegments(new r.EdgesGeometry(H),new r.LineBasicMaterial({color:13938487,linewidth:2}));B.position.copy(G.position),B.rotation.y=h,w.add(B)}const oe=new r.MeshStandardMaterial({color:2236962,metalness:.9,roughness:.2}),V=3.2;(t.shape==="circle"?[[C*.3,C*.3],[-C*.3,C*.3],[C*.3,-C*.3],[-C*.3,-C*.3]]:[[C/2-10,t.height/2-10],[-C/2+10,t.height/2-10],[C/2-10,-t.height/2+10],[-C/2+10,-t.height/2+10]]).forEach(([B,k])=>{const L=new r.Mesh(new r.CylinderGeometry(V,V,33,16),oe);L.position.set(l+B*Math.cos(h)-k*Math.sin(h),33/2,I+B*Math.sin(h)+k*Math.cos(h)),L.castShadow=!0,w.add(L)});const K=i.chairs.filter(B=>B.tableId===t.id);K.forEach(B=>{const k=B.size||40,L=38,u=new r.MeshStandardMaterial({color:9127187,roughness:.5,metalness:.1}),re=new r.MeshStandardMaterial({color:12092939,roughness:.7,metalness:.05}),Q=K.filter(ge=>ge.position===B.position).length,F=(["top","bottom"].includes(B.position)?C:t.height)-k*Q,N=Q>1?F/(Q+1):F/2,m=N+B.index*(k+N)+k/2,he=k*.4;let g=0,M=0;B.position==="top"?(g=m-C/2,M=t.height/2+he+k/2):B.position==="bottom"?(g=m-C/2,M=-(t.height/2+he+k/2)):B.position==="left"?(g=-(C/2+he+k/2),M=m-t.height/2):(g=C/2+he+k/2,M=m-t.height/2);const Se=g*Math.cos(h)-M*Math.sin(h),Y=g*Math.sin(h)+M*Math.cos(h),b=new r.Mesh(new r.BoxGeometry(k*.75,4,k*.75),re),ze=L*.4;b.position.set(l+Se,ze,I-Y);const Pe={top:0,bottom:Math.PI,left:Math.PI/2,right:-Math.PI/2}[B.position]||0;b.rotation.y=Pe+h,b.castShadow=!0,w.add(b);const le=new r.Mesh(new r.BoxGeometry(k*.75,L*.55,3),u),pe=k*.75/2+1.5;le.position.set(b.position.x-Math.sin(b.rotation.y)*pe,L*.65,b.position.z-Math.cos(b.rotation.y)*pe),le.rotation.y=b.rotation.y,le.castShadow=!0,w.add(le);const x=ze-4/2,we=new r.CylinderGeometry(2,2,x,8),Oe=new r.MeshStandardMaterial({color:6636321,roughness:.6,metalness:.2});[[k*.3,k*.3],[k*.3,-k*.3],[-k*.3,k*.3],[-k*.3,-k*.3]].forEach(([ge,Ce])=>{const be=new r.Mesh(we,Oe),He=Math.cos(b.rotation.y),s=Math.sin(b.rotation.y);be.position.set(b.position.x+ge*He-Ce*s,x/2,b.position.z+ge*s+Ce*He),be.castShadow=!0,w.add(be)})})});const ie=()=>{var t;if(ee.current=requestAnimationFrame(ie),ae.current&&ae.current.progress<1){const $=ae.current;$.progress+=.05,$.progress>=1&&($.progress=1,ue(!1),ae.current=null);const C=(l=>l<.5?4*l*l*l:1-Math.pow(-2*l+2,3)/2)($.progress);if(a.current){a.current.position.lerpVectors($.startPos,$.endPos,C);const l=new r.Vector3;l.lerpVectors($.startTarget,$.endTarget,C),a.current.lookAt(l)}}if(W&&a.current&&!_){const $=Math.sqrt(a.current.position.x**2+a.current.position.z**2),q=Math.atan2(a.current.position.z,a.current.position.x)+De.current;a.current.position.x=$*Math.cos(q),a.current.position.z=$*Math.sin(q),a.current.lookAt(0,100,0)}(t=D.current)==null||t.render(w,P)};ie();const ne=()=>{d.current&&a.current&&D.current&&(a.current.aspect=d.current.clientWidth/d.current.clientHeight,a.current.updateProjectionMatrix(),D.current.setSize(d.current.clientWidth,d.current.clientHeight))};return window.addEventListener("resize",ne),()=>{window.removeEventListener("resize",ne),ee.current&&cancelAnimationFrame(ee.current),D.current&&d.current&&(d.current.removeChild(D.current.domElement),D.current.dispose())}},[c,i,W,_]),c?e.jsx("div",{className:"rfp-fixed rfp-inset-0 bg-black/60 backdrop-blur-sm z-[200] rfp-flex rfp-items-center rfp-justify-center rfp-p-2",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 rounded-3xl shadow-2xl rfp-w-full rfp-h-full max-w-[98vw] max-h-[98vh] rfp-flex rfp-flex-col rfp-overflow-hidden rfp-border rfp-border-gray-800",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 rfp-p-1",children:e.jsxs("div",{className:"rfp-bg-gray-900 rfp-px-6 rfp-py-4 rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"rfp-text-2xl rfp-font-bold rfp-text-white rfp-flex rfp-items-center rfp-gap-3",children:[e.jsx("div",{className:"rfp-p-2 bg-gradient-to-br from-blue-500 to-purple-600 rfp-rounded-lg",children:e.jsx(E.Move3d,{className:"rfp-w-5 rfp-h-5"})}),"3D Floor Plan Visualization"]}),e.jsxs("p",{className:"rfp-text-gray-400 rfp-text-sm rfp-mt-1",children:["Professional Camera Controls â€¢ ",i.name]})]}),e.jsx("button",{onClick:p,className:"p-2.5 bg-red-500/20 hover:bg-red-500/30 rfp-text-red-400 rfp-rounded-xl rfp-transition-all hover:scale-110",children:e.jsx(E.X,{className:"rfp-w-5 rfp-h-5"})})]})}),e.jsxs("div",{className:"rfp-flex-1 rfp-flex rfp-gap-3 rfp-p-3 rfp-min-h-0",children:[e.jsxs("div",{className:"rfp-w-80 bg-black/90 backdrop-blur-xl rounded-2xl shadow-2xl rfp-border rfp-border-gray-700 rfp-p-5 rfp-flex rfp-flex-col rfp-gap-5 overflow-y-auto flex-shrink-0",children:[e.jsx("button",{onClick:()=>Ge("default"),className:"rfp-px-4 rfp-py-3 bg-gradient-to-r from-blue-500 to-purple-600 rfp-text-white rfp-rounded-xl rfp-font-semibold rfp-transition-all hover:scale-105 hover:shadow-lg rfp-flex rfp-items-center rfp-justify-center rfp-gap-2",children:"ðŸ  Default View"}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-3",children:[e.jsxs("div",{className:"rfp-text-white rfp-text-sm rfp-font-bold rfp-uppercase rfp-tracking-wider rfp-flex rfp-items-center rfp-gap-2 rfp-pb-2 rfp-border-b rfp-border-gray-700",children:[e.jsx(E.Move3d,{className:"rfp-w-5 rfp-h-5 rfp-text-purple-400"}),"Manual Control"]}),e.jsx("div",{className:"rfp-flex rfp-justify-center",children:e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-1",children:[e.jsx("button",{onClick:()=>me("up"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30 mx-auto",disabled:_,title:"Rotate Up",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsxs("div",{className:"rfp-flex rfp-gap-1 rfp-justify-center",children:[e.jsx("button",{onClick:()=>me("left"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30",disabled:_,title:"Rotate Left",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"rfp-w-12 rfp-h-12 bg-gradient-to-br from-blue-600 to-purple-600 rfp-rounded-lg rfp-flex rfp-items-center rfp-justify-center",children:e.jsx(E.Move3d,{className:"rfp-w-6 rfp-h-6 rfp-text-white"})}),e.jsx("button",{onClick:()=>me("right"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30",disabled:_,title:"Rotate Right",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("button",{onClick:()=>me("down"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30 mx-auto",disabled:_,title:"Rotate Down",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})})]}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-3",children:[e.jsxs("div",{className:"rfp-text-white rfp-text-sm rfp-font-bold rfp-uppercase rfp-tracking-wider rfp-flex rfp-items-center rfp-gap-2 rfp-pb-2 rfp-border-b rfp-border-gray-700",children:[e.jsx(E.ZoomIn,{className:"rfp-w-5 rfp-h-5 rfp-text-green-400"}),"Zoom & Rotation"]}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-2",children:[e.jsxs("button",{onClick:()=>xe(.85),className:"rfp-px-4 rfp-py-3 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-semibold disabled:opacity-30",disabled:_,children:[e.jsx(E.ZoomIn,{className:"rfp-w-5 rfp-h-5"}),"Zoom In"]}),e.jsxs("button",{onClick:()=>xe(1.15),className:"rfp-px-4 rfp-py-3 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-semibold disabled:opacity-30",disabled:_,children:[e.jsx(E.ZoomOut,{className:"rfp-w-5 rfp-h-5"}),"Zoom Out"]}),e.jsxs("button",{onClick:()=>U(!W),className:`px-4 py-3 rounded-xl transition-all hover:scale-105 flex items-center justify-center gap-2 font-semibold ${W?"bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg":"bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white"}`,children:[e.jsx(E.RotateCcw,{className:`w-5 h-5 ${W?"animate-spin":""}`}),W?"Auto-Rotating":"Auto-Rotate"]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-3 mt-auto",children:[e.jsxs("button",{onClick:()=>Ge("default"),className:"rfp-px-4 rfp-py-3 bg-gradient-to-r from-orange-500 to-red-600 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 hover:shadow-lg rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-bold",children:[e.jsx(E.Maximize2,{className:"rfp-w-5 rfp-h-5"}),"Reset View"]}),e.jsxs("div",{className:"bg-gray-800/50 rfp-rounded-xl rfp-p-4 rfp-border rfp-border-gray-700",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-text-gray-400 rfp-mb-3",children:[e.jsx(E.Grid,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{className:"rfp-font-medium rfp-text-sm",children:"Scene Statistics"})]}),e.jsxs("div",{className:"rfp-grid grid-cols-2 rfp-gap-2 rfp-text-sm",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-emerald-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[i.tables.length," Tables"]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-amber-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[i.chairs.length," Chairs"]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-purple-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[i.objects.length," Objects"]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-blue-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[i.walls.length," Walls"]})]})]})]})]})]}),e.jsxs("div",{className:"rfp-flex-1 rfp-relative bg-gradient-to-br from-gray-100 via-gray-50 to-gray-100 rounded-2xl rfp-overflow-hidden shadow-2xl rfp-border rfp-border-gray-300",children:[e.jsx("div",{ref:d,className:"rfp-w-full rfp-h-full"}),_&&e.jsx("div",{className:"rfp-absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsx("div",{className:"bg-black/80 backdrop-blur-xl rfp-rounded-xl rfp-px-6 rfp-py-3 shadow-2xl rfp-border rfp-border-gray-700",children:e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3",children:[e.jsx("div",{className:"rfp-animate-spin rfp-rounded-full rfp-h-5 rfp-w-5 rfp-border-2 rfp-border-gray-500 border-t-white"}),e.jsx("span",{className:"rfp-text-white rfp-text-sm rfp-font-medium",children:"Transitioning Camera..."})]})})})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-900 via-slate-900 to-gray-900 rfp-px-6 rfp-py-3 rfp-border-t rfp-border-gray-800",children:e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-4",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx(E.Layers,{className:"rfp-w-4 rfp-h-4 rfp-text-gray-400"}),e.jsxs("span",{className:"rfp-text-sm rfp-text-gray-400",children:["Viewing: ",e.jsx("span",{className:"rfp-text-white rfp-font-semibold",children:i.name})]})]}),e.jsxs("div",{className:"rfp-text-sm rfp-text-gray-400",children:["Camera: ",e.jsx("span",{className:"rfp-text-white rfp-font-semibold",children:sr[ke].name})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-text-xs rfp-text-gray-500",children:[e.jsx("span",{children:"High Performance Mode"}),e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-green-500 rfp-rounded-full rfp-animate-pulse"})]})]})})]})}):null},Cr=({fullScreen:i=!1})=>{const[c,p]=v.useState([{id:"floor-1",name:"Ground Floor",isActive:!0,tables:[],chairs:[],objects:[],walls:[],fixedElements:[]}]),[d,se]=v.useState("floor-1"),[a,D]=v.useState(null),[ee,W]=v.useState(!1),[U,ke]=v.useState({x:0,y:0}),z=1,[_,ue]=v.useState(!0),[De,ae]=v.useState(!1),[Ge,me]=v.useState(!1),[xe,w]=v.useState(null),[P,Z]=v.useState(null),[ye,ve]=v.useState(null),[fe,Me]=v.useState(!1),[Ae,T]=v.useState(null),[R,Ne]=v.useState(null),ie=v.useRef(null),ne=v.useRef(null),t=v.useRef(null);v.useEffect(()=>{if((a==null?void 0:a.type)==="table"){const s=$();if(!s)return;const n=s.chairs.filter(f=>f.tableId===a.id);if(n.filter(f=>f.size===void 0).length>0){const f={};n.forEach(y=>{y.size!==void 0&&!f[y.position]&&(f[y.position]=y.size)}),p(y=>y.map(S=>S.id===d?{...S,chairs:S.chairs.map(A=>{if(A.tableId===a.id&&A.size===void 0){const j=f[A.position]??40;return{...A,size:j}}return A})}:S))}}},[a]);const $=()=>c.find(s=>s.id===d),q=(s,n="medium")=>{const o=$();if(!o)return;const{width:f,height:y}=er(s,n),S={id:_e(),name:`Table ${o.tables.length+1}`,shape:s,size:n,x:200+o.tables.length*20,y:200+o.tables.length*20,width:f,height:y,rotation:0};p(A=>A.map(j=>j.id===d?{...j,tables:[...j.tables,S]}:j)),D({type:"table",id:S.id})},C=s=>{const n=$();if(!n)return;const o={id:_e(),name:`${qe[s]} ${n.objects.length+1}`,type:s,x:300+n.objects.length*30,y:300+n.objects.length*30,width:120,height:80,rotation:0};p(f=>f.map(y=>y.id===d?{...y,objects:[...y.objects,o]}:y)),D({type:"object",id:o.id})},l=s=>{if(!a||a.type!=="table")return;const n=$();if(!n)return;const o=n.chairs.filter(j=>j.tableId===a.id&&j.position===s),f=o.length,y=o.find(j=>j.size!==void 0),S=(y==null?void 0:y.size)??40,A={id:_e(),tableId:a.id,position:s,index:f,x:0,y:0,size:S};p(j=>j.map(J=>J.id===d?{...J,chairs:[...J.chairs,A]}:J))},I=s=>{if(!a||a.type!=="table")return;const n=$();if(!n)return;const o=n.chairs.filter(y=>y.tableId===a.id&&y.position===s);if(o.length===0)return;const f=o.reduce((y,S)=>S.index>y.index?S:y);p(y=>y.map(S=>S.id===d?{...S,chairs:S.chairs.filter(A=>A.id!==f.id)}:S))},h=(s,n)=>{!a||a.type!=="table"||!$()||p(f=>f.map(y=>y.id===d?{...y,chairs:y.chairs.map(S=>S.tableId===a.id&&S.position===s?{...S,size:n}:S)}:y))},X=()=>{!a||a.type!=="table"||!$()||p(n=>n.map(o=>o.id===d?{...o,chairs:o.chairs.map(f=>{if(f.tableId===a.id){const{size:y,...S}=f;return S}return f})}:o))},H=()=>{a&&(a.type==="table"?p(s=>s.map(n=>n.id===d?{...n,tables:n.tables.filter(o=>o.id!==a.id),chairs:n.chairs.filter(o=>o.tableId!==a.id)}:n)):a.type==="object"?p(s=>s.map(n=>n.id===d?{...n,objects:n.objects.filter(o=>o.id!==a.id)}:n)):a.type==="wall"?p(s=>s.map(n=>n.id===d?{...n,walls:n.walls.filter(o=>o.id!==a.id)}:n)):a.type==="fixedElement"&&p(s=>s.map(n=>n.id===d?{...n,fixedElements:n.fixedElements.filter(o=>o.id!==a.id)}:n)),D(null))},G=s=>{!a||a.type!=="wall"||p(n=>n.map(o=>o.id===d?{...o,walls:o.walls.map(f=>f.id===a.id?{...f,thickness:s}:f)}:o))},oe=s=>{!a||a.type!=="wall"||p(n=>n.map(o=>o.id===d?{...o,walls:o.walls.map(f=>f.id===a.id?{...f,type:s}:f)}:o))},V=()=>{!a||a.type!=="table"||p(s=>s.map(n=>n.id===d?{...n,tables:n.tables.map(o=>o.id===a.id?{...o,rotation:(o.rotation||0)+45}:o)}:n))},ce=()=>{if(!a||a.type!=="table")return;const s=$();if(!s)return;const n=s.tables.find(S=>S.id===a.id);if(!n)return;const o={...n,id:_e(),name:`${n.name} Copy`,x:n.x+50,y:n.y+50},y=s.chairs.filter(S=>S.tableId===n.id).map(S=>({...S,id:_e(),tableId:o.id}));p(S=>S.map(A=>A.id===d?{...A,tables:[...A.tables,o],chairs:[...A.chairs,...y]}:A)),D({type:"table",id:o.id})},K=v.useCallback(s=>{!a||a.type!=="table"||p(n=>n.map(o=>o.id===d?{...o,tables:o.tables.map(f=>f.id===a.id?s(f):f)}:o))},[a,d]),B=s=>{K(n=>{const{width:o,height:f}=er(n.shape,s);return{...n,size:s,width:o,height:f}})},k=(s,n)=>{K(o=>({...o,width:s,height:n,size:"medium"}))},L=s=>{!a||a.type!=="object"||p(n=>n.map(o=>o.id===d?{...o,objects:o.objects.map(f=>f.id===a.id?{...f,name:s}:f)}:o))},u=(s,n)=>{!a||a.type!=="object"||p(o=>o.map(f=>f.id===d?{...f,objects:f.objects.map(y=>y.id===a.id?{...y,width:s,height:n}:y)}:f))},re=s=>{!a||a.type!=="object"||p(n=>n.map(o=>o.id===d?{...o,objects:o.objects.map(f=>f.id===a.id?{...f,rotation:s}:f)}:o))},Q=(s,n)=>{!a||a.type!=="fixedElement"||p(o=>o.map(f=>f.id===d?{...f,fixedElements:f.fixedElements.map(y=>y.id===a.id?{...y,width:s,height:n}:y)}:f))},Ee=s=>{K(n=>({...n,name:s}))},F=s=>{if(ie.current&&!fe){if(Ge&&xe){const n=ie.current.getBoundingClientRect(),o=Math.round((s.clientX-n.left)/z/O)*O,f=Math.round((s.clientY-n.top)/z/O)*O;if(!P)Z({x:o,y:f});else{if(!$())return;const S=Ue(P,{x:o,y:f}),A={id:_e(),type:xe,startX:P.x,startY:P.y,endX:S.x,endY:S.y,thickness:8};p(j=>j.map(J=>J.id===d?{...J,walls:[...J.walls,A]}:J)),Z(null),ve(null),me(!1),w(null)}return}D(null)}},N=(s,n)=>{D({type:s,id:n})},m=(s,n)=>{if(!ie.current)return;s.preventDefault(),s.stopPropagation();const o=ie.current.getBoundingClientRect(),f=(s.clientX-o.left)/z,y=(s.clientY-o.top)/z,S=$();if(!S)return;const A=S.tables.find($e=>$e.id===n),j=S.objects.find($e=>$e.id===n),J=S.fixedElements.find($e=>$e.id===n),Te=S.walls.find($e=>$e.id===n);if(Te)ke({x:f-Te.startX,y:y-Te.startY}),ne.current={id:n,type:"wall"};else{const $e=A||j||J;$e&&ke({x:f-$e.x,y:y-$e.y});const We=A?"table":j?"object":J?"fixedElement":"table";ne.current={id:n,type:We}}W(!0)},he=v.useCallback(s=>{!ee&&!fe||!ne.current||!ie.current||(t.current&&cancelAnimationFrame(t.current),t.current=requestAnimationFrame(()=>{var A,j,J,Te,$e;if(!ie.current)return;const n=ie.current.getBoundingClientRect(),o=(s.clientX-n.left)/z,f=(s.clientY-n.top)/z,y=Math.round(o/O)*O,S=Math.round(f/O)*O;if(fe&&((A=ne.current)==null?void 0:A.type)==="wall"){const We=c.find(Xe=>Xe.id===d),Be=We==null?void 0:We.walls.find(Xe=>{var Ie;return Xe.id===((Ie=ne.current)==null?void 0:Ie.id)});if(Be){const Xe=Ae==="start"?{x:Be.endX,y:Be.endY}:{x:Be.startX,y:Be.startY},Ie=Ue(Xe,{x:y,y:S});p(Fe=>Fe.map(de=>de.id===d?{...de,walls:de.walls.map(te=>{var Le;return te.id===((Le=ne.current)==null?void 0:Le.id)?Ae==="start"?{...te,startX:Ie.x,startY:Ie.y}:{...te,endX:Ie.x,endY:Ie.y}:te})}:de))}}else if(((j=ne.current)==null?void 0:j.type)==="table"){const We=o-U.x,Be=f-U.y,Xe=Math.round(We/O)*O,Ie=Math.round(Be/O)*O;p(Fe=>Fe.map(de=>de.id===d?{...de,tables:de.tables.map(te=>{var Le;return te.id===((Le=ne.current)==null?void 0:Le.id)?{...te,x:Xe,y:Ie}:te})}:de))}else if(((J=ne.current)==null?void 0:J.type)==="object"){const We=o-U.x,Be=f-U.y,Xe=Math.round(We/O)*O,Ie=Math.round(Be/O)*O;p(Fe=>Fe.map(de=>de.id===d?{...de,objects:de.objects.map(te=>{var Le;return te.id===((Le=ne.current)==null?void 0:Le.id)?{...te,x:Xe,y:Ie}:te})}:de))}else if(((Te=ne.current)==null?void 0:Te.type)==="fixedElement"){const We=o-U.x,Be=f-U.y,Xe=Math.round(We/O)*O,Ie=Math.round(Be/O)*O;p(Fe=>Fe.map(de=>de.id===d?{...de,fixedElements:de.fixedElements.map(te=>{var Le;return te.id===((Le=ne.current)==null?void 0:Le.id)?{...te,x:Xe,y:Ie}:te})}:de))}else if((($e=ne.current)==null?void 0:$e.type)==="wall"&&!fe){const We=o-U.x,Be=f-U.y,Xe=Math.round(We/O)*O,Ie=Math.round(Be/O)*O;p(Fe=>Fe.map(de=>de.id===d?{...de,walls:de.walls.map(te=>{var or;if(te.id!==((or=ne.current)==null?void 0:or.id))return te;const Le=Xe-te.startX,nr=Ie-te.startY;return{...te,startX:te.startX+Le,startY:te.startY+nr,endX:te.endX+Le,endY:te.endY+nr}})}:de))}}))},[ee,fe,Ae,U,d,z,c]),g=()=>{t.current&&(cancelAnimationFrame(t.current),t.current=null),W(!1),ne.current=null,Me(!1),T(null),Ne(null)},M=(s,n,o)=>{s.preventDefault(),s.stopPropagation(),Me(!0),T(o),ne.current={id:n,type:"wall"}},Se=()=>{const s={id:_e(),name:`Floor ${c.length+1}`,isActive:!1,tables:[],chairs:[],objects:[],walls:[],fixedElements:[]};p(n=>[...n,s]),b(s.id)},Y=()=>{if(c.length<=1)return;const s=c.filter(n=>n.id!==d);p(s),se(s[0].id)},b=s=>{p(n=>n.map(o=>({...o,isActive:o.id===s}))),se(s),D(null)},ze=(s,n)=>{p(o=>o.map(f=>f.id===s?{...f,name:n}:f))},Pe=s=>{me(!0),w(s),Z(null),ve(null),D(null)},le=s=>{const n=$();if(!n)return;const o={id:_e(),name:`${s.charAt(0).toUpperCase()+s.slice(1)} ${n.fixedElements.length+1}`,type:s,x:400+n.fixedElements.length*30,y:400+n.fixedElements.length*30,width:60,height:60,rotation:0};p(f=>f.map(y=>y.id===d?{...y,fixedElements:[...y.fixedElements,o]}:y)),D({type:"fixedElement",id:o.id})},pe=()=>{const s={floors:c,timestamp:new Date().toISOString()};console.log("Saving floor plan:",s),alert("Floor plan saved! (Check console for data)")};v.useEffect(()=>{const s=o=>he(o),n=()=>g();return(ee||fe)&&(document.addEventListener("mousemove",s),document.addEventListener("mouseup",n)),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",n)}},[ee,fe,he]);const Ze=s=>{var n;if(Ge&&P&&ie.current){const o=ie.current.getBoundingClientRect(),f=Math.round((s.clientX-o.left)/z/O)*O,y=Math.round((s.clientY-o.top)/z/O)*O,S=Ue(P,{x:f,y});ve(S)}else if(fe&&((n=ne.current)==null?void 0:n.type)==="wall"&&ie.current){const o=ie.current.getBoundingClientRect(),f=Math.round((s.clientX-o.left)/z/O)*O,y=Math.round((s.clientY-o.top)/z/O)*O,S=$(),A=S==null?void 0:S.walls.find(j=>{var J;return j.id===((J=ne.current)==null?void 0:J.id)});if(A){const j=Ae==="start"?{x:A.endX,y:A.endY}:{x:A.startX,y:A.startY},J=Ue(j,{x:f,y});Ne(Ae==="start"?{startX:J.x,startY:J.y,endX:A.endX,endY:A.endY}:{startX:A.startX,startY:A.startY,endX:J.x,endY:J.y})}}};v.useEffect(()=>{const s=n=>{n.key==="Escape"&&Ge&&(me(!1),w(null),Z(null),ve(null))};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[Ge]);const x=$(),we=x==null?void 0:x.tables.find(s=>(a==null?void 0:a.type)==="table"&&s.id===a.id),Oe=x==null?void 0:x.objects.find(s=>(a==null?void 0:a.type)==="object"&&s.id===a.id),ge=x==null?void 0:x.walls.find(s=>(a==null?void 0:a.type)==="wall"&&s.id===a.id),Ce=x==null?void 0:x.fixedElements.find(s=>(a==null?void 0:a.type)==="fixedElement"&&s.id===a.id),be=we?(x==null?void 0:x.chairs.filter(s=>s.tableId===we.id))??[]:[],He=v.useCallback(()=>ue(s=>!s),[]);return e.jsxs("div",{className:`restaurant-floor-planner rfp-flex ${i?"rfp-h-screen":"rfp-h-full"} rfp-bg-gray-50`,children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:pr}}),e.jsx(vr,{floors:c,currentFloor:x,onAddFloor:Se,onRemoveFloor:Y,onSwitchFloor:b,onRenameFloor:ze,onAddTable:q,onAddObject:C,onStartWallDrawing:Pe,onAddFixedElement:le,onRotateTable:V,onDuplicateTable:ce,onRemoveTable:H,onSave:pe,selectedTable:we??null,selectedTableChairs:be}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(Sr,{showGrid:_,selectedTable:we??null,selectedObject:Oe??null,selectedWall:ge??null,selectedFixedElement:Ce??null,selectedTableChairs:be,tableCount:(x==null?void 0:x.tables.length)??0,chairCount:(x==null?void 0:x.chairs.length)??0,objectCount:(x==null?void 0:x.objects.length)??0,wallCount:(x==null?void 0:x.walls.length)??0,fixedElementCount:(x==null?void 0:x.fixedElements.length)??0,selectedElementType:(a==null?void 0:a.type)??null,onToggleGrid:He,onAddChair:l,onRemoveChair:I,onChangeTableSize:B,onCustomTableSize:k,onTableNameChange:Ee,onObjectNameChange:L,onObjectResize:u,onObjectRotate:re,onRemoveObject:H,onRemoveWall:H,onRemoveFixedElement:H,onChangeWallThickness:G,onConvertWallType:oe,onFixedElementResize:Q,onChairSizeChange:h,onResetChairSizes:X,on3DPreview:()=>ae(!0)}),e.jsxs("div",{className:"flex-1 overflow-hidden bg-gray-100 relative",children:[e.jsxs("div",{ref:ie,className:`w-full h-full relative ${Ge?"cursor-crosshair":fe?"cursor-grabbing":"cursor-default"}`,style:{transform:`scale(${z})`,transformOrigin:"top left",background:_?"radial-gradient(circle, #d1d5db 1px, transparent 1px)":"white",backgroundSize:`${O*z}px ${O*z}px`},onClick:F,onMouseMove:Ze,children:[(x==null?void 0:x.tables.length)===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸª"}),e.jsx("div",{className:"text-xl font-medium mb-2",children:"Welcome to Your Restaurant Designer"}),e.jsx("div",{className:"text-lg",children:'Click "Add Tables" in the sidebar to start designing your floor plan'}),e.jsxs("div",{className:"mt-4 space-y-1 text-sm",children:[e.jsx("div",{children:"â€¢ Drag tables to move them around"}),e.jsx("div",{children:"â€¢ Click tables to select and edit properties"}),e.jsx("div",{children:"â€¢ Add chairs from the top toolbar or the table properties panel"}),e.jsx("div",{children:"â€¢ Use multiple floors for complex layouts"})]})]})}),x==null?void 0:x.tables.map(s=>e.jsx(wr,{table:s,isSelected:(a==null?void 0:a.type)==="table"&&a.id===s.id,chairs:x.chairs.filter(n=>n.tableId===s.id),onSelect:()=>N("table",s.id),onDrag:m,onDragEnd:g},s.id)),x==null?void 0:x.objects.map(s=>e.jsx(br,{object:s,isSelected:(a==null?void 0:a.type)==="object"&&a.id===s.id,onSelect:()=>N("object",s.id),onDragStart:n=>m(n,s.id)},s.id)),x==null?void 0:x.walls.map(s=>e.jsx(rr,{wall:s,isSelected:(a==null?void 0:a.type)==="wall"&&a.id===s.id,onSelect:()=>N("wall",s.id),onDragHandle:(n,o)=>M(n,s.id,o),onDragStart:n=>m(n,s.id)},s.id)),Ge&&P&&ye&&xe&&e.jsx(rr,{wall:{id:"temp-wall",type:xe,startX:P.x,startY:P.y,endX:ye.x,endY:ye.y,thickness:8},isSelected:!1,onSelect:()=>{}}),R&&e.jsx("div",{className:"absolute pointer-events-none",style:{left:`${R.startX}px`,top:`${R.startY}px`,width:`${Math.sqrt(Math.pow(R.endX-R.startX,2)+Math.pow(R.endY-R.startY,2))}px`,height:"4px",transform:`rotate(${Math.atan2(R.endY-R.startY,R.endX-R.startX)*(180/Math.PI)}deg)`,transformOrigin:"top left",zIndex:15},children:e.jsx("div",{className:"w-full h-full border-2 border-blue-400 border-dashed opacity-70 bg-blue-100 rounded-sm"})}),x==null?void 0:x.fixedElements.map(s=>e.jsx(ur,{element:s,isSelected:(a==null?void 0:a.type)==="fixedElement"&&a.id===s.id,onSelect:()=>N("fixedElement",s.id),onDragStart:n=>m(n,s.id)},s.id)),x==null?void 0:x.chairs.map(s=>{const n=x.tables.find(f=>f.id===s.tableId);if(!n)return null;const o=x.chairs.filter(f=>f.tableId===s.tableId&&f.position===s.position).length;return e.jsx(xr,{chair:s,table:n,totalChairsOnSide:o,isSelected:!1,onSelect:()=>{},onDrag:()=>{},onDragEnd:()=>{}},s.id)}),a&&a.type==="table"&&we&&e.jsx("div",{className:"absolute border-2 border-blue-500 border-dashed rounded pointer-events-none",style:{left:we.x-10,top:we.y-10,width:(we.shape==="rectangle"?we.width*1.5:we.width)+20,height:we.height+20,transform:`rotate(${we.rotation||0}deg)`}})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-white bg-opacity-95 border-t border-gray-200 p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{children:["Floor: ",x==null?void 0:x.name]})]}),ee&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Dragging..."})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-gray-500",children:["Zoom: ",Math.round(z*100),"% | Grid: ",_?"On":"Off"]}),a&&e.jsx("div",{className:"text-blue-600 font-medium",children:a.type==="table"&&we?`${we.name} (${we.shape})`:"Element Selected"})]})]})})]})]}),x&&e.jsx(ar,{floor:x,isOpen:De,onClose:()=>ae(!1)})]})};Ye.Preview3DModal=ar,Ye.RestaurantFloorPlanner=Cr,Object.defineProperty(Ye,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=restaurant-floor-planner.umd.js.map
