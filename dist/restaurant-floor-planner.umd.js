(function(Ae,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("react/jsx-runtime"),require("react"),require("lucide-react"),require("three")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","react","lucide-react","three"],e):(Ae=typeof globalThis<"u"?globalThis:Ae||self,e(Ae.RestaurantFloorPlanner={},Ae["react/jsx-runtime"],Ae.React,Ae.LucideReact,Ae.THREE))})(this,function(Ae,e,y,G,or){"use strict";function ir(o){const l=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(o){for(const d in o)if(d!=="default"){const N=Object.getOwnPropertyDescriptor(o,d);Object.defineProperty(l,d,N.get?N:{enumerable:!0,get:()=>o[d]})}}return l.default=o,Object.freeze(l)}const r=ir(or),Cr="",lr=`
  .hexagon-shape {
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
  }
`,O=20,pr={small:{width:50,height:50},medium:{width:90,height:90},large:{width:130,height:130}},dr={square:G.Square,circle:G.Circle,rectangle:G.Square,hexagon:G.Square},Je={small:"Small",medium:"Medium",large:"Big"},Ue={bar:G.Wine,kitchen:G.ChefHat,toilet:G.Bath},Ze={bar:"Bar",kitchen:"Kitchen",toilet:"Toilet"},Ke={bar:{bg:"bg-gradient-to-br from-purple-500 to-purple-700",border:"border-purple-600",text:"text-purple-100"},kitchen:{bg:"bg-gradient-to-br from-orange-500 to-orange-700",border:"border-orange-600",text:"text-orange-100"},toilet:{bg:"bg-gradient-to-br from-cyan-500 to-cyan-700",border:"border-cyan-600",text:"text-cyan-100"}},qe={wall:"Wall",door:"Door",window:"Window"},fr={wall:G.RectangleVertical,door:G.DoorOpen,window:G.RectangleVertical},Qe={pillar:"Pillar",column:"Column",stairs:"Stairs"},cr={pillar:G.Columns,column:G.Columns,stairs:G.Rows},hr={pillar:{bg:"bg-gradient-to-br from-gray-600 to-gray-800",border:"border-gray-700",text:"text-gray-100"},column:{bg:"bg-gradient-to-br from-slate-600 to-slate-800",border:"border-slate-700",text:"text-slate-100"},stairs:{bg:"bg-gradient-to-br from-stone-600 to-stone-800",border:"border-stone-700",text:"text-stone-100"}},Fe=()=>Math.random().toString(36).slice(2,11),gr=o=>{const l=o.shape==="rectangle"?o.width*1.5:o.width,d=Math.min(l,o.height),N=Math.round(d*.35);return Math.max(18,Math.min(48,N))},je=o=>o.shape==="rectangle"?o.width*1.5:o.width,Re=(o,l)=>{const{width:d,height:N}=pr[l];return{width:o==="rectangle"?d*1.5:d,height:N}},Ve=(o,l)=>{const d=Math.abs(l.x-o.x),N=Math.abs(l.y-o.y);return d>N?{x:l.x,y:o.y}:{x:o.x,y:l.y}},mr=({chair:o,table:l,isSelected:d,onSelect:N,onDrag:n,onDragEnd:v,totalChairsOnSide:U})=>{const ie=gr(l),T=o.size??Math.round(ie*1.3),le=Math.max(10,Math.round(T*.25)),J=Math.min(T-4,Math.max(20,Math.round(T*.65))),H=je(l),V=(l.rotation||0)*(Math.PI/180),Me=(()=>{const $e=(o.position==="top"||o.position==="bottom"?H:l.height)-T*U,me=U>1?$e/(U+1):$e/2,ue=me+o.index*(T+me)+T/2;let c=0,I=0;switch(o.position){case"top":c=ue-H/2,I=-(l.height/2+le+T/2);break;case"bottom":c=ue-H/2,I=l.height/2+le+T/2;break;case"left":c=-(H/2+le+T/2),I=ue-l.height/2;break;case"right":c=H/2+le+T/2,I=ue-l.height/2;break}const Z=c*Math.cos(V)-I*Math.sin(V),ye=c*Math.sin(V)+I*Math.cos(V),pe=l.x+H/2,Ge=l.y+l.height/2;return{x:pe+Z-T/2,y:Ge+ye-T/2}})(),Ye=()=>{let Q=0;switch(o.position){case"top":Q=0;break;case"right":Q=90;break;case"bottom":Q=180;break;case"left":Q=270;break}return Q+(l.rotation||0)};return e.jsx("div",{className:`absolute cursor-move transition-all duration-150 ${d?"ring-4 ring-amber-400 ring-offset-2":""}`,style:{left:Me.x,top:Me.y,width:T,height:T,transform:`rotate(${Ye()}deg)`,zIndex:d?100:50,filter:"drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2))"},onMouseDown:Q=>{Q.stopPropagation(),N(),n(Q,o.id)},onMouseUp:v,children:e.jsx("div",{className:"rfp-w-full rfp-h-full bg-gradient-to-br from-amber-500 to-amber-700 rfp-rounded-lg rfp-border-4 border-amber-800 rfp-flex rfp-items-center rfp-justify-center rfp-shadow-xl hover:shadow-2xl hover:scale-105 rfp-transition-all",children:e.jsx(G.Armchair,{size:J,strokeWidth:3.5,className:"text-amber-50"})})})},xr=({table:o,chairs:l,isSelected:d,onSelect:N,onDrag:n,onDragEnd:v})=>{const U={left:o.x,top:o.y,width:je(o),height:o.height,zIndex:d?100:50,transform:`rotate(${o.rotation||0}deg)`},ie="w-full h-full flex items-center justify-center relative",T=o.shape==="circle"?`${ie} rounded-full`:o.shape==="hexagon"?`${ie} hexagon-shape`:ie,J=l.filter(Me=>Me.tableId===o.id).length,H=o.name.match(/\d+/),V=H?H[0]:o.name;return e.jsx("div",{className:`absolute cursor-move transition-all duration-150 ${d?"ring-2 ring-emerald-500 ring-offset-2":""}`,style:U,onMouseDown:Me=>{Me.stopPropagation(),N(),n(Me,o.id)},onClick:Me=>{Me.stopPropagation(),N()},onMouseUp:v,children:e.jsxs("div",{className:T,children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 rounded-[inherit]",style:{background:"linear-gradient(145deg, #059669 0%, #047857 50%, #065f46 100%)",boxShadow:`
              0 8px 16px rgba(0, 0, 0, 0.3),
              0 4px 8px rgba(0, 0, 0, 0.2),
              inset 0 2px 4px rgba(255, 255, 255, 0.2),
              inset 0 -2px 4px rgba(0, 0, 0, 0.2)
            `}}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rounded-[inherit] rfp-opacity-20",style:{background:`
              repeating-linear-gradient(
                90deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.1) 2px,
                rgba(0, 0, 0, 0.1) 4px
              )
            `}}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rounded-[inherit]",style:{border:"3px solid transparent",borderImage:"linear-gradient(145deg, rgba(255,255,255,0.4), rgba(0,0,0,0.2)) 1",pointerEvents:"none"}}),e.jsxs("div",{className:"rfp-relative z-10 rfp-flex rfp-flex-col rfp-items-center rfp-justify-center rfp-gap-1 rfp-text-white rfp-drop-shadow-lg",children:[e.jsxs("span",{className:"rfp-text-xs rfp-font-bold rfp-uppercase rfp-tracking-wide",children:["N: ",V]}),e.jsxs("span",{className:"rfp-text-xs rfp-font-bold rfp-uppercase rfp-tracking-wide",children:["S: ",J]})]})]})})},wr=({object:o,isSelected:l,onSelect:d,onDragStart:N})=>{const n=Ue[o.type],v=Ke[o.type],[U,ie]=y.useState(!1),T=le=>{ie(!0),N(le);const J=()=>{ie(!1),document.removeEventListener("mouseup",J)};document.addEventListener("mouseup",J)};return e.jsxs("div",{className:`absolute cursor-move select-none ${U?"":"transition-all duration-75"} ${v.bg} ${v.border} border-2 rounded-lg shadow-lg flex items-center justify-center ${l?"ring-4 ring-blue-400 ring-opacity-50 scale-105":"hover:scale-102"}`,style:{left:`${o.x}px`,top:`${o.y}px`,width:`${o.width}px`,height:`${o.height}px`,transform:`rotate(${o.rotation}deg)`,transformOrigin:"center",willChange:U?"transform":"auto"},onClick:le=>{le.stopPropagation(),d()},onMouseDown:T,children:[e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-items-center rfp-justify-center rfp-gap-2 rfp-pointer-events-none",children:[e.jsx(n,{className:`w-8 h-8 ${v.text}`,strokeWidth:2}),e.jsx("span",{className:`text-sm font-bold ${v.text} uppercase tracking-wide`,children:o.name})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rfp-absolute -top-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-nw-resize"}),e.jsx("div",{className:"rfp-absolute -top-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-ne-resize"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-sw-resize"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white cursor-se-resize"})]})]})},er=({wall:o,isSelected:l,onSelect:d,onDragHandle:N,onDragStart:n})=>{const v=Math.sqrt(Math.pow(o.endX-o.startX,2)+Math.pow(o.endY-o.startY,2)),U=Math.atan2(o.endY-o.startY,o.endX-o.startX)*(180/Math.PI),ie=()=>{if(!l)return"pointer";const H=Math.abs(o.endX-o.startX),V=Math.abs(o.endY-o.startY);return H>V?"ew-resize":"ns-resize"},T=()=>{switch(o.type){case"wall":return"bg-gray-800";case"door":return"bg-amber-600";case"window":return"bg-blue-500"}},le=()=>o.type==="window"?"bg-gradient-to-r from-blue-400 via-blue-300 to-blue-400":o.type==="door"?"":T(),J=()=>{const H=v*.1,V=(v-H)/2;return e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative",children:[e.jsx("div",{className:"rfp-absolute rfp-left-0 bg-gradient-to-r from-amber-600 to-amber-700 rfp-shadow-md rfp-rounded-sm",style:{width:`${V}px`,height:`${o.thickness}px`,borderTop:"1px solid #fbbf24",borderBottom:"1px solid #78350f",borderRight:"2px solid #92400e"},children:e.jsx("div",{className:"rfp-absolute right-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rfp-rounded-full rfp-shadow-sm"})}),e.jsx("div",{className:"rfp-absolute rfp-bg-transparent",style:{left:`${V}px`,width:`${H}px`,height:`${o.thickness}px`}}),e.jsx("div",{className:"rfp-absolute rfp-right-0 bg-gradient-to-r from-amber-700 to-amber-600 rfp-shadow-md rfp-rounded-sm",style:{width:`${V}px`,height:`${o.thickness}px`,borderTop:"1px solid #fbbf24",borderBottom:"1px solid #78350f",borderLeft:"2px solid #92400e"},children:e.jsx("div",{className:"rfp-absolute left-1 top-1/2 transform -translate-y-1/2 w-1.5 h-1.5 bg-yellow-500 rfp-rounded-full rfp-shadow-sm"})})]})};return e.jsxs("div",{onClick:H=>{H.stopPropagation(),d()},onMouseDown:H=>{l&&n&&(H.stopPropagation(),n(H))},className:`absolute transition-all ${l?"ring-4 ring-blue-400 ring-opacity-50 hover:ring-6 hover:ring-blue-300":""}`,style:{left:`${o.startX}px`,top:`${o.startY}px`,width:`${v}px`,height:`${o.thickness}px`,transform:`rotate(${U}deg)`,transformOrigin:"top left",zIndex:10,cursor:l?"move":"pointer",pointerEvents:"auto"},children:[o.type==="door"?J():e.jsx("div",{className:`w-full h-full ${le()} shadow-lg hover:opacity-90 transition-opacity rounded-sm`,children:l&&e.jsxs("div",{className:"rfp-absolute -top-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30",children:[qe[o.type]," - ",Math.round(v),"px"]})}),o.type==="door"&&l&&e.jsxs("div",{className:"rfp-absolute -top-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30",children:[qe[o.type]," - ",Math.round(v),"px"]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rfp-absolute -left-2 top-1/2 transform -translate-y-1/2 rfp-w-5 rfp-h-5 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white hover:bg-blue-600 hover:scale-125 rfp-transition-all rfp-shadow-xl z-30",style:{cursor:ie()},onMouseDown:H=>{H.stopPropagation(),N==null||N(H,"start")},title:"Drag to resize"}),e.jsx("div",{className:"rfp-absolute -right-2 top-1/2 transform -translate-y-1/2 rfp-w-5 rfp-h-5 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white hover:bg-blue-600 hover:scale-125 rfp-transition-all rfp-shadow-xl z-30",style:{cursor:ie()},onMouseDown:H=>{H.stopPropagation(),N==null||N(H,"end")},title:"Drag to resize"})]})]})},br=({element:o,isSelected:l,onSelect:d,onDragStart:N})=>{const[n,v]=y.useState(!1),U=T=>{v(!0),N(T);const le=()=>{v(!1),document.removeEventListener("mouseup",le)};document.addEventListener("mouseup",le)},ie=()=>o.type==="pillar"?e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative",children:[e.jsxs("div",{className:"rfp-absolute inset-2 bg-gradient-to-br from-gray-400 via-gray-600 to-gray-800 rfp-rounded-full shadow-2xl",children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-full bg-gradient-to-tr from-transparent via-white/10 to-white/20"}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-full shadow-inner",style:{boxShadow:"inset -4px -4px 12px rgba(0,0,0,0.5), inset 4px 4px 12px rgba(255,255,255,0.2)"}})]}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center",children:e.jsx("div",{className:"w-1/3 h-1/3 bg-white/10 rfp-rounded-full blur-sm"})})]}):o.type==="column"?e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative",children:[e.jsxs("div",{className:"rfp-absolute inset-2 bg-gradient-to-br from-slate-400 via-slate-600 to-slate-800 rfp-rounded-lg shadow-2xl",children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-lg bg-gradient-to-br from-white/20 via-transparent to-black/30"}),e.jsx("div",{className:"rfp-absolute rfp-top-0 rfp-left-0 rfp-right-0 rfp-h-1 bg-gradient-to-r from-transparent via-white/30 to-transparent rounded-t-lg"}),e.jsx("div",{className:"rfp-absolute rfp-top-0 rfp-bottom-0 rfp-left-0 rfp-w-1 bg-gradient-to-b from-transparent via-white/30 to-transparent rounded-l-lg"}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-rounded-lg",style:{boxShadow:"inset 0 0 20px rgba(0,0,0,0.5)"}})]}),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center rfp-pointer-events-none",children:e.jsx("div",{className:"w-0.5 h-2/3 bg-white/20"})})]}):o.type==="stairs"?e.jsxs("div",{className:"rfp-w-full rfp-h-full rfp-relative bg-gradient-to-br from-amber-200 via-amber-300 to-amber-400 rfp-rounded-lg rfp-shadow-xl rfp-overflow-hidden",children:[[0,1,2,3,4,5].map(T=>e.jsxs("div",{className:"rfp-absolute rfp-left-0 rfp-right-0 bg-gradient-to-r from-amber-400 to-amber-500 rfp-border-t border-amber-600",style:{top:`${T*16.66}%`,height:"16.66%",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:[e.jsx("div",{className:"rfp-absolute rfp-inset-0 bg-gradient-to-b from-white/20 to-transparent h-1/2"}),e.jsx("div",{className:"rfp-absolute rfp-bottom-0 rfp-left-0 rfp-right-0 h-px bg-black/30"})]},T)),e.jsx("div",{className:"rfp-absolute rfp-inset-0 rfp-flex rfp-items-center rfp-justify-center rfp-pointer-events-none",children:e.jsx("div",{className:"bg-white/80 rfp-rounded-full rfp-p-2 rfp-shadow-lg",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6 text-amber-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 15l7-7 7 7"})})})})]}):null;return e.jsxs("div",{className:`absolute cursor-move select-none ${n?"":"transition-all duration-75"} rounded-lg ${l?"ring-4 ring-blue-400 ring-opacity-50 scale-105":"hover:scale-102"}`,style:{left:`${o.x}px`,top:`${o.y}px`,width:`${o.width}px`,height:`${o.height}px`,transform:`rotate(${o.rotation}deg)`,transformOrigin:"center",willChange:n?"transform":"auto",zIndex:20},onClick:T=>{T.stopPropagation(),d()},onMouseDown:U,children:[ie(),l&&e.jsx("div",{className:"rfp-absolute -bottom-8 left-1/2 transform -translate-x-1/2 rfp-bg-gray-900 rfp-text-white rfp-text-xs rfp-px-2 rfp-py-1 rfp-rounded whitespace-nowrap rfp-shadow-lg z-30",children:o.name}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rfp-absolute -top-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"}),e.jsx("div",{className:"rfp-absolute -top-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -left-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"}),e.jsx("div",{className:"rfp-absolute -bottom-1 -right-1 rfp-w-3 rfp-h-3 rfp-bg-blue-500 rfp-rounded-full rfp-border-2 border-white"})]})]})},ur=Je,yr=({floors:o,currentFloor:l,onAddFloor:d,onRemoveFloor:N,onSwitchFloor:n,onRenameFloor:v,onAddTable:U,onAddObject:ie,onStartWallDrawing:T,onAddFixedElement:le,onRotateTable:J,onDuplicateTable:H,onRemoveTable:V,onSave:Me,onLoad:Ye,selectedTable:Q,selectedTableChairs:$e})=>{const[me,ue]=y.useState(null),[c,I]=y.useState(""),[Z,ye]=y.useState("tables"),pe=y.useRef(null);y.useEffect(()=>{me&&pe.current&&(pe.current.focus(),pe.current.select())},[me]);const Ge=S=>{ue(S.id),I(S.name)},be=()=>{me&&c.trim()&&v(me,c.trim()),ue(null),I("")},Oe=S=>{S.key==="Enter"?be():S.key==="Escape"&&(ue(null),I(""))};return e.jsxs("div",{className:"rfp-w-80 rfp-bg-white rfp-shadow-lg rfp-border-r rfp-border-gray-200 rfp-flex rfp-flex-col",children:[e.jsxs("div",{className:"rfp-p-4 bg-gradient-to-r from-blue-600 to-purple-600 rfp-text-white",children:[e.jsx("h1",{className:"rfp-text-xl rfp-font-bold",children:"Restaurant Designer"}),e.jsx("p",{className:"rfp-text-blue-100 rfp-text-sm",children:"Professional Floor Planner"})]}),e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between rfp-mb-4",children:[e.jsxs("h2",{className:"rfp-text-lg rfp-font-semibold rfp-text-gray-800 rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx(G.Layers,{className:"rfp-w-5 rfp-h-5"}),"Floor Plans (",o.length,")"]}),e.jsxs("div",{className:"rfp-flex rfp-gap-1",children:[e.jsx("button",{onClick:d,className:"rfp-p-2 rfp-text-gray-600 hover:text-green-600 hover:bg-green-50 rfp-rounded-lg transition-colors",title:"Add New Floor",children:e.jsx(G.Plus,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:N,disabled:o.length<=1,className:"rfp-p-2 rfp-text-gray-600 hover:text-red-600 hover:bg-red-50 rfp-rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove Current Floor",children:e.jsx(G.Minus,{className:"rfp-w-4 rfp-h-4"})})]})]}),e.jsx("div",{className:"rfp-space-y-2 rfp-max-h-32 overflow-y-auto",children:o.map(S=>e.jsxs("div",{className:`w-full p-3 rounded-lg transition-all flex items-center justify-between ${S.isActive?"bg-blue-100 text-blue-800 border border-blue-200 shadow-sm":"text-gray-600 hover:bg-gray-100 border border-transparent"}`,onClick:()=>{me!==S.id&&n(S.id)},onDoubleClick:()=>Ge(S),children:[e.jsxs("div",{className:"rfp-flex-1",children:[me===S.id?e.jsx("input",{ref:pe,type:"text",value:c,onChange:Ne=>I(Ne.target.value),onBlur:be,onKeyDown:Oe,className:"rfp-w-full rfp-px-2 rfp-py-1 rfp-text-sm rfp-font-medium rfp-bg-white rfp-border rfp-border-blue-400 rfp-rounded focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:Ne=>Ne.stopPropagation()}):e.jsx("div",{className:"rfp-font-medium rfp-cursor-pointer",children:S.name}),e.jsxs("div",{className:"rfp-text-xs rfp-text-gray-500 mt-0.5",children:[S.tables.length," tables, ",S.chairs.length," chairs"]})]}),S.isActive&&e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-blue-500 rfp-rounded-full"})]},S.id))})]}),e.jsx("div",{className:"rfp-border-b rfp-border-gray-200",children:e.jsxs("div",{className:"rfp-flex",children:[e.jsxs("button",{onClick:()=>ye("tables"),className:`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${Z==="tables"?"bg-white text-emerald-600 border-b-2 border-emerald-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(G.LayoutGrid,{className:"rfp-w-4 rfp-h-4"}),"Tables"]}),e.jsxs("button",{onClick:()=>ye("objects"),className:`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${Z==="objects"?"bg-white text-purple-600 border-b-2 border-purple-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(G.Package,{className:"rfp-w-4 rfp-h-4"}),"Objects"]}),e.jsxs("button",{onClick:()=>ye("roomLayout"),className:`flex-1 py-3 px-4 font-semibold text-sm transition-all flex items-center justify-center gap-2 ${Z==="roomLayout"?"bg-white text-gray-700 border-b-2 border-gray-700":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(G.Home,{className:"rfp-w-4 rfp-h-4"}),"Room"]})]})}),Z==="tables"&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Add Tables"}),e.jsx("div",{className:"rfp-grid grid-cols-2 rfp-gap-3",children:Object.entries(dr).map(([S,Ne])=>e.jsxs("button",{onClick:()=>U(S),className:"rfp-p-3 rfp-border-2 rfp-border-gray-200 rfp-rounded-lg hover:border-emerald-400 hover:bg-emerald-50 rfp-transition-all rfp-flex rfp-flex-col rfp-items-center rfp-gap-2 hover:shadow-md",children:[e.jsx(Ne,{className:"rfp-w-6 rfp-h-6 text-emerald-600"}),e.jsx("span",{className:"rfp-text-xs rfp-text-gray-700 rfp-capitalize rfp-font-medium",children:S})]},S))})]}),Z==="objects"&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Add Objects"}),e.jsx("div",{className:"rfp-space-y-3",children:Object.keys(Ze).map(S=>{const Ne=Ue[S],R=Ke[S],K=Ze[S];return e.jsxs("button",{onClick:()=>ie(S),className:`w-full p-4 ${R.bg} border-2 ${R.border} rounded-xl hover:scale-105 transition-all flex items-center gap-3 shadow-lg hover:shadow-xl`,children:[e.jsx("div",{className:"bg-white/20 rfp-p-2 rfp-rounded-lg",children:e.jsx(Ne,{className:`w-6 h-6 ${R.text}`,strokeWidth:2.5})}),e.jsxs("div",{className:"rfp-flex-1 rfp-text-left",children:[e.jsx("span",{className:`text-base font-bold ${R.text}`,children:K}),e.jsx("div",{className:"rfp-text-xs text-white/80 mt-0.5",children:"Click to add to floor"})]})]},S)})})]}),Z==="roomLayout"&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-mb-6",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Draw Walls"}),e.jsx("div",{className:"rfp-space-y-2",children:["wall","door","window"].map(S=>{const Ne=fr[S],R=qe[S],K={wall:"bg-gradient-to-br from-gray-600 to-gray-800 border-gray-700 text-white hover:from-gray-700 hover:to-gray-900",door:"bg-gradient-to-br from-amber-500 to-amber-700 border-amber-600 text-white hover:from-amber-600 hover:to-amber-800",window:"bg-gradient-to-br from-blue-500 to-blue-700 border-blue-600 text-white hover:from-blue-600 hover:to-blue-800"};return e.jsxs("button",{onClick:()=>T(S),className:`w-full p-3 border-2 rounded-lg transition-all flex items-center gap-3 shadow-md hover:shadow-lg ${K[S]}`,children:[e.jsx(Ne,{className:"rfp-w-5 rfp-h-5",strokeWidth:2.5}),e.jsx("span",{className:"rfp-text-sm rfp-font-semibold",children:R})]},S)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800 rfp-mb-3",children:"Add Elements"}),e.jsx("div",{className:"rfp-space-y-2",children:["pillar","column","stairs"].map(S=>{const Ne=cr[S],R=hr[S],K=Qe[S];return e.jsxs("button",{onClick:()=>le(S),className:`w-full p-3 ${R.bg} border-2 ${R.border} rounded-lg hover:scale-105 transition-all flex items-center gap-3 shadow-md hover:shadow-lg`,children:[e.jsx("div",{className:"bg-white/10 p-1.5 rfp-rounded",children:e.jsx(Ne,{className:`w-5 h-5 ${R.text}`,strokeWidth:2.5})}),e.jsx("span",{className:`text-sm font-semibold ${R.text}`,children:K})]},S)})})]})]}),Q&&e.jsxs("div",{className:"rfp-p-4 rfp-border-b rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between rfp-mb-3",children:[e.jsx("h3",{className:"text-md rfp-font-semibold rfp-text-gray-800",children:"Table Properties"}),e.jsxs("div",{className:"rfp-flex rfp-gap-1",children:[e.jsx("button",{onClick:J,className:"rfp-p-1 rfp-text-blue-600 hover:bg-blue-100 rfp-rounded transition-colors",title:"Rotate Table",children:e.jsx(G.RotateCw,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:H,className:"rfp-p-1 rfp-text-green-600 hover:bg-green-100 rfp-rounded transition-colors",title:"Duplicate Table",children:e.jsx(G.Plus,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:V,className:"rfp-p-1 rfp-text-red-600 hover:bg-red-100 rfp-rounded transition-colors",title:"Delete Table",children:e.jsx(G.Trash2,{className:"rfp-w-4 rfp-h-4"})})]})]}),e.jsxs("div",{className:"rfp-space-y-3 rfp-text-sm rfp-text-gray-600",children:[e.jsxs("div",{className:"rfp-grid grid-cols-2 rfp-gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Name"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800",children:Q.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Shape"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800 rfp-capitalize",children:Q.shape})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Size"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800",children:ur[Q.size]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-xs rfp-uppercase rfp-tracking-wide rfp-text-gray-400",children:"Seats"}),e.jsx("div",{className:"rfp-font-semibold rfp-text-gray-800",children:$e.length})]})]}),e.jsx("div",{className:"rfp-bg-blue-50 rfp-border rfp-border-blue-200 rfp-rounded-md rfp-p-3",children:e.jsxs("p",{className:"rfp-text-xs rfp-text-blue-700",children:["ðŸ’¡ ",e.jsx("span",{className:"rfp-font-semibold",children:"Tip:"})," Use the ",e.jsx("span",{className:"rfp-font-semibold",children:"Manage Chairs"})," button in the toolbar above to add or remove chairs from each side of the table."]})})]})]}),e.jsxs("div",{className:"rfp-p-4 mt-auto rfp-space-y-3",children:[e.jsxs("div",{className:"rfp-bg-gray-50 rfp-p-3 rfp-rounded-lg",children:[e.jsx("h4",{className:"rfp-text-sm rfp-font-semibold rfp-text-gray-700 rfp-mb-2",children:"Current Floor Stats"}),e.jsxs("div",{className:"rfp-grid grid-cols-2 rfp-gap-4 rfp-text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-gray-600",children:"Tables"}),e.jsx("div",{className:"rfp-font-bold rfp-text-lg text-emerald-600",children:(l==null?void 0:l.tables.length)??0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-gray-600",children:"Total Seats"}),e.jsx("div",{className:"rfp-font-bold rfp-text-lg text-amber-600",children:(l==null?void 0:l.chairs.length)??0})]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-gap-2",children:[e.jsxs("button",{onClick:Me,className:"rfp-flex-1 rfp-bg-green-600 rfp-text-white rfp-py-3 rfp-px-4 rfp-rounded-lg hover:bg-green-700 transition-colors rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-medium",children:[e.jsx(G.Save,{className:"rfp-w-4 rfp-h-4"}),"Save"]}),e.jsxs("button",{onClick:Ye,className:"rfp-flex-1 rfp-bg-blue-600 rfp-text-white rfp-py-3 rfp-px-4 rfp-rounded-lg hover:bg-blue-700 transition-colors rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-medium",children:[e.jsx(G.Upload,{className:"rfp-w-4 rfp-h-4"}),"Load"]})]})]})]})},rr=Je,vr=["top","right","bottom","left"],Mr=["small","medium","large"],Nr=({showGrid:o,selectedTable:l,selectedObject:d,selectedWall:N,selectedFixedElement:n,selectedTableChairs:v,onToggleGrid:U,onAddChair:ie,onRemoveChair:T,onChangeTableSize:le,onTableNameChange:J,onCustomTableSize:H,onObjectNameChange:V,onObjectResize:Me,onRemoveObject:Ye,onRemoveWall:Q,onRemoveFixedElement:$e,onChangeWallThickness:me,onConvertWallType:ue,onFixedElementNameChange:c,onFixedElementResize:I,onChairSizeChange:Z,onResetChairSizes:ye,on3DPreview:pe,onObjectRotate:Ge,tableCount:be,chairCount:Oe,objectCount:S,wallCount:Ne,fixedElementCount:R,selectedElementType:K})=>{const Le=y.useRef(null),t=y.useRef(null),q=y.useRef(null),D=y.useRef(null),[k,p]=y.useState(!1),[$,h]=y.useState(!1),[L,F]=y.useState(!1),[z,oe]=y.useState(!1),[_,de]=y.useState(!1),[ee,B]=y.useState(90),[E,W]=y.useState(90),[b,te]=y.useState(120),[j,ke]=y.useState(80),[Y,C]=y.useState(60),[m,xe]=y.useState(60);return y.useEffect(()=>{const g=M=>{Le.current&&!Le.current.contains(M.target)&&p(!1),t.current&&!t.current.contains(M.target)&&h(!1),q.current&&!q.current.contains(M.target)&&F(!1),D.current&&!D.current.contains(M.target)&&oe(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]),y.useEffect(()=>{l?(B(l.width),W(l.height)):(p(!1),h(!1),de(!1)),d?(te(d.width),ke(d.height)):F(!1),n?(C(n.width),xe(n.height)):oe(!1)},[l,d,n]),e.jsx("div",{className:"rfp-bg-white rfp-border-b rfp-border-gray-200 rfp-shadow-sm min-h-[72px]",children:e.jsxs("div",{className:"rfp-px-4 rfp-py-3 rfp-flex rfp-items-center rfp-justify-between min-h-[72px]",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3 rfp-flex-wrap",children:[e.jsxs("button",{onClick:U,className:`px-3 py-2 rounded-lg transition-all flex items-center gap-2 text-sm font-medium ${o?"bg-blue-500 text-white shadow-md hover:bg-blue-600":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:o?"Hide Grid":"Show Grid",children:[o?e.jsx(G.Eye,{className:"rfp-w-4 rfp-h-4"}):e.jsx(G.EyeOff,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Grid"})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),e.jsxs("div",{ref:Le,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>{p(!k),h(!1)},className:"rfp-px-3 rfp-py-2 rfp-rounded-lg bg-gradient-to-r from-amber-500 to-amber-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",children:[e.jsx(G.Armchair,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Manage Chairs"}),e.jsx("span",{className:"rfp-ml-1 px-1.5 py-0.5 bg-white/20 rfp-rounded rfp-text-xs",children:v.length})]}),k&&e.jsxs("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-72 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-500 to-amber-600 rfp-px-4 rfp-py-3 rfp-text-white",children:e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx(G.Armchair,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{className:"rfp-font-semibold rfp-text-sm",children:"Chair Positions"})]}),e.jsxs("span",{className:"rfp-text-xs bg-white/20 rfp-px-2 rfp-py-1 rfp-rounded",children:["Total: ",v.length]})]})}),e.jsxs("div",{className:"rfp-p-3 rfp-space-y-2",children:[vr.map(g=>{const M=v.filter(x=>x.position===g).length,Ce=v.find(x=>x.position===g),A=(Ce==null?void 0:Ce.size)||40;return e.jsxs("div",{className:"rfp-bg-gray-50 rfp-rounded-lg rfp-px-3 rfp-py-2 rfp-border rfp-border-gray-200 hover:border-amber-300 rfp-transition-all rfp-space-y-2",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3",children:[e.jsx("div",{className:"rfp-w-8 rfp-h-8 bg-gradient-to-br from-gray-600 to-gray-700 rfp-rounded-md rfp-flex rfp-items-center rfp-justify-center rfp-text-white rfp-text-xs rfp-font-bold rfp-uppercase",children:g[0]}),e.jsxs("div",{children:[e.jsx("div",{className:"rfp-text-sm rfp-font-medium rfp-text-gray-800 rfp-capitalize",children:g}),e.jsxs("div",{className:"rfp-text-xs rfp-text-gray-500",children:[M," chair",M!==1?"s":""]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-1",children:[e.jsx("button",{onClick:()=>T(g),disabled:M===0,className:"rfp-w-7 rfp-h-7 rfp-rounded-md rfp-bg-red-50 rfp-text-red-600 hover:bg-red-100 disabled:opacity-30 disabled:cursor-not-allowed rfp-transition-all rfp-flex rfp-items-center rfp-justify-center",title:"Remove chair",children:e.jsx(G.Minus,{className:"rfp-w-4 rfp-h-4"})}),e.jsx("button",{onClick:()=>ie(g),className:"rfp-w-7 rfp-h-7 rfp-rounded-md rfp-bg-green-50 rfp-text-green-600 hover:bg-green-100 rfp-transition-all rfp-flex rfp-items-center rfp-justify-center",title:"Add chair",children:e.jsx(G.Plus,{className:"rfp-w-4 rfp-h-4"})})]})]}),M>0&&e.jsxs("div",{className:"rfp-pt-2 rfp-border-t rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between rfp-mb-1",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-medium rfp-text-gray-600",children:"Chair Size"}),e.jsxs("span",{className:"rfp-text-xs rfp-font-bold text-amber-600",children:[A,"px"]})]}),e.jsx("input",{type:"range",min:"20",max:"60",value:A,onChange:x=>Z==null?void 0:Z(g,parseInt(x.target.value)),className:"rfp-w-full rfp-h-2 bg-gradient-to-r from-amber-200 to-amber-400 rfp-rounded-full appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, rgb(251, 191, 36) 0%, rgb(251, 191, 36) ${(A-20)/40*100}%, rgb(253, 230, 138) ${(A-20)/40*100}%, rgb(253, 230, 138) 100%)`}})]})]},g)}),e.jsxs("button",{onClick:()=>ye==null?void 0:ye(),className:"rfp-w-full rfp-mt-3 rfp-px-3 rfp-py-2 bg-gradient-to-r from-gray-500 to-gray-600 rfp-text-white rfp-rounded-lg hover:from-gray-600 hover:to-gray-700 rfp-transition-all rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-text-sm rfp-font-medium",children:[e.jsx(G.RotateCcw,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Reset All Sizes"})]})]})]})]}),e.jsxs("div",{ref:t,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>{h(!$),p(!1)},className:"rfp-px-3 rfp-py-2 rfp-rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",children:[e.jsx(G.Square,{className:"rfp-w-4 rfp-h-4"}),e.jsxs("span",{children:["Size: ",rr[l.size]]})]}),$&&e.jsxs("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-64 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 rfp-px-4 rfp-py-2 rfp-text-white",children:e.jsx("span",{className:"rfp-font-semibold rfp-text-sm",children:"Table Size"})}),e.jsxs("div",{className:"rfp-p-3 rfp-space-y-2",children:[e.jsx("div",{className:"rfp-flex rfp-gap-2",children:Mr.map(g=>{const M=l.size===g;return e.jsx("button",{onClick:()=>{le(g),de(!1)},className:`flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-all ${M&&!_?"bg-emerald-500 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:rr[g]},g)})}),e.jsxs("button",{onClick:()=>de(!_),className:`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-all ${_?"bg-purple-500 text-white shadow-sm":"bg-gradient-to-r from-purple-100 to-purple-50 text-purple-700 hover:from-purple-200 hover:to-purple-100"}`,children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("span",{className:"rfp-text-sm rfp-font-semibold",children:"Pro Mode"}),e.jsx("span",{className:"rfp-text-xs bg-white/20 px-1.5 py-0.5 rfp-rounded",children:"Custom"})]}),e.jsx(G.ChevronRight,{className:`w-4 h-4 transition-transform ${_?"rotate-90":""}`})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${_?"max-h-48 opacity-100":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"rfp-pt-2 rfp-space-y-3 rfp-border-t rfp-border-gray-200",children:[e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Width"}),e.jsxs("span",{className:"rfp-text-xs font-mono rfp-bg-purple-100 rfp-text-purple-700 rfp-px-2 py-0.5 rfp-rounded",children:[ee,"px"]})]}),e.jsx("input",{type:"range",min:"40",max:"200",step:"5",value:ee,onChange:g=>{const M=parseInt(g.target.value);B(M),H(M,E)},className:"rfp-w-full rfp-h-2 rfp-bg-purple-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${(ee-40)/160*100}%, rgb(233, 213, 255) ${(ee-40)/160*100}%, rgb(233, 213, 255) 100%)`}})]}),e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Height"}),e.jsxs("span",{className:"rfp-text-xs font-mono rfp-bg-purple-100 rfp-text-purple-700 rfp-px-2 py-0.5 rfp-rounded",children:[E,"px"]})]}),e.jsx("input",{type:"range",min:"40",max:"200",step:"5",value:E,onChange:g=>{const M=parseInt(g.target.value);W(M),H(ee,M)},className:"rfp-w-full rfp-h-2 rfp-bg-purple-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, rgb(168, 85, 247) 0%, rgb(168, 85, 247) ${(E-40)/160*100}%, rgb(233, 213, 255) ${(E-40)/160*100}%, rgb(233, 213, 255) 100%)`}})]}),e.jsx("p",{className:"rfp-text-xs rfp-text-gray-500 italic rfp-pt-1",children:"Drag sliders for precise sizing"})]})})]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:"Name:"}),e.jsx("input",{type:"text",value:l.name,onChange:g=>J(g.target.value),className:"rfp-bg-transparent rfp-text-sm rfp-text-gray-800 rfp-font-medium focus:outline-none rfp-w-32",placeholder:"Table name"})]})]}),d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),e.jsxs("div",{ref:q,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>F(!L),className:`px-3 py-2 rounded-lg ${d.type==="bar"?"bg-gradient-to-r from-purple-500 to-purple-600":d.type==="kitchen"?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gradient-to-r from-cyan-500 to-cyan-600"} text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`,children:[(()=>{const g=Ue[d.type];return e.jsx(g,{className:"rfp-w-4 rfp-h-4"})})(),e.jsxs("span",{children:["Resize ",Ze[d.type]]})]}),L&&e.jsxs("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-w-64 rfp-bg-white rfp-border rfp-border-gray-200 rfp-rounded-xl shadow-2xl z-50 rfp-overflow-hidden",children:[e.jsx("div",{className:`${d.type==="bar"?"bg-gradient-to-r from-purple-500 to-purple-600":d.type==="kitchen"?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gradient-to-r from-cyan-500 to-cyan-600"} px-4 py-2 text-white`,children:e.jsx("span",{className:"rfp-font-semibold rfp-text-sm",children:"Custom Size"})}),e.jsxs("div",{className:"rfp-p-3 rfp-space-y-3",children:[e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Width"}),e.jsxs("span",{className:`text-xs font-mono px-2 py-0.5 rounded ${d.type==="bar"?"bg-purple-100 text-purple-700":d.type==="kitchen"?"bg-orange-100 text-orange-700":"bg-cyan-100 text-cyan-700"}`,children:[b,"px"]})]}),e.jsx("input",{type:"range",min:"60",max:"1000",step:"10",value:b,onChange:g=>{const M=parseInt(g.target.value);te(M),Me(M,j)},className:"rfp-w-full rfp-h-2 rfp-bg-gray-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, ${d.type==="bar"?"rgb(168, 85, 247)":d.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} 0%, ${d.type==="bar"?"rgb(168, 85, 247)":d.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} ${(b-60)/940*100}%, rgb(229, 231, 235) ${(b-60)/940*100}%, rgb(229, 231, 235) 100%)`}})]}),e.jsxs("div",{className:"rfp-space-y-1",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsx("label",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600 rfp-uppercase rfp-tracking-wide",children:"Height"}),e.jsxs("span",{className:`text-xs font-mono px-2 py-0.5 rounded ${d.type==="bar"?"bg-purple-100 text-purple-700":d.type==="kitchen"?"bg-orange-100 text-orange-700":"bg-cyan-100 text-cyan-700"}`,children:[j,"px"]})]}),e.jsx("input",{type:"range",min:"60",max:"1000",step:"10",value:j,onChange:g=>{const M=parseInt(g.target.value);ke(M),Me(b,M)},className:"rfp-w-full rfp-h-2 rfp-bg-gray-200 rfp-rounded-lg appearance-none rfp-cursor-pointer slider-thumb",style:{background:`linear-gradient(to right, ${d.type==="bar"?"rgb(168, 85, 247)":d.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} 0%, ${d.type==="bar"?"rgb(168, 85, 247)":d.type==="kitchen"?"rgb(249, 115, 22)":"rgb(6, 182, 212)"} ${(j-60)/940*100}%, rgb(229, 231, 235) ${(j-60)/940*100}%, rgb(229, 231, 235) 100%)`}})]}),e.jsx("p",{className:"rfp-text-xs rfp-text-gray-500 italic rfp-pt-1",children:"Drag sliders to resize the object"})]})]})]}),e.jsxs("button",{onClick:()=>{const g=((d.rotation||0)+90)%360;Ge==null||Ge(g)},className:`px-3 py-2 rounded-lg ${d.type==="bar"?"bg-gradient-to-r from-purple-600 to-purple-700":d.type==="kitchen"?"bg-gradient-to-r from-orange-600 to-orange-700":"bg-gradient-to-r from-cyan-600 to-cyan-700"} text-white shadow-md hover:shadow-lg transition-all flex items-center gap-2 text-sm font-semibold`,title:"Rotate 90Â°",children:[e.jsx(G.RotateCcw,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Rotate"})]}),e.jsxs("button",{onClick:Ye,className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",title:"Delete Object",children:[e.jsx(G.Trash2,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Delete"})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:"Name:"}),e.jsx("input",{type:"text",value:d.name,onChange:g=>V(g.target.value),className:"rfp-bg-transparent rfp-text-sm rfp-text-gray-800 rfp-font-medium focus:outline-none rfp-w-32",placeholder:"Object name"})]})]}),N&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),ue&&e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-1 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-p-1",children:[e.jsx("button",{onClick:()=>ue("wall"),className:`px-3 py-1.5 rounded text-xs font-semibold transition-all ${N.type==="wall"?"bg-gray-600 text-white shadow-md":"text-gray-600 hover:bg-gray-200"}`,title:"Convert to Wall",children:"Wall"}),e.jsx("button",{onClick:()=>ue("door"),className:`px-3 py-1.5 rounded text-xs font-semibold transition-all ${N.type==="door"?"bg-amber-600 text-white shadow-md":"text-gray-600 hover:bg-gray-200"}`,title:"Convert to Door",children:"Door"}),e.jsx("button",{onClick:()=>ue("window"),className:`px-3 py-1.5 rounded text-xs font-semibold transition-all ${N.type==="window"?"bg-blue-600 text-white shadow-md":"text-gray-600 hover:bg-gray-200"}`,title:"Convert to Window",children:"Window"})]}),me&&e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-text-gray-600",children:"Thickness:"}),e.jsxs("select",{value:N.thickness,onChange:g=>me(Number(g.target.value)),className:"rfp-px-2 rfp-py-1 rfp-text-sm rfp-border rfp-border-gray-300 rfp-rounded rfp-bg-white hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:4,children:"Thin (4px)"}),e.jsx("option",{value:8,children:"Normal (8px)"}),e.jsx("option",{value:12,children:"Thick (12px)"}),e.jsx("option",{value:16,children:"Very Thick (16px)"})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:[e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:qe[N.type]}),e.jsxs("span",{className:"rfp-text-sm rfp-text-gray-600",children:[Math.round(Math.sqrt(Math.pow(N.endX-N.startX,2)+Math.pow(N.endY-N.startY,2))),"px"]})]}),e.jsxs("button",{onClick:Q,className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",title:"Delete Wall",children:[e.jsx(G.Trash2,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Delete"})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px rfp-h-8 rfp-bg-gray-300"}),e.jsx("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-bg-gray-50 rfp-border rfp-border-gray-300 rfp-rounded-lg rfp-px-3 rfp-py-2",children:e.jsx("span",{className:"rfp-text-xs rfp-font-semibold rfp-uppercase rfp-tracking-wide rfp-text-gray-500",children:Qe[n.type]})}),I&&e.jsxs("div",{ref:D,className:"rfp-relative",children:[e.jsxs("button",{onClick:()=>oe(!z),className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-gray-600 hover:bg-gray-700 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",children:[e.jsx(G.Square,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Resize"})]}),z&&e.jsx("div",{className:"rfp-absolute top-full rfp-left-0 rfp-mt-2 rfp-bg-white rfp-rounded-xl shadow-2xl rfp-border rfp-border-gray-200 rfp-p-4 z-50 min-w-[320px]",children:e.jsxs("div",{className:"rfp-space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-items-center rfp-mb-2",children:[e.jsx("label",{className:"rfp-text-sm rfp-font-semibold rfp-text-gray-700",children:"Width"}),e.jsxs("span",{className:"rfp-text-sm rfp-font-bold rfp-text-blue-600",children:[Y,"px"]})]}),e.jsx("input",{type:"range",min:"30",max:"200",value:Y,onChange:g=>{const M=parseInt(g.target.value);C(M),I(M,m)},className:"rfp-w-full rfp-h-2 bg-gradient-to-r from-blue-200 to-blue-500 rfp-rounded-lg appearance-none rfp-cursor-pointer slider"}),e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-text-xs rfp-text-gray-500 rfp-mt-1",children:[e.jsx("span",{children:"30px"}),e.jsx("span",{children:"200px"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-items-center rfp-mb-2",children:[e.jsx("label",{className:"rfp-text-sm rfp-font-semibold rfp-text-gray-700",children:"Height"}),e.jsxs("span",{className:"rfp-text-sm rfp-font-bold rfp-text-blue-600",children:[m,"px"]})]}),e.jsx("input",{type:"range",min:"30",max:"200",value:m,onChange:g=>{const M=parseInt(g.target.value);xe(M),I(Y,M)},className:"rfp-w-full rfp-h-2 bg-gradient-to-r from-green-200 to-green-500 rfp-rounded-lg appearance-none rfp-cursor-pointer slider"}),e.jsxs("div",{className:"rfp-flex rfp-justify-between rfp-text-xs rfp-text-gray-500 rfp-mt-1",children:[e.jsx("span",{children:"30px"}),e.jsx("span",{children:"200px"})]})]}),e.jsx("div",{className:"rfp-pt-3 rfp-border-t rfp-border-gray-200",children:e.jsxs("div",{className:"rfp-text-center",children:[e.jsx("span",{className:"rfp-text-xs rfp-text-gray-600",children:"Current Size: "}),e.jsxs("span",{className:"rfp-text-sm rfp-font-bold rfp-text-gray-800",children:[Y," Ã— ",m,"px"]})]})})]})})]}),e.jsxs("button",{onClick:$e,className:"rfp-px-3 rfp-py-2 rfp-rounded-lg rfp-bg-red-500 hover:bg-red-600 rfp-text-white rfp-shadow-md hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-text-sm rfp-font-semibold",title:"Delete Element",children:[e.jsx(G.Trash2,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{children:"Delete"})]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3 rfp-flex-wrap",children:[e.jsxs("button",{onClick:pe,className:"rfp-px-4 rfp-py-2 bg-gradient-to-r from-purple-600 to-blue-600 rfp-text-white rfp-rounded-lg hover:shadow-lg rfp-transition-all rfp-flex rfp-items-center rfp-gap-2 rfp-font-semibold rfp-text-sm",children:[e.jsx(G.Box,{className:"rfp-w-4 rfp-h-4"}),"3D"]}),e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 bg-emerald-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-emerald-600 rfp-rounded-full"}),e.jsxs("span",{className:"rfp-font-medium text-emerald-800",children:["Tables: ",be]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 bg-amber-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-amber-600 rfp-rounded-full"}),e.jsxs("span",{className:"rfp-font-medium text-amber-800",children:["Chairs: ",Oe]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 rfp-bg-purple-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-purple-600 rfp-rounded-full"}),e.jsxs("span",{className:"rfp-font-medium rfp-text-purple-800",children:["Objects: ",S]})]}),K&&e.jsxs("div",{className:"rfp-flex rfp-items-center gap-1.5 rfp-px-2 rfp-py-1 rfp-bg-blue-50 rfp-rounded rfp-text-xs",children:[e.jsx("div",{className:"w-1.5 h-1.5 rfp-bg-blue-600 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-font-medium rfp-text-blue-800 rfp-capitalize",children:["Selected: ",K]})]})]})]})})},tr={default:{position:{x:1050,y:800,z:1050},target:{x:0,y:100,z:0},name:"Default",icon:"ðŸ "},top:{position:{x:0,y:1200,z:1},target:{x:0,y:0,z:0},name:"Top View",icon:"â¬‡"},front:{position:{x:0,y:300,z:1e3},target:{x:0,y:100,z:0},name:"Front",icon:"â¬†"},side:{position:{x:1e3,y:300,z:0},target:{x:0,y:100,z:0},name:"Side",icon:"âž¡"},corner:{position:{x:-900,y:700,z:-900},target:{x:0,y:100,z:0},name:"Corner",icon:"â†–"}},sr=({floor:o,isOpen:l,onClose:d})=>{const N=y.useRef(null),n=y.useRef(null),v=y.useRef(null),U=y.useRef(null),ie=y.useRef(null),[T,le]=y.useState(!1),[J,H]=y.useState("default"),[V,Me]=y.useState(!1),Ye=y.useRef(.003),Q=y.useRef(null),$e=c=>{if(!v.current||V)return;const I=tr[c],Z=v.current;Q.current={startPos:Z.position.clone(),endPos:new r.Vector3(I.position.x,I.position.y,I.position.z),startTarget:new r.Vector3(0,100,0),endTarget:new r.Vector3(I.target.x,I.target.y,I.target.z),progress:0},Me(!0),H(c),le(!1)},me=c=>{if(!v.current||V)return;const I=v.current,Z=Math.sqrt(I.position.x**2+I.position.z**2),ye=Math.atan2(I.position.z,I.position.x);switch(c){case"left":const pe=ye+.2;I.position.x=Z*Math.cos(pe),I.position.z=Z*Math.sin(pe);break;case"right":const Ge=ye-.2;I.position.x=Z*Math.cos(Ge),I.position.z=Z*Math.sin(Ge);break;case"up":I.position.y=Math.min(I.position.y+50,900);break;case"down":I.position.y=Math.max(I.position.y-50,100);break}I.lookAt(0,100,0)},ue=c=>{!v.current||V||(v.current.position.multiplyScalar(c),v.current.lookAt(0,100,0))};return y.useEffect(()=>{if(!l||!N.current)return;const c=new r.Scene;c.background=new r.Color(14608111),n.current=c;const I=new r.PerspectiveCamera(45,N.current.clientWidth/N.current.clientHeight,.1,1e4);I.position.set(1050,800,1050),I.lookAt(0,100,0),v.current=I;const Z=new r.WebGLRenderer({antialias:!0,alpha:!0});Z.setSize(N.current.clientWidth,N.current.clientHeight),Z.shadowMap.enabled=!0,Z.shadowMap.type=r.PCFSoftShadowMap,Z.toneMapping=r.ACESFilmicToneMapping,Z.toneMappingExposure=1.2,N.current.appendChild(Z.domElement),U.current=Z;const ye=new r.PMREMGenerator(Z),pe=new r.Scene;pe.background=new r.Color(16777215);const Ge=ye.fromScene(pe).texture;c.environment=Ge,ye.dispose(),c.add(new r.AmbientLight(16777215,.6));const be=new r.DirectionalLight(16777215,.8);be.position.set(400,600,300),be.castShadow=!0,be.shadow.mapSize.width=4096,be.shadow.mapSize.height=4096,be.shadow.camera.left=be.shadow.camera.bottom=-700,be.shadow.camera.right=be.shadow.camera.top=700,be.shadow.bias=-1e-4,c.add(be);const Oe=new r.DirectionalLight(16777215,.3);Oe.position.set(-400,400,-300),c.add(Oe);const S=new r.DirectionalLight(16777215,.2);S.position.set(0,300,-500),c.add(S);const Ne=new r.Mesh(new r.PlaneGeometry(1200,1200),new r.MeshStandardMaterial({color:13684949,roughness:.8,metalness:.2}));Ne.rotation.x=-Math.PI/2,Ne.receiveShadow=!0,c.add(Ne);const R=new r.GridHelper(3e3,150,10526888,12105920);R.position.y=1,c.add(R),o.walls.forEach(t=>{const q=Math.sqrt(Math.pow(t.endX-t.startX,2)+Math.pow(t.endY-t.startY,2)),D=Math.atan2(t.endY-t.startY,t.endX-t.startX),k=t.type==="window"?80:120,p=t.startX+(t.endX-t.startX)/2-400,$=-(t.startY+(t.endY-t.startY)/2-400);if(t.type==="door"){const h=new r.Group,L=q,F=k,z=t.thickness*.8,oe=new r.MeshStandardMaterial({color:3812901,roughness:.9,metalness:0}),_=8,de=new r.Mesh(new r.BoxGeometry(L,_,t.thickness+4),oe);de.position.y=F/2-_/2,h.add(de);const ee=new r.Mesh(new r.BoxGeometry(L,_,t.thickness+4),oe);ee.position.y=-F/2+_/2,h.add(ee);const B=new r.Mesh(new r.BoxGeometry(_,F,t.thickness+4),oe);B.position.x=-L/2+_/2,h.add(B);const E=B.clone();E.position.x=L/2-_/2,h.add(E);const W=new r.MeshStandardMaterial({color:5125166,roughness:.85,metalness:0}),b=new r.MeshStandardMaterial({color:10400693,transparent:!0,opacity:.5,roughness:.95,metalness:0}),te=(L-_*2-4)/2,j=F-_*2-4,ke=Pe=>{const Ee=new r.Group,fe=new r.Mesh(new r.BoxGeometry(te,j,z),W);Ee.add(fe);const ce=new r.Mesh(new r.PlaneGeometry(te*.8,j*.85),b);ce.position.set(0,0,z/2+.1),Ee.add(ce);const w=new r.MeshStandardMaterial({color:8947848,metalness:.4,roughness:.7}),se=new r.Mesh(new r.CylinderGeometry(.6,.6,12,12),w);return se.rotation.z=Math.PI/2,se.position.set(Pe>0?-te*.35:te*.35,0,z/2+1.5),Ee.add(se),Ee.position.x=Pe,Ee},Y=ke(-te/2),C=ke(te/2);h.add(Y),h.add(C);const m=14,xe=new r.PlaneGeometry(L*.9,m),g=document.createElement("canvas");g.width=512,g.height=128;const M=g.getContext("2d");M&&(M.fillStyle="#3a2e25",M.fillRect(0,0,g.width,g.height),M.font="bold 60px Arial",M.fillStyle="#f5d590",M.textAlign="center",M.textBaseline="middle",M.fillText("WELCOME",g.width/2,g.height/2));const Ce=new r.CanvasTexture(g),A=new r.MeshStandardMaterial({map:Ce,roughness:.8,metalness:.1}),x=new r.Mesh(xe,A);x.position.set(0,F/2-_-m/2-4,t.thickness/2+2),h.add(x),h.position.set(p,F/2,$),h.rotation.y=-D,h.castShadow=!0,h.receiveShadow=!0,c.add(h)}else if(t.type==="window"){const h=q>20?q:120,L=k,F=L*.45,z=L*.65,oe=L*.1,_=L*.3,de=new r.MeshStandardMaterial({color:13158608,roughness:.85,metalness:.05}),ee=new r.MeshPhysicalMaterial({color:2763306,metalness:.95,roughness:.2,clearcoat:.8,clearcoatRoughness:.1}),B=new r.MeshPhysicalMaterial({color:15135487,transparent:!0,opacity:.4,transmission:.85,thickness:1.5,roughness:.05,metalness:.05,ior:1.52,envMapIntensity:1,clearcoat:.8,clearcoatRoughness:.1,reflectivity:.5}),E=new r.Mesh(new r.BoxGeometry(h,F,t.thickness),de);E.position.set(p,F/2,$),E.rotation.y=-D,E.receiveShadow=!0,E.castShadow=!0,c.add(E);const W=F+z/2,b=4,te=Math.max(2,Math.floor(h/80)),j=(h-b*(te+1))/te;for(let g=0;g<te;g++){const M=-h/2+b+j/2+g*(j+b),Ce=p+M*Math.cos(-D),A=$+M*Math.sin(-D),x=new r.Mesh(new r.BoxGeometry(j-2,z-b*2,1),B);if(x.position.set(Ce,W,A),x.rotation.y=-D,x.castShadow=!1,x.receiveShadow=!1,c.add(x),g<te-1){const Pe=-h/2+b+(g+1)*j+(g+.5)*b,Ee=p+Pe*Math.cos(-D),fe=$+Pe*Math.sin(-D),ce=new r.Mesh(new r.BoxGeometry(b,z,t.thickness+3),ee);ce.position.set(Ee,W,fe),ce.rotation.y=-D,ce.castShadow=!0,c.add(ce)}}const ke=F+z+oe/2,Y=new r.Mesh(new r.BoxGeometry(h-b*2,oe-b,1),B);Y.position.set(p,ke,$),Y.rotation.y=-D,Y.castShadow=!1,c.add(Y);const C=new r.Mesh(new r.BoxGeometry(h,b,t.thickness+2),ee);C.position.set(p,F+z+b/2,$),C.rotation.y=-D,C.castShadow=!0,c.add(C);const m=new r.Mesh(new r.BoxGeometry(h,b,t.thickness+2),ee);m.position.set(p,F+z+oe+b/2,$),m.rotation.y=-D,m.castShadow=!0,c.add(m);const xe=new r.Mesh(new r.BoxGeometry(h,_,t.thickness),de);xe.position.set(p,F+z+oe+_/2,$),xe.rotation.y=-D,xe.castShadow=!0,xe.receiveShadow=!0,c.add(xe)}else{const h=new r.Mesh(new r.BoxGeometry(q,k,t.thickness),new r.MeshStandardMaterial({color:12105920,roughness:.9,metalness:.05}));h.position.set(p,k/2,$),h.rotation.y=-D,h.castShadow=!0,h.receiveShadow=!0,c.add(h)}}),o.fixedElements.forEach(t=>{const q=t.x-400+t.width/2,D=-(t.y-400+t.height/2);if(t.type==="pillar"){const k=Math.min(t.width,t.height)/2,p=new r.Mesh(new r.CylinderGeometry(k,k*1.1,140,32),new r.MeshStandardMaterial({color:4868698,roughness:.6,metalness:.4}));p.position.set(q,70,D),p.castShadow=!0,c.add(p);const $=new r.Mesh(new r.CylinderGeometry(k*1.3,k*1.1,10,32),new r.MeshStandardMaterial({color:5921386,roughness:.5,metalness:.5}));$.position.set(q,135,D),$.castShadow=!0,c.add($);const h=new r.Mesh(new r.CylinderGeometry(k*1.2,k*1.3,10,32),new r.MeshStandardMaterial({color:5921386,roughness:.5,metalness:.5}));h.position.set(q,5,D),h.castShadow=!0,c.add(h)}else if(t.type==="column"){const k=new r.Mesh(new r.BoxGeometry(t.width,140,t.height),new r.MeshStandardMaterial({color:3816010,roughness:.7,metalness:.3}));k.position.set(q,70,D),k.castShadow=!0,c.add(k);const p=new r.LineSegments(new r.EdgesGeometry(k.geometry),new r.LineBasicMaterial({color:6974074}));p.position.copy(k.position),c.add(p)}else{const $=t.height/8;for(let h=0;h<8;h++){const L=new r.Mesh(new r.BoxGeometry(t.width,6.25,$*(8-h)),new r.MeshStandardMaterial({color:6636321,roughness:.8}));L.position.set(q,6.25/2+h*6.25,D+h*$/2),L.castShadow=!0,c.add(L);const F=new r.LineSegments(new r.EdgesGeometry(L.geometry),new r.LineBasicMaterial({color:3810320}));F.position.copy(L.position),c.add(F)}}}),o.objects.forEach(t=>{const q=t.x-400+t.width/2,D=-(t.y-400+t.height/2),k=-(t.rotation*Math.PI/180);if(t.type==="bar"){const p=t.x-400+t.width/2,$=-(t.y-400+t.height/2),h=-(t.rotation*Math.PI/180),L=50,F=new r.MeshPhysicalMaterial({color:1710618,roughness:.5,metalness:.8,clearcoat:.2,clearcoatRoughness:.4}),z=new r.Mesh(new r.BoxGeometry(t.width,L,t.height),F);z.position.set(p,L/2,$),z.rotation.y=h,z.castShadow=!0,z.receiveShadow=!0,c.add(z);const oe=[8323072,10770944,6691328,9109504,8930304],_=oe[Math.floor(Math.random()*oe.length)],de=new r.MeshPhysicalMaterial({color:_,metalness:.1,roughness:.05,transmission:.9,thickness:2,ior:1.5,reflectivity:.9,clearcoat:1,clearcoatRoughness:.05}),ee=new r.Mesh(new r.BoxGeometry(t.width+6,6,t.height+6),de);ee.position.set(p,L+3,$),ee.rotation.y=h,ee.castShadow=!0,c.add(ee);const B=new r.MeshStandardMaterial({emissive:16711799,emissiveIntensity:.6,color:0}),E=new r.Mesh(new r.BoxGeometry(t.width+6,.5,t.height+6),B);E.position.set(p,L+1,$),E.rotation.y=h,c.add(E);const W=_===8323072?13938487:11579568,b=new r.Mesh(new r.BoxGeometry(t.width+8,.6,t.height+8),new r.MeshStandardMaterial({color:W,metalness:1,roughness:.2}));b.position.set(p,L+6.5,$),b.rotation.y=h,c.add(b);const te=new r.MeshStandardMaterial({color:13421772,metalness:1,roughness:.1}),j=new r.CylinderGeometry(2,2,L,16);[[t.width/2-6,t.height/2-6],[-t.width/2+6,t.height/2-6],[t.width/2-6,-t.height/2+6],[-t.width/2+6,-t.height/2+6]].forEach(([we,Se])=>{const ve=new r.Mesh(j,te);ve.position.set(p+we*Math.cos(h)-Se*Math.sin(h),L/2,$+we*Math.sin(h)+Se*Math.cos(h)),ve.castShadow=!0,c.add(ve)});const Y=new r.PointLight(_,.4,600);Y.position.set(p,L+70,$),c.add(Y);const C=120,m=new r.Group,xe=new r.MeshPhysicalMaterial({color:2105376,metalness:1,roughness:.25,clearcoat:.6,clearcoatRoughness:.1}),g=new r.Mesh(new r.BoxGeometry(t.width+40,10,t.height+40),xe);g.castShadow=!0,g.receiveShadow=!0,m.add(g);const M=new r.MeshPhysicalMaterial({color:10770944,metalness:0,roughness:.05,transmission:.95,thickness:1.5,ior:1.45,clearcoat:1,clearcoatRoughness:.05}),Ce=new r.Mesh(new r.PlaneGeometry(t.width+32,t.height+32),M);Ce.rotation.x=-Math.PI/2,Ce.position.y=-3,m.add(Ce);const A=new r.MeshStandardMaterial({emissive:16764040,emissiveIntensity:1.6,color:0}),x=new r.BoxGeometry(4,2,t.height+36),Pe=new r.Mesh(x,A),Ee=Pe.clone();Pe.position.set(-(t.width+36)/2,-2,0),Ee.position.set((t.width+36)/2,-2,0),m.add(Pe,Ee);const fe=new r.Group,ce=[11674146,14919767,9127187,27028,7810842];for(let we=-3;we<=3;we++){const Se=ce[Math.floor(Math.random()*ce.length)],ve=new r.MeshPhysicalMaterial({color:Se,roughness:.1,transmission:.95,thickness:.6,ior:1.5,clearcoat:.3,clearcoatRoughness:.2}),s=new r.Mesh(new r.CylinderGeometry(3,3,20,32),ve);s.position.set(we*12,-12,0),fe.add(s);const a=new r.Mesh(new r.CylinderGeometry(1.2,1.2,6,16),ve);a.position.set(we*12,-3,0),fe.add(a)}fe.position.y=-15,m.add(fe);const w=new r.MeshPhysicalMaterial({color:16777215,roughness:.1,transmission:.9,thickness:.4,ior:1.45});for(let we=-2;we<=2;we++){const Se=new r.Mesh(new r.SphereGeometry(2.5,16,16,0,Math.PI),w);Se.position.set(we*10,-25,0),Se.scale.y=.6,m.add(Se)}const se=new r.MeshStandardMaterial({color:11184810,metalness:1,roughness:.2}),_e=new r.CylinderGeometry(1.5,1.5,C-60,16);[[t.width/2-10,t.height/2-10],[-t.width/2+10,t.height/2-10],[t.width/2-10,-t.height/2+10],[-t.width/2+10,-t.height/2+10]].forEach(([we,Se])=>{const ve=new r.Mesh(_e,se);ve.position.set(we,-(C-80)/2,Se),ve.rotation.x=Math.PI/2,m.add(ve)}),m.position.set(p,C,$),m.rotation.y=h,c.add(m);const He=new r.PointLight(16755285,.8,600);He.position.set(p,C-20,$),c.add(He)}else if(t.type==="kitchen"){const p=new r.Group,$=new r.MeshPhysicalMaterial({color:11579568,metalness:1,roughness:.25,envMapIntensity:1,clearcoat:1,clearcoatRoughness:.05}),h=new r.MeshPhysicalMaterial({color:10079487,roughness:.05,transmission:.9,thickness:.5,metalness:.1,envMapIntensity:1.2}),L=new r.Mesh(new r.BoxGeometry(t.width,50,t.height),$);L.position.set(0,25,0),L.castShadow=!0,L.receiveShadow=!0,p.add(L);const F=new r.Mesh(new r.BoxGeometry(t.width,4,t.height),h);F.position.set(0,52,0),p.add(F);const z=new r.Mesh(new r.BoxGeometry(t.width*.4,10,t.height*.6),new r.MeshStandardMaterial({color:2236962,roughness:.4}));z.position.set(-t.width*.2,55,0),p.add(z);const oe=new r.MeshStandardMaterial({color:3355443,metalness:.8,roughness:.2});[[-t.width*.25,t.height*.15],[-t.width*.15,t.height*.15],[-t.width*.25,-t.height*.15],[-t.width*.15,-t.height*.15]].forEach(([Y,C])=>{const m=new r.Mesh(new r.CylinderGeometry(6,6,2,32),oe);m.rotation.x=Math.PI/2,m.position.set(Y,61,C),p.add(m)});const de=new r.Mesh(new r.BoxGeometry(t.width*.5,35,t.height*.65),new r.MeshPhysicalMaterial({color:12632256,metalness:1,roughness:.2,envMapIntensity:1.1}));de.position.set(-t.width*.2,95,0),de.castShadow=!0,p.add(de);const ee=new r.MeshPhysicalMaterial({color:14540253,roughness:.3,metalness:.5});for(let Y=0;Y<3;Y++){const C=new r.Mesh(new r.BoxGeometry(t.width*.7,4,t.height*.2),ee);C.position.set(t.width*.15,75+Y*22,t.height*.35),C.castShadow=!0,p.add(C)}const B=new r.MeshStandardMaterial({color:8947848,metalness:.9,roughness:.2});for(let Y=-1;Y<=1;Y++){const C=new r.Mesh(new r.CylinderGeometry(1.5,1.5,15,16),B);C.rotation.z=Math.PI/2,C.position.set(Y*t.width*.2,35,t.height*.45),p.add(C)}const E=new r.PointLight(16777215,1.5,400);E.position.set(0,140,0),E.castShadow=!0,p.add(E);const W=document.createElement("canvas");W.width=1024,W.height=768;const b=W.getContext("2d");b&&(b.fillStyle="#dc2626",b.fillRect(0,0,W.width,W.height),b.strokeStyle="#ffffff",b.lineWidth=25,b.strokeRect(30,30,W.width-60,W.height-60),b.strokeStyle="#000000",b.lineWidth=15,b.strokeRect(50,50,W.width-100,W.height-100),b.shadowColor="rgba(0, 0, 0, 0.8)",b.shadowBlur=20,b.shadowOffsetX=8,b.shadowOffsetY=8,b.font="bold 180px Arial",b.textAlign="center",b.textBaseline="middle",b.fillStyle="#ffffff",b.fillText("ðŸ‘¨â€ðŸ³",W.width/2,W.height/2-150),b.fillStyle="#ffffff",b.font="bold 220px Impact, Arial Black, sans-serif",b.fillText("CHEF",W.width/2,W.height/2+120),b.strokeStyle="#000000",b.lineWidth=12,b.strokeText("CHEF",W.width/2,W.height/2+120),b.strokeStyle="#fbbf24",b.lineWidth=6,b.strokeText("CHEF",W.width/2,W.height/2+120));const te=new r.CanvasTexture(W),j=new r.Mesh(new r.PlaneGeometry(t.height*.6,t.height*.45),new r.MeshStandardMaterial({map:te,roughness:.4,metalness:.1,emissive:14427686,emissiveIntensity:.3}));j.position.set(-t.width/2+3,50,0),j.rotation.y=Math.PI/2,p.add(j);const ke=new r.Mesh(new r.PlaneGeometry(t.height*.6,t.height*.45),new r.MeshStandardMaterial({map:te,roughness:.4,metalness:.1,emissive:14427686,emissiveIntensity:.3}));ke.position.set(t.width/2-3,50,0),ke.rotation.y=-Math.PI/2,p.add(ke),p.position.set(q,0,D),p.rotation.y=k,c.add(p)}else if(t.type==="toilet"){const p=new r.Group,$=new r.MeshStandardMaterial({color:14013914,roughness:.7,metalness:.05}),h=new r.MeshStandardMaterial({color:3900150,roughness:.6,metalness:.1}),L=new r.MeshStandardMaterial({color:15680580,roughness:.6,metalness:.1}),F=new r.MeshStandardMaterial({color:14277081,roughness:.7,metalness:.05}),z=120,oe=new r.Mesh(new r.BoxGeometry(t.width,4,t.height),F);oe.position.y=2,oe.receiveShadow=!0,p.add(oe);const _=new r.Mesh(new r.BoxGeometry(t.width,z,6),$);_.position.set(0,z/2,-t.height/2),_.castShadow=!0,p.add(_);const de=new r.Mesh(new r.BoxGeometry(6,z,t.height),$);de.position.set(-t.width/2,z/2,0),de.castShadow=!0,p.add(de);const ee=new r.Mesh(new r.BoxGeometry(6,z,t.height),$);ee.position.set(t.width/2,z/2,0),ee.castShadow=!0,p.add(ee);const B=new r.Mesh(new r.BoxGeometry(t.width*.24,z,6),$);B.position.set(0,z/2,t.height/2),B.castShadow=!0,p.add(B);const E=new r.Mesh(new r.BoxGeometry(t.width*.055,z,6),$);E.position.set(-t.width*.4725,z/2,t.height/2),E.castShadow=!0,p.add(E);const W=new r.Mesh(new r.BoxGeometry(t.width*.055,z,6),$);W.position.set(t.width*.4725,z/2,t.height/2),W.castShadow=!0,p.add(W);const b=new r.Mesh(new r.BoxGeometry(t.width*.33,z-95,6),$);b.position.set(t.width*.285,95+(z-95)/2,t.height/2),b.castShadow=!0,p.add(b);const te=new r.Mesh(new r.BoxGeometry(t.width*.33,z-95,6),$);te.position.set(-t.width*.285,95+(z-95)/2,t.height/2),te.castShadow=!0,p.add(te);const j=new r.Mesh(new r.BoxGeometry(t.width*.33,95,4),h);j.position.set(t.width*.285,47.5,t.height/2-2),j.castShadow=!0,p.add(j);const ke=new r.MeshStandardMaterial({color:13938487,metalness:.1,roughness:.8}),Y=new r.Mesh(new r.CylinderGeometry(1.5,1.5,12,16),ke);Y.rotation.z=Math.PI/2,Y.position.set(t.width*.285-t.width*.132,47.5,t.height/2+1),p.add(Y);const C=document.createElement("canvas");C.width=512,C.height=768;const m=C.getContext("2d");if(m){const Te=m.createLinearGradient(0,0,0,C.height);Te.addColorStop(0,"#3b82f6"),Te.addColorStop(1,"#1e40af"),m.fillStyle=Te,m.fillRect(0,0,C.width,C.height),m.strokeStyle="#ffffff",m.lineWidth=12,m.strokeRect(20,20,C.width-40,C.height-40),m.strokeStyle="rgba(255, 255, 255, 0.3)",m.lineWidth=6,m.strokeRect(30,30,C.width-60,C.height-60),m.shadowColor="rgba(0, 0, 0, 0.5)",m.shadowBlur=15,m.shadowOffsetX=4,m.shadowOffsetY=4,m.fillStyle="#ffffff",m.font="bold 120px Georgia, serif",m.textAlign="center",m.textBaseline="middle",m.fillText("W.C.",C.width/2,C.height/2-100),m.strokeStyle="#ffffff",m.lineWidth=4,m.beginPath(),m.moveTo(100,C.height/2),m.lineTo(C.width-100,C.height/2),m.stroke();const he=m.createLinearGradient(0,C.height/2,0,C.height/2+150);he.addColorStop(0,"#ffd700"),he.addColorStop(.5,"#ffed4e"),he.addColorStop(1,"#ffd700"),m.fillStyle=he,m.font="bold 140px Georgia, serif",m.fillText("MALE",C.width/2,C.height/2+120),m.strokeStyle="#b8860b",m.lineWidth=3,m.strokeText("MALE",C.width/2,C.height/2+120)}const xe=new r.CanvasTexture(C),g=new r.Mesh(new r.PlaneGeometry(t.width*.25,t.width*.375),new r.MeshStandardMaterial({map:xe,roughness:.3,metalness:.15,emissive:1982639,emissiveIntensity:.1}));g.position.set(t.width*.285,47.5,t.height/2+2.5),p.add(g);const M=new r.Mesh(new r.BoxGeometry(t.width*.33,95,4),L);M.position.set(-t.width*.285,47.5,t.height/2-2),M.castShadow=!0,p.add(M);const Ce=Y.clone();Ce.position.set(-t.width*.285+t.width*.132,47.5,t.height/2+1),p.add(Ce);const A=document.createElement("canvas");A.width=512,A.height=768;const x=A.getContext("2d");if(x){const Te=x.createLinearGradient(0,0,0,A.height);Te.addColorStop(0,"#ef4444"),Te.addColorStop(1,"#b91c1c"),x.fillStyle=Te,x.fillRect(0,0,A.width,A.height),x.strokeStyle="#ffffff",x.lineWidth=12,x.strokeRect(20,20,A.width-40,A.height-40),x.strokeStyle="rgba(255, 255, 255, 0.3)",x.lineWidth=6,x.strokeRect(30,30,A.width-60,A.height-60),x.shadowColor="rgba(0, 0, 0, 0.5)",x.shadowBlur=15,x.shadowOffsetX=4,x.shadowOffsetY=4,x.fillStyle="#ffffff",x.font="bold 120px Georgia, serif",x.textAlign="center",x.textBaseline="middle",x.fillText("W.C.",A.width/2,A.height/2-100),x.strokeStyle="#ffffff",x.lineWidth=4,x.beginPath(),x.moveTo(100,A.height/2),x.lineTo(A.width-100,A.height/2),x.stroke();const he=x.createLinearGradient(0,A.height/2,0,A.height/2+150);he.addColorStop(0,"#ffb6c1"),he.addColorStop(.5,"#ffd1dc"),he.addColorStop(1,"#ffb6c1"),x.fillStyle=he,x.font="bold 120px Georgia, serif",x.fillText("FEMALE",A.width/2,A.height/2+120),x.strokeStyle="#dc143c",x.lineWidth=3,x.strokeText("FEMALE",A.width/2,A.height/2+120)}const Pe=new r.CanvasTexture(A),Ee=new r.Mesh(new r.PlaneGeometry(t.width*.25,t.width*.375),new r.MeshStandardMaterial({map:Pe,roughness:.3,metalness:.15,emissive:12131356,emissiveIntensity:.1}));Ee.position.set(-t.width*.285,47.5,t.height/2+2.5),p.add(Ee);const fe=document.createElement("canvas");fe.width=512,fe.height=256;const ce=fe.getContext("2d");ce&&(ce.fillStyle="#d5d5da",ce.fillRect(0,0,fe.width,fe.height),ce.fillStyle="#2a2a2a",ce.font="bold 140px Arial",ce.textAlign="center",ce.textBaseline="middle",ce.fillText("W.C.",fe.width/2,fe.height/2));const w=new r.CanvasTexture(fe),se=new r.Mesh(new r.PlaneGeometry(t.width*.4,t.width*.2),new r.MeshStandardMaterial({map:w,roughness:.5,metalness:.05}));se.position.set(0,100,-t.height/2+3.5),p.add(se);const _e=new r.MeshStandardMaterial({color:16119285,metalness:.1,roughness:.5}),He=new r.Mesh(new r.BoxGeometry(t.width*.5,12,t.height*.25),_e);He.position.set(0,32,-t.height*.3),He.castShadow=!0,p.add(He);const we=new r.MeshStandardMaterial({color:16777215,roughness:.3,metalness:.05}),Se=new r.Mesh(new r.CylinderGeometry(12,12,6,32),we);Se.position.set(0,40,-t.height*.3),p.add(Se);const ve=new r.MeshStandardMaterial({color:12632256,metalness:.1,roughness:.8}),s=new r.Mesh(new r.TorusGeometry(4,1,8,24,Math.PI),ve);s.rotation.z=Math.PI/2,s.position.set(0,48,-t.height*.35),p.add(s);const a=new r.MeshStandardMaterial({color:16777215,roughness:.25,metalness:.05}),i=new r.Mesh(new r.CylinderGeometry(10,8,12,32),a);i.position.set(-t.width*.25,6,t.height*.25),p.add(i);const f=new r.Mesh(new r.TorusGeometry(9,2,16,32),a);f.rotation.x=Math.PI/2,f.position.set(-t.width*.25,13,t.height*.25),p.add(f);const u=new r.Mesh(new r.BoxGeometry(14,20,8),a);u.position.set(-t.width*.25,22,t.height*.25-10),p.add(u);const P=new r.Mesh(new r.BoxGeometry(2,6,1),ve);P.position.set(-t.width*.25+8,25,t.height*.25-10),p.add(P);const X=new r.Mesh(new r.SphereGeometry(7,32,32,0,Math.PI*2,0,Math.PI/1.5),a);X.position.set(t.width*.25,25,t.height*.25),X.rotation.x=Math.PI/6,p.add(X);const re=new r.Mesh(new r.CylinderGeometry(1.5,1.5,8,16),ve);re.position.set(t.width*.25,35,t.height*.25-5),p.add(re);const ae=new r.PointLight(16777215,.5,280);ae.position.set(0,z-15,0),ae.castShadow=!1,p.add(ae),p.position.set(q,0,D),p.rotation.y=k,c.add(p)}}),o.tables.forEach(t=>{const k=t.shape==="rectangle"?t.width*1.5:t.width,p=t.x-400+k/2,$=-(t.y-400+t.height/2),h=-(t.rotation*Math.PI/180),L=new r.MeshPhysicalMaterial({color:7294519,roughness:.35,metalness:.1,clearcoat:.4,clearcoatRoughness:.2,sheen:.5,sheenColor:new r.Color(10251068)}),F=t.shape==="circle"?new r.CylinderGeometry(k/2,k/2,4,64):new r.BoxGeometry(k,4,t.height),z=new r.Mesh(F,L);if(z.position.set(p,33+4/2,$),z.rotation.y=h,z.castShadow=!0,z.receiveShadow=!0,c.add(z),t.shape==="circle"){const B=new r.Mesh(new r.TorusGeometry(k/2+1,1.2,16,64),new r.MeshStandardMaterial({color:13938487,metalness:1,roughness:.3}));B.position.set(p,33+4/2+.5,$),B.rotation.x=Math.PI/2,c.add(B)}else{const B=new r.LineSegments(new r.EdgesGeometry(F),new r.LineBasicMaterial({color:13938487,linewidth:2}));B.position.copy(z.position),B.rotation.y=h,c.add(B)}const oe=new r.MeshStandardMaterial({color:2236962,metalness:.9,roughness:.2}),_=3.2;(t.shape==="circle"?[[k*.3,k*.3],[-k*.3,k*.3],[k*.3,-k*.3],[-k*.3,-k*.3]]:[[k/2-10,t.height/2-10],[-k/2+10,t.height/2-10],[k/2-10,-t.height/2+10],[-k/2+10,-t.height/2+10]]).forEach(([B,E])=>{const W=new r.Mesh(new r.CylinderGeometry(_,_,33,16),oe);W.position.set(p+B*Math.cos(h)-E*Math.sin(h),33/2,$+B*Math.sin(h)+E*Math.cos(h)),W.castShadow=!0,c.add(W)});const ee=o.chairs.filter(B=>B.tableId===t.id);ee.forEach(B=>{const E=B.size||40,W=38,b=new r.MeshStandardMaterial({color:9127187,roughness:.5,metalness:.1}),te=new r.MeshStandardMaterial({color:12092939,roughness:.7,metalness:.05}),j=ee.filter(we=>we.position===B.position).length,Y=(["top","bottom"].includes(B.position)?k:t.height)-E*j,C=j>1?Y/(j+1):Y/2,m=C+B.index*(E+C)+E/2,xe=E*.4;let g=0,M=0;B.position==="top"?(g=m-k/2,M=t.height/2+xe+E/2):B.position==="bottom"?(g=m-k/2,M=-(t.height/2+xe+E/2)):B.position==="left"?(g=-(k/2+xe+E/2),M=m-t.height/2):(g=k/2+xe+E/2,M=m-t.height/2);const Ce=g*Math.cos(h)-M*Math.sin(h),A=g*Math.sin(h)+M*Math.cos(h),x=new r.Mesh(new r.BoxGeometry(E*.75,4,E*.75),te),Pe=W*.4;x.position.set(p+Ce,Pe,$-A);const Ee={top:0,bottom:Math.PI,left:Math.PI/2,right:-Math.PI/2}[B.position]||0;x.rotation.y=Ee+h,x.castShadow=!0,c.add(x);const fe=new r.Mesh(new r.BoxGeometry(E*.75,W*.55,3),b),ce=E*.75/2+1.5;fe.position.set(x.position.x-Math.sin(x.rotation.y)*ce,W*.65,x.position.z-Math.cos(x.rotation.y)*ce),fe.rotation.y=x.rotation.y,fe.castShadow=!0,c.add(fe);const se=Pe-4/2,_e=new r.CylinderGeometry(2,2,se,8),He=new r.MeshStandardMaterial({color:6636321,roughness:.6,metalness:.2});[[E*.3,E*.3],[E*.3,-E*.3],[-E*.3,E*.3],[-E*.3,-E*.3]].forEach(([we,Se])=>{const ve=new r.Mesh(_e,He),s=Math.cos(x.rotation.y),a=Math.sin(x.rotation.y);ve.position.set(x.position.x+we*s-Se*a,se/2,x.position.z+we*a+Se*s),ve.castShadow=!0,c.add(ve)})})});const K=()=>{var t;if(ie.current=requestAnimationFrame(K),Q.current&&Q.current.progress<1){const q=Q.current;q.progress+=.05,q.progress>=1&&(q.progress=1,Me(!1),Q.current=null);const k=(p=>p<.5?4*p*p*p:1-Math.pow(-2*p+2,3)/2)(q.progress);if(v.current){v.current.position.lerpVectors(q.startPos,q.endPos,k);const p=new r.Vector3;p.lerpVectors(q.startTarget,q.endTarget,k),v.current.lookAt(p)}}if(T&&v.current&&!V){const q=Math.sqrt(v.current.position.x**2+v.current.position.z**2),D=Math.atan2(v.current.position.z,v.current.position.x)+Ye.current;v.current.position.x=q*Math.cos(D),v.current.position.z=q*Math.sin(D),v.current.lookAt(0,100,0)}(t=U.current)==null||t.render(c,I)};K();const Le=()=>{N.current&&v.current&&U.current&&(v.current.aspect=N.current.clientWidth/N.current.clientHeight,v.current.updateProjectionMatrix(),U.current.setSize(N.current.clientWidth,N.current.clientHeight))};return window.addEventListener("resize",Le),()=>{window.removeEventListener("resize",Le),ie.current&&cancelAnimationFrame(ie.current),U.current&&N.current&&(N.current.removeChild(U.current.domElement),U.current.dispose())}},[l,o,T,V]),l?e.jsx("div",{className:"rfp-fixed rfp-inset-0 bg-black/60 backdrop-blur-sm z-[200] rfp-flex rfp-items-center rfp-justify-center rfp-p-2",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 via-slate-900 to-gray-900 rounded-3xl shadow-2xl rfp-w-full rfp-h-full max-w-[98vw] max-h-[98vh] rfp-flex rfp-flex-col rfp-overflow-hidden rfp-border rfp-border-gray-800",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 rfp-p-1",children:e.jsxs("div",{className:"rfp-bg-gray-900 rfp-px-6 rfp-py-4 rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"rfp-text-2xl rfp-font-bold rfp-text-white rfp-flex rfp-items-center rfp-gap-3",children:[e.jsx("div",{className:"rfp-p-2 bg-gradient-to-br from-blue-500 to-purple-600 rfp-rounded-lg",children:e.jsx(G.Move3d,{className:"rfp-w-5 rfp-h-5"})}),"3D Floor Plan Visualization"]}),e.jsxs("p",{className:"rfp-text-gray-400 rfp-text-sm rfp-mt-1",children:["Professional Camera Controls â€¢ ",o.name]})]}),e.jsx("button",{onClick:d,className:"p-2.5 bg-red-500/20 hover:bg-red-500/30 rfp-text-red-400 rfp-rounded-xl rfp-transition-all hover:scale-110",children:e.jsx(G.X,{className:"rfp-w-5 rfp-h-5"})})]})}),e.jsxs("div",{className:"rfp-flex-1 rfp-flex rfp-gap-3 rfp-p-3 rfp-min-h-0",children:[e.jsxs("div",{className:"rfp-w-80 bg-black/90 backdrop-blur-xl rounded-2xl shadow-2xl rfp-border rfp-border-gray-700 rfp-p-5 rfp-flex rfp-flex-col rfp-gap-5 overflow-y-auto flex-shrink-0",children:[e.jsx("button",{onClick:()=>$e("default"),className:"rfp-px-4 rfp-py-3 bg-gradient-to-r from-blue-500 to-purple-600 rfp-text-white rfp-rounded-xl rfp-font-semibold rfp-transition-all hover:scale-105 hover:shadow-lg rfp-flex rfp-items-center rfp-justify-center rfp-gap-2",children:"ðŸ  Default View"}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-3",children:[e.jsxs("div",{className:"rfp-text-white rfp-text-sm rfp-font-bold rfp-uppercase rfp-tracking-wider rfp-flex rfp-items-center rfp-gap-2 rfp-pb-2 rfp-border-b rfp-border-gray-700",children:[e.jsx(G.Move3d,{className:"rfp-w-5 rfp-h-5 rfp-text-purple-400"}),"Manual Control"]}),e.jsx("div",{className:"rfp-flex rfp-justify-center",children:e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-1",children:[e.jsx("button",{onClick:()=>me("up"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30 mx-auto",disabled:V,title:"Rotate Up",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsxs("div",{className:"rfp-flex rfp-gap-1 rfp-justify-center",children:[e.jsx("button",{onClick:()=>me("left"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30",disabled:V,title:"Rotate Left",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("div",{className:"rfp-w-12 rfp-h-12 bg-gradient-to-br from-blue-600 to-purple-600 rfp-rounded-lg rfp-flex rfp-items-center rfp-justify-center",children:e.jsx(G.Move3d,{className:"rfp-w-6 rfp-h-6 rfp-text-white"})}),e.jsx("button",{onClick:()=>me("right"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30",disabled:V,title:"Rotate Right",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsx("button",{onClick:()=>me("down"),className:"rfp-w-12 rfp-h-12 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-lg rfp-transition-all hover:scale-110 rfp-flex rfp-items-center rfp-justify-center disabled:opacity-30 mx-auto",disabled:V,title:"Rotate Down",children:e.jsx("svg",{className:"rfp-w-6 rfp-h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})})]}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-3",children:[e.jsxs("div",{className:"rfp-text-white rfp-text-sm rfp-font-bold rfp-uppercase rfp-tracking-wider rfp-flex rfp-items-center rfp-gap-2 rfp-pb-2 rfp-border-b rfp-border-gray-700",children:[e.jsx(G.ZoomIn,{className:"rfp-w-5 rfp-h-5 rfp-text-green-400"}),"Zoom & Rotation"]}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-2",children:[e.jsxs("button",{onClick:()=>ue(.85),className:"rfp-px-4 rfp-py-3 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-semibold disabled:opacity-30",disabled:V,children:[e.jsx(G.ZoomIn,{className:"rfp-w-5 rfp-h-5"}),"Zoom In"]}),e.jsxs("button",{onClick:()=>ue(1.15),className:"rfp-px-4 rfp-py-3 rfp-bg-gray-800 hover:bg-gray-700 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-semibold disabled:opacity-30",disabled:V,children:[e.jsx(G.ZoomOut,{className:"rfp-w-5 rfp-h-5"}),"Zoom Out"]}),e.jsxs("button",{onClick:()=>le(!T),className:`px-4 py-3 rounded-xl transition-all hover:scale-105 flex items-center justify-center gap-2 font-semibold ${T?"bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg":"bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white"}`,children:[e.jsx(G.RotateCcw,{className:`w-5 h-5 ${T?"animate-spin":""}`}),T?"Auto-Rotating":"Auto-Rotate"]})]})]}),e.jsxs("div",{className:"rfp-flex rfp-flex-col rfp-gap-3 mt-auto",children:[e.jsxs("button",{onClick:()=>$e("default"),className:"rfp-px-4 rfp-py-3 bg-gradient-to-r from-orange-500 to-red-600 rfp-text-white rfp-rounded-xl rfp-transition-all hover:scale-105 hover:shadow-lg rfp-flex rfp-items-center rfp-justify-center rfp-gap-2 rfp-font-bold",children:[e.jsx(G.Maximize2,{className:"rfp-w-5 rfp-h-5"}),"Reset View"]}),e.jsxs("div",{className:"bg-gray-800/50 rfp-rounded-xl rfp-p-4 rfp-border rfp-border-gray-700",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-text-gray-400 rfp-mb-3",children:[e.jsx(G.Grid,{className:"rfp-w-4 rfp-h-4"}),e.jsx("span",{className:"rfp-font-medium rfp-text-sm",children:"Scene Statistics"})]}),e.jsxs("div",{className:"rfp-grid grid-cols-2 rfp-gap-2 rfp-text-sm",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-emerald-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[o.tables.length," Tables"]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 bg-amber-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[o.chairs.length," Chairs"]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-purple-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[o.objects.length," Objects"]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-blue-500 rfp-rounded-full rfp-animate-pulse"}),e.jsxs("span",{className:"rfp-text-gray-300",children:[o.walls.length," Walls"]})]})]})]})]})]}),e.jsxs("div",{className:"rfp-flex-1 rfp-relative bg-gradient-to-br from-gray-100 via-gray-50 to-gray-100 rounded-2xl rfp-overflow-hidden shadow-2xl rfp-border rfp-border-gray-300",children:[e.jsx("div",{ref:N,className:"rfp-w-full rfp-h-full"}),V&&e.jsx("div",{className:"rfp-absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsx("div",{className:"bg-black/80 backdrop-blur-xl rfp-rounded-xl rfp-px-6 rfp-py-3 shadow-2xl rfp-border rfp-border-gray-700",children:e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-3",children:[e.jsx("div",{className:"rfp-animate-spin rfp-rounded-full rfp-h-5 rfp-w-5 rfp-border-2 rfp-border-gray-500 border-t-white"}),e.jsx("span",{className:"rfp-text-white rfp-text-sm rfp-font-medium",children:"Transitioning Camera..."})]})})})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-gray-900 via-slate-900 to-gray-900 rfp-px-6 rfp-py-3 rfp-border-t rfp-border-gray-800",children:e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-justify-between",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-4",children:[e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2",children:[e.jsx(G.Layers,{className:"rfp-w-4 rfp-h-4 rfp-text-gray-400"}),e.jsxs("span",{className:"rfp-text-sm rfp-text-gray-400",children:["Viewing: ",e.jsx("span",{className:"rfp-text-white rfp-font-semibold",children:o.name})]})]}),e.jsxs("div",{className:"rfp-text-sm rfp-text-gray-400",children:["Camera: ",e.jsx("span",{className:"rfp-text-white rfp-font-semibold",children:tr[J].name})]})]}),e.jsxs("div",{className:"rfp-flex rfp-items-center rfp-gap-2 rfp-text-xs rfp-text-gray-500",children:[e.jsx("span",{children:"High Performance Mode"}),e.jsx("div",{className:"rfp-w-2 rfp-h-2 rfp-bg-green-500 rfp-rounded-full rfp-animate-pulse"})]})]})})]})}):null},Sr=()=>{const[o,l]=y.useState([{id:"floor-1",name:"Ground Floor",isActive:!0,tables:[],chairs:[],objects:[],walls:[],fixedElements:[]}]),[d,N]=y.useState("floor-1"),[n,v]=y.useState(null),[U,ie]=y.useState(!1),[T,le]=y.useState({x:0,y:0}),J=1,[H,V]=y.useState(!0),[Me,Ye]=y.useState(!1),[Q,$e]=y.useState(!1),[me,ue]=y.useState(null),[c,I]=y.useState(null),[Z,ye]=y.useState(null),[pe,Ge]=y.useState(!1),[be,Oe]=y.useState(null),[S,Ne]=y.useState(null),R=y.useRef(null),K=y.useRef(null),Le=y.useRef(null);y.useEffect(()=>{if((n==null?void 0:n.type)==="table"){const s=t();if(!s)return;const a=s.chairs.filter(f=>f.tableId===n.id);if(a.filter(f=>f.size===void 0).length>0){const f={};a.forEach(u=>{u.size!==void 0&&!f[u.position]&&(f[u.position]=u.size)}),l(u=>u.map(P=>P.id===d?{...P,chairs:P.chairs.map(X=>{if(X.tableId===n.id&&X.size===void 0){const re=f[X.position]??40;return{...X,size:re}}return X})}:P))}}},[n]);const t=()=>o.find(s=>s.id===d),q=(s,a="medium")=>{const i=t();if(!i)return;const{width:f,height:u}=Re(s,a),P={id:Fe(),name:`Table ${i.tables.length+1}`,shape:s,size:a,x:200+i.tables.length*20,y:200+i.tables.length*20,width:f,height:u,rotation:0};l(X=>X.map(re=>re.id===d?{...re,tables:[...re.tables,P]}:re)),v({type:"table",id:P.id})},D=s=>{const a=t();if(!a)return;const i={id:Fe(),name:`${Ze[s]} ${a.objects.length+1}`,type:s,x:300+a.objects.length*30,y:300+a.objects.length*30,width:120,height:80,rotation:0};l(f=>f.map(u=>u.id===d?{...u,objects:[...u.objects,i]}:u)),v({type:"object",id:i.id})},k=s=>{if(!n||n.type!=="table")return;const a=t();if(!a)return;const i=a.chairs.filter(re=>re.tableId===n.id&&re.position===s),f=i.length,u=i.find(re=>re.size!==void 0),P=(u==null?void 0:u.size)??40,X={id:Fe(),tableId:n.id,position:s,index:f,x:0,y:0,size:P};l(re=>re.map(ae=>ae.id===d?{...ae,chairs:[...ae.chairs,X]}:ae))},p=s=>{if(!n||n.type!=="table")return;const a=t();if(!a)return;const i=a.chairs.filter(u=>u.tableId===n.id&&u.position===s);if(i.length===0)return;const f=i.reduce((u,P)=>P.index>u.index?P:u);l(u=>u.map(P=>P.id===d?{...P,chairs:P.chairs.filter(X=>X.id!==f.id)}:P))},$=(s,a)=>{!n||n.type!=="table"||!t()||l(f=>f.map(u=>u.id===d?{...u,chairs:u.chairs.map(P=>P.tableId===n.id&&P.position===s?{...P,size:a}:P)}:u))},h=()=>{!n||n.type!=="table"||!t()||l(a=>a.map(i=>i.id===d?{...i,chairs:i.chairs.map(f=>{if(f.tableId===n.id){const{size:u,...P}=f;return P}return f})}:i))},L=()=>{n&&(n.type==="table"?l(s=>s.map(a=>a.id===d?{...a,tables:a.tables.filter(i=>i.id!==n.id),chairs:a.chairs.filter(i=>i.tableId!==n.id)}:a)):n.type==="object"?l(s=>s.map(a=>a.id===d?{...a,objects:a.objects.filter(i=>i.id!==n.id)}:a)):n.type==="wall"?l(s=>s.map(a=>a.id===d?{...a,walls:a.walls.filter(i=>i.id!==n.id)}:a)):n.type==="fixedElement"&&l(s=>s.map(a=>a.id===d?{...a,fixedElements:a.fixedElements.filter(i=>i.id!==n.id)}:a)),v(null))},F=s=>{!n||n.type!=="wall"||l(a=>a.map(i=>i.id===d?{...i,walls:i.walls.map(f=>f.id===n.id?{...f,thickness:s}:f)}:i))},z=s=>{!n||n.type!=="wall"||l(a=>a.map(i=>i.id===d?{...i,walls:i.walls.map(f=>f.id===n.id?{...f,type:s}:f)}:i))},oe=()=>{!n||n.type!=="table"||l(s=>s.map(a=>a.id===d?{...a,tables:a.tables.map(i=>i.id===n.id?{...i,rotation:(i.rotation||0)+45}:i)}:a))},_=()=>{if(!n||n.type!=="table")return;const s=t();if(!s)return;const a=s.tables.find(P=>P.id===n.id);if(!a)return;const i={...a,id:Fe(),name:`${a.name} Copy`,x:a.x+50,y:a.y+50},u=s.chairs.filter(P=>P.tableId===a.id).map(P=>({...P,id:Fe(),tableId:i.id}));l(P=>P.map(X=>X.id===d?{...X,tables:[...X.tables,i],chairs:[...X.chairs,...u]}:X)),v({type:"table",id:i.id})},de=y.useCallback(s=>{!n||n.type!=="table"||l(a=>a.map(i=>i.id===d?{...i,tables:i.tables.map(f=>f.id===n.id?s(f):f)}:i))},[n,d]),ee=s=>{de(a=>{const{width:i,height:f}=Re(a.shape,s);return{...a,size:s,width:i,height:f}})},B=(s,a)=>{de(i=>({...i,width:s,height:a,size:"medium"}))},E=s=>{!n||n.type!=="object"||l(a=>a.map(i=>i.id===d?{...i,objects:i.objects.map(f=>f.id===n.id?{...f,name:s}:f)}:i))},W=(s,a)=>{!n||n.type!=="object"||l(i=>i.map(f=>f.id===d?{...f,objects:f.objects.map(u=>u.id===n.id?{...u,width:s,height:a}:u)}:f))},b=s=>{!n||n.type!=="object"||l(a=>a.map(i=>i.id===d?{...i,objects:i.objects.map(f=>f.id===n.id?{...f,rotation:s}:f)}:i))},te=(s,a)=>{!n||n.type!=="fixedElement"||l(i=>i.map(f=>f.id===d?{...f,fixedElements:f.fixedElements.map(u=>u.id===n.id?{...u,width:s,height:a}:u)}:f))},j=s=>{de(a=>({...a,name:s}))},ke=s=>{if(R.current&&!pe){if(Q&&me){const a=R.current.getBoundingClientRect(),i=Math.round((s.clientX-a.left)/J/O)*O,f=Math.round((s.clientY-a.top)/J/O)*O;if(!c)I({x:i,y:f});else{if(!t())return;const P=Ve(c,{x:i,y:f}),X={id:Fe(),type:me,startX:c.x,startY:c.y,endX:P.x,endY:P.y,thickness:8};l(re=>re.map(ae=>ae.id===d?{...ae,walls:[...ae.walls,X]}:ae)),I(null),ye(null),$e(!1),ue(null)}return}v(null)}},Y=(s,a)=>{v({type:s,id:a})},C=(s,a)=>{if(!R.current)return;s.preventDefault(),s.stopPropagation();const i=R.current.getBoundingClientRect(),f=(s.clientX-i.left)/J,u=(s.clientY-i.top)/J,P=t();if(!P)return;const X=P.tables.find(he=>he.id===a),re=P.objects.find(he=>he.id===a),ae=P.fixedElements.find(he=>he.id===a),Te=P.walls.find(he=>he.id===a);if(Te)le({x:f-Te.startX,y:u-Te.startY}),K.current={id:a,type:"wall"};else{const he=X||re||ae;he&&le({x:f-he.x,y:u-he.y});const We=X?"table":re?"object":ae?"fixedElement":"table";K.current={id:a,type:We}}ie(!0)},m=y.useCallback(s=>{!U&&!pe||!K.current||!R.current||(Le.current&&cancelAnimationFrame(Le.current),Le.current=requestAnimationFrame(()=>{var X,re,ae,Te,he;if(!R.current)return;const a=R.current.getBoundingClientRect(),i=(s.clientX-a.left)/J,f=(s.clientY-a.top)/J,u=Math.round(i/O)*O,P=Math.round(f/O)*O;if(pe&&((X=K.current)==null?void 0:X.type)==="wall"){const We=o.find(Xe=>Xe.id===d),Be=We==null?void 0:We.walls.find(Xe=>{var ze;return Xe.id===((ze=K.current)==null?void 0:ze.id)});if(Be){const Xe=be==="start"?{x:Be.endX,y:Be.endY}:{x:Be.startX,y:Be.startY},ze=Ve(Xe,{x:u,y:P});l(De=>De.map(ge=>ge.id===d?{...ge,walls:ge.walls.map(ne=>{var Ie;return ne.id===((Ie=K.current)==null?void 0:Ie.id)?be==="start"?{...ne,startX:ze.x,startY:ze.y}:{...ne,endX:ze.x,endY:ze.y}:ne})}:ge))}}else if(((re=K.current)==null?void 0:re.type)==="table"){const We=i-T.x,Be=f-T.y,Xe=Math.round(We/O)*O,ze=Math.round(Be/O)*O;l(De=>De.map(ge=>ge.id===d?{...ge,tables:ge.tables.map(ne=>{var Ie;return ne.id===((Ie=K.current)==null?void 0:Ie.id)?{...ne,x:Xe,y:ze}:ne})}:ge))}else if(((ae=K.current)==null?void 0:ae.type)==="object"){const We=i-T.x,Be=f-T.y,Xe=Math.round(We/O)*O,ze=Math.round(Be/O)*O;l(De=>De.map(ge=>ge.id===d?{...ge,objects:ge.objects.map(ne=>{var Ie;return ne.id===((Ie=K.current)==null?void 0:Ie.id)?{...ne,x:Xe,y:ze}:ne})}:ge))}else if(((Te=K.current)==null?void 0:Te.type)==="fixedElement"){const We=i-T.x,Be=f-T.y,Xe=Math.round(We/O)*O,ze=Math.round(Be/O)*O;l(De=>De.map(ge=>ge.id===d?{...ge,fixedElements:ge.fixedElements.map(ne=>{var Ie;return ne.id===((Ie=K.current)==null?void 0:Ie.id)?{...ne,x:Xe,y:ze}:ne})}:ge))}else if(((he=K.current)==null?void 0:he.type)==="wall"&&!pe){const We=i-T.x,Be=f-T.y,Xe=Math.round(We/O)*O,ze=Math.round(Be/O)*O;l(De=>De.map(ge=>ge.id===d?{...ge,walls:ge.walls.map(ne=>{var nr;if(ne.id!==((nr=K.current)==null?void 0:nr.id))return ne;const Ie=Xe-ne.startX,ar=ze-ne.startY;return{...ne,startX:ne.startX+Ie,startY:ne.startY+ar,endX:ne.endX+Ie,endY:ne.endY+ar}})}:ge))}}))},[U,pe,be,T,d,J,o]),xe=()=>{Le.current&&(cancelAnimationFrame(Le.current),Le.current=null),ie(!1),K.current=null,Ge(!1),Oe(null),Ne(null)},g=(s,a,i)=>{s.preventDefault(),s.stopPropagation(),Ge(!0),Oe(i),K.current={id:a,type:"wall"}},M=()=>{const s={id:Fe(),name:`Floor ${o.length+1}`,isActive:!1,tables:[],chairs:[],objects:[],walls:[],fixedElements:[]};l(a=>[...a,s]),A(s.id)},Ce=()=>{if(o.length<=1)return;const s=o.filter(a=>a.id!==d);l(s),N(s[0].id)},A=s=>{l(a=>a.map(i=>({...i,isActive:i.id===s}))),N(s),v(null)},x=(s,a)=>{l(i=>i.map(f=>f.id===s?{...f,name:a}:f))},Pe=s=>{$e(!0),ue(s),I(null),ye(null),v(null)},Ee=s=>{const a=t();if(!a)return;const i={id:Fe(),name:`${s.charAt(0).toUpperCase()+s.slice(1)} ${a.fixedElements.length+1}`,type:s,x:400+a.fixedElements.length*30,y:400+a.fixedElements.length*30,width:60,height:60,rotation:0};l(f=>f.map(u=>u.id===d?{...u,fixedElements:[...u.fixedElements,i]}:u)),v({type:"fixedElement",id:i.id})},fe=()=>{const s={floors:o,timestamp:new Date().toISOString()};console.log("Saving floor plan:",s),alert("Floor plan saved! (Check console for data)")};y.useEffect(()=>{const s=i=>m(i),a=()=>xe();return(U||pe)&&(document.addEventListener("mousemove",s),document.addEventListener("mouseup",a)),()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",a)}},[U,pe,m]);const ce=s=>{var a;if(Q&&c&&R.current){const i=R.current.getBoundingClientRect(),f=Math.round((s.clientX-i.left)/J/O)*O,u=Math.round((s.clientY-i.top)/J/O)*O,P=Ve(c,{x:f,y:u});ye(P)}else if(pe&&((a=K.current)==null?void 0:a.type)==="wall"&&R.current){const i=R.current.getBoundingClientRect(),f=Math.round((s.clientX-i.left)/J/O)*O,u=Math.round((s.clientY-i.top)/J/O)*O,P=t(),X=P==null?void 0:P.walls.find(re=>{var ae;return re.id===((ae=K.current)==null?void 0:ae.id)});if(X){const re=be==="start"?{x:X.endX,y:X.endY}:{x:X.startX,y:X.startY},ae=Ve(re,{x:f,y:u});Ne(be==="start"?{startX:ae.x,startY:ae.y,endX:X.endX,endY:X.endY}:{startX:X.startX,startY:X.startY,endX:ae.x,endY:ae.y})}}};y.useEffect(()=>{const s=a=>{a.key==="Escape"&&Q&&($e(!1),ue(null),I(null),ye(null))};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[Q]);const w=t(),se=w==null?void 0:w.tables.find(s=>(n==null?void 0:n.type)==="table"&&s.id===n.id),_e=w==null?void 0:w.objects.find(s=>(n==null?void 0:n.type)==="object"&&s.id===n.id),He=w==null?void 0:w.walls.find(s=>(n==null?void 0:n.type)==="wall"&&s.id===n.id),we=w==null?void 0:w.fixedElements.find(s=>(n==null?void 0:n.type)==="fixedElement"&&s.id===n.id),Se=se?(w==null?void 0:w.chairs.filter(s=>s.tableId===se.id))??[]:[],ve=y.useCallback(()=>V(s=>!s),[]);return e.jsxs("div",{className:"restaurant-floor-planner rfp-flex rfp-h-screen rfp-bg-gray-50",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:lr}}),e.jsx(yr,{floors:o,currentFloor:w,onAddFloor:M,onRemoveFloor:Ce,onSwitchFloor:A,onRenameFloor:x,onAddTable:q,onAddObject:D,onStartWallDrawing:Pe,onAddFixedElement:Ee,onRotateTable:oe,onDuplicateTable:_,onRemoveTable:L,onSave:fe,selectedTable:se??null,selectedTableChairs:Se}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(Nr,{showGrid:H,selectedTable:se??null,selectedObject:_e??null,selectedWall:He??null,selectedFixedElement:we??null,selectedTableChairs:Se,tableCount:(w==null?void 0:w.tables.length)??0,chairCount:(w==null?void 0:w.chairs.length)??0,objectCount:(w==null?void 0:w.objects.length)??0,wallCount:(w==null?void 0:w.walls.length)??0,fixedElementCount:(w==null?void 0:w.fixedElements.length)??0,selectedElementType:(n==null?void 0:n.type)??null,onToggleGrid:ve,onAddChair:k,onRemoveChair:p,onChangeTableSize:ee,onCustomTableSize:B,onTableNameChange:j,onObjectNameChange:E,onObjectResize:W,onObjectRotate:b,onRemoveObject:L,onRemoveWall:L,onRemoveFixedElement:L,onChangeWallThickness:F,onConvertWallType:z,onFixedElementResize:te,onChairSizeChange:$,onResetChairSizes:h,on3DPreview:()=>Ye(!0)}),e.jsxs("div",{className:"flex-1 overflow-hidden bg-gray-100 relative",children:[e.jsxs("div",{ref:R,className:`w-full h-full relative ${Q?"cursor-crosshair":pe?"cursor-grabbing":"cursor-default"}`,style:{transform:`scale(${J})`,transformOrigin:"top left",background:H?"radial-gradient(circle, #d1d5db 1px, transparent 1px)":"white",backgroundSize:`${O*J}px ${O*J}px`},onClick:ke,onMouseMove:ce,children:[(w==null?void 0:w.tables.length)===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸª"}),e.jsx("div",{className:"text-xl font-medium mb-2",children:"Welcome to Your Restaurant Designer"}),e.jsx("div",{className:"text-lg",children:'Click "Add Tables" in the sidebar to start designing your floor plan'}),e.jsxs("div",{className:"mt-4 space-y-1 text-sm",children:[e.jsx("div",{children:"â€¢ Drag tables to move them around"}),e.jsx("div",{children:"â€¢ Click tables to select and edit properties"}),e.jsx("div",{children:"â€¢ Add chairs from the top toolbar or the table properties panel"}),e.jsx("div",{children:"â€¢ Use multiple floors for complex layouts"})]})]})}),w==null?void 0:w.tables.map(s=>e.jsx(xr,{table:s,isSelected:(n==null?void 0:n.type)==="table"&&n.id===s.id,chairs:w.chairs.filter(a=>a.tableId===s.id),onSelect:()=>Y("table",s.id),onDrag:C,onDragEnd:xe},s.id)),w==null?void 0:w.objects.map(s=>e.jsx(wr,{object:s,isSelected:(n==null?void 0:n.type)==="object"&&n.id===s.id,onSelect:()=>Y("object",s.id),onDragStart:a=>C(a,s.id)},s.id)),w==null?void 0:w.walls.map(s=>e.jsx(er,{wall:s,isSelected:(n==null?void 0:n.type)==="wall"&&n.id===s.id,onSelect:()=>Y("wall",s.id),onDragHandle:(a,i)=>g(a,s.id,i),onDragStart:a=>C(a,s.id)},s.id)),Q&&c&&Z&&me&&e.jsx(er,{wall:{id:"temp-wall",type:me,startX:c.x,startY:c.y,endX:Z.x,endY:Z.y,thickness:8},isSelected:!1,onSelect:()=>{}}),S&&e.jsx("div",{className:"absolute pointer-events-none",style:{left:`${S.startX}px`,top:`${S.startY}px`,width:`${Math.sqrt(Math.pow(S.endX-S.startX,2)+Math.pow(S.endY-S.startY,2))}px`,height:"4px",transform:`rotate(${Math.atan2(S.endY-S.startY,S.endX-S.startX)*(180/Math.PI)}deg)`,transformOrigin:"top left",zIndex:15},children:e.jsx("div",{className:"w-full h-full border-2 border-blue-400 border-dashed opacity-70 bg-blue-100 rounded-sm"})}),w==null?void 0:w.fixedElements.map(s=>e.jsx(br,{element:s,isSelected:(n==null?void 0:n.type)==="fixedElement"&&n.id===s.id,onSelect:()=>Y("fixedElement",s.id),onDragStart:a=>C(a,s.id)},s.id)),w==null?void 0:w.chairs.map(s=>{const a=w.tables.find(f=>f.id===s.tableId);if(!a)return null;const i=w.chairs.filter(f=>f.tableId===s.tableId&&f.position===s.position).length;return e.jsx(mr,{chair:s,table:a,totalChairsOnSide:i,isSelected:!1,onSelect:()=>{},onDrag:()=>{},onDragEnd:()=>{}},s.id)}),n&&n.type==="table"&&se&&e.jsx("div",{className:"absolute border-2 border-blue-500 border-dashed rounded pointer-events-none",style:{left:se.x-10,top:se.y-10,width:(se.shape==="rectangle"?se.width*1.5:se.width)+20,height:se.height+20,transform:`rotate(${se.rotation||0}deg)`}})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-white bg-opacity-95 border-t border-gray-200 p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{children:["Floor: ",w==null?void 0:w.name]})]}),U&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Dragging..."})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-gray-500",children:["Zoom: ",Math.round(J*100),"% | Grid: ",H?"On":"Off"]}),n&&e.jsx("div",{className:"text-blue-600 font-medium",children:n.type==="table"&&se?`${se.name} (${se.shape})`:"Element Selected"})]})]})})]})]}),w&&e.jsx(sr,{floor:w,isOpen:Me,onClose:()=>Ye(!1)})]})};Ae.Preview3DModal=sr,Ae.RestaurantFloorPlanner=Sr,Object.defineProperty(Ae,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=restaurant-floor-planner.umd.js.map
